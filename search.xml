<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>Androidçš„mavenæ’ä»¶å’Œmaven-publishæ’ä»¶</title>
    <url>/Android%E7%9A%84maven%E6%8F%92%E4%BB%B6%E5%92%8Cmaven-publish%E6%8F%92%E4%BB%B6.html</url>
    <content><![CDATA[<h4 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h4><p>ç”±äºmavenæ’ä»¶å·²ç»åºŸå¼ƒï¼Œè¢«maven-publishæ’ä»¶æ›¿ä»£äº†ï¼Œæœ‰äº›è€é¡¹ç›®è¿˜åœ¨ä½¿ç”¨mavenæ’ä»¶ï¼Œæ‰€ä»¥éœ€è¦çŸ¥é“å¦‚ä½•å‡çº§ï¼Œè¿™é‡Œåšä¸€ä¸ªå¯¹æ¯”ã€‚</p>
<h4 id="mavenæ’ä»¶"><a href="#mavenæ’ä»¶" class="headerlink" title="mavenæ’ä»¶"></a>mavenæ’ä»¶</h4><p>ä»¥ä¸‹æ˜¯æ€»ä½“é…ç½®ï¼Œå…·ä½“è¿˜ä¼šæ¶‰åŠï¼šæ˜¯å¦ä¸Šä¼ æºç </p>
<figure class="highlight groovy"><table><tr><td class="code"><pre><span class="line">apply <span class="attr">plugin:</span> <span class="string">&#x27;maven&#x27;</span></span><br><span class="line"></span><br><span class="line">uploadArchives &#123;</span><br><span class="line">    repositories &#123;</span><br><span class="line">        mavenDeployer &#123;</span><br><span class="line">            <span class="comment">//release è¿˜æ˜¯snapshotæ‰“åŒ…</span></span><br><span class="line">            <span class="keyword">def</span> isRelease = project.AAR_BUILD_TYPE == <span class="string">&quot;release&quot;</span></span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> (isRelease) &#123;</span><br><span class="line">                repository(<span class="attr">url:</span> project.RELEASE_URL) &#123; <span class="comment">//æ­£å¼ä»“åº“åœ°å€</span></span><br><span class="line">                    authentication(<span class="attr">userName:</span> project.MAVEN_USERNAME, <span class="attr">password:</span> project.MAVEN_PASSWORD)</span><br><span class="line">                &#125;</span><br><span class="line">                pom.version = project.AAR_VERSION<span class="comment">//eg: 1.0.0</span></span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                repository(<span class="attr">url:</span> project.SNAPSHOT_URL) &#123;<span class="comment">//æµ‹è¯•ä»“åº“åœ°å€</span></span><br><span class="line">                    authentication(<span class="attr">userName:</span> project.MAVEN_USERNAME, <span class="attr">password:</span> project.MAVEN_PASSWORD)</span><br><span class="line">                &#125;</span><br><span class="line">                pom.version = project.AAR_SNAPSHOT_VERSION<span class="comment">//eg: 1.0.0-shapshot</span></span><br><span class="line">            &#125;</span><br><span class="line">            pom.groupId = project.POM_GROUPID<span class="comment">//egï¼šcom.github.bumptech.glide</span></span><br><span class="line">            pom.artifactId = project.POM_ARTIFACTID<span class="comment">//eg: glide</span></span><br><span class="line">            pom.name = project.POM_NAME<span class="comment">// eg: glide</span></span><br><span class="line">            pom.packaging = project.POM_PACKAGING<span class="comment">//eg: aar/jar</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h4 id="maven-publishæ’ä»¶"><a href="#maven-publishæ’ä»¶" class="headerlink" title="maven-publishæ’ä»¶"></a>maven-publishæ’ä»¶</h4><figure class="highlight groovy"><table><tr><td class="code"><pre><span class="line">apply <span class="attr">plugin:</span> <span class="string">&#x27;maven-publish&#x27;</span></span><br><span class="line"></span><br><span class="line">publishing &#123;</span><br><span class="line">    repositories &#123;<span class="comment">//ä»“åº“</span></span><br><span class="line">        maven &#123;</span><br><span class="line">            url = <span class="string">&quot;https://s01.oss.sonatype.org/service/local/staging/deploy/maven2/&quot;</span></span><br><span class="line">            credentials &#123;</span><br><span class="line">                username = <span class="string">&quot;sonatypeUsername&quot;</span></span><br><span class="line">                password = <span class="string">&quot;sonatypePassword&quot;</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    publications &#123;<span class="comment">//å‘å¸ƒäº§ç‰©</span></span><br><span class="line">        <span class="comment">//ä¸‹é¢è¿™ä¸ªåå­—å¯ä»¥è‡ªå·±å®šä¹‰å¦‚ï¼šdebugã€release</span></span><br><span class="line">        maven(MavenPublication) &#123;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">//é…ç½®äº§ç‰©ï¼Œä¸‰ç§æ–¹å¼</span></span><br><span class="line">            <span class="comment">//1ã€ä¾èµ–bundleReleaseAarä»»åŠ¡ï¼Œå¹¶ä¸Šä¼ äº§ç‰©</span></span><br><span class="line">            afterEvaluate&#123;</span><br><span class="line">                artifact(tasks.getByName(<span class="string">&quot;bundleReleaseAar&quot;</span>))</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//2ã€ç›´æ¥æŒ‡å®šè·¯å¾„</span></span><br><span class="line">            artifact <span class="string">&quot;$buildDir/outputs/aar/$&#123;project.name&#125;-release.aar&quot;</span></span><br><span class="line">            <span class="comment">//3ã€ç»“åˆagpæ’ä»¶</span></span><br><span class="line">            </span><br><span class="line">            groupId = <span class="string">&#x27;com.example&#x27;</span></span><br><span class="line">            artifactId = <span class="string">&#x27;my-library&#x27;</span></span><br><span class="line">            version = <span class="string">&#x27;1.0.0&#x27;</span></span><br><span class="line"></span><br><span class="line">            pom &#123;</span><br><span class="line">                name = <span class="string">&#x27;My Library&#x27;</span></span><br><span class="line">                description = <span class="string">&#x27;A description of my library&#x27;</span></span><br><span class="line">                url = <span class="string">&#x27;https://github.com/example/my-library&#x27;</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>ç»“åˆagpæ’ä»¶ï¼ŒæŒ‡å®šäº§ç‰©ï¼š</p>
<figure class="highlight groovy"><table><tr><td class="code"><pre><span class="line">afterEvaluate &#123;</span><br><span class="line">    publishing &#123;</span><br><span class="line">        repositories &#123;<span class="comment">//ä»“åº“</span></span><br><span class="line">        </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    publications &#123;<span class="comment">//å‘å¸ƒäº§ç‰©</span></span><br><span class="line">        maven(MavenPublication) &#123;</span><br><span class="line">            from components.release<span class="comment">//å‘å¸ƒå†…å®¹</span></span><br><span class="line">            artifact sourcejar<span class="comment">//ä¸Šä¼ æºç </span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h4 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h4><p><a href="https://blog.csdn.net/h_bpdwn/article/details/122479437">mavenæ’ä»¶ å’Œ maven-publish æ’ä»¶çš„åŒºåˆ«</a><br><a href="https://www.bytezonex.com/archives/R8trm3Wz.html">Maven æ’ä»¶ä¸ Maven-Publish æ’ä»¶çš„å·®å¼‚</a></p>
]]></content>
  </entry>
  <entry>
    <title>Androidæ¶ˆæ¯æœºåˆ¶</title>
    <url>/android-aosp-event-loop.html</url>
    <content><![CDATA[<hr>
<h4 id="ä¸€ã€ç›¸å…³ç±»å’Œç»“æ„"><a href="#ä¸€ã€ç›¸å…³ç±»å’Œç»“æ„" class="headerlink" title="ä¸€ã€ç›¸å…³ç±»å’Œç»“æ„"></a>ä¸€ã€ç›¸å…³ç±»å’Œç»“æ„</h4><center>
    <img src="../images/android-basic-eventloop.png" width="100%"/>
</center>

<h4 id="äºŒã€åŸºæœ¬ä½¿ç”¨"><a href="#äºŒã€åŸºæœ¬ä½¿ç”¨" class="headerlink" title="äºŒã€åŸºæœ¬ä½¿ç”¨"></a>äºŒã€åŸºæœ¬ä½¿ç”¨</h4><h5 id="2-1-ä¸»çº¿ç¨‹çš„äº‹ä»¶å¾ªç¯"><a href="#2-1-ä¸»çº¿ç¨‹çš„äº‹ä»¶å¾ªç¯" class="headerlink" title="2.1 ä¸»çº¿ç¨‹çš„äº‹ä»¶å¾ªç¯"></a>2.1 ä¸»çº¿ç¨‹çš„äº‹ä»¶å¾ªç¯</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> android.app;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">ActivityThread</span> <span class="keyword">extends</span> <span class="title">ClientTransactionHandler</span></span></span><br><span class="line"><span class="class">        <span class="keyword">implements</span> <span class="title">ActivityThreadInternal</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">     <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">         <span class="comment">//...</span></span><br><span class="line">         Looper.prepareMainLooper();</span><br><span class="line">         </span><br><span class="line">         Looper.loop();</span><br><span class="line">     &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h5 id="2-2-æ„å»ºè‡ªå·±çš„äº‹ä»¶å¾ªç¯"><a href="#2-2-æ„å»ºè‡ªå·±çš„äº‹ä»¶å¾ªç¯" class="headerlink" title="2.2 æ„å»ºè‡ªå·±çš„äº‹ä»¶å¾ªç¯"></a>2.2 æ„å»ºè‡ªå·±çš„äº‹ä»¶å¾ªç¯</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LooperThread</span> <span class="keyword">extends</span> <span class="title">Thread</span> </span>&#123;</span><br><span class="line">      <span class="keyword">public</span> Handler mHandler;</span><br><span class="line"></span><br><span class="line">      <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">          Looper.prepare();</span><br><span class="line"></span><br><span class="line">          mHandler = <span class="keyword">new</span> Handler() &#123;</span><br><span class="line">              <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handleMessage</span><span class="params">(Message msg)</span> </span>&#123;</span><br><span class="line">                  <span class="comment">// process incoming messages here</span></span><br><span class="line">              &#125;</span><br><span class="line">          &#125;;</span><br><span class="line"></span><br><span class="line">          Looper.loop();</span><br><span class="line">      &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="ä¸‰ã€åŸç†å‰–æ"><a href="#ä¸‰ã€åŸç†å‰–æ" class="headerlink" title="ä¸‰ã€åŸç†å‰–æ"></a>ä¸‰ã€åŸç†å‰–æ</h4><h5 id="3-1-æ„å»ºäº‹ä»¶å¾ªç¯"><a href="#3-1-æ„å»ºäº‹ä»¶å¾ªç¯" class="headerlink" title="3.1 æ„å»ºäº‹ä»¶å¾ªç¯"></a>3.1 æ„å»ºäº‹ä»¶å¾ªç¯</h5><center>
    <img src="../images/android-basic-eventloop-start.png" width="70%"/>
</center>


<h5 id="3-2-å‘é€æ¶ˆæ¯"><a href="#3-2-å‘é€æ¶ˆæ¯" class="headerlink" title="3.2 å‘é€æ¶ˆæ¯"></a>3.2 å‘é€æ¶ˆæ¯</h5><center>
    <img src="../images/android-basic-eventloop-send.png" width="70%"/>
</center>


<h5 id="3-3-æ¶ˆæ¯æ‰§è¡Œ"><a href="#3-3-æ¶ˆæ¯æ‰§è¡Œ" class="headerlink" title="3.3 æ¶ˆæ¯æ‰§è¡Œ"></a>3.3 æ¶ˆæ¯æ‰§è¡Œ</h5><center>
    <img src="../images/android-basic-eventloop-callback.png" width="50%"/>
</center>

<h5 id="3-4-åŒæ­¥å±éšœ"><a href="#3-4-åŒæ­¥å±éšœ" class="headerlink" title="3.4 åŒæ­¥å±éšœ"></a>3.4 åŒæ­¥å±éšœ</h5><h6 id="3-4-1-æ¶ˆæ¯çš„åˆ†ç±»"><a href="#3-4-1-æ¶ˆæ¯çš„åˆ†ç±»" class="headerlink" title="3.4.1 æ¶ˆæ¯çš„åˆ†ç±»"></a>3.4.1 æ¶ˆæ¯çš„åˆ†ç±»</h6><ul>
<li>åŒæ­¥æ¶ˆæ¯</li>
<li>å¼‚æ­¥æ¶ˆæ¯</li>
<li>å±éšœæ¶ˆæ¯</li>
</ul>
<h6 id="3-4-2-åŒæ­¥å±éšœæ˜¯ä»€ä¹ˆ"><a href="#3-4-2-åŒæ­¥å±éšœæ˜¯ä»€ä¹ˆ" class="headerlink" title="3.4.2 åŒæ­¥å±éšœæ˜¯ä»€ä¹ˆ"></a>3.4.2 åŒæ­¥å±éšœæ˜¯ä»€ä¹ˆ</h6><p>ä¸€ç§ç‰¹æ®Šçš„Messageï¼Œå…¶target=null</p>
<h6 id="3-4-3-åŒæ­¥å±éšœå·¥ä½œåŸç†"><a href="#3-4-3-åŒæ­¥å±éšœå·¥ä½œåŸç†" class="headerlink" title="3.4.3 åŒæ­¥å±éšœå·¥ä½œåŸç†"></a>3.4.3 åŒæ­¥å±éšœå·¥ä½œåŸç†</h6><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function">Message <span class="title">next</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> pendingIdleHandlerCount = -<span class="number">1</span>; <span class="comment">// -1 only during first iteration</span></span><br><span class="line">    <span class="keyword">int</span> nextPollTimeoutMillis = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (;;) &#123;</span><br><span class="line">        <span class="comment">//...</span></span><br><span class="line">        <span class="keyword">synchronized</span> (<span class="keyword">this</span>) &#123;</span><br><span class="line">            <span class="comment">// Try to retrieve the next message.  Return if found.</span></span><br><span class="line">            <span class="keyword">final</span> <span class="keyword">long</span> now = SystemClock.uptimeMillis();</span><br><span class="line">            Message prevMsg = <span class="keyword">null</span>;</span><br><span class="line">            Message msg = mMessages;</span><br><span class="line">            <span class="keyword">if</span> (msg != <span class="keyword">null</span> &amp;&amp; msg.target == <span class="keyword">null</span>) &#123;<span class="comment">//ç¢°åˆ°åŒæ­¥å±éšœ</span></span><br><span class="line">                <span class="comment">// Stalled by a barrier.  Find the next asynchronous message in the queue.</span></span><br><span class="line">                <span class="comment">// do whileå¾ªç¯éå†æ¶ˆæ¯é“¾è¡¨</span></span><br><span class="line">                <span class="comment">// è·³å‡ºå¾ªç¯æ—¶ï¼ŒmsgæŒ‡å‘ç¦»è¡¨å¤´æœ€è¿‘çš„ä¸€ä¸ªå¼‚æ­¥æ¶ˆæ¯</span></span><br><span class="line">                <span class="keyword">do</span> &#123;</span><br><span class="line">                    prevMsg = msg;</span><br><span class="line">                    msg = msg.next;</span><br><span class="line">                &#125; <span class="keyword">while</span> (msg != <span class="keyword">null</span> &amp;&amp; !msg.isAsynchronous());</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (msg != <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (now &lt; msg.when) &#123;</span><br><span class="line">                    <span class="comment">//...</span></span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="comment">// Got a message.</span></span><br><span class="line">                    mBlocked = <span class="keyword">false</span>;</span><br><span class="line">                    <span class="keyword">if</span> (prevMsg != <span class="keyword">null</span>) &#123;</span><br><span class="line">                        <span class="comment">//å°†msgä»æ¶ˆæ¯é“¾è¡¨ä¸­ç§»é™¤</span></span><br><span class="line">                        prevMsg.next = msg.next;</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        mMessages = msg.next;</span><br><span class="line">                    &#125;</span><br><span class="line">                    msg.next = <span class="keyword">null</span>;</span><br><span class="line">                    <span class="keyword">if</span> (DEBUG) Log.v(TAG, <span class="string">&quot;Returning message: &quot;</span> + msg);</span><br><span class="line">                    msg.markInUse();</span><br><span class="line">                    <span class="comment">//è¿”å›å¼‚æ­¥æ¶ˆæ¯</span></span><br><span class="line">                    <span class="keyword">return</span> msg;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">// No more messages.</span></span><br><span class="line">                nextPollTimeoutMillis = -<span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//...</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å½“è®¾ç½®äº†åŒæ­¥å±éšœä¹‹åï¼Œnextå‡½æ•°å°†ä¼šå¿½ç•¥æ‰€æœ‰çš„åŒæ­¥æ¶ˆæ¯ï¼Œè¿”å›å¼‚æ­¥æ¶ˆæ¯ã€‚æ¢å¥è¯è¯´å°±æ˜¯ï¼Œè®¾ç½®äº†åŒæ­¥å±éšœä¹‹åï¼ŒHandleråªä¼šå¤„ç†å¼‚æ­¥æ¶ˆæ¯ã€‚å†æ¢å¥è¯è¯´ï¼ŒåŒæ­¥å±éšœä¸ºHandleræ¶ˆæ¯æœºåˆ¶å¢åŠ äº†ä¸€ç§ç®€å•çš„ä¼˜å…ˆçº§æœºåˆ¶ï¼Œå¼‚æ­¥æ¶ˆæ¯çš„ä¼˜å…ˆçº§è¦é«˜äºåŒæ­¥æ¶ˆæ¯ã€‚</p>
<h6 id="3-4-4-å®é™…åº”ç”¨"><a href="#3-4-4-å®é™…åº”ç”¨" class="headerlink" title="3.4.4 å®é™…åº”ç”¨"></a>3.4.4 å®é™…åº”ç”¨</h6><p>Androidåº”ç”¨æ¡†æ¶ä¸­ä¸ºäº†æ›´å¿«çš„å“åº”UIåˆ·æ–°äº‹ä»¶åœ¨ViewRootImpl.scheduleTraversalsä¸­ä½¿ç”¨äº†åŒæ­¥å±éšœ</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">scheduleTraversals</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!mTraversalScheduled) &#123;</span><br><span class="line">        mTraversalScheduled = <span class="keyword">true</span>;</span><br><span class="line">        <span class="comment">//è®¾ç½®åŒæ­¥éšœç¢ï¼Œç¡®ä¿mTraversalRunnableä¼˜å…ˆè¢«æ‰§è¡Œ</span></span><br><span class="line">        mTraversalBarrier = mHandler.getLooper().getQueue().postSyncBarrier();</span><br><span class="line">        <span class="comment">//å†…éƒ¨é€šè¿‡Handlerå‘é€äº†ä¸€ä¸ªå¼‚æ­¥æ¶ˆæ¯</span></span><br><span class="line">        mChoreographer.postCallback(</span><br><span class="line">                Choreographer.CALLBACK_TRAVERSAL, mTraversalRunnable, <span class="keyword">null</span>);</span><br><span class="line">        <span class="keyword">if</span> (!mUnbufferedInputDispatch) &#123;</span><br><span class="line">            scheduleConsumeBatchedInput();</span><br><span class="line">        &#125;</span><br><span class="line">        notifyRendererOfFramePending();</span><br><span class="line">        pokeDrawLockIfNeeded();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h4 id="å››ã€å…¶ä»–"><a href="#å››ã€å…¶ä»–" class="headerlink" title="å››ã€å…¶ä»–"></a>å››ã€å…¶ä»–</h4><p><a href="https://www.jxhs.me/2021/04/08/linux%E5%86%85%E6%A0%B8Epoll-%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86/">Epoll å®ç°åŸç†</a></p>
<p><a href="https://www.cnblogs.com/LoyenWang/p/12622904.html">Linux select/pollæœºåˆ¶åŸç†åˆ†æ</a></p>
]]></content>
      <categories>
        <category>è®¡ç®—æœº</category>
      </categories>
      <tags>
        <tag>Android</tag>
      </tags>
  </entry>
  <entry>
    <title>Androidä¸­çš„çº¦æŸå¸ƒå±€</title>
    <url>/android-basic-constraintlayout.html</url>
    <content><![CDATA[<h4 id="ä¸€ã€æ¦‚è¿°"><a href="#ä¸€ã€æ¦‚è¿°" class="headerlink" title="ä¸€ã€æ¦‚è¿°"></a>ä¸€ã€æ¦‚è¿°</h4><p>&ensp;&ensp;&ensp;&ensp;Androidä¸­çš„è§†å›¾æ˜¯ä»¥æ ‘çš„å½¢å¼ç»„ç»‡èµ·æ¥çš„ï¼Œå®ƒæ˜¯ä¸€ç§å±‚æ¬¡ç»“æ„ã€‚åœ¨ä»£ç ä¸­ä½“ç°ä¸ºç»„åˆæ¨¡å¼ï¼Œä¸€ä¸ªViewGroupå¯ä»¥åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªViewï¼ŒåŒæ—¶ViewGroupåˆæ˜¯ä¸€ä¸ªViewã€‚åœ¨å¸ƒå±€æ–‡ä»¶ä¸­ä½“ç°ä¸ºxmlçš„ç»“ç‚¹å’Œç¼©è¿›ã€‚<br>&ensp;&ensp;&ensp;&ensp;åŒæ—¶è§†å›¾çš„æ¸²æŸ“å°‘ä¸äº†å¯¹å…¶è¿›è¡Œéå†ï¼Œè¿™å°±æ¶‰åŠæ•°æ®ç»“æ„ä¸­æ ‘çš„æ·±åº¦ä¼˜å…ˆéå†å’Œå¹¿åº¦ä¼˜å…ˆéå†ã€‚æœ‰æ—¶å€™ä¸€äº›å¤æ‚çš„å¸ƒå±€ä¸€æ¬¡éå†è¿˜æ— æ³•å®Œå…¨ç¡®å®šViewçš„ä¿¡æ¯ã€‚å¦‚ä½•é€šè¿‡ç®—æ³•æ–¹å¼é™ä½æ ‘çš„å±‚æ¬¡å‘¢ï¼Ÿä¹Ÿè®¸è¿™å°±æ˜¯çº¦æŸå¸ƒå±€å­˜åœ¨çš„æ„ä¹‰å§ã€‚<br>&ensp;&ensp;&ensp;&ensp;åœ¨Androidä¸­ï¼Œçµæ´»è¿ç”¨ConstraintLayoutåŒ…æ‹¬ä»¥ä¸‹å‡ ä¸ªç‚¹ï¼š</p>
<ul>
<li>ä¸»å±æ€§<ul>
<li>é€šè¿‡ç›¸å¯¹ä½ç½®çº¦æŸView</li>
<li>æ§åˆ¶çº¦æŸä¹‹é—´çš„è·ç¦»</li>
<li>å±…ä¸­å’Œåç§»ç™¾åˆ†æ¯”</li>
<li>é€šè¿‡åœ†å®šä½ğŸ“ŒView</li>
<li>é€šè¿‡å¯è§æ€§æ§åˆ¶View</li>
<li>é€šè¿‡åˆ†è¾¨ç‡çº¦æŸView</li>
<li>é€šè¿‡é“¾â›“çº¦æŸView</li>
</ul>
</li>
<li>è¾…åŠ©å·¥å…·<ul>
<li>Barrierå±éšœçº¦æŸ</li>
<li>Groupåˆ†ç»„çº¦æŸ</li>
<li>Placeholderå ä½çº¦æŸ</li>
<li>Guidelineå¼•å¯¼çº¿çº¦æŸ</li>
</ul>
</li>
</ul>
<h4 id="äºŒã€ä½¿ç”¨"><a href="#äºŒã€ä½¿ç”¨" class="headerlink" title="äºŒã€ä½¿ç”¨"></a>äºŒã€ä½¿ç”¨</h4><h5 id="2-1-é€šè¿‡ç›¸å¯¹ä½ç½®çº¦æŸView"><a href="#2-1-é€šè¿‡ç›¸å¯¹ä½ç½®çº¦æŸView" class="headerlink" title="2.1 é€šè¿‡ç›¸å¯¹ä½ç½®çº¦æŸView"></a>2.1 é€šè¿‡ç›¸å¯¹ä½ç½®çº¦æŸView</h5><center>
    <img src="../images/constraint/constraint_relative_position.png" width="500"/>
</center>

<table>
<thead>
<tr>
<th>çº¦æŸå±æ€§</th>
<th>æè¿°</th>
<th>çº¦æŸå±æ€§</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td>layout_constraintLeft_toLeftOf</td>
<td></td>
<td>layout_constraintLeft_toRightOf</td>
<td></td>
</tr>
<tr>
<td>layout_constraintRight_toLeftOf</td>
<td></td>
<td>layout_constraintRight_toRightOf</td>
<td></td>
</tr>
<tr>
<td>layout_constraintTop_toTopOf</td>
<td></td>
<td>layout_constraintTop_toBottomOf</td>
<td></td>
</tr>
<tr>
<td>layout_constraintBottom_toTopOf</td>
<td></td>
<td>layout_constraintBottom_toBottomOf</td>
<td></td>
</tr>
<tr>
<td>layout_constraintStart_toEndOf</td>
<td></td>
<td>layout_constraintStart_toStartOf</td>
<td></td>
</tr>
<tr>
<td>layout_constraintEnd_toStartOf</td>
<td></td>
<td>layout_constraintEnd_toEndOf</td>
<td></td>
</tr>
<tr>
<td>layout_constraintBaseline_toBaselineOf</td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>
<h5 id="2-2-æ§åˆ¶çº¦æŸä¹‹é—´çš„è·ç¦»"><a href="#2-2-æ§åˆ¶çº¦æŸä¹‹é—´çš„è·ç¦»" class="headerlink" title="2.2 æ§åˆ¶çº¦æŸä¹‹é—´çš„è·ç¦»"></a>2.2 æ§åˆ¶çº¦æŸä¹‹é—´çš„è·ç¦»</h5><center>
    <img src="../images/constraint/constraint_margin.png" width="500"/>
</center> 

<table>
<thead>
<tr>
<th>çº¦æŸå±æ€§</th>
<th>æè¿°</th>
<th>çº¦æŸå±æ€§</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td>android:layout_marginStart</td>
<td></td>
<td>layout_goneMarginStart</td>
<td></td>
</tr>
<tr>
<td>android:layout_marginEnd</td>
<td></td>
<td>layout_goneMarginEnd</td>
<td></td>
</tr>
<tr>
<td>android:layout_marginLeft</td>
<td></td>
<td>layout_goneMarginLeft</td>
<td></td>
</tr>
<tr>
<td>android:layout_marginTop</td>
<td></td>
<td>layout_goneMarginTop</td>
<td></td>
</tr>
<tr>
<td>android:layout_marginRight</td>
<td></td>
<td>layout_goneMarginRight</td>
<td></td>
</tr>
<tr>
<td>android:layout_marginBottom</td>
<td></td>
<td>layout_goneMarginBottom</td>
<td></td>
</tr>
<tr>
<td>android:layout_marginBaseline</td>
<td></td>
<td>layout_goneMarginBaseline</td>
<td></td>
</tr>
</tbody></table>
<h5 id="2-3-å±…ä¸­å’Œåç§»ç™¾åˆ†æ¯”"><a href="#2-3-å±…ä¸­å’Œåç§»ç™¾åˆ†æ¯”" class="headerlink" title="2.3 å±…ä¸­å’Œåç§»ç™¾åˆ†æ¯”"></a>2.3 å±…ä¸­å’Œåç§»ç™¾åˆ†æ¯”</h5><table>
    <tr>
        <td><img src="../images/constraint/constraint_center_position.png" width="300"/></td>
        <td><img src="../images/constraint/constraint_center_position_bias.png" width="300"/></td>
    </tr>
</table>

<table>
<thead>
<tr>
<th>çº¦æŸå±æ€§</th>
<th>æè¿°</th>
<th>çº¦æŸå±æ€§</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td>layout_constraintHorizontal_bias</td>
<td></td>
<td>layout_constraintVertical_bias</td>
<td></td>
</tr>
</tbody></table>
<h5 id="2-4-é€šè¿‡åœ†å®šä½ğŸ“ŒView"><a href="#2-4-é€šè¿‡åœ†å®šä½ğŸ“ŒView" class="headerlink" title="2.4 é€šè¿‡åœ†å®šä½ğŸ“ŒView"></a>2.4 é€šè¿‡åœ†å®šä½ğŸ“ŒView</h5><center>
    <img src="../images/constraint/constraint_circular_position.jpeg" width="400"/>
</center>

<table>
<thead>
<tr>
<th>çº¦æŸå±æ€§</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td>layout_constraintCircle</td>
<td>å¦ä¸€ä¸ªwidgetçš„id</td>
</tr>
<tr>
<td>layout_constraintCircleRadius</td>
<td>åœ†çš„åŠå¾„</td>
</tr>
<tr>
<td>layout_constraintCircleAngle</td>
<td>è§’åº¦</td>
</tr>
</tbody></table>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Button</span> <span class="attr">android:id</span>=<span class="string">&quot;@+id/buttonB&quot;</span> </span></span><br><span class="line"><span class="tag">   <span class="attr">app:layout_constraintCircle</span>=<span class="string">&quot;@+id/buttonA&quot;</span></span></span><br><span class="line"><span class="tag">   <span class="attr">app:layout_constraintCircleRadius</span>=<span class="string">&quot;100dp&quot;</span></span></span><br><span class="line"><span class="tag">   <span class="attr">app:layout_constraintCircleAngle</span>=<span class="string">&quot;45&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="2-5-é€šè¿‡å¯è§æ€§æ§åˆ¶View"><a href="#2-5-é€šè¿‡å¯è§æ€§æ§åˆ¶View" class="headerlink" title="2.5 é€šè¿‡å¯è§æ€§æ§åˆ¶View"></a>2.5 é€šè¿‡å¯è§æ€§æ§åˆ¶View</h5><center>
    <img src="../images/constraint/constraint_visibility_behavior.jpeg" width="400"/>
</center>

<h5 id="2-6-é€šè¿‡åˆ†è¾¨ç‡çº¦æŸView"><a href="#2-6-é€šè¿‡åˆ†è¾¨ç‡çº¦æŸView" class="headerlink" title="2.6 é€šè¿‡åˆ†è¾¨ç‡çº¦æŸView"></a>2.6 é€šè¿‡åˆ†è¾¨ç‡çº¦æŸView</h5><table>
<thead>
<tr>
<th>çº¦æŸå±æ€§</th>
<th>æè¿°</th>
<th>çº¦æŸå±æ€§</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td>android:minWidth</td>
<td></td>
<td>android:minHeight</td>
<td></td>
</tr>
<tr>
<td>android:maxWidth</td>
<td></td>
<td>android:maxHeight</td>
<td></td>
</tr>
</tbody></table>
<p>2.6.1 ç™¾åˆ†æ¯”</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Button</span> <span class="attr">android:id</span>=<span class="string">&quot;@+id/buttonA&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;0dp&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">app:layout_constraintWidth_default</span>=<span class="string">&quot;percent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">app:layout_constraintWidth_percent</span>=<span class="string">&quot;0.5&quot;</span></span></span><br><span class="line"><span class="tag">/&gt;</span></span><br></pre></td></tr></table></figure>
<p><code>app:layout_constraintWidth_default</code>å¯ä»¥å–çš„å€¼åŒ…æ‹¬ï¼š</p>
<ul>
<li>spread</li>
<li>percent</li>
<li>wrap</li>
</ul>
<p>åœ¨ConstraintLayout-1.1ä¹‹åï¼Œä½¿ç”¨<code>app:layout_constrainedWidth=&quot;true&quot;</code>æ›¿ä»£<code>app:layout_constraintWidth_default=&quot;wrap&quot;</code></p>
<p>2.6.2 æ¯”ç‡<br>å®½é«˜ä¸€æ¯”ä¸€ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Button</span> <span class="attr">android:id</span>=<span class="string">&quot;@+id/buttonA&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;0dp&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">app:layout_constraintDimensionRatio</span>=<span class="string">&quot;1:1&quot;</span></span></span><br><span class="line"><span class="tag">/&gt;</span></span><br></pre></td></tr></table></figure>
<p>æŒ‡å®šä¸€æ¡è¾¹ç¬¦åˆçº¦æŸæ¯”ç‡ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Button</span> <span class="attr">android:layout_width</span>=<span class="string">&quot;0dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;0dp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintDimensionRatio</span>=<span class="string">&quot;H,16:9&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintBottom_toBottomOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintTop_toTopOf</span>=<span class="string">&quot;parent&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="2-7-é€šè¿‡é“¾â›“çº¦æŸView"><a href="#2-7-é€šè¿‡é“¾â›“çº¦æŸView" class="headerlink" title="2.7 é€šè¿‡é“¾â›“çº¦æŸView"></a>2.7 é€šè¿‡é“¾â›“çº¦æŸView</h5><table>
    <tr>
        <td><img src="../images/constraint/constraint_chain.png" width="300"/></td>
        <td><img src="../images/constraint/constraint_chain_head.png" width="300"/></td>
    </tr>
</table>

<table>
    <tr>
        <td>å›¾ç¤º</td>
        <td>Style</td>
    </tr>
    <tr>
        <td><img src="../images/constraint/constraint_chain_spread.png" width="250"/></td>
        <td> _chainStyle="spread" </td>
    </tr>
     <tr>
      <td><img src="../images/constraint/constraint_chain_spread_inside.png" width="250"/></td>
      <td> _chainStyle="spread_inside" </td>
     </tr>
     <tr>
     <td><img src="../images/constraint/constraint_chain_weight.png" width="250"/></td>
     <td> _chainStyle="spread" <br> _weight="1" </td>
     </tr>
     <tr>
     <td><img src="../images/constraint/constraint_chain_packed.png" width="250"/></td>
     <td> _chainStyle="packed" </td>
     </tr>
     <tr>
     <td><img src="../images/constraint/constraint_chain_bias.png" width="250"/></td>
     <td> _chainStyle="packed" <br> _bias="0.3"</td>
     </tr>
</table>

<h5 id="2-8-Barrier"><a href="#2-8-Barrier" class="headerlink" title="2.8 Barrier"></a>2.8 Barrier</h5><p>å°†å¤šä¸ªViewçš„æŸä¸€è¾¹çš„æç«¯å€¼ä½œä¸ºçº¦æŸï¼š</p>
<table>
    <tr>
        <td><img src="../images/constraint/constraint_barrier_start.png" width="300"/></td>
        <td><img src="../images/constraint/constraint_barrier_end.png" width="300"/></td>
    </tr>
</table>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">androidx.constraintlayout.widget.Barrier</span></span></span><br><span class="line"><span class="tag">              <span class="attr">android:id</span>=<span class="string">&quot;@+id/barrier&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">app:barrierDirection</span>=<span class="string">&quot;start/end&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">app:constraint_referenced_ids</span>=<span class="string">&quot;button1,button2&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="2-9-Groupåˆ†ç»„çº¦æŸ"><a href="#2-9-Groupåˆ†ç»„çº¦æŸ" class="headerlink" title="2.9 Groupåˆ†ç»„çº¦æŸ"></a>2.9 Groupåˆ†ç»„çº¦æŸ</h5><p>å°†å¤šä¸ªViewä½œä¸ºä¸€ä¸ªç»„ä¸€èµ·æ§åˆ¶ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">androidx.constraintlayout.widget.Group</span></span></span><br><span class="line"><span class="tag">              <span class="attr">android:id</span>=<span class="string">&quot;@+id/group&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">android:visibility</span>=<span class="string">&quot;visible&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">app:constraint_referenced_ids</span>=<span class="string">&quot;button4,button9&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>æ— æ³•é€šè¿‡groupè®¾ç½®ç‚¹å‡»äº‹ä»¶<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line">group.referencedIds.forEach &#123; id -&gt;</span><br><span class="line">     view.findViewById(id).setOnClickListener &#123;</span><br><span class="line">        <span class="comment">//do something</span></span><br><span class="line">     &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h5 id="2-10-Placeholderå ä½çº¦æŸ"><a href="#2-10-Placeholderå ä½çº¦æŸ" class="headerlink" title="2.10 Placeholderå ä½çº¦æŸ"></a>2.10 Placeholderå ä½çº¦æŸ</h5><p>&ensp;&ensp;&ensp;&ensp;Placeholderæ˜¯ä¸€ä¸ªè™šæ‹Ÿçš„å ä½ç¬¦Viewï¼Œç•Œé¢ä¸Šå…¶ä»–å­˜åœ¨çš„Viewå¯ä»¥é€šè¿‡<code>placeholder.setContentId(R.id.xxx)</code>å°†è‡ªå·±çš„ä½ç½®è®¾ç½®åˆ°placeholderçš„ä½ç½®ï¼ŒåŸä½ç½®è§†å›¾å°†ä¸å¯è§ã€‚<br>&ensp;&ensp;&ensp;&ensp;æˆ‘ä»¬å¯ä»¥ä½¿ç”¨Placeholderæ­å»ºä¸€ä¸ªå¸ƒå±€æ¨¡æ¿ï¼Œincludeåˆ°å…¶ä»–å¸ƒå±€å½“ä¸­ï¼Œæ¥å¡«å……æ¨¡æ¿ä¸­çš„è§†å›¾ï¼Œè¿™å°†ä½¿æ‰€æœ‰çš„ç•Œé¢æœ‰ä¸€ä¸ªé€šç”¨çš„æ¨¡æ¿ã€‚</p>
<h5 id="2-11-Guidelineå¼•å¯¼çº¿çº¦æŸ"><a href="#2-11-Guidelineå¼•å¯¼çº¿çº¦æŸ" class="headerlink" title="2.11 Guidelineå¼•å¯¼çº¿çº¦æŸ"></a>2.11 Guidelineå¼•å¯¼çº¿çº¦æŸ</h5><p>Guidelineåªèƒ½åœ¨ConstraintLayoutä¸­ä½¿ç”¨ï¼Œåœ¨æ°´å¹³æˆ–å‚ç›´æ–¹å‘è®¾ç½®è¾…åŠ©å¸ƒå±€çš„ä¸å¯è§çº¿æ¡ã€‚</p>
<table>
<thead>
<tr>
<th>çº¦æŸå±æ€§</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td>layout_constraintGuide_begin</td>
<td>è·å¸ƒå±€çš„å·¦è¾¹æˆ–è€…ä¸Šè¾¹xå¤„è®¾ç½®å¼•å¯¼çº¿</td>
</tr>
<tr>
<td>layout_constraintGuide_end</td>
<td>è·å¸ƒå±€å³è¾¹æˆ–ä¸‹é¢xå¤„è®¾ç½®å¼•å¯¼çº¿</td>
</tr>
<tr>
<td>layout_constraintGuide_percent</td>
<td>å®½æˆ–é«˜çš„ç™¾åˆ†ä¹‹xå¤„è®¾ç½®å¼•å¯¼çº¿</td>
</tr>
</tbody></table>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">androidx.constraintlayout.widget.ConstraintLayout</span></span></span><br><span class="line"><span class="tag">        <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">xmlns:app</span>=<span class="string">&quot;http://schemas.android.com/apk/res-auto&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">xmlns:tools</span>=<span class="string">&quot;http://schemas.android.com/tools&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">androidx.constraintlayout.widget.Guideline</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:id</span>=<span class="string">&quot;@+id/guideline&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">app:layout_constraintGuide_begin</span>=<span class="string">&quot;100dp&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:orientation</span>=<span class="string">&quot;vertical&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">Button</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:text</span>=<span class="string">&quot;Button&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:id</span>=<span class="string">&quot;@+id/button&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">app:layout_constraintLeft_toLeftOf</span>=<span class="string">&quot;@+id/guideline&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_marginTop</span>=<span class="string">&quot;16dp&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">app:layout_constraintTop_toTopOf</span>=<span class="string">&quot;parent&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">androidx.constraintlayout.widget.ConstraintLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="ä¸‰ã€åŸç†"><a href="#ä¸‰ã€åŸç†" class="headerlink" title="ä¸‰ã€åŸç†"></a>ä¸‰ã€åŸç†</h4><h5 id="3-1-è§£å†³çº¦æŸé—®é¢˜"><a href="#3-1-è§£å†³çº¦æŸé—®é¢˜" class="headerlink" title="3.1 è§£å†³çº¦æŸé—®é¢˜"></a>3.1 è§£å†³çº¦æŸé—®é¢˜</h5><p>3.1.1 å®šä¹‰å˜é‡</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">x[1], x[2], ... x[n]</span><br></pre></td></tr></table></figure>
<p>3.1.2 å®šä¹‰çº¦æŸé—®é¢˜ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">a[1]x[1] + ... + a[n]x[n] = b</span><br><span class="line">a[1]x[1] + ... + a[n]x[n] &lt;= b</span><br><span class="line">a[1]x[1] + ... + a[n]x[n] &gt;= b</span><br></pre></td></tr></table></figure>
<p>3.2.3 è®¡ç®—çº¦æŸæ–¹ç¨‹<br>é£Ÿç«é¸¡ç®—æ³•ï¼šé£Ÿç«é¸¡æ˜¯ä¸€ç§ç”Ÿæ´»åœ¨æ–°å‡ å†…äºšçƒ­å¸¦é›¨æ—ä¸­çš„é¸Ÿç±»ï¼Œä»¥æ°´æœä¸ºé£Ÿã€‚åŒæ—¶å®ƒä¹Ÿæ˜¯ä¸€ç§è§£å†³çº¿æ€§æ–¹ç¨‹å’Œçº¿æ€§ä¸ç­‰å¼çš„ç®—æ³•ã€‚1990å¹´åœ¨åç››é¡¿å¤§å­¦è¢«è¯æ˜å’Œå‘ç°ã€‚çº¿æ€§æ–¹ç¨‹éå¸¸é€‚åˆç”¨äºè¡¨ç¤ºç”¨æˆ·ç•Œé¢ä¸­è§†å›¾çš„ä½ç½®ã€å¤§å°ã€ä¸å…¶ä»–è§†å›¾çš„å…³ç³»ã€‚</p>
<h5 id="3-2-ä¸ªäººç†è§£ï¼š"><a href="#3-2-ä¸ªäººç†è§£ï¼š" class="headerlink" title="3.2 ä¸ªäººç†è§£ï¼š"></a>3.2 ä¸ªäººç†è§£ï¼š</h5><p>å®šä¹‰å˜é‡ -&gt; å£°æ˜Viewå¯¹è±¡<br>å®šä¹‰çº¦æŸé—®é¢˜ -&gt; å»ºç«‹Viewä¹‹é—´çš„çº¦æŸå…³ç³»<br>è®¡ç®—çº¦æŸæ–¹ç¨‹ -&gt; è®¡ç®—è§†å›¾çš„å¤§å°ã€åæ ‡  </p>
<h4 id="å››ã€å‚è€ƒæ–‡æ¡£"><a href="#å››ã€å‚è€ƒæ–‡æ¡£" class="headerlink" title="å››ã€å‚è€ƒæ–‡æ¡£"></a>å››ã€å‚è€ƒæ–‡æ¡£</h4><p><a href="https://developer.android.com/reference/androidx/constraintlayout/widget/ConstraintLayout">1.å®˜æ–¹æ–‡æ¡£</a><br><a href="https://constraintlayout.com/layouts/">2.åŸºæœ¬ä½¿ç”¨</a><br><a href="https://biaomingzhong.github.io/2017/constraintlayout-basics-chains-2/">3.åŸºæœ¬ä½¿ç”¨-è¯‘æ–‡</a><br><a href="https://wiresareobsolete.com/2016/07/constraintlayout-part-1/">4.ConstraintLayout, Inside and Out: Part 1</a><br><a href="https://wiresareobsolete.com/2016/07/constraintlayout-part-2/">5.ConstraintLayout, Inside and Out: Part 2</a><br><a href="https://constraints.cs.washington.edu/cassowary/cassowary-tr.pdf">6.çº¿æ€§çº¦æŸè§£å†³ç®—æ³•</a><br><a href="https://cassowary.readthedocs.io/en/latest/topics/theory.html">7.è§£å†³çº¦æŸ</a></p>
]]></content>
      <categories>
        <category>è®¡ç®—æœº</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>View</tag>
      </tags>
  </entry>
  <entry>
    <title>Admobçš„åˆå§‹åŒ–è¿‡ç¨‹</title>
    <url>/admob-init-performance-test.html</url>
    <content><![CDATA[<p>åœ¨æ¥å…¥Google Admobæ—¶ï¼Œä¾æ®å®˜æ–¹æ–‡æ¡£ æˆ– ä¾æ®å¼€å‘ä¹ æƒ¯ï¼Œæˆ‘ä»¬ä¸€èˆ¬å…ˆå¯¹Admob SDKè¿›è¡Œåˆå§‹åŒ–ï¼Œç„¶åè¿›è¡Œå¹¿å‘ŠåŠ è½½ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="comment">// first init the admob sdk</span></span><br><span class="line">MobileAds.initialize(context) &#123;</span><br><span class="line">    <span class="comment">//init successful</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//second load Ad</span></span><br><span class="line"><span class="keyword">val</span> adRequest = AdRequest.Builder().build()</span><br><span class="line">adView.loadAd(adRequest)</span><br></pre></td></tr></table></figure>

<p>é‚£ä¹ˆï¼Œå¤šæ€è€ƒä¸€ä¸‹ï¼Œæˆ‘ä»¬æœ‰ä¸ªç–‘é—®ï¼š</p>
<h4 id="1ã€ä¸€å®šè¦å…ˆåˆå§‹åŒ–ï¼Œæ‰èƒ½åŠ è½½å¹¿å‘Šå—â“"><a href="#1ã€ä¸€å®šè¦å…ˆåˆå§‹åŒ–ï¼Œæ‰èƒ½åŠ è½½å¹¿å‘Šå—â“" class="headerlink" title="1ã€ä¸€å®šè¦å…ˆåˆå§‹åŒ–ï¼Œæ‰èƒ½åŠ è½½å¹¿å‘Šå—â“"></a>1ã€ä¸€å®šè¦å…ˆåˆå§‹åŒ–ï¼Œæ‰èƒ½åŠ è½½å¹¿å‘Šå—â“</h4><p>å®éªŒè®¾è®¡ï¼šä¸æ‰§è¡Œåˆå§‹åŒ–æ“ä½œï¼Œç›´æ¥è¯·æ±‚å¹¿å‘Šã€‚</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">val</span> adRequest = AdRequest.Builder().build()</span><br><span class="line">adView.loadAd(adRequest)</span><br></pre></td></tr></table></figure>

<p>å®éªŒç»“è®ºï¼šä¸åˆå§‹åŒ–SDKä¹Ÿèƒ½æˆåŠŸåŠ è½½åˆ°å¹¿å‘Šã€‚</p>
<h4 id="2ã€ä¸ºä»€ä¹ˆä¸åˆå§‹åŒ–ä¹Ÿèƒ½åŠ è½½å¹¿å‘Šå‘¢â“"><a href="#2ã€ä¸ºä»€ä¹ˆä¸åˆå§‹åŒ–ä¹Ÿèƒ½åŠ è½½å¹¿å‘Šå‘¢â“" class="headerlink" title="2ã€ä¸ºä»€ä¹ˆä¸åˆå§‹åŒ–ä¹Ÿèƒ½åŠ è½½å¹¿å‘Šå‘¢â“"></a>2ã€ä¸ºä»€ä¹ˆä¸åˆå§‹åŒ–ä¹Ÿèƒ½åŠ è½½å¹¿å‘Šå‘¢â“</h4><p>çŒœæƒ³ï¼š<br>1ã€åˆå§‹åŒ–å’ŒåŠ è½½æœ‰å…³è”æ€§ï¼šåŠ è½½å¹¿å‘Šæ—¶ï¼Œå‘ç°æ²¡æœ‰åˆå§‹åŒ–ï¼Œå…ˆè¿›è¡Œäº†åˆå§‹åŒ–ï¼Œå†æ‰§è¡Œå¹¿å‘ŠåŠ è½½æ“ä½œã€‚<br>2ã€åˆå§‹åŒ–å’ŒåŠ è½½æ— å…³è”ç³»ï¼šåŠ è½½å¹¿å‘Šä¸éœ€è¦SDKåˆå§‹åŒ–ï¼Œä¸¤è€…æ— å…³è”ã€‚</p>
<p>è®¾ï¼šå¹¿å‘Šåˆå§‹åŒ–è€—æ—¶mæ¯«ç§’ï¼Œå¹¿å‘ŠåŠ è½½è€—æ—¶næ¯«ç§’ï¼Œæ€»è€—æ—¶m+næ¯«ç§’ã€‚</p>
<p>å®éªŒè®¾è®¡ï¼š<br>Aç»„ï¼šæ‰§è¡Œåˆå§‹åŒ–ï¼ŒåŒæ—¶æ‰§è¡Œå¹¿å‘ŠåŠ è½½ã€‚<br>è‹¥åˆå§‹åŒ–å’ŒåŠ è½½æœ‰å…³è”æ€§ï¼Œå¹¿å‘ŠåŠ è½½æ—¶é•¿çº¦ç­‰äºm+nã€‚<br>è‹¥åˆå§‹åŒ–å’ŒåŠ è½½æ— å…³è”æ€§ï¼Œå¹¿å‘ŠåŠ è½½æ—¶é•¿çº¦ç­‰äºnã€‚</p>
<p>æ—¥å¿—è¾“å‡ºç¤ºä¾‹ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">2024-07-06 10:10:06.061 23555-23555 InitAndLoad     com...oid.gms.example.bannerexample  D  call init....</span><br><span class="line">2024-07-06 10:10:06.224 23555-23555 InitAndLoad     com...oid.gms.example.bannerexample  D  start load....</span><br><span class="line">2024-07-06 10:10:07.401 23555-23555 InitAndLoad     com...oid.gms.example.bannerexample  D  after init = 1340</span><br><span class="line">2024-07-06 10:10:08.416 23555-23555 InitAndLoad     com...oid.gms.example.bannerexample  D  onAdLoaded...cost = 2192</span><br></pre></td></tr></table></figure>

<p>åˆå§‹åŒ–è€—æ—¶ m=1340ms<br>åŠ è½½è€—æ—¶ n=2192ms</p>
<p>Bç»„ï¼šå»¶è¿Ÿ10sæ‰§è¡Œåˆå§‹åŒ–ã€‚ç«‹å³æ‰§è¡Œå¹¿å‘ŠåŠ è½½ã€‚</p>
<p>æ—¥å¿—è¾“å‡ºç¤ºä¾‹ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">2024-07-06 13:23:42.675 27481-27481 DelayInitAndLoad    com...oid.gms.example.bannerexample  D  start load....</span><br><span class="line">2024-07-06 13:23:43.453 27481-27481 DelayInitAndLoad    com...oid.gms.example.bannerexample  D  call init....</span><br><span class="line">2024-07-06 13:23:46.208 27481-27481 DelayInitAndLoad    com...oid.gms.example.bannerexample  D  onAdLoaded...cost = 3532</span><br><span class="line">2024-07-06 13:23:53.486 27481-27481 DelayInitAndLoad    com...oid.gms.example.bannerexample  D  after init = 24</span><br></pre></td></tr></table></figure>

<p>åˆå§‹åŒ–è€—æ—¶ m=24ms<br>åŠ è½½è€—æ—¶ n=3532ms</p>
<p>ç»“è®ºï¼šç”±äºå¹¿å‘ŠåŠ è½½æˆåŠŸåï¼Œæ‰è°ƒç”¨åˆå§‹åŒ–é€»è¾‘ï¼Œå› æ­¤åˆå§‹åŒ–æ—¶é•¿å¤§å¹…é™ä½ã€‚æ•…ï¼šåˆå§‹åŒ–å’ŒåŠ è½½æœ‰å…³è”æ€§ã€‚</p>
<h4 id="3ã€èšåˆçš„SDKåˆå§‹åŒ–äº†å—â“"><a href="#3ã€èšåˆçš„SDKåˆå§‹åŒ–äº†å—â“" class="headerlink" title="3ã€èšåˆçš„SDKåˆå§‹åŒ–äº†å—â“"></a>3ã€èšåˆçš„SDKåˆå§‹åŒ–äº†å—â“</h4><p>å®éªŒè®¾è®¡ï¼š<br>Aï¼šä¸åˆå§‹åŒ–SDKï¼ŒåŠ è½½å¹¿å‘Šåï¼Œæ‰“å¼€AdInspectorã€‚<br>Bï¼šåˆå§‹åŒ–SDKï¼ŒåŠ è½½å¹¿å‘Šåï¼Œæ‰“å¼€AdInspectorã€‚</p>
<table>
    <tr>
        <td><img src="../images/ad/mediator_failure.png" width="70%"/></td>
        <td><img src="../images/ad/mediator_success.png" width="70%"/></td>
    </tr>
</table>

<p>å®éªŒç»“è®ºï¼šä¸åˆå§‹åŒ–åªèƒ½åŠ è½½Admobè‡ªèº«çš„å¹¿å‘Šï¼Œåˆå§‹åŒ–åå¯ä»¥åŠ è½½èšåˆæºçš„å¹¿å‘Šã€‚</p>
<h4 id="3ã€åˆå§‹åŒ–æˆåŠŸåå†åŠ è½½å¹¿å‘Š-VS-ç›´æ¥åŠ è½½å¹¿å‘Š-åŠ è½½é€Ÿåº¦çš„å¯¹æ¯”"><a href="#3ã€åˆå§‹åŒ–æˆåŠŸåå†åŠ è½½å¹¿å‘Š-VS-ç›´æ¥åŠ è½½å¹¿å‘Š-åŠ è½½é€Ÿåº¦çš„å¯¹æ¯”" class="headerlink" title="3ã€åˆå§‹åŒ–æˆåŠŸåå†åŠ è½½å¹¿å‘Š VS ç›´æ¥åŠ è½½å¹¿å‘Š åŠ è½½é€Ÿåº¦çš„å¯¹æ¯”"></a>3ã€åˆå§‹åŒ–æˆåŠŸåå†åŠ è½½å¹¿å‘Š VS ç›´æ¥åŠ è½½å¹¿å‘Š åŠ è½½é€Ÿåº¦çš„å¯¹æ¯”</h4><p>ç›´æ¥åŠ è½½ï¼š</p>
<table>
<thead>
<tr>
<th>ç¬¬ä¸€ç»„</th>
<th>ç¬¬äºŒç»„</th>
<th>ç¬¬ä¸‰ç»„</th>
<th>ç¬¬å››ç»„</th>
<th>ç¬¬äº”ç»„</th>
</tr>
</thead>
<tbody><tr>
<td>2915ms</td>
<td>1581ms</td>
<td>1435ms</td>
<td>1621ms</td>
<td>1581ms</td>
</tr>
</tbody></table>
<p>åˆå§‹åŒ–ååŠ è½½ï¼š</p>
<table>
<thead>
<tr>
<th></th>
<th>ç¬¬ä¸€ç»„</th>
<th>ç¬¬äºŒç»„</th>
<th>ç¬¬ä¸‰ç»„</th>
<th>ç¬¬å››ç»„</th>
<th>ç¬¬äº”ç»„</th>
</tr>
</thead>
<tbody><tr>
<td>åˆå§‹åŒ–</td>
<td>2373ms</td>
<td>2374</td>
<td>2463</td>
<td>2427</td>
<td>2298</td>
</tr>
<tr>
<td>åŠ è½½</td>
<td>1468ms</td>
<td>1386</td>
<td>1505</td>
<td>2498</td>
<td>1250</td>
</tr>
<tr>
<td>æ—¥å¿—æ€»è€—æ—¶</td>
<td>3843</td>
<td>3762</td>
<td>3970</td>
<td>4927</td>
<td>3550</td>
</tr>
</tbody></table>
<p>ç»“è®ºï¼šåˆå§‹åŒ–åæ‰åŠ è½½å¹¿å‘Šæ…¢äºç›´æ¥åŠ è½½å¹¿å‘Šã€‚</p>
<h4 id="4ã€ä¸€ç§å¼€å±å¹¿å‘Šçš„ä¼˜åŒ–æ–¹æ¡ˆ"><a href="#4ã€ä¸€ç§å¼€å±å¹¿å‘Šçš„ä¼˜åŒ–æ–¹æ¡ˆ" class="headerlink" title="4ã€ä¸€ç§å¼€å±å¹¿å‘Šçš„ä¼˜åŒ–æ–¹æ¡ˆ"></a>4ã€ä¸€ç§å¼€å±å¹¿å‘Šçš„ä¼˜åŒ–æ–¹æ¡ˆ</h4><p>ä¸åˆå§‹åŒ–SDKä¹Ÿèƒ½åŠ è½½åˆ°Admobå¹¿å‘Šï¼Œä¸”åŠ è½½é€Ÿåº¦è¾ƒå¿«ï¼Œä½†æ˜¯æ²¡æœ‰å‚ä¸biddingï¼Œä»·æ ¼è¾ƒä½ã€‚<br>åˆå§‹åŒ–ä¹‹åï¼ŒåŠ è½½èšåˆæºå¹¿å‘Šï¼Œé€Ÿåº¦è¾ƒæ…¢ï¼Œä½†ç»è¿‡biddingåï¼Œä»·æ ¼ä¼šé«˜ä¸€ç‚¹ã€‚</p>
<p>ç»“åˆä¸¤ä¸ªåŠ è½½æ–¹å¼ï¼Œé—ªå±æ—¶æ®µå†…åŠ è½½å¹¿å‘Šï¼Œé—ªå±nç§’æ—¶é•¿å†…ï¼ŒåŠ è½½åˆ°biddingç±»å‹åˆ™å±•ç¤ºbiddingç±»å‹ã€‚æ²¡åŠ è½½åˆ°ï¼Œåˆ™å±•ç¤ºAdmobç±»å‹ã€‚</p>
]]></content>
  </entry>
  <entry>
    <title>æºç åˆ†æ-ç½‘ç»œæ¡†æ¶ä¹‹Retrofit</title>
    <url>/android-github-source-retrofit.html</url>
    <content><![CDATA[<h4 id="ä¸€ã€ä½¿ç”¨"><a href="#ä¸€ã€ä½¿ç”¨" class="headerlink" title="ä¸€ã€ä½¿ç”¨"></a>ä¸€ã€ä½¿ç”¨</h4><h5 id="1-1-å®šä¹‰APIæ–¹æ³•"><a href="#1-1-å®šä¹‰APIæ–¹æ³•" class="headerlink" title="1.1 å®šä¹‰APIæ–¹æ³•"></a>1.1 å®šä¹‰APIæ–¹æ³•</h5><figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">RemoteApi</span> </span>&#123;</span><br><span class="line">    <span class="meta">@GET(<span class="meta-string">&quot;timeline&quot;</span>)</span></span><br><span class="line">    <span class="keyword">suspend</span> <span class="function"><span class="keyword">fun</span> <span class="title">timeline</span><span class="params">()</span></span>: RemoteLaunchesResponse </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="1-2-è·å–æœåŠ¡"><a href="#1-2-è·å–æœåŠ¡" class="headerlink" title="1.2 è·å–æœåŠ¡"></a>1.2 è·å–æœåŠ¡</h5><figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">val</span> client = OkHttpClient.Builder()</span><br><span class="line">             .addInterceptor(loggingInterceptor)</span><br><span class="line">             .build()</span><br><span class="line"></span><br><span class="line"> <span class="keyword">val</span> retrofit = Retrofit.Builder()</span><br><span class="line">             .client(client)</span><br><span class="line">             .baseUrl(<span class="string">&quot;http://10.0.0.2:8080/&quot;</span>)</span><br><span class="line">             .addConverterFactory(GsonConverterFactory.create())</span><br><span class="line">             .build()</span><br><span class="line"></span><br><span class="line"> <span class="keyword">val</span> api = retrofit.create(RemoteApi::<span class="keyword">class</span>.java) <span class="comment">//1ã€createåšäº†ä»€ä¹ˆï¼Ÿ</span></span><br></pre></td></tr></table></figure>

<h5 id="1-3-å‘èµ·è¯·æ±‚"><a href="#1-3-å‘èµ·è¯·æ±‚" class="headerlink" title="1.3 å‘èµ·è¯·æ±‚"></a>1.3 å‘èµ·è¯·æ±‚</h5><figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line">api.timeline() <span class="comment">//2ã€è°ƒç”¨æ¥å£æ–¹æ³•æ€ä¹ˆå‘èµ·è¯·æ±‚?</span></span><br></pre></td></tr></table></figure>


<h4 id="äºŒã€åŸç†"><a href="#äºŒã€åŸç†" class="headerlink" title="äºŒã€åŸç†"></a>äºŒã€åŸç†</h4><center>
    <img src="../images/android-source-retrofit.jpeg" width="100%"/>
</center>

<h5 id="2-1-createåšäº†ä»€ä¹ˆ"><a href="#2-1-createåšäº†ä»€ä¹ˆ" class="headerlink" title="2.1 createåšäº†ä»€ä¹ˆ"></a>2.1 createåšäº†ä»€ä¹ˆ</h5><p>Retrofitçš„ç½‘ç»œè¯·æ±‚æ–¹æ³•éƒ½æ˜¯å®šä¹‰åœ¨æ¥å£ä¸­çš„ï¼Œå®ƒä¼šåœ¨è¿è¡Œæ—¶åˆ©ç”¨Javaçš„åŠ¨æ€ä»£ç†äº§ç”Ÿä»£ç†å¯¹è±¡ï¼Œæ‰€ä»¥<code>create()</code>å°±æ˜¯åˆ›å»ºä»£ç†å¯¹è±¡çš„æ–¹æ³•ã€‚</p>
<h5 id="2-2-è°ƒç”¨æ¥å£æ–¹æ³•æ€ä¹ˆå‘èµ·è¯·æ±‚"><a href="#2-2-è°ƒç”¨æ¥å£æ–¹æ³•æ€ä¹ˆå‘èµ·è¯·æ±‚" class="headerlink" title="2.2 è°ƒç”¨æ¥å£æ–¹æ³•æ€ä¹ˆå‘èµ·è¯·æ±‚"></a>2.2 è°ƒç”¨æ¥å£æ–¹æ³•æ€ä¹ˆå‘èµ·è¯·æ±‚</h5><p>å½“è°ƒç”¨æ¥å£æ–¹æ³•æ—¶ï¼Œå®é™…ä¸Šæ˜¯è°ƒç”¨äº†ä»£ç†å¯¹è±¡çš„æ–¹æ³•ã€‚å®ƒä¼šå»Retrofitä¸­æ‰¾è¯¥æ–¹æ³•å¯¹åº”çš„<code>ServiceMethod</code>ï¼Œå¦‚æœæ‰¾åˆ°ç¼“å­˜ç›´æ¥ä½¿ç”¨ï¼Œå¦åˆ™è§£æåå†ä½¿ç”¨ã€‚</p>
<p>è§£æçš„ç»“æœæ˜¯<code>ServiceMethod</code>çš„å­ç±»<code>CallAdapted</code>ã€<code>SuspendForResponse</code>ã€<code>SuspendForBody</code>ä¸‰è€…ä¹‹ä¸€ã€‚</p>
<p>è§£æç»“æŸåè°ƒç”¨è¿”å›å¯¹è±¡çš„<code>invoke</code>æ–¹æ³•åˆå§‹åŒ–OkHttpCallå¯¹è±¡å‘èµ·çœŸæ­£çš„è¯·æ±‚ã€‚</p>
<h4 id="ä¸‰ã€æ€»ç»“"><a href="#ä¸‰ã€æ€»ç»“" class="headerlink" title="ä¸‰ã€æ€»ç»“"></a>ä¸‰ã€æ€»ç»“</h4><p>é˜…è¯»æºç çš„è¿‡ç¨‹å½“ä¸­ï¼Œç”»äº†è¯¦ç»†çš„ä»£ç æ‰§è¡Œæµç¨‹å›¾ä¾›åç»­å›é¡¾ã€‚å¦å¤–æºç ä¸­è¿˜æœ‰ä¸¤ä¸ªé‡è¦çš„å¯¹å¤–æ‹“å±•æ¥å£<code>CallAdapter</code>å’Œ<code>Converter</code>æ²¡æœ‰è¯¦ç»†åˆ†æã€‚</p>
]]></content>
      <categories>
        <category>è®¡ç®—æœº</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>å®‰å“æ¡†æ¶</tag>
      </tags>
  </entry>
  <entry>
    <title>æºç åˆ†æ-é¡¹ç›®æ¶æ„ä¹‹SpaceX</title>
    <url>/android-github-source-spacex.html</url>
    <content><![CDATA[<h4 id="ä¸€ã€æ¦‚è¿°"><a href="#ä¸€ã€æ¦‚è¿°" class="headerlink" title="ä¸€ã€æ¦‚è¿°"></a>ä¸€ã€æ¦‚è¿°</h4><p>æ­¤æ–‡æ˜¯å¯¹Githubå¼€æºé¡¹ç›®<a href="https://github.com/ferPrieto/SpaceX-prepare-for-Clean-Architecture-liftoff">SpaceX-prepare-for-Clean-Architecture-liftoff</a> çš„æºç é˜…è¯»è®°å½•ã€‚å®ƒæ˜¯ä¸€ä¸ªä¸ºäº†é˜è¿°å¯¹<strong>Clean Architecture</strong>çš„ç†è§£è€Œä½œçš„Demoé¡¹ç›®ï¼Œæ˜¯ä¸€ä¸ªå€¼å¾—å­¦ä¹ çš„é¡¹ç›®ã€‚</p>
<h4 id="äºŒã€æºç åˆ†æ"><a href="#äºŒã€æºç åˆ†æ" class="headerlink" title="äºŒã€æºç åˆ†æ"></a>äºŒã€æºç åˆ†æ</h4><h5 id="2-1-æ¨¡å—ä¹‹é—´çš„ä¾èµ–å…³ç³»"><a href="#2-1-æ¨¡å—ä¹‹é—´çš„ä¾èµ–å…³ç³»" class="headerlink" title="2.1 æ¨¡å—ä¹‹é—´çš„ä¾èµ–å…³ç³»"></a>2.1 æ¨¡å—ä¹‹é—´çš„ä¾èµ–å…³ç³»</h5><p>é¡¹ç›®åŒ…å«ä»¥ä¸‹libraryï¼š</p>
<ul>
<li>app</li>
<li>buildSrc</li>
<li>core</li>
<li>core-android-test</li>
<li>data</li>
<li>data-api</li>
<li>domain</li>
<li>navigation</li>
<li>presentation</li>
</ul>
<p>æ¨¡å—ä¹‹é—´çš„ä¾èµ–å…³ç³»å¯ç”¨ä¸‹å›¾ç®€è¿°ï¼š</p>
<center>
    <img src="../images/android-source-spacex.jpeg" width="500"/>
</center>

<h5 id="2-2-ç±»å’Œæ¨¡å—ä¹‹é—´çš„å…³ç³»"><a href="#2-2-ç±»å’Œæ¨¡å—ä¹‹é—´çš„å…³ç³»" class="headerlink" title="2.2 ç±»å’Œæ¨¡å—ä¹‹é—´çš„å…³ç³»"></a>2.2 ç±»å’Œæ¨¡å—ä¹‹é—´çš„å…³ç³»</h5><center>
    <img src="../images/android-source-spacex-overview.jpeg" width="600"/>
</center>


<h4 id="ä¸‰ã€æ€»ç»“"><a href="#ä¸‰ã€æ€»ç»“" class="headerlink" title="ä¸‰ã€æ€»ç»“"></a>ä¸‰ã€æ€»ç»“</h4><p>é¡¹ç›®é‡åœ¨é˜è¿°æ¶æ„æ€æƒ³æ‰€ä»¥æ¯”è¾ƒç®€å•ï¼Œå…¶ä¸­å¾ˆå¤šä¸œè¥¿å€¼å¾—æˆ‘ä»¬åœ¨é¡¹ç›®ä¸­å€Ÿé‰´ã€‚æ•°æ®å±‚çš„æ¶æ„æ¨¡å¼å‚çœ‹<a href="https://martinfowler.com/bliki/PresentationDomainDataLayering.html">martin fowler</a> çš„æ–‡ç« ã€‚</p>
]]></content>
      <categories>
        <category>è®¡ç®—æœº</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>æ¶æ„</tag>
      </tags>
  </entry>
  <entry>
    <title>Jetpack Compose Side Effects</title>
    <url>/android-jetpack-compose-sideeffect.html</url>
    <content><![CDATA[<h4 id="ä¸€ã€ä»€ä¹ˆæ˜¯Side-Effect"><a href="#ä¸€ã€ä»€ä¹ˆæ˜¯Side-Effect" class="headerlink" title="ä¸€ã€ä»€ä¹ˆæ˜¯Side-Effect"></a>ä¸€ã€ä»€ä¹ˆæ˜¯Side-Effect</h4><blockquote>
<p><a href="https://en.wikipedia.org/wiki/Side_effect_(computer_science)">wiki</a>:åœ¨è®¡ç®—æœºç§‘å­¦ä¸­ï¼Œå½“å‡½æ•°ã€è¡¨è¾¾å¼ã€æ“ä½œä¼šä¿®æ”¹å®ƒä½œç”¨åŸŸä¹‹å¤–çš„çŠ¶æ€å˜é‡å€¼æ—¶ï¼Œæˆ‘ä»¬å°±è¯´å®ƒå…·æœ‰å‰¯ä½œç”¨ã€‚ä¹Ÿå°±æ˜¯è¯´é™¤è¿”å›å€¼ä¹‹å¤–å…¶ä»–çš„å¯¹å¤–ä¿®æ”¹éƒ½å«å‰¯ä½œç”¨ã€‚<br>å¸¸è§çš„ä¾‹å­åŒ…æ‹¬ï¼šä¿®æ”¹éæœ¬åœ°å˜é‡ã€ä¿®æ”¹å‚æ•°ä¼ è¿›æ¥çš„å¯å˜å¼•ç”¨ã€æ‰§è¡ŒI/Oç­‰ã€‚</p>
</blockquote>
<h4 id="äºŒã€Composeä¸­çš„Side-Effect"><a href="#äºŒã€Composeä¸­çš„Side-Effect" class="headerlink" title="äºŒã€Composeä¸­çš„Side-Effect"></a>äºŒã€Composeä¸­çš„Side-Effect</h4><p>å› ä¸ºJetpack Composeæ˜¯ç”±ä¸€ç³»åˆ—çš„<code>@Composable</code>å‡½æ•°ç»„æˆçš„ï¼Œ<code>@Composable</code>å‡½æ•°åœ¨æ‰§è¡Œæ—¶å¯èƒ½ä¼šè¢«è·³è¿‡ï¼ˆå‡ºäºä¼˜åŒ–çš„è§’åº¦ï¼‰æˆ–æ‰§è¡Œå¤šæ¬¡ï¼ˆrecompositionï¼‰ã€‚<br>é‚£å¯¹äºå‡½æ•°å†…éƒ¨çš„ç½‘ç»œè¯·æ±‚ã€å¯¹å¤–éƒ¨çŠ¶æ€çš„ä¿®æ”¹æ€ä¹ˆåŠï¼Ÿæœ‰å¯èƒ½æ‰§è¡Œå¤šæ¬¡ï¼Ÿæœ‰å¯èƒ½ä¸æ‰§è¡Œï¼Ÿè¿™å°±äº§ç”Ÿäº†æŸç§ä¸å¯é¢„æœŸçš„é”™è¯¯çŠ¶æ€ï¼Œæˆ–è€…æ³„éœ²ã€‚<br>ä¸ºäº†è§£å†³æ­¤ç±»é—®é¢˜ï¼ŒComposeæä¾›äº†ç›¸åº”çš„APIï¼Œè¿™äº›APIä¸»è¦èšç„¦äºå¯¹è¿™äº›å‰¯ä½œç”¨çš„ç”Ÿå‘½å‘¨æœŸè¿›è¡Œç®¡ç†ã€‚</p>
<p>è¿™äº›APIå¯ä»¥åˆ†æˆä¸¤å¤§ç±»ï¼š</p>
<ul>
<li>SuspendedEffect<ul>
<li>rememberCoroutineScope</li>
<li>launchedEffect</li>
</ul>
</li>
<li>Non-Suspended Side Effects<ul>
<li>DisposableEffect</li>
<li>SideEffect</li>
</ul>
</li>
</ul>
<h4 id="ä¸‰ã€SuspendedEffect"><a href="#ä¸‰ã€SuspendedEffect" class="headerlink" title="ä¸‰ã€SuspendedEffect"></a>ä¸‰ã€SuspendedEffect</h4><h5 id="3-1-LaunchedEffect"><a href="#3-1-LaunchedEffect" class="headerlink" title="3.1 LaunchedEffect"></a>3.1 LaunchedEffect</h5><p>åœ¨é¦–æ¬¡compositionçš„æ—¶å€™è¢«è°ƒç”¨ã€‚recompositionæ—¶ä¸ä¼šå†æ¬¡è°ƒç”¨ã€‚å¯ä»¥é€šè¿‡æ”¹å˜Keyè®©å…¶é‡æ–°è°ƒç”¨ã€‚<br>å®ƒæ˜¯ä¸€ä¸ªåç¨‹ä½œç”¨åŸŸï¼Œæˆ‘ä»¬å¯ä»¥æ‰§è¡Œä¸€äº›æŒ‚èµ·å‡½æ•°ï¼Œå½“composableå‡½æ•°é€€å‡ºæ—¶ï¼Œåç¨‹ä¼šè¢«å–æ¶ˆã€‚</p>
<p>ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œå¯åŠ¨å³æ‰§è¡Œå¾ªç¯é€»è¾‘ï¼Œæ¯ç§’ä¿®æ”¹ä¸€æ¬¡çŠ¶æ€å€¼å¹¶è§¦å‘recompositionï¼Œä½†recompositionå¹¶ä¸å½±å“LaunchedEffectå†…çš„é€»è¾‘ã€‚</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Composable</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">LaunchedEffect</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">var</span> timer <span class="keyword">by</span> remember &#123; mutableStateOf(<span class="number">0</span>) &#125;</span><br><span class="line">    Box(modifier = Modifier.fillMaxSize(), </span><br><span class="line">        contentAlignment = Alignment.Center) &#123;</span><br><span class="line">        Text(<span class="string">&quot;Time <span class="variable">$timer</span>&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    LaunchedEffect(key1 = <span class="built_in">Unit</span>) &#123;</span><br><span class="line">        <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">            delay(<span class="number">1000</span>)</span><br><span class="line">            timer++</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="3-2-RememberCoroutineScope"><a href="#3-2-RememberCoroutineScope" class="headerlink" title="3.2 RememberCoroutineScope"></a>3.2 RememberCoroutineScope</h5><p><code>LaunchedEffect</code>çš„å¯åŠ¨å’Œå–æ¶ˆè·ŸéšComposableå‡½æ•°çš„ç”Ÿå‘½å‘¨æœŸã€‚å¦‚æœæƒ³è‡ªå·±æ§åˆ¶ç”Ÿå‘½å‘¨æœŸå¯ä»¥ä½¿ç”¨<code>RememberCoroutineScope</code></p>
<p>ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œåç¨‹çš„æ§åˆ¶æƒè½¬ç§»åˆ°æˆ‘ä»¬è‡ªå·±æ‰‹ä¸­ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Composable</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">JustRememberCoroutineScope</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">val</span> scope = rememberCoroutineScope()</span><br><span class="line">    <span class="keyword">var</span> timer <span class="keyword">by</span> remember &#123; mutableStateOf(<span class="number">0</span>) &#125;</span><br><span class="line">    <span class="keyword">var</span> timerStartStop <span class="keyword">by</span> remember &#123; mutableStateOf(<span class="literal">false</span>) &#125;</span><br><span class="line">    <span class="keyword">var</span> job: Job? <span class="keyword">by</span> remember &#123; mutableStateOf(<span class="literal">null</span>) &#125;</span><br><span class="line"></span><br><span class="line">    Box(modifier = Modifier.fillMaxSize(),</span><br><span class="line">        contentAlignment = Alignment.Center) &#123;</span><br><span class="line">        Column(horizontalAlignment = Alignment.CenterHorizontally) &#123;</span><br><span class="line">            Text(<span class="string">&quot;Time <span class="variable">$timer</span>&quot;</span>)</span><br><span class="line">            Button(onClick = &#123;</span><br><span class="line">                timerStartStop = !timerStartStop</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (timerStartStop) &#123;</span><br><span class="line">                    job?.cancel()</span><br><span class="line">                    job = scope.launch &#123;</span><br><span class="line">                        <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">                            delay(<span class="number">1000</span>)</span><br><span class="line">                            timer++</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    job?.cancel()</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">            &#125;) &#123;</span><br><span class="line">                Text(<span class="keyword">if</span> (timerStartStop) <span class="string">&quot;Stop&quot;</span> <span class="keyword">else</span> <span class="string">&quot;Start&quot;</span>)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="å››ã€Non-Suspended-Side-Effects"><a href="#å››ã€Non-Suspended-Side-Effects" class="headerlink" title="å››ã€Non-Suspended Side Effects"></a>å››ã€Non-Suspended Side Effects</h4><h5 id="4-1-DisposableEffect"><a href="#4-1-DisposableEffect" class="headerlink" title="4.1 DisposableEffect"></a>4.1 DisposableEffect</h5><p>ä¸<code>LaunchedEffect</code>ä¸€æ ·ï¼Œç«‹å³å¯åŠ¨ï¼Œé€šè¿‡ä¿®æ”¹keyå¯ä»¥å†æ¬¡å¯åŠ¨ã€‚å®ƒæä¾›äº†ä¸€ä¸ªé”€æ¯æ—¶çš„å›è°ƒï¼Œå½“å†æ¬¡å¯åŠ¨æ—¶ï¼Œå‰ä¸€ä¸ªçš„<code>onDispose</code>æ–¹æ³•ä¼šè¢«å›è°ƒã€‚</p>
<p>ä¸‹é¢çš„ä¾‹å­æ¯æ¬¡ç‚¹å‡»æŒ‰é’®æ”¹å˜çŠ¶æ€è¿›è¡Œrecomposeï¼ŒåŒæ—¶ä¼šæ”¹å˜<code>DisposableEffect</code>çš„keyï¼Œé”€æ¯ä¸Šä¸€ä¸ªEffectå¹¶æ”¶åˆ°å›è°ƒã€‚</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Composable</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">JustDisposableEffect</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">var</span> timerStartStop <span class="keyword">by</span> remember &#123; mutableStateOf(<span class="literal">false</span>) &#125;</span><br><span class="line">    Box(modifier = Modifier.fillMaxSize(),</span><br><span class="line">        contentAlignment = Alignment.Center) &#123;</span><br><span class="line">        Column(horizontalAlignment = Alignment.CenterHorizontally) &#123;</span><br><span class="line">            Button(onClick = &#123;</span><br><span class="line">                timerStartStop = !timerStartStop</span><br><span class="line">            &#125;) &#123;</span><br><span class="line">                Text(<span class="keyword">if</span> (timerStartStop) <span class="string">&quot;Stop&quot;</span> <span class="keyword">else</span> <span class="string">&quot;Start&quot;</span>)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> context = LocalContext.current</span><br><span class="line"></span><br><span class="line">    DisposableEffect(key1 = timerStartStop) &#123;</span><br><span class="line">        <span class="keyword">val</span> x = (<span class="number">1.</span><span class="number">.10</span>).random()</span><br><span class="line">        Toast.makeText(context, <span class="string">&quot;Start <span class="variable">$x</span>&quot;</span>, LENGTH_SHORT).show()</span><br><span class="line"></span><br><span class="line">        onDispose &#123;</span><br><span class="line">            Toast.makeText(context, <span class="string">&quot;Stop <span class="variable">$x</span>&quot;</span>, LENGTH_SHORT).show()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="4-2-SideEffect"><a href="#4-2-SideEffect" class="headerlink" title="4.2 SideEffect"></a>4.2 SideEffect</h5><p>ä½¿ç”¨åœºæ™¯ï¼š</p>
<ul>
<li>æ¯æ¬¡composition / recompositionæˆåŠŸåè¢«è°ƒç”¨</li>
<li>ç”¨äºå¯¹å¤–éƒ¨çŠ¶æ€çš„æ›´æ–°</li>
<li>æ— éœ€åšæ¸…ç†å›æ”¶æ“ä½œæ—¶</li>
</ul>
<p>ä¾‹1ï¼šå¯¹å¤–éƒ¨çŠ¶æ€çš„æ›´æ–°</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Composable</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">MyScreen</span><span class="params">(drawerTouchHandler: <span class="type">TouchHandler</span>)</span></span> &#123;</span><br><span class="line">  <span class="keyword">val</span> drawerState = rememberDrawerState(DrawerValue.Closed)</span><br><span class="line"></span><br><span class="line">  SideEffect &#123;</span><br><span class="line">    drawerTouchHandler.enabled = drawerState.isOpen</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¾‹2ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> i = <span class="number">0</span></span><br><span class="line"><span class="meta">@Composable</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">MyComposable</span><span class="params">()</span></span>&#123;</span><br><span class="line">    SideEffect &#123; <span class="comment">//this will handle the side effect that may occur</span></span><br><span class="line">        i++</span><br><span class="line">    &#125;</span><br><span class="line">    Button(onClick = &#123;&#125;)&#123;</span><br><span class="line">        Text(text = <span class="string">&quot;Click&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h4 id="äº”ã€å‚è€ƒ"><a href="#äº”ã€å‚è€ƒ" class="headerlink" title="äº”ã€å‚è€ƒ"></a>äº”ã€å‚è€ƒ</h4><p><a href="https://jorgecastillo.dev/jetpack-compose-effect-handlers">Jetpack Compose Effect Handlers</a><br><a href="https://www.section.io/engineering-education/side-effects-and-effects-handling-in-jetpack-compose/">SideEffects and Effects Handling in Jetpack Compose</a><br><a href="https://medium.com/mobile-app-development-publication/jetpack-compose-side-effects-made-easy-a4867f876928">Jetpack Compose Side Effects Made Easy</a></p>
]]></content>
      <categories>
        <category>è®¡ç®—æœº</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>Compose</tag>
      </tags>
  </entry>
  <entry>
    <title>æºç åˆ†æ-WorkManager</title>
    <url>/android-github-source-workmanager.html</url>
    <content><![CDATA[<h4 id="ä¸€ã€åˆå§‹åŒ–æµç¨‹"><a href="#ä¸€ã€åˆå§‹åŒ–æµç¨‹" class="headerlink" title="ä¸€ã€åˆå§‹åŒ–æµç¨‹"></a>ä¸€ã€åˆå§‹åŒ–æµç¨‹</h4><p>1ã€WorkManageré›†æˆäº†<code>androidx.startup</code> åº“ï¼Œé€šè¿‡<code>startup</code>åº“çš„<code>ContentProvider</code>åœ¨åº”ç”¨å¯åŠ¨æ—¶è¿›è¡Œåˆå§‹åŒ–ã€‚<br>è§<code>work-runtime</code>çš„Manifestæ–‡ä»¶ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">provider</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:name</span>=<span class="string">&quot;androidx.startup.InitializationProvider&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:authorities</span>=<span class="string">&quot;$&#123;applicationId&#125;.androidx-startup&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:exported</span>=<span class="string">&quot;false&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">tools:node</span>=<span class="string">&quot;merge&quot;</span> &gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta-data</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:name</span>=<span class="string">&quot;androidx.work.WorkManagerInitializer&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:value</span>=<span class="string">&quot;androidx.startup&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">provider</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>å…¶åˆå§‹åŒ–ç±»ä¸º<code>WorkManagerInitializer</code>ï¼Œå…¶ä¸­è°ƒç”¨äº†<code>WorkManager#initialize</code>ï¼Œç„¶åè°ƒç”¨<code>WorkManager</code>çš„æ„é€ å‡½æ•°ã€‚<br>æ•´ä¸ªæµç¨‹åˆå§‹åŒ–äº†å¦‚ä¸‹ä¸€äº›å¯¹è±¡ï¼š</p>
<center>
    <img src="../images/android-workmanager_init.jpg" width="100%"/>
</center>


<h4 id="äºŒã€ä»»åŠ¡"><a href="#äºŒã€ä»»åŠ¡" class="headerlink" title="äºŒã€ä»»åŠ¡"></a>äºŒã€ä»»åŠ¡</h4><h5 id="2-1-å®šä¹‰ä»»åŠ¡"><a href="#2-1-å®šä¹‰ä»»åŠ¡" class="headerlink" title="2.1 å®šä¹‰ä»»åŠ¡"></a>2.1 å®šä¹‰ä»»åŠ¡</h5><p>å½“æˆ‘ä»¬è‡ªå®šä¹‰ä»»åŠ¡æ—¶ï¼Œéœ€è¦ç»§æ‰¿<code>Work</code>ç±»ï¼ŒWorkManagerå†…éƒ¨å¯¹<code>Work</code>çš„ç»“æ„å®šä¹‰å¦‚ä¸‹ï¼š</p>
<center>
    <img src="../images/android-workmanager-work.jpg" width="40%"/>
</center>

<p>å…¶ä¸­<code>DiagnosticsWorker</code>å’Œ<code>CombineContinueationsWorker</code>æ˜¯å†…éƒ¨ä½¿ç”¨çš„ä¸¤ä¸ªä»»åŠ¡ã€‚</p>
<h5 id="2-2-æäº¤ä»»åŠ¡"><a href="#2-2-æäº¤ä»»åŠ¡" class="headerlink" title="2.2 æäº¤ä»»åŠ¡"></a>2.2 æäº¤ä»»åŠ¡</h5><p>æˆ‘ä»¬å°†ä»»åŠ¡ä»¥è¯·æ±‚ï¼ˆWorkRequestï¼‰çš„å½¢å¼æäº¤ï¼ˆenqueueï¼‰ç»™WorkManagerã€‚WorkManagerä¼šå°†è¯·æ±‚è£…æ¢æˆå†…éƒ¨çš„WorkContinuationå¯¹è±¡ã€‚</p>
<center>
    <img src="../images/android-workmanager-request.jpg" width="70%"/>
</center>

<p>WorkContinuationå¯ä»¥å°†å¤šä¸ª<code>OneTimeWorkrequest</code>æ„å»ºæˆä»»æ„ä¾èµ–å…³ç³»çš„æ— ç¯å›¾ã€‚è€ŒWorkContinuationçš„<code>enqueue</code>æ–¹æ³•åˆ™æ˜¯ä»»åŠ¡è¢«æ‰§è¡Œè°ƒåº¦çš„å…¥å£ã€‚</p>
<h5 id="2-3-æ‰§è¡Œä»»åŠ¡"><a href="#2-3-æ‰§è¡Œä»»åŠ¡" class="headerlink" title="2.3 æ‰§è¡Œä»»åŠ¡"></a>2.3 æ‰§è¡Œä»»åŠ¡</h5><p>å¯¹ä»»åŠ¡è¿›è¡Œä¸åŒçš„æ“ä½œï¼Œå¦‚ï¼šå–æ¶ˆã€ç»“æŸã€å¼€å§‹ç­‰ã€‚WorkManagerå†…éƒ¨ä¼šå°†è¿™äº›è¡Œä¸ºè½¬æ¢æˆå¯¹åº”çš„Runnableäº¤ç»™è°ƒåº¦ç³»ç»Ÿè¿›è¡Œæ‰§è¡Œã€‚</p>
<center>
    <img src="../images/android-workmanager-action.jpg" width="70%"/>
</center>


<h4 id="ä¸‰ã€ä»»åŠ¡çš„è°ƒåº¦"><a href="#ä¸‰ã€ä»»åŠ¡çš„è°ƒåº¦" class="headerlink" title="ä¸‰ã€ä»»åŠ¡çš„è°ƒåº¦"></a>ä¸‰ã€ä»»åŠ¡çš„è°ƒåº¦</h4><p>æäº¤ç»™WorkManagerçš„ä»»åŠ¡ï¼Œä¼šå°è£…æˆ<code>EnqueueRunnable</code>äº¤ç»™é»˜è®¤çš„<code>SerialExecutor</code>å»æ‰§è¡Œã€‚<br><code>EnqueueRunnable</code>çš„runæ–¹æ³•ä¼šå…ˆå°†ä»»åŠ¡åŠ å…¥æ•°æ®åº“ä¸­ä¿å­˜ã€‚ç„¶åè¿›è¡Œä»»åŠ¡è°ƒåº¦ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (mWorkContinuation.hasCycles()) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalStateException(</span><br><span class="line">                    String.format(<span class="string">&quot;WorkContinuation has cycles (%s)&quot;</span>, mWorkContinuation));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//åŠ å…¥æ•°æ®åº“</span></span><br><span class="line">        <span class="keyword">boolean</span> needsScheduling = addToDatabase();</span><br><span class="line">        <span class="keyword">if</span> (needsScheduling) &#123;</span><br><span class="line">            <span class="comment">// Enable RescheduleReceiver, only when there are Worker&#x27;s that need scheduling.</span></span><br><span class="line">            <span class="keyword">final</span> Context context =</span><br><span class="line">                    mWorkContinuation.getWorkManagerImpl().getApplicationContext();</span><br><span class="line">            PackageManagerHelper.setComponentEnabled(context, RescheduleReceiver.class, <span class="keyword">true</span>);</span><br><span class="line">            <span class="comment">//è¿›è¡Œä»»åŠ¡è°ƒåº¦</span></span><br><span class="line">            scheduleWorkInBackground();</span><br><span class="line">        &#125;</span><br><span class="line">        mOperation.setState(Operation.SUCCESS);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Throwable exception) &#123;</span><br><span class="line">        mOperation.setState(<span class="keyword">new</span> Operation.State.FAILURE(exception));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="å››ã€å…¶ä»–"><a href="#å››ã€å…¶ä»–" class="headerlink" title="å››ã€å…¶ä»–"></a>å››ã€å…¶ä»–</h4><h5 id="4-1-ä»»åŠ¡çš„çº¦æŸ"><a href="#4-1-ä»»åŠ¡çš„çº¦æŸ" class="headerlink" title="4.1 ä»»åŠ¡çš„çº¦æŸ"></a>4.1 ä»»åŠ¡çš„çº¦æŸ</h5><h4 id="äº”ã€æ€»ç»“"><a href="#äº”ã€æ€»ç»“" class="headerlink" title="äº”ã€æ€»ç»“"></a>äº”ã€æ€»ç»“</h4><p>WorkManageråº“å¹¶ä¸ç®—å¤æ‚ã€‚è¿™ç§å¯¹ä»»åŠ¡çš„ç®¡ç†å’Œè°ƒåº¦æ¡†æ¶çš„æºç ï¼Œæˆ‘ä»¬å¯ä»¥å¤šçœ‹ï¼Œå­¦ä¹ ä¸€ä¸‹é‡Œé¢çš„è®¾è®¡æ€è·¯ã€‚æœ‰ä¸ªå¤§æ¦‚çš„å°è±¡ï¼Œåç»­å†™ç›¸å…³é€»è¾‘æ—¶å¯ä»¥å€Ÿé‰´ã€‚</p>
<ul>
<li>å€ŸåŠ©<code>startup</code>åˆå§‹åŒ–ä½ çš„æ¡†æ¶</li>
<li>æ„å»ºæœ‰ä¾èµ–å…³ç³»çš„ä»»åŠ¡</li>
<li>é€šè¿‡Runnableè§£è€¦ä»»åŠ¡çš„è¯·æ±‚å’Œæ‰§è¡Œã€‚</li>
</ul>
]]></content>
      <categories>
        <category>è®¡ç®—æœº</category>
      </categories>
      <tags>
        <tag>Android</tag>
      </tags>
  </entry>
  <entry>
    <title>android jetpack startup</title>
    <url>/android-jetpack-startup.html</url>
    <content><![CDATA[<h4 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h4><p><a href="https://cs.android.com/androidx/platform/frameworks/support/+/androidx-main:startup/">æºç </a></p>
<p>startupåº“æ˜¯ä¸€ä¸ªæç®€å¯åŠ¨ä¼˜åŒ–åº“ï¼Œå¯ä»¥è§£å†³å¯åŠ¨ä¸­çš„ä¾èµ–é¡ºåºé—®é¢˜ã€‚</p>
<h4 id="åŸºæœ¬ä½¿ç”¨"><a href="#åŸºæœ¬ä½¿ç”¨" class="headerlink" title="åŸºæœ¬ä½¿ç”¨"></a>åŸºæœ¬ä½¿ç”¨</h4><p>1.1 å®ç°Initializeræ¥å£</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LoggerInitializer</span> : <span class="type">Initializer</span>&lt;<span class="type">Logger</span>&gt; </span>&#123;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">create</span><span class="params">(context: <span class="type">Context</span>)</span></span>: Logger &#123;</span><br><span class="line">        Logger.<span class="keyword">init</span>(context)</span><br><span class="line">        <span class="keyword">return</span> Logger</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">dependencies</span><span class="params">()</span></span>: List&lt;Class&lt;<span class="keyword">out</span> Initializer&lt;*&gt;&gt;&gt; &#123;</span><br><span class="line">        <span class="keyword">return</span> emptyList()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>1.2 AndroidManifest.xmlä¸­å£°æ˜</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">provider</span>&gt;</span></span><br><span class="line">    android:name=&quot;androidx.startup.InitializationProvider&quot;</span><br><span class="line">    android:authorities=&quot;$&#123;applicationId&#125;.androidx-startup&quot;</span><br><span class="line">    android:exported=&quot;false&quot;</span><br><span class="line">    tools:node=&quot;merge&quot;&gt;</span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta-data</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:name</span>=<span class="string">&quot;me.xxx.demo.LoggerInitializer&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:value</span>=<span class="string">&quot;androidx.startup&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">provider</span>&gt;</span></span><br></pre></td></tr></table></figure>


<h4 id="æºç åˆ†æ"><a href="#æºç åˆ†æ" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><p>1ã€é»˜è®¤ç”±ContentProvider onCreateä¸­è·å–AppInitializer<strong>å•ä¾‹</strong><br>2ã€è°ƒç”¨AppInitializerå•ä¾‹çš„discoverAndInitializeï¼Œ<strong>è§£æManifest</strong>é‡Œé¢çš„mate<br>3ã€è§£æå®Œåæ”¾å…¥Set&lt;Class<? extends Initializer<?>&gt;&gt;ä¸­<br>4ã€éå†Setï¼Œè°ƒç”¨doInitializeè¿›è¡Œåˆå§‹åŒ–<br>    4.1 æ£€æŸ¥å¾ªç¯ä¾èµ–é—®é¢˜<br>    4.2 æ‰¾åˆ°æ­¤é¡¹çš„æ‰€æœ‰ä¾èµ–é¡¹ï¼Œé€’å½’è°ƒç”¨doInitialize<br>    4.3 æ­¤é¡¹ä¾èµ–åˆå§‹åŒ–å®Œæˆ</p>
<h4 id="ç¼ºç‚¹"><a href="#ç¼ºç‚¹" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h4><ul>
<li>ä¸æ”¯æŒçº¿ç¨‹æ§åˆ¶å’Œç­‰å¾…</li>
</ul>
<h4 id="å…¶ä»–ç›¸å…³åº“"><a href="#å…¶ä»–ç›¸å…³åº“" class="headerlink" title="å…¶ä»–ç›¸å…³åº“"></a>å…¶ä»–ç›¸å…³åº“</h4><p><a href="https://github.com/idisfkj/android-startup">android-startup</a></p>
]]></content>
  </entry>
  <entry>
    <title>Jetpack Compose State Management</title>
    <url>/android-jetpack-compose-state-management.html</url>
    <content><![CDATA[<p>â€“</p>
<center>
    <img src="../images/ui-equals-function-of-state.png" width="100%"/>
</center>

<h4 id="ä¸€ã€ä»€ä¹ˆæ˜¯çŠ¶æ€"><a href="#ä¸€ã€ä»€ä¹ˆæ˜¯çŠ¶æ€" class="headerlink" title="ä¸€ã€ä»€ä¹ˆæ˜¯çŠ¶æ€"></a>ä¸€ã€ä»€ä¹ˆæ˜¯çŠ¶æ€</h4><blockquote>
<p>çŠ¶æ€æ˜¯ä¸€äº›è¢«Viewã€Widgetè®¢é˜…æˆ–è§‚å¯Ÿçš„å¯¹è±¡ï¼Œå®ƒåŒ…å«æ•°æ®ã€‚ä»»ä½•çŠ¶æ€ï¼ˆæ•°æ®ï¼‰çš„å˜åŒ–éƒ½ä¼šé€šçŸ¥ç»™è§‚å¯Ÿå®ƒçš„Viewã€Widgetã€‚</p>
</blockquote>
<ul>
<li>ç½‘ç»œæ–­å¼€æ—¶å±•ç¤ºçš„Toast</li>
<li>å‘å¸ƒçš„åšå®¢åŠå…¶è¯„è®º</li>
<li>ç‚¹å‡»æŒ‰é’®æ—¶çš„æ°´æ³¢çº¹åŠ¨ç”»</li>
</ul>
<h4 id="äºŒã€Composeä¸­çš„çŠ¶æ€"><a href="#äºŒã€Composeä¸­çš„çŠ¶æ€" class="headerlink" title="äºŒã€Composeä¸­çš„çŠ¶æ€"></a>äºŒã€Composeä¸­çš„çŠ¶æ€</h4><h5 id="2-1-è®°ä½çŠ¶æ€"><a href="#2-1-è®°ä½çŠ¶æ€" class="headerlink" title="2.1 è®°ä½çŠ¶æ€"></a>2.1 è®°ä½çŠ¶æ€</h5><p>Composableå‡½æ•°å¯ä»¥ä½¿ç”¨<code>remember</code>åœ¨åˆå§‹åŒ–æ—¶å­˜å‚¨ä¸€ä¸ªå¯¹è±¡åˆ°å†…å­˜ä¸­ã€‚æ¯æ¬¡recompositionæ—¶è¿™ä¸ªå¯¹è±¡éƒ½ä¼šè¢«è¿”å›ã€‚</p>
<h5 id="2-2-å¯è§‚å¯ŸçŠ¶æ€"><a href="#2-2-å¯è§‚å¯ŸçŠ¶æ€" class="headerlink" title="2.2 å¯è§‚å¯ŸçŠ¶æ€"></a>2.2 å¯è§‚å¯ŸçŠ¶æ€</h5><p><code>mutableStateOf</code>å‡½æ•°å¯ä»¥åˆ›å»ºä¸€ä¸ªå¯è§‚å¯Ÿçš„å¯å˜æ•°æ®ï¼Œæ­¤æ•°æ®çš„å˜åŒ–å°†è§¦å‘recomposition</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Composable</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">MySwitch</span><span class="params">()</span></span> &#123;</span><br><span class="line">   <span class="comment">// I have a State in Compose&#x27;s MutableState</span></span><br><span class="line">   <span class="keyword">val</span> checked = remember &#123; mutableStateOf(<span class="literal">false</span>) &#125;</span><br><span class="line">   Switch(</span><br><span class="line">       <span class="comment">// Observe the State by accessing the value property</span></span><br><span class="line">       checked = checked.value,</span><br><span class="line">       onCheckedChange = &#123;</span><br><span class="line">           checked.value = it</span><br><span class="line">       &#125;</span><br><span class="line">   )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="2-3-å…¶ä»–çŠ¶æ€ç±»å‹"><a href="#2-3-å…¶ä»–çŠ¶æ€ç±»å‹" class="headerlink" title="2.3 å…¶ä»–çŠ¶æ€ç±»å‹"></a>2.3 å…¶ä»–çŠ¶æ€ç±»å‹</h5><p>é™¤äº†ä½¿ç”¨<code>MutableState&lt;T&gt;</code>æŒæœ‰çŠ¶æ€å¤–ï¼Œä½ è¿˜å¯ä»¥ä½¿ç”¨ä»¥ä¸‹è¿™äº›å¯è§‚å¯Ÿæ•°æ®ç±»å‹æ¥ç»´æŠ¤çŠ¶æ€ã€‚</p>
<ul>
<li>LiveData</li>
<li>Flow</li>
<li>RxJava2</li>
</ul>
<p>ä½†æ˜¯ï¼Œåœ¨ä½¿ç”¨æ—¶éœ€è¦å°†å…¶è½¬æˆ<code>State&lt;T&gt;</code>ç±»å‹</p>
<ul>
<li><code>LiveData&lt;T&gt;.observeAsState()</code></li>
<li><code>Flow&lt;T&gt;.collectAsState()</code></li>
</ul>
<h5 id="2-4-stateless"><a href="#2-4-stateless" class="headerlink" title="2.4 stateless"></a>2.4 stateless</h5><p>åœ¨Composableå‡½æ•°ä¸­ä¿å­˜çŠ¶æ€å°†é™ä½å®ƒçš„å¯å¤ç”¨æ€§ï¼Œé€šè¿‡å°†çŠ¶æ€å‘å¤–æŠ½ç¦»æ¥å¢åŠ å…¶å¤ç”¨æ€§ã€‚</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Composable</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">HelloScreen</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">var</span> name <span class="keyword">by</span> rememberSaveable &#123; mutableStateOf(<span class="string">&quot;&quot;</span>) &#125;</span><br><span class="line"></span><br><span class="line">    HelloContent(name = name, onNameChange = &#123; name = it &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Composable</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">HelloContent</span><span class="params">(name: <span class="type">String</span>, onNameChange: (<span class="type">String</span>) -&gt; <span class="type">Unit</span>)</span></span> &#123;</span><br><span class="line">    Column(modifier = Modifier.padding(<span class="number">16.</span>dp)) &#123;</span><br><span class="line">        Text(</span><br><span class="line">            text = <span class="string">&quot;Hello, <span class="variable">$name</span>&quot;</span>,</span><br><span class="line">            modifier = Modifier.padding(bottom = <span class="number">8.</span>dp),</span><br><span class="line">            style = MaterialTheme.typography.h5</span><br><span class="line">        )</span><br><span class="line">        OutlinedTextField(</span><br><span class="line">            value = name,</span><br><span class="line">            onValueChange = onNameChange,</span><br><span class="line">            label = &#123; Text(<span class="string">&quot;Name&quot;</span>) &#125;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="2-5-çŠ¶æ€æ¢å¤"><a href="#2-5-çŠ¶æ€æ¢å¤" class="headerlink" title="2.5 çŠ¶æ€æ¢å¤"></a>2.5 çŠ¶æ€æ¢å¤</h5><p>å½“Activityé‡å»ºæ—¶ï¼Œæƒ³è¦ä¿ç•™çŠ¶æ€ï¼Œå¹¶åœ¨é‡å»ºåæ¢å¤çŠ¶æ€ï¼Œå¯ä»¥ä½¿ç”¨<code>rememberSaveable</code>å°†çŠ¶æ€ä¿å­˜åˆ°Bundleä¸­ã€‚</p>
<ul>
<li>Parcelize</li>
<li>MapSaver</li>
<li>ListSaver</li>
</ul>
<h4 id="ä¸‰ã€å‚è€ƒ"><a href="#ä¸‰ã€å‚è€ƒ" class="headerlink" title="ä¸‰ã€å‚è€ƒ"></a>ä¸‰ã€å‚è€ƒ</h4><p><a href="https://developer.android.com/jetpack/compose/state#state-in-composables">State and Jetpack Compose</a><br><a href="https://medium.com/@takahirom/jetpack-compose-state-guideline-494d467b6e76">Jetpack Compose State Guideline</a><br><a href="https://levelup.gitconnected.com/managing-state-in-android-f4d042646521">Managing State in Android</a></p>
]]></content>
      <categories>
        <category>è®¡ç®—æœº</category>
      </categories>
      <tags>
        <tag>Android</tag>
      </tags>
  </entry>
  <entry>
    <title>Androidä¸­çš„æ—¥å¿—åº“</title>
    <url>/android-library-log.html</url>
    <content><![CDATA[<p>æ—¥å¿—åº“æ˜¯ä¸€ä¸ªé¡¹ç›®çš„åŸºç¡€åŠŸèƒ½ä¹‹ä¸€ï¼Œå®ƒåº”è¯¥åŒ…æ‹¬ä½†ä¸é™äºä»¥ä¸‹åŠŸèƒ½ï¼š</p>
<ul>
<li>æ‰©å±•æ€§ï¼šæ”¯æŒæŠŠæ—¥å¿—è®°å½•åˆ°å¤šä¸ªåœ°æ–¹ï¼Œå¦‚ï¼šæœ¬åœ°æ–‡ä»¶ã€æ§åˆ¶å°ã€å´©æºƒç³»ç»Ÿã€‚</li>
<li>é«˜æ€§èƒ½ï¼šæ—¥å¿—è®°å½•è¾ƒä¸ºé¢‘ç¹æ—¶ï¼Œå¦‚ä½•å†™æ–‡ä»¶ï¼Œæé«˜æ€§èƒ½ã€‚</li>
<li>ç¨³å®šæ€§ï¼šå´©æºƒå‰ä¸€åˆ»çš„æ—¥å¿—ä¸ä¸¢å¤±ã€‚</li>
</ul>
<p>ä»¥ä¸‹æ˜¯ä¸€äº›å¼€æºçš„æ—¥å¿—åº“ï¼Œåšä¸€ä¸ªè®°å½•ï¼š</p>
<ul>
<li><a href="https://github.com/pqpo/Log4a">Log4a</a> 0.9k star</li>
</ul>
<p>åŸºäº mmap, é«˜æ€§èƒ½ã€é«˜å¯ç”¨çš„ Android æ—¥å¿—æ”¶é›†æ¡†æ¶</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">Log4a.i(TAG, &quot;Helloï¼ŒLog4a!&quot;);</span><br><span class="line">Log4a.flush();</span><br><span class="line">Log4a.release();</span><br></pre></td></tr></table></figure>


<ul>
<li><a href="https://github.com/elvishew/xLog">xLog</a> 3.1k star</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    LogConfiguration config = <span class="keyword">new</span> LogConfiguration.Builder()</span><br><span class="line">        .logLevel(BuildConfig.DEBUG ? LogLevel.ALL             <span class="comment">// Specify log level, logs below this level won&#x27;t be printed, default: LogLevel.ALL</span></span><br><span class="line">            : LogLevel.NONE)</span><br><span class="line">        .tag(<span class="string">&quot;MY_TAG&quot;</span>)                                         <span class="comment">// Specify TAG, default: &quot;X-LOG&quot;</span></span><br><span class="line">        .enableThreadInfo()                                    <span class="comment">// Enable thread info, disabled by default</span></span><br><span class="line">        .enableStackTrace(<span class="number">2</span>)                                   <span class="comment">// Enable stack trace info with depth 2, disabled by default</span></span><br><span class="line">        .enableBorder()                                        <span class="comment">// Enable border, disabled by default</span></span><br><span class="line">        .jsonFormatter(<span class="keyword">new</span> MyJsonFormatter())                  <span class="comment">// Default: DefaultJsonFormatter</span></span><br><span class="line">        .xmlFormatter(<span class="keyword">new</span> MyXmlFormatter())                    <span class="comment">// Default: DefaultXmlFormatter</span></span><br><span class="line">        .throwableFormatter(<span class="keyword">new</span> MyThrowableFormatter())        <span class="comment">// Default: DefaultThrowableFormatter</span></span><br><span class="line">        .threadFormatter(<span class="keyword">new</span> MyThreadFormatter())              <span class="comment">// Default: DefaultThreadFormatter</span></span><br><span class="line">        .stackTraceFormatter(<span class="keyword">new</span> MyStackTraceFormatter())      <span class="comment">// Default: DefaultStackTraceFormatter</span></span><br><span class="line">        .borderFormatter(<span class="keyword">new</span> MyBoardFormatter())               <span class="comment">// Default: DefaultBorderFormatter</span></span><br><span class="line">        .addObjectFormatter(AnyClass.class,                    <span class="comment">// Add formatter for specific class of object</span></span><br><span class="line">            <span class="keyword">new</span> AnyClassObjectFormatter())                     <span class="comment">// Use Object.toString() by default</span></span><br><span class="line">        .addInterceptor(<span class="keyword">new</span> BlacklistTagsFilterInterceptor(    <span class="comment">// Add blacklist tags filter</span></span><br><span class="line">            <span class="string">&quot;blacklist1&quot;</span>, <span class="string">&quot;blacklist2&quot;</span>, <span class="string">&quot;blacklist3&quot;</span>))</span><br><span class="line">        .addInterceptor(<span class="keyword">new</span> MyInterceptor())                   <span class="comment">// Add other log interceptor</span></span><br><span class="line">        .build();</span><br><span class="line">    </span><br><span class="line">    Printer androidPrinter = <span class="keyword">new</span> AndroidPrinter(<span class="keyword">true</span>);         <span class="comment">// Printer that print the log using android.util.Log</span></span><br><span class="line">    Printer consolePrinter = <span class="keyword">new</span> ConsolePrinter();             <span class="comment">// Printer that print the log to console using System.out</span></span><br><span class="line">    Printer filePrinter = <span class="keyword">new</span> FilePrinter                      <span class="comment">// Printer that print(save) the log to file</span></span><br><span class="line">        .Builder(<span class="string">&quot;&lt;path-to-logs-dir&gt;&quot;</span>)                         <span class="comment">// Specify the directory path of log file(s)</span></span><br><span class="line">        .fileNameGenerator(<span class="keyword">new</span> DateFileNameGenerator())        <span class="comment">// Default: ChangelessFileNameGenerator(&quot;log&quot;)</span></span><br><span class="line">        .backupStrategy(<span class="keyword">new</span> NeverBackupStrategy())             <span class="comment">// Default: FileSizeBackupStrategy(1024 * 1024)</span></span><br><span class="line">        .cleanStrategy(<span class="keyword">new</span> FileLastModifiedCleanStrategy(MAX_TIME))     <span class="comment">// Default: NeverCleanStrategy()</span></span><br><span class="line">        .flattener(<span class="keyword">new</span> MyFlattener())                          <span class="comment">// Default: DefaultFlattener</span></span><br><span class="line">        .writer(<span class="keyword">new</span> MyWriter())                                <span class="comment">// Default: SimpleWriter</span></span><br><span class="line">        .build();</span><br><span class="line">    </span><br><span class="line">    XLog.init(                                                 <span class="comment">// Initialize XLog</span></span><br><span class="line">        config,                                                <span class="comment">// Specify the log configuration, if not specified, will use new LogConfiguration.Builder().build()</span></span><br><span class="line">        androidPrinter,                                        <span class="comment">// Specify printers, if no printer is specified, AndroidPrinter(for Android)/ConsolePrinter(for java) will be used.</span></span><br><span class="line">        consolePrinter,</span><br><span class="line">        filePrinter);</span><br><span class="line">&#125;</span><br><span class="line">````</span><br><span class="line"></span><br><span class="line">+ [logger](https:<span class="comment">//github.com/orhanobut/logger) 13.7k star</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">```java</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123; </span><br><span class="line">    FormatStrategy formatStrategy = PrettyFormatStrategy.newBuilder()</span><br><span class="line">      .showThreadInfo(<span class="keyword">false</span>)  <span class="comment">// (Optional) Whether to show thread info or not. Default true</span></span><br><span class="line">      .methodCount(<span class="number">0</span>)         <span class="comment">// (Optional) How many method line to show. Default 2</span></span><br><span class="line">      .methodOffset(<span class="number">7</span>)        <span class="comment">// (Optional) Hides internal method calls up to offset. Default 5</span></span><br><span class="line">      .logStrategy(customLog) <span class="comment">// (Optional) Changes the log strategy to print out. Default LogCat</span></span><br><span class="line">      .tag(<span class="string">&quot;My custom tag&quot;</span>)   <span class="comment">// (Optional) Global tag for every log. Default PRETTY_LOGGER</span></span><br><span class="line">      .build();</span><br><span class="line"></span><br><span class="line">    Logger.addLogAdapter(<span class="keyword">new</span> AndroidLogAdapter(formatStrategy));</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
  </entry>
  <entry>
    <title>Roomæ•°æ®åº“é…·ä¸ƒæ¡</title>
    <url>/android-library-room-7-tips.html</url>
    <content><![CDATA[<h4 id="ä¸€ã€é€šè¿‡RoomDatabase-Callbacké¢„å¡«å……æ•°æ®"><a href="#ä¸€ã€é€šè¿‡RoomDatabase-Callbacké¢„å¡«å……æ•°æ®" class="headerlink" title="ä¸€ã€é€šè¿‡RoomDatabase#Callbacké¢„å¡«å……æ•°æ®"></a>ä¸€ã€é€šè¿‡<code>RoomDatabase#Callback</code>é¢„å¡«å……æ•°æ®</h4><p>å¦‚æœéœ€è¦åœ¨æ•°æ®åº“åˆ›å»ºæˆ–æ•°æ®åº“æ‰“å¼€çš„æ—¶å€™æ·»åŠ ä¸€äº›é»˜è®¤æ•°æ®ï¼Œå¯ä»¥ä½¿ç”¨<code>RoomDatabase#Callback</code>æ¥å£å¹¶å¤å†™å®ƒçš„<code>onCreate</code>æˆ–<code>onOpen</code>æ–¹æ³•ã€‚ç”±äºDAOå¯¹è±¡åªèƒ½åœ¨è¿™ä¸¤ä¸ªæ–¹æ³•è¿”å›åä½¿ç”¨ï¼Œæ‰€ä»¥æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–°çº¿ç¨‹æ¥æ’å…¥æ•°æ®ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">Room.databaseBuilder(context.applicationContext,</span><br><span class="line">        DataDatabase::<span class="keyword">class</span>.java, <span class="string">&quot;Sample.db&quot;</span>)</span><br><span class="line">        <span class="comment">// prepopulate the database after onCreate was called</span></span><br><span class="line">        .addCallback(<span class="keyword">object</span> : Callback() &#123;</span><br><span class="line">            <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(db: <span class="type">SupportSQLiteDatabase</span>)</span></span> &#123;</span><br><span class="line">                <span class="keyword">super</span>.onCreate(db)</span><br><span class="line">                <span class="comment">// moving to a new thread</span></span><br><span class="line">                ioThread &#123;</span><br><span class="line">                    getInstance(context).dataDao()</span><br><span class="line">                                        .insert(PREPOPULATE_DATA)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">        .build()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>éœ€è¦æ³¨æ„çš„æ˜¯</strong>ï¼šå½“appé¦–æ¬¡å¯åŠ¨æ—¶ï¼Œåœ¨createå’Œinsertä¹‹é—´å´©æºƒçš„è¯ï¼Œæ•°æ®å°†æ°¸è¿œä¸ä¼šè¢«æ’å…¥ã€‚</p>
<h4 id="äºŒã€ä½¿ç”¨DAOçš„ç»§æ‰¿èƒ½åŠ›"><a href="#äºŒã€ä½¿ç”¨DAOçš„ç»§æ‰¿èƒ½åŠ›" class="headerlink" title="äºŒã€ä½¿ç”¨DAOçš„ç»§æ‰¿èƒ½åŠ›"></a>äºŒã€ä½¿ç”¨DAOçš„ç»§æ‰¿èƒ½åŠ›</h4><p>å¾ˆå¤šDAOé‡Œå­˜åœ¨ä¸€æ ·çš„<code>Insert</code>ã€<code>Update</code>ã€<code>Delete</code>æ–¹æ³•ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç»§æ‰¿æ¥é¿å…è¿™äº›é‡å¤çš„ä»£ç ã€‚</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">BaseDao</span>&lt;<span class="type">T</span>&gt; </span>&#123;</span><br><span class="line">    <span class="meta">@Insert</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">insert</span><span class="params">(<span class="keyword">vararg</span> obj: <span class="type">T</span>)</span></span></span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@Dao</span></span><br><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">DataDao</span> : <span class="type">BaseDao</span>&lt;<span class="type">Data</span>&gt;</span>() &#123;</span><br><span class="line">    <span class="meta">@Query(<span class="meta-string">&quot;SELECT * FROM Data&quot;</span>)</span></span><br><span class="line">    <span class="keyword">abstract</span> <span class="function"><span class="keyword">fun</span> <span class="title">getData</span><span class="params">()</span></span>: List&lt;Data&gt;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h4 id="ä¸‰ã€é€šè¿‡-Transactionå‡å°‘äº‹åŠ¡æŸ¥è¯¢çš„æ¨¡æ¿ä»£ç "><a href="#ä¸‰ã€é€šè¿‡-Transactionå‡å°‘äº‹åŠ¡æŸ¥è¯¢çš„æ¨¡æ¿ä»£ç " class="headerlink" title="ä¸‰ã€é€šè¿‡@Transactionå‡å°‘äº‹åŠ¡æŸ¥è¯¢çš„æ¨¡æ¿ä»£ç "></a>ä¸‰ã€é€šè¿‡<code>@Transaction</code>å‡å°‘äº‹åŠ¡æŸ¥è¯¢çš„æ¨¡æ¿ä»£ç </h4><p>ç”¨<code>@Transaction</code>æ³¨è§£çš„æ–¹æ³•ä¼šåœ¨ä¸€ä¸ªäº‹åŠ¡é‡Œé¢æ‰§è¡Œã€‚å½“è¿™äº›æ–¹æ³•æ‰§è¡Œå¼‚å¸¸æ—¶ï¼Œäº‹åŠ¡ä¹Ÿä¼šå¤±è´¥ã€‚</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Dao</span></span><br><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">UserDao</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Transaction</span></span><br><span class="line">    <span class="keyword">open</span> <span class="function"><span class="keyword">fun</span> <span class="title">updateData</span><span class="params">(users: <span class="type">List</span>&lt;<span class="type">User</span>&gt;)</span></span> &#123;</span><br><span class="line">        deleteAllUsers()</span><br><span class="line">        insertAll(users)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Insert</span></span><br><span class="line">    <span class="keyword">abstract</span> <span class="function"><span class="keyword">fun</span> <span class="title">insertAll</span><span class="params">(users: <span class="type">List</span>&lt;<span class="type">User</span>&gt;)</span></span></span><br><span class="line">    <span class="meta">@Query(<span class="meta-string">&quot;DELETE FROM Users&quot;</span>)</span></span><br><span class="line">    <span class="keyword">abstract</span> <span class="function"><span class="keyword">fun</span> <span class="title">deleteAllUsers</span><span class="params">()</span></span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å½“<code>@Query</code>æ–¹æ³•å¸¦æœ‰selectè¯­å¥æ—¶ï¼Œåœ¨ä¸‹åˆ—æƒ…å†µä¸‹ä½ å¯èƒ½ä¼šä½¿ç”¨<code>@Transation</code>æ³¨è§£</p>
<ul>
<li>å½“æŸ¥è¯¢çš„ç»“æœé›†å¾ˆå¤§æ—¶ï¼Œè®©æŸ¥è¯¢åœ¨ä¸€æ¬¡äº‹åŠ¡é‡Œå®Œæˆèƒ½å¤Ÿä¿è¯ï¼šå¦‚æœæŸ¥è¯¢ç»“æœä¸æ»¡è¶³å•ä¸ªæ¸¸æ ‡çª—å£ï¼Œå®ƒä¸ä¼šå› ä¸ºåœ¨æ¸¸æ ‡çª—å£äº¤æ¢ä¹‹é—´çš„æ•°æ®åº“æ›´æ”¹è€Œä¸­æ–­ã€‚</li>
<li>å¦‚æœæŸ¥è¯¢ç»“æœæ˜¯ä¸€ä¸ªå¸¦<code>@Relation</code>å­—æ®µçš„POJOï¼Œæ­¤å­—æ®µä¼šå•ç‹¬æŸ¥è¯¢ï¼Œæ‰€ä»¥è®©ä»–ä»¬è¿è¡Œåœ¨ä¸€ä¸ªäº‹åŠ¡ä¸­å¯ä»¥ç¡®ä¿ç»“æœä¸€è‡´ã€‚</li>
</ul>
<p><code>Delete</code>ã€<code>Update</code>ã€<code>Insert</code>æ–¹æ³•åŒ…å«å¤šä¸ªå‚æ•°æ—¶ä¼šè‡ªåŠ¨åœ¨äº‹åŠ¡é‡Œæ‰§è¡Œã€‚</p>
<h4 id="å››ã€åªè¯»éœ€è¦çš„æ•°æ®"><a href="#å››ã€åªè¯»éœ€è¦çš„æ•°æ®" class="headerlink" title="å››ã€åªè¯»éœ€è¦çš„æ•°æ®"></a>å››ã€åªè¯»éœ€è¦çš„æ•°æ®</h4><p>å…³æ³¨Appçš„å†…å­˜æ¶ˆè€—ï¼ŒåªåŠ è½½éœ€è¦ä½¿ç”¨çš„å­—æ®µï¼Œè¿™èƒ½æé«˜æŸ¥è¯¢é€Ÿåº¦å‡å°‘IOæ¶ˆè€—ã€‚</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Entity(tableName = <span class="meta-string">&quot;users&quot;</span>)</span></span><br><span class="line"><span class="keyword">data</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span></span>(<span class="meta">@PrimaryKey</span></span><br><span class="line">                <span class="keyword">val</span> id: String,</span><br><span class="line">                <span class="keyword">val</span> userName: String,</span><br><span class="line">                <span class="keyword">val</span> firstName: String, </span><br><span class="line">                <span class="keyword">val</span> lastName: String,</span><br><span class="line">                <span class="keyword">val</span> email: String,</span><br><span class="line">                <span class="keyword">val</span> dateOfBirth: Date, </span><br><span class="line">                <span class="keyword">val</span> registrationDate: Date)</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢çš„ç±»ä¸­ï¼Œå¾ˆå¤šå­—æ®µæˆ‘ä»¬ç”¨ä¸åˆ°ï¼Œå®šä¹‰ä¸€ä¸ªç±»ï¼ŒåªåŒ…å«æˆ‘ä»¬éœ€è¦çš„å­—æ®µï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">data</span> <span class="class"><span class="keyword">class</span> <span class="title">UserMinimal</span></span>(<span class="keyword">val</span> userId: String,</span><br><span class="line">                       <span class="keyword">val</span> firstName: String, </span><br><span class="line">                       <span class="keyword">val</span> lastName: String)</span><br></pre></td></tr></table></figure>

<p>åœ¨DAOä¸­ï¼Œå®šä¹‰æ–¹æ³•åªæŸ¥è¯¢æ‰€éœ€å­—æ®µï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Dao</span></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">UserDao</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Query(â€œSELECT userId, firstName, lastName FROM Users)</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">getUsersMinimal</span><span class="params">()</span></span>: List&lt;UserMinimal&gt;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="äº”ã€ä½¿ç”¨å¤–é”®"><a href="#äº”ã€ä½¿ç”¨å¤–é”®" class="headerlink" title="äº”ã€ä½¿ç”¨å¤–é”®"></a>äº”ã€ä½¿ç”¨å¤–é”®</h4><p>å³ä½¿Roomä¸ç›´æ¥æ”¯æŒå…³ç³»ï¼Œä½†å®ƒå…è®¸ä½ å®šä¹‰å¤–é”®æ¥çº¦æŸå®ä½“ä¹‹é—´çš„å…³ç³»ã€‚</p>
<p>Roomçš„<code>@ForeignKey</code>æ˜¯<code>@Entity</code>æ³¨è§£çš„ä¸€éƒ¨åˆ†ï¼Œç”¨æ¥æ”¯æŒSqliteçš„å¤–é”®ç‰¹æ€§ã€‚å®ƒå¼ºåˆ¶è¡¨ä¹‹é—´çš„çº¦æŸï¼Œå½“ä½ ä¿®æ”¹è¡¨æ—¶ï¼Œä¿è¯å…³ç³»ä¸€è‡´æ€§ã€‚</p>
<p>çœ‹ä¸€ä¸‹<code>User</code>å’Œ<code>Pet</code>ç±»ï¼Œ<code>Pet</code>æœ‰ä¸»äººï¼Œä»¥userIdå…³è”ã€‚</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Entity(tableName = <span class="meta-string">&quot;pets&quot;</span>,</span></span><br><span class="line"><span class="meta">        foreignKeys = arrayOf(</span></span><br><span class="line"><span class="meta">            ForeignKey(entity = User::class,</span></span><br><span class="line"><span class="meta">                       parentColumns = arrayOf(<span class="meta-string">&quot;userId&quot;</span>)</span>,</span><br><span class="line">                       childColumns = arrayOf(<span class="string">&quot;owner&quot;</span>))))</span><br><span class="line"><span class="keyword">data</span> <span class="class"><span class="keyword">class</span> <span class="title">Pet</span></span>(<span class="meta">@PrimaryKey</span> <span class="keyword">val</span> petId: String,</span><br><span class="line">              <span class="keyword">val</span> name: String,</span><br><span class="line">              <span class="keyword">val</span> owner: String)</span><br></pre></td></tr></table></figure>

<p>ä½ å¯ä»¥å®šä¹‰ä¸€äº›è¡Œä¸ºï¼Œå½“ä¾‹å­ä¸­çš„<code>User</code>åœ¨æ•°æ®åº“ä¸­è¢«åˆ é™¤æˆ–ä¿®æ”¹ã€‚ä½ å¯ä»¥åšä»¥ä¸‹ä¸€äº›æ“ä½œï¼š<code>NO_ACTION</code>ã€<code>RESTRICT</code>ã€<code>SET_NULL</code>ã€<code>SET_DEFAULT</code>æˆ–<code>CASCADE</code>ï¼Œè¿™äº›æ“ä½œå’ŒSqliteä¿æŒä¸€è‡´ã€‚</p>
<p><strong>æ³¨æ„ï¼š</strong> åœ¨Roomä¸­<code>SET_DEFAULT</code>å’Œ<code>SET_NULL</code>æ•ˆæœä¸€è‡´ï¼Œå› ä¸ºRoomè¿˜ä¸å…è®¸ä¸ºæ•°æ®åˆ—è®¾ç½®é»˜è®¤å€¼ã€‚</p>
<h4 id="å…­ã€ä½¿ç”¨-Relationç®€åŒ–ä¸€å¯¹å¤šæŸ¥è¯¢"><a href="#å…­ã€ä½¿ç”¨-Relationç®€åŒ–ä¸€å¯¹å¤šæŸ¥è¯¢" class="headerlink" title="å…­ã€ä½¿ç”¨@Relationç®€åŒ–ä¸€å¯¹å¤šæŸ¥è¯¢"></a>å…­ã€ä½¿ç”¨<code>@Relation</code>ç®€åŒ–ä¸€å¯¹å¤šæŸ¥è¯¢</h4><p>åœ¨å‰é¢<code>User-Pet</code>çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æœ‰ä¸ªä¸€å¯¹å¤šçš„å…³ç³»ï¼Œä¸€ä¸ªäººå¯ä»¥æœ‰å¤šä¸ªå® ç‰©ã€‚å½“æˆ‘ä»¬æƒ³è·å–ä¸»äººå’Œå® ç‰©é›†åˆæ—¶ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">data</span> <span class="class"><span class="keyword">class</span> <span class="title">UserAndAllPets</span> </span>(<span class="keyword">val</span> user: User,</span><br><span class="line">                           <span class="keyword">val</span> pets: List&lt;Pet&gt; = ArrayList())</span><br></pre></td></tr></table></figure>

<p>éœ€è¦ä¸¤ä¸ªæŸ¥è¯¢ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Query(â€œSELECT * FROM Usersâ€)</span></span><br><span class="line"><span class="keyword">public</span> List&lt;User&gt; getUsers();</span><br><span class="line"></span><br><span class="line"><span class="meta">@Query(â€œSELECT * FROM Pets where owner = :userIdâ€)</span></span><br><span class="line"><span class="keyword">public</span> List&lt;Pet&gt; getPetsForUser(String userId);</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬éœ€è¦éå†ç”¨æˆ·æ¥æŸ¥å® ç‰©ã€‚</p>
<p>ä¸ºäº†ç®€åŒ–æ­¤è¿‡ç¨‹ï¼ŒRoomçš„<code>@Relation</code>æ³¨è§£è‡ªåŠ¨å…³è”å®ä½“ã€‚æ­¤æ³¨è§£åªèƒ½ç”¨äº<code>List</code>å’Œ<code>Set</code>å¯¹è±¡ã€‚</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserAndAllPets</span> </span>&#123;</span><br><span class="line">   <span class="meta">@Embedded</span></span><br><span class="line">   <span class="keyword">var</span> user: User? = <span class="literal">null</span></span><br><span class="line"></span><br><span class="line">   <span class="meta">@Relation(parentColumn = â€œuserIdâ€,</span></span><br><span class="line"><span class="meta">             entityColumn = â€œownerâ€)</span></span><br><span class="line">   <span class="keyword">var</span> pets: List&lt;Pet&gt; = ArrayList()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åœ¨DAOä¸­ï¼Œæˆ‘ä»¬å®šä¹‰ä¸€æ¬¡æŸ¥è¯¢ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Transaction</span></span><br><span class="line"><span class="meta">@Query(â€œSELECT * FROM Usersâ€)</span></span><br><span class="line">List&lt;UserAndAllPets&gt; getUsers();</span><br></pre></td></tr></table></figure>


<h4 id="ä¸ƒã€é¿å…å¯è§‚å¯ŸæŸ¥è¯¢çš„å‡é€šçŸ¥"><a href="#ä¸ƒã€é¿å…å¯è§‚å¯ŸæŸ¥è¯¢çš„å‡é€šçŸ¥" class="headerlink" title="ä¸ƒã€é¿å…å¯è§‚å¯ŸæŸ¥è¯¢çš„å‡é€šçŸ¥"></a>ä¸ƒã€é¿å…å¯è§‚å¯ŸæŸ¥è¯¢çš„å‡é€šçŸ¥</h4><p>å¯è§‚å¯ŸæŸ¥è¯¢ï¼Œåªå…³å¿ƒå¯¹åº”IDçš„å¯¹è±¡ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Query(â€œSELECT * FROM Users WHERE userId = :id)</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">getUserById</span><span class="params">(id: <span class="type">String</span>)</span></span>: LiveData&lt;User&gt; </span><br><span class="line"></span><br><span class="line"><span class="comment">// or</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@Query(â€œSELECT * FROM Users WHERE userId = :id)</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">getUserById</span><span class="params">(id: <span class="type">String</span>)</span></span>: Flowable&lt;User&gt;</span><br></pre></td></tr></table></figure>

<p>æ¯æ¬¡æ­¤ç”¨æˆ·æ›´æ–°çš„æ—¶å€™ä½ éƒ½å¾—åˆ°ä¸€ä¸ªæ–°é€šçŸ¥ã€‚ä½†æ˜¯å…¶ä»–çš„ä¸€äº›ä¸å½±å“æ­¤IDçš„ä¿®æ”¹ï¼ˆdeleteã€updateã€insertï¼‰ä¼šå‘é€é€šçŸ¥ã€‚</p>
<p>è¿™ç§åœºæ™¯èƒŒåçš„åŸå› æ˜¯ä»€ä¹ˆï¼š<br>1ã€Sqliteæ”¯æŒè§¦å‘å™¨ï¼Œ<code>DELETE</code>ã€<code>UPDATE</code>ã€<code>INSERT</code>å‘ç”Ÿæ—¶æˆ–è§¦å‘ã€‚<br>2ã€Roomåˆ›å»ºäº†ä¸€ä¸ª<code>InvalidationTracker</code>æ¥è·Ÿè¸ªè§‚å¯Ÿè¡¨çš„å˜åŒ–ã€‚<br>3ã€<code>LiveData</code>å’Œ<code>Flowable</code>æŸ¥è¯¢ä¾èµ–<code>InvalidationTracker.Observer#onInvalidated</code>é€šçŸ¥ï¼Œæ”¶åˆ°é€šçŸ¥å°±åšä¸€æ¬¡å†æŸ¥è¯¢æ“ä½œã€‚</p>
<p>RoomåªçŸ¥é“è¡¨è¢«ä¿®æ”¹äº†ï¼Œä¸çŸ¥é“ä¸ºä»€ä¹ˆä¿®æ”¹ä¹Ÿä¸çŸ¥é“ä»€ä¹ˆè¢«ä¿®æ”¹ã€‚å› æ­¤ï¼Œå†æŸ¥è¯¢æ“ä½œä¼šé‡æ–°é€šçŸ¥ã€‚ç”±äºRoomä¸åœ¨å†…å­˜ä¿å­˜æ•°æ®ä¹Ÿä¸èƒ½ä¿è¯objectçš„equalsæ–¹æ³•æ‰€ä»¥ä»–ä¸çŸ¥é“å¯¹è±¡æ˜¯å¦å˜åŒ–äº†ã€‚</p>
<p>ä½ éœ€è¦è‡ªå·±ä¿è¯DAOè¿‡æ»¤æ”¶åˆ°çš„äº‹ä»¶ï¼Œåªå¯¹å…³å¿ƒçš„æ•°æ®åšå‡ºå“åº”ã€‚</p>
<p>å¦‚æœè§‚å¯Ÿçš„æ˜¯<code>Flowable</code>ï¼Œä½¿ç”¨<code>Flowable#distinctUntilChanged</code>ã€‚</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Dao</span></span><br><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">UserDao</span> : <span class="type">BaseDao</span>&lt;<span class="type">User</span>&gt;</span>() &#123;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* Get a user by id.</span></span><br><span class="line"><span class="comment">* <span class="doctag">@return</span> the user from the table with a specific id.</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@Query(â€œSELECT * FROM Users WHERE userid = :idâ€)</span></span><br><span class="line"><span class="keyword">protected</span> <span class="keyword">abstract</span> <span class="function"><span class="keyword">fun</span> <span class="title">getUserById</span><span class="params">(id: <span class="type">String</span>)</span></span>: Flowable&lt;User&gt;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">getDistinctUserById</span><span class="params">(id: <span class="type">String</span>)</span></span>: </span><br><span class="line">    Flowable&lt;User&gt; = getUserById(id).distinctUntilChanged()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¦‚æœè§‚å¯Ÿçš„æ˜¯<code>LiveData</code>ï¼Œå¯ä»¥ç”¨<code>MediatorLiveData</code>å¤„ç†åªè®©æœ‰å˜åŒ–çš„æ•°æ®å‘é€äº‹ä»¶ã€‚</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="type">&lt;T&gt;</span> LiveData<span class="type">&lt;T&gt;</span>.<span class="title">getDistinct</span><span class="params">()</span></span>: LiveData&lt;T&gt; &#123;</span><br><span class="line">    <span class="keyword">val</span> distinctLiveData = MediatorLiveData&lt;T&gt;()</span><br><span class="line">    distinctLiveData.addSource(<span class="keyword">this</span>, <span class="keyword">object</span> : Observer&lt;T&gt; &#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">var</span> initialized = <span class="literal">false</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">var</span> lastObj: T? = <span class="literal">null</span></span><br><span class="line">        <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onChanged</span><span class="params">(obj: <span class="type">T</span>?)</span></span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (!initialized) &#123;</span><br><span class="line">                initialized = <span class="literal">true</span></span><br><span class="line">                lastObj = obj</span><br><span class="line">                distinctLiveData.postValue(lastObj)</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> ((obj == <span class="literal">null</span> &amp;&amp; lastObj != <span class="literal">null</span>) </span><br><span class="line">                       || obj != lastObj) &#123;</span><br><span class="line">                lastObj = obj</span><br><span class="line">                distinctLiveData.postValue(lastObj)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">return</span> distinctLiveData</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åœ¨DAOä¸­ï¼Œè®©çœŸæ­£å…³å¿ƒå˜åŒ–çš„æ–¹æ³•ä½¿ç”¨<code>public</code>ä¿®é¥°ï¼ŒæŸ¥è¯¢æ–¹æ³•ç”¨<code>protected</code>ä¿®é¥°</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Dao</span></span><br><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">UserDao</span> : <span class="type">BaseDao</span>&lt;<span class="type">User</span>&gt;</span>() &#123;</span><br><span class="line">    <span class="meta">@Query(â€œSELECT * FROM Users WHERE userid = :idâ€)</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">abstract</span> <span class="function"><span class="keyword">fun</span> <span class="title">getUserById</span><span class="params">(id: <span class="type">String</span>)</span></span>: LiveData&lt;User&gt;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">getDistinctUserById</span><span class="params">(id: <span class="type">String</span>)</span></span>: LiveData&lt;User&gt; = getUserById(id).getDistinct()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>æ³¨æ„ï¼š</strong> å¦‚æœä½ è¿”å›åˆ—è¡¨ç”¨äºå±•ç¤ºï¼Œè€ƒè™‘ä½¿ç”¨<code>Paging</code>åº“ï¼Œå®ƒèƒ½å¸®ä½ å¤„ç†æ•°æ®çš„å˜åŒ–ã€‚</p>
]]></content>
      <categories>
        <category>è®¡ç®—æœº</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>æ•°æ®åº“</tag>
      </tags>
  </entry>
  <entry>
    <title>Androidåˆ†åŒºå­˜å‚¨</title>
    <url>/android-scoped-storage.html</url>
    <content><![CDATA[<h3 id="ä¸€ã€Whatã€Whyï¼ˆæ˜¯ä»€ä¹ˆã€ä¸ºä»€ä¹ˆï¼‰"><a href="#ä¸€ã€Whatã€Whyï¼ˆæ˜¯ä»€ä¹ˆã€ä¸ºä»€ä¹ˆï¼‰" class="headerlink" title="ä¸€ã€Whatã€Whyï¼ˆæ˜¯ä»€ä¹ˆã€ä¸ºä»€ä¹ˆï¼‰"></a>ä¸€ã€Whatã€Whyï¼ˆæ˜¯ä»€ä¹ˆã€ä¸ºä»€ä¹ˆï¼‰</h3><p>1.1 ä»€ä¹ˆæ˜¯åˆ†åŒºå­˜å‚¨<br>äº†è§£ä¼ ç»Ÿçš„å…±äº«å­˜å‚¨ (Shared Storage):</p>
<ul>
<li>æ¯ä¸ªappæœ‰ç‹¬ç«‹çš„å­˜å‚¨ç©ºé—´Android/data/pkgå…¶ä»–åº”ç”¨ä¸å¯è§ï¼ˆContext.getExternalFileDirï¼‰</li>
<li>è®¿é—®å¤–éƒ¨ç©ºé—´éœ€è¦é¢å¤–æƒé™READ/WRITE_EXTERNAL_STORAGEã€è·å–å­˜å‚¨æƒé™çš„åº”ç”¨å¯ä»¥è®¿é—®æ•´ä¸ªå¤–éƒ¨å­˜å‚¨ç©ºé—´</li>
<li>åº”ç”¨å¸è½½æ—¶ï¼Œä¿å­˜åœ¨å¤–éƒ¨å­˜å‚¨ç©ºé—´æ–‡ä»¶ä¸ä¼šè¢«åˆ é™¤ã€‚</li>
</ul>
<span id="more"></span>

<p>å…±äº«å­˜å‚¨å¸¦æ¥çš„é—®é¢˜</p>
<ul>
<li>æ•°æ®å®‰å…¨</li>
<li>å­˜å‚¨ç©ºé—´æµªè´¹ï¼Œéš¾ä»¥ç®¡ç†</li>
</ul>
<p>åˆ†åŒºå­˜å‚¨è§£å†³æ–¹æ¡ˆ(Scoped Storage):</p>
<ul>
<li>å¿…é¡»é€šè¿‡Media Store APIå’ŒStorage Access FrameWorkè®¿é—®æ–‡ä»¶ç³»ç»Ÿã€‚=&gt;å¯¹ä¼ ç»Ÿå…±äº«å­˜å‚¨ç³»ç»Ÿçš„ä¸€ç§å¼ºåˆ¶çº¦æŸ</li>
<li>æ–‡ä»¶å½’å±ï¼šæ“ä½œè‡ªå·±åˆ›å»ºçš„æ–‡ä»¶æ— éœ€ä»»ä½•æƒé™ï¼ˆè‡ªå·±åˆ›å»ºçš„æ–‡ä»¶ç³»ç»Ÿä¼šè®°å½•æ­¤æ–‡ä»¶çš„å½’å±appï¼Œåº”ç”¨å¸è½½åæ¸…é™¤è¯¥å½’å±å­—æ®µï¼Œé‡è£…åè¯»å–è¯¥æ–‡ä»¶ä»éœ€æƒé™ç”³è¯·ï¼‰ï¼Œéå…±äº«æ–‡ä»¶å­˜å…¥ç§æœ‰ç›®å½•ã€‚=&gt;æ–‡ä»¶å’Œåº”ç”¨æŒ‚é’©ï¼Œä¾¿äºæ“ä½œç³»ç»Ÿè¿›è¡Œç®¡ç†</li>
</ul>
<p>By The Way:<br>åœ¨Android-Q ï¼ˆAPI-29ï¼‰ä¸­é€šè¿‡android:requestLegacyExternalStorage=â€trueâ€å¯ä»¥ç¦ç”¨åˆ†åŒºå­˜å‚¨<br>åœ¨Android-R ï¼ˆAPI-30ï¼‰ä¸­å¿…é¡»ä½¿ç”¨åˆ†åŒºå­˜å‚¨<br>åœ¨Android-Qä¸­å®Œå…¨ç¦ç”¨äº†File APIï¼ŒAndroid-Ré‡æ–°å¯ç”¨</p>
<h3 id="äºŒã€Howï¼ˆåˆ†åŒºå­˜å‚¨å®è·µ-æ•°æ®çš„å¢ã€åˆ ã€æ”¹ã€æŸ¥ï¼‰"><a href="#äºŒã€Howï¼ˆåˆ†åŒºå­˜å‚¨å®è·µ-æ•°æ®çš„å¢ã€åˆ ã€æ”¹ã€æŸ¥ï¼‰" class="headerlink" title="äºŒã€Howï¼ˆåˆ†åŒºå­˜å‚¨å®è·µ-æ•°æ®çš„å¢ã€åˆ ã€æ”¹ã€æŸ¥ï¼‰"></a>äºŒã€Howï¼ˆåˆ†åŒºå­˜å‚¨å®è·µ-æ•°æ®çš„å¢ã€åˆ ã€æ”¹ã€æŸ¥ï¼‰</h3><p>2.1 å¯¹åª’ä½“æ–‡ä»¶çš„å¢åˆ æ”¹æŸ¥ï¼š</p>
<ul>
<li>å¢æŸ¥ï¼šæ–°å¢æ“ä½œæ— éœ€ä»»ä½•æƒé™ã€‚æŸ¥è¯¢å…¶ä»–åº”ç”¨çš„åª’ä½“èµ„æºéœ€è¦READ_EXTERNAL_STORAGEæƒé™ã€‚æŸ¥è¯¢è‡ªå·±åº”ç”¨åˆ›å»ºçš„åª’ä½“èµ„æºæ— éœ€æƒé™ï¼Œå½“åº”ç”¨å¸è½½é‡è£…åï¼Œè‡ªå·±åˆ›å»ºçš„èµ„æºä¹Ÿéœ€è¦ç”³è¯·æƒé™ã€‚</li>
</ul>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">suspend</span> <span class="function"><span class="keyword">fun</span> <span class="title">saveImageToAlbum</span><span class="params">(context: <span class="type">Context</span>, imageFile: <span class="type">File</span>, imageName: <span class="type">String</span>)</span></span>: <span class="built_in">Boolean</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> withContext(Dispatchers.IO) &#123;</span><br><span class="line">        <span class="keyword">val</span> contentValues = ContentValues().apply &#123;</span><br><span class="line">            put(MediaStore.Images.Media.DISPLAY_NAME, imageName)</span><br><span class="line">            put(MediaStore.Images.Media.DESCRIPTION, <span class="string">&quot;å›¾ç‰‡æè¿°&quot;</span>)</span><br><span class="line">            put(MediaStore.Images.Media.MIME_TYPE, <span class="string">&quot;image/jpg&quot;</span>)</span><br><span class="line">            <span class="comment">// æ–‡ä»¶å¾…å¤„ç†çŠ¶æ€ï¼Œæœ¬åº”ç”¨ç‹¬å ï¼Œå…¶ä»–åº”ç”¨æš‚æ—¶æ— æ³•è®¿é—®</span></span><br><span class="line">            <span class="keyword">if</span> (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.Q) &#123;</span><br><span class="line">                put(MediaStore.Images.Media.IS_PENDING, <span class="number">1</span>)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// æ’å…¥æ•°æ®åº“ï¼Œè·å¾—uri</span></span><br><span class="line">        <span class="keyword">val</span> uri = context.contentResolver</span><br><span class="line">            .insert(MediaStore.Images.Media.EXTERNAL_CONTENT_URI, contentValues)</span><br><span class="line">            ?: <span class="keyword">return</span><span class="symbol">@withContext</span> <span class="literal">false</span></span><br><span class="line">        <span class="comment">// æ ¹æ®uriæ‰“å¼€è¾“å‡ºæµï¼Œå†™å…¥imageFileæ–‡ä»¶</span></span><br><span class="line">        context.contentResolver.openOutputStream(uri)?.use &#123; it.write(imageFile.readBytes()) &#125;</span><br><span class="line">        <span class="comment">// åˆ‡æ¢æ–‡ä»¶å¾…å¤„ç†çŠ¶æ€</span></span><br><span class="line">        <span class="keyword">if</span> (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.Q) &#123;</span><br><span class="line">            contentValues.clear()</span><br><span class="line">            contentValues.put(MediaStore.Images.Media.IS_PENDING, <span class="number">0</span>)</span><br><span class="line">            context.contentResolver.update(uri, contentValues, <span class="literal">null</span>, <span class="literal">null</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span><span class="symbol">@withContext</span> <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<ul>
<li>åˆ æ”¹ï¼šåˆ æ”¹è‡ªå·±åˆ›å»ºçš„åª’ä½“èµ„æºæ— éœ€æƒé™ã€‚åˆ æ”¹å…¶ä»–åº”ç”¨åˆ›å»ºçš„èµ„æºéœ€è¦æ•è·RecoverableSecurityExceptionå¼‚å¸¸åï¼Œå‘ç”¨æˆ·ç”³è¯·åˆ é™¤æƒé™ã€‚</li>
</ul>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">suspend</span> <span class="function"><span class="keyword">fun</span> <span class="title">performDeleteImage</span><span class="params">(image: <span class="type">MediaStoreModel</span>)</span></span> &#123;</span><br><span class="line">    withContext(Dispatchers.IO) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            getApplication&lt;Application&gt;().contentResolver.delete(</span><br><span class="line">                image.contentUri,</span><br><span class="line">                <span class="string">&quot;<span class="subst">$&#123;MediaStore.Images.Media._ID&#125;</span> = ?&quot;</span>,</span><br><span class="line">                arrayOf(image.id.toString())</span><br><span class="line">            )</span><br><span class="line">        &#125; <span class="keyword">catch</span> (securityException: SecurityException) &#123;</span><br><span class="line">            <span class="keyword">if</span> (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.Q) &#123;</span><br><span class="line">               <span class="keyword">val</span> recoverableSecurityException = securityException <span class="keyword">as</span>? RecoverableSecurityException</span><br><span class="line">                        ?: <span class="keyword">throw</span> securityException</span><br><span class="line">               startIntentSenderForResult(</span><br><span class="line">                   recoverableSecurityException.userAction.actionIntent.intentSender,</span><br><span class="line">                   DELETE_PERMISSION_REQUEST,</span><br><span class="line">                   <span class="literal">null</span>,</span><br><span class="line">                   <span class="number">0</span>,</span><br><span class="line">                   <span class="number">0</span>,</span><br><span class="line">                   <span class="number">0</span>,</span><br><span class="line">                   <span class="literal">null</span>)</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">throw</span> securityException</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>2.2 å¯¹æ–‡æ¡£çš„å¢åˆ æ”¹æŸ¥ï¼š<br>å¯¹å¤–éƒ¨æ–‡æ¡£çš„è¯»å†™æ“ä½œéœ€è¦ä½¿ç”¨Storage Access FrameWorkï¼Œé€šè¿‡å„ç§Intentäº¤ç”±ç³»ç»Ÿå¤„ç†ã€‚æ›´å¤šå®ä¾‹è§<a href="https://ppting.me/2020/04/19/2020_04_19_about_Storage_Access_Framework/">å‚è€ƒèµ„æ–™2</a></p>
<p>SAFå­˜å‚¨çš„é™åˆ¶ï¼š</p>
<ul>
<li>Intent.ACTION_OPEN_DOCUMENT_TREEè®¿é—®é™åˆ¶<ul>
<li>å†…éƒ¨å­˜å‚¨æ ¹ç›®å½•</li>
<li>Downloadç›®å½•</li>
<li>Android/data/  å’Œ  Android/obb/</li>
</ul>
</li>
</ul>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="comment">//åˆ›å»ºæ–‡æ¡£-è¿”å›Uriå†è¿›è¡Œå†™å…¥</span></span><br><span class="line"><span class="keyword">val</span> intent = Intent(Intent.ACTION_CREATE_DOCUMENT).apply &#123;</span><br><span class="line">    addCategory(Intent.CATEGORY_OPENABLE)</span><br><span class="line">    type = <span class="string">&quot;text/plain&quot;</span></span><br><span class="line">    putExtra(Intent.EXTRA_TITLE, <span class="string">&quot;test.txt&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//è¯»å–&amp;åˆ æ”¹</span></span><br><span class="line"><span class="keyword">val</span> intent = Intent(Intent.ACTION_OPEN_DOCUMENT).apply &#123;</span><br><span class="line">    addCategory(Intent.CATEGORY_OPENABLE)</span><br><span class="line">    type = <span class="string">&quot;*/*&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//ç›®å½•æ“ä½œ</span></span><br><span class="line"><span class="keyword">val</span> intent = Intent(Intent.ACTION_OPEN_DOCUMENT_TREE).apply &#123;</span><br><span class="line">    flags = Intent.FLAG_GRANT_WRITE_URI_PERMISSION</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>2.3 æ‰¹é‡æ“ä½œ<br>é€šè¿‡MediaStoreé™æ€æ–¹æ³•åˆ›å»ºä¿®æ”¹è¯·æ±‚ï¼Œå¾æ±‚ç”¨æˆ·åŒæ„åè¿›è¡Œæ“ä½œã€‚Android-Råæ–°å¢çš„APIï¼Œæ—§ç‰ˆéœ€èµ°å›contentResolver.delete()æ“ä½œ</p>
<table>
<thead>
<tr>
<th>æ“ä½œ</th>
<th>è§£é‡Š</th>
</tr>
</thead>
<tbody><tr>
<td>createWriteRequest</td>
<td>å‘ç”¨æˆ·è¯·æ±‚åª’ä½“æ–‡ä»¶ç»„å†™å…¥æƒé™</td>
</tr>
<tr>
<td>createFavoriteRequest</td>
<td>ç”¨æˆ·å°†è®¾å¤‡ä¸ŠæŒ‡å®šçš„åª’ä½“æ–‡ä»¶æ ‡è®°ä¸ºâ€œæ”¶è—â€çš„è¯·æ±‚</td>
</tr>
<tr>
<td>createTrashRequest</td>
<td>ç”¨æˆ·å°†æŒ‡å®šçš„åª’ä½“æ–‡ä»¶æ”¾å…¥è®¾å¤‡åƒåœ¾ç®±çš„è¯·æ±‚ã€‚åƒåœ¾ç®±ä¸­çš„å†…å®¹ä¼šåœ¨ç³»ç»Ÿå®šä¹‰çš„æ—¶é—´æ®µåè¢«æ°¸ä¹…åˆ é™¤ã€‚</td>
</tr>
<tr>
<td>createDeleteRequest</td>
<td>ç”¨æˆ·ç«‹å³æ°¸ä¹…åˆ é™¤æŒ‡å®šçš„åª’ä½“æ–‡ä»¶</td>
</tr>
</tbody></table>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">val</span> uriList = [] <span class="comment">//A collection of content URIs to modify. </span></span><br><span class="line"><span class="keyword">val</span> pendingIntent = MediaStore.createWriteRequest(contentResolver,urisToModify)</span><br><span class="line"></span><br><span class="line"><span class="comment">// Launch a system prompt requesting user permission for the operation.</span></span><br><span class="line">startIntentSenderForResult(editPendingIntent.intentSender,</span><br><span class="line">                           EDIT_REQUEST_CODE, </span><br><span class="line">                           <span class="literal">null</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h3 id="ä¸‰ã€ç›´æ¥æ–‡ä»¶è¯»å†™"><a href="#ä¸‰ã€ç›´æ¥æ–‡ä»¶è¯»å†™" class="headerlink" title="ä¸‰ã€ç›´æ¥æ–‡ä»¶è¯»å†™"></a>ä¸‰ã€ç›´æ¥æ–‡ä»¶è¯»å†™</h3><p>Android-11é‡æ–°æ”¯æŒFileå¯¹è±¡è®¿é—®æ–‡ä»¶çš„ç›´æ¥è·¯å¾„ã€‚<br>1ã€é’ˆå¯¹åª’ä½“æ–‡ä»¶<br>    - å½’å±äºä½ åº”ç”¨çš„æ–‡ä»¶ å’Œ ä½ çš„ç§æœ‰ç›®å½• çš„æ–‡ä»¶ å¯ä»¥ç›´æ¥ä½¿ç”¨File APIè®¿é—®<br>    - å¦‚æœç›´æ¥ç”¨File APIè®¿é—®æ²¡æœ‰æƒé™çš„æ–‡ä»¶ï¼ŒæŠ›å‡º FileNotFoundException<br>2ã€Media Store DATA å±æ€§<br>DATAå±æ€§å­˜å‚¨äº†åª’ä½“æ–‡ä»¶çš„ç»å¯¹è·¯å¾„ï¼Œåœ¨Android-10çš„æ—¶å€™åºŸå¼ƒäº†è¯¥å±æ€§ã€‚ç”±äºAndroid-11åˆæ”¯æŒFileå¯¹è±¡ï¼Œæ‰€ä»¥DATAå±æ€§ä¹Ÿå¯ä»¥è¯»å–ç›´æ¥è·¯å¾„ï¼Œä½†ä¸ä¸€å®šæœ‰å€¼ã€‚ä½†æ˜¯æ–°å¢å’Œæ›´æ–°æ“ä½œä¸è¦å†ä½¿ç”¨DATAäº†ï¼Œè¯·ä½¿ç”¨DISPLAY_NAME å’Œ RELATIVE_PATH ã€‚</p>
<h3 id="å››ã€å¦å¤–ä¸€æ‰‡çª—"><a href="#å››ã€å¦å¤–ä¸€æ‰‡çª—" class="headerlink" title="å››ã€å¦å¤–ä¸€æ‰‡çª—"></a>å››ã€å¦å¤–ä¸€æ‰‡çª—</h3><p>å¯¹äºä¸€äº›ç‰¹æ®Šçš„Appï¼Œä¾‹å¦‚æ–‡ä»¶ç®¡ç†å™¨ï¼Œå¤‡ä»½ç­‰ã€‚å¯ä»¥ç”³è¯·æ‰€æœ‰æ–‡ä»¶è®¿é—®æƒé™<br>1.å£°æ˜ MANAGE_EXTERNAL_STORAGE æƒé™<br>2.ä½¿ç”¨ ACTION_MANAGE_ALL_FILES_ACCESS_PERMISSION  å°†ç”¨æˆ·å¼•å¯¼è‡³ä¸€ä¸ªç³»ç»Ÿè®¾ç½®é¡µé¢è¿›è¡Œæˆæƒ</p>
<p>æˆæƒèŒƒå›´</p>
<ul>
<li>è¯»å†™å…±äº«å­˜å‚¨åŒºçš„æ‰€æœ‰æ–‡ä»¶<ul>
<li>Media content ï¼ˆMediaStoreï¼‰</li>
<li>Documents and other files ï¼ˆSAFï¼‰</li>
<li>Datasets ï¼ˆBlobStoreManagerï¼‰</li>
</ul>
</li>
<li>MediaStore.Filesæ•°æ®åº“è¡¨</li>
<li>USB å’Œ SDå¡ æ ¹ç›®å½•</li>
<li>é™¤ /Android/data/ å’Œ /sdcard/Android ä¹‹å¤–çš„å…¶ä»–ç§æœ‰ç›®å½•</li>
</ul>
<h3 id="äº”ã€åº”ç”¨æˆªå›¾"><a href="#äº”ã€åº”ç”¨æˆªå›¾" class="headerlink" title="äº”ã€åº”ç”¨æˆªå›¾"></a>äº”ã€åº”ç”¨æˆªå›¾</h3><table>
    <tr>
        <td><img src="../images/scoped_storage.png" width="200"/></td>
        <td><img src="../images/scoped_storage_2.png" width="200"/></td>
    </tr>
</table>]]></content>
      <categories>
        <category>è®¡ç®—æœº</category>
      </categories>
      <tags>
        <tag>Android</tag>
      </tags>
  </entry>
  <entry>
    <title>Android-11é€‚é…</title>
    <url>/android-target-30.html</url>
    <content><![CDATA[<h4 id="ä¸€ã€å˜æ›´æ¦‚è§ˆ"><a href="#ä¸€ã€å˜æ›´æ¦‚è§ˆ" class="headerlink" title="ä¸€ã€å˜æ›´æ¦‚è§ˆ"></a>ä¸€ã€å˜æ›´æ¦‚è§ˆ</h4><h5 id="1ã€éšç§"><a href="#1ã€éšç§" class="headerlink" title="1ã€éšç§"></a>1ã€éšç§</h5><ul>
<li>åˆ†åŒºå­˜å‚¨</li>
<li>è‡ªåŠ¨é‡Šæ”¾æƒé™</li>
<li>åå°å®šä½</li>
<li>åŒ…å¯è§æ€§</li>
</ul>
<h5 id="2ã€å®‰å…¨"><a href="#2ã€å®‰å…¨" class="headerlink" title="2ã€å®‰å…¨"></a>2ã€å®‰å…¨</h5><ul>
<li><a href="https://source.android.com/devices/tech/debug/tagged-pointers">å †æŒ‡é’ˆæ·»åŠ æ ‡è®°</a></li>
<li>Toast<ul>
<li>ğŸš«ç¦æ­¢åå°å¼¹å‡ºå«è‡ªå®šä¹‰Viewçš„Toast</li>
<li>Toastæ”¯æŒæ˜¾ç¤º/éšè—å›è°ƒ</li>
<li>éƒ¨åˆ†Viewç›¸å…³APIè°ƒæ•´</li>
</ul>
</li>
</ul>
<h5 id="3ã€è¿æ¥"><a href="#3ã€è¿æ¥" class="headerlink" title="3ã€è¿æ¥"></a>3ã€è¿æ¥</h5><ul>
<li>é™åˆ¶å¯¹APNæ•°æ®åº“ï¼ˆAccess Point Namesï¼‰çš„è¯»å†™</li>
</ul>
<h5 id="4ã€Accessibility"><a href="#4ã€Accessibility" class="headerlink" title="4ã€Accessibility"></a>4ã€Accessibility</h5><ul>
<li>æ–‡æœ¬è½¬è¯­éŸ³ï¼ˆTTSï¼‰å’Œè¯­éŸ³è¯†åˆ« éœ€è¦å£°æ˜<queries></li>
<li>åœ¨res/rawä¸‹å£°æ˜å¯¹accessibilityçš„ä½¿ç”¨</li>
</ul>
<h5 id="5ã€ç›¸æœº"><a href="#5ã€ç›¸æœº" class="headerlink" title="5ã€ç›¸æœº"></a>5ã€ç›¸æœº</h5><ul>
<li>ä»¥ä¸‹Actioné»˜è®¤åªèƒ½è°ƒèµ·ç³»ç»Ÿç›¸æœºï¼Œé™¤éæŒ‡å®šåŒ…å<ul>
<li>android.media.action.VIDEO_CAPTURE</li>
<li>android.media.action.IMAGE_CAPTURE</li>
<li>android.media.action.IMAGE_CAPTURE_SECURE</li>
</ul>
</li>
</ul>
<h5 id="6ã€åº”ç”¨æ‰“åŒ…å’Œå®‰è£…"><a href="#6ã€åº”ç”¨æ‰“åŒ…å’Œå®‰è£…" class="headerlink" title="6ã€åº”ç”¨æ‰“åŒ…å’Œå®‰è£…"></a>6ã€åº”ç”¨æ‰“åŒ…å’Œå®‰è£…</h5><ul>
<li>ğŸš«ç¦æ­¢å‹ç¼©resources.arsc</li>
<li>å¿…é¡»ä½¿ç”¨V2åŠä»¥ä¸Šç‰ˆæœ¬è¿›è¡Œapkç­¾å<h5 id="7ã€Firebase"><a href="#7ã€Firebase" class="headerlink" title="7ã€Firebase"></a>7ã€Firebase</h5></li>
<li>target-30çš„apkåœ¨6.0åŠä»¥ä¸Šè®¾å¤‡ï¼Œä¸èƒ½ä½¿ç”¨Firebase JobDispatcher å’Œ GCMNetworkManager</li>
</ul>
<h5 id="8ã€allowBackupå±æ€§è°ƒæ•´"><a href="#8ã€allowBackupå±æ€§è°ƒæ•´" class="headerlink" title="8ã€allowBackupå±æ€§è°ƒæ•´"></a>8ã€allowBackupå±æ€§è°ƒæ•´</h5><h5 id="9ã€ä¿®æ”¹SPçš„OnSharedPreferenceChangeListenerå›è°ƒ"><a href="#9ã€ä¿®æ”¹SPçš„OnSharedPreferenceChangeListenerå›è°ƒ" class="headerlink" title="9ã€ä¿®æ”¹SPçš„OnSharedPreferenceChangeListenerå›è°ƒ"></a>9ã€ä¿®æ”¹SPçš„OnSharedPreferenceChangeListenerå›è°ƒ</h5><h5 id="10ã€éSDKæ¥å£è°ƒç”¨é»‘åå•"><a href="#10ã€éSDKæ¥å£è°ƒç”¨é»‘åå•" class="headerlink" title="10ã€éSDKæ¥å£è°ƒç”¨é»‘åå•"></a>10ã€éSDKæ¥å£è°ƒç”¨é»‘åå•</h5><h4 id="äºŒã€å˜æ›´è¯¦æƒ…"><a href="#äºŒã€å˜æ›´è¯¦æƒ…" class="headerlink" title="äºŒã€å˜æ›´è¯¦æƒ…"></a>äºŒã€å˜æ›´è¯¦æƒ…</h4><h5 id="1ã€åˆ†åŒºå­˜å‚¨"><a href="#1ã€åˆ†åŒºå­˜å‚¨" class="headerlink" title="1ã€åˆ†åŒºå­˜å‚¨"></a>1ã€åˆ†åŒºå­˜å‚¨</h5><ul>
<li><p>é’ˆå¯¹ç‰¹æ®Šç±»å‹åº”ç”¨(æ–‡ä»¶ç®¡ç†å™¨ã€æ–‡ä»¶å¤‡ä»½ã€æ–‡ä»¶åŠ å¯†)<br><br>è¿™ç§ç±»å‹çš„åº”ç”¨éœ€è¦å¤§è§„æ¨¡çš„è¿›è¡Œæ–‡ä»¶æ“ä½œï¼Œè¿ç§»æˆæœ¬è¾ƒé«˜ï¼Œæ¨èä½¿ç”¨æ–°çš„å­˜å‚¨ç®¡ç†æƒé™ MANAGE_EXTERNAL_STORAGE ï¼ˆå‚è€ƒ1:æ­¤æƒé™çš„æˆæƒèŒƒå›´ï¼‰</p>
<ul>
<li>ä¼˜ç‚¹ï¼š<br><br>  1ã€å¼€å¯åç›´æ¥æ‹¥æœ‰æ‰€æœ‰è¯»å†™æƒé™ï¼ˆåŒ…æ‹¬æ‹”æ’çš„SDå¡ï¼ŒUSBç­‰ï¼‰<br><br>  2ã€æ¸…ç¼“å­˜ä¸ä¼šä¸¢å¤±æˆæƒ<br><br>  3ã€å¤„ç†æˆæœ¬è¾ƒä½ï¼Œåªéœ€å…¼å®¹æ—§çš„åŠ¨æ€æƒé™ç”³è¯·éƒ¨åˆ†çš„é€»è¾‘ã€‚<br></li>
<li>ç¼ºç‚¹ï¼š<br><br>  1ã€éœ€è¦è·³è½¬è®¾ç½®é¡µé¢å¼€å¯æƒé™ï¼Œæœ‰æŸäº§å“æ•°æ®ï¼ˆè½®è¯¢æƒé™ï¼Œå¼ºåˆ¶æ‹‰å›ï¼‰<br><br>  2ã€éœ€è¦æäº¤GPç”³è¯·è¡¨å•ï¼Œå®¡æ ¸é€šè¿‡æ‰èƒ½ä¸Šæ¶<br></li>
<li>å®è·µï¼š<br><br>  1ã€åˆ¤æ–­æƒé™ Environment.isExternalStorageManager() <br><br>  2ã€è·³è½¬è®¾ç½®é¡µé¢å¼•å¯¼ç”¨æˆ·å¼€å¯æƒé™çš„æ–¹å¼ï¼šæ³¨æ„ä¸‹é¢ä¸¤ä¸ª<strong>Action</strong>çš„åŒºåˆ«<br><pre><code>  Settings.ACTION_MANAGE_APP_ALL_FILES_ACCESS_PERMISSION&lt;br&gt;
  Settings.ACTION_MANAGE_ALL_FILES_ACCESS_PERMISSION
</code></pre>
</li>
</ul>
</li>
</ul>
<ul>
<li>é’ˆå¯¹æ™®é€šåº”ç”¨<br>æ— æ³•ç”³è¯·æ–°çš„å­˜å‚¨ç®¡ç†æƒé™ MANAGE_EXTERNAL_STORAGE ã€‚åªèƒ½å¯¹æ—§çš„APIè¿›è¡Œæ”¹é€ å…¼å®¹ï¼Œå°†å…¶è¿ç§»åˆ°å­˜å‚¨è®¿é—®æ¡†æ¶SAFï¼ˆStorage Access Frameworkï¼‰åŒ…æ‹¬Document-API æˆ– MediaStore-APIã€‚<ul>
<li>ä¼˜ç‚¹ï¼š <br><br>  1ã€äº¤äº’é€»è¾‘ï¼Œå’Œä»£ç é€»è¾‘ç»“æ„æ¯”è¾ƒç»Ÿä¸€ <br><br>  2ã€æé«˜éšç§ä¸å®‰å…¨æ€§ï¼Œé¿å…æ‚ä¹±æ— ç« çš„æ–‡ä»¶ç³»ç»Ÿ <br></li>
<li>ç¼ºç‚¹ï¼š <br><br>  1ã€è¿ç§»æˆæœ¬è¾ƒé«˜ï¼Œéœ€è¦åšå¤§é‡çš„APIå…¼å®¹ï¼Œå¯èƒ½å½±å“äº§å“é€»è¾‘ <br></li>
<li>å®è·µï¼š <br><br>  1ã€åˆ†åŒºå­˜å‚¨æ–‡æ¡£ <br></li>
<li>æ³¨æ„äº‹é¡¹ï¼š <br><br>  1ã€åšå¥½æ•°æ®è¿ç§»ï¼Œé¿å…å‡çº§åï¼ŒåŸæ¥çš„æ•°æ®åœ¨ä¸å¯è®¿é—®åŒºåŸŸ <br><br>  2ã€ä¿ç•™ [requestLegacyExternalStorage=true] å±æ€§ <br></li>
</ul>
</li>
</ul>
<blockquote>
<p>æˆ‘çš„åº”ç”¨1.0ç‰ˆæœ¬ä¹‹å‰æ•°æ®åº“å­˜å‚¨åœ¨å¤–éƒ¨ï¼Œä¸ºäº†é€‚é…target-30ï¼Œæˆ‘åœ¨1.1ç‰ˆæœ¬ï¼Œå†™äº†æ•°æ®è¿ç§»ä»£ç ã€‚1.2ç‰ˆæœ¬ï¼Œæˆ‘åšäº†target-30å‡çº§ã€‚æŸç”¨æˆ·ç›´æ¥è·³è¿‡1.1ç‰ˆæœ¬å‡çº§åˆ°äº†1.2ç‰ˆæœ¬ã€‚æ— æ³•è¿è¡Œè¿ç§»ä»£ç ã€‚æ€ä¹ˆåŠï¼</p>
</blockquote>
<p>preserveLegacyExternalStorage å±æ€§ï¼šé’ˆå¯¹å‡çº§ç”¨æˆ·ï¼Œæš‚æ—¶ç»´æŒå…¼å®¹å±æ€§ï¼Œå¸è½½åå¤±æ•ˆã€‚</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">application</span></span></span><br><span class="line"><span class="tag">  	<span class="attr">android:preserveLegacyExternalStorage</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>


<h5 id="2ã€ç”µè¯å·ç "><a href="#2ã€ç”µè¯å·ç " class="headerlink" title="2ã€ç”µè¯å·ç  "></a>2ã€ç”µè¯å·ç  <br></h5><p>ä»¥ä¸‹ä¸¤ä¸ªæ–¹æ³•çš„è°ƒç”¨éœ€è¦ç”³è¯·æ–°çš„æƒé™ï¼š READ_PHONE_NUMBERS <br><br>getLine1Number()<br>getMsisdn()</p>
<h5 id="3ã€å®šä½"><a href="#3ã€å®šä½" class="headerlink" title="3ã€å®šä½ "></a>3ã€å®šä½ <br></h5><ul>
<li>å¢åŠ Only this time é€‰é¡¹</li>
<li>ä¸èƒ½ä¸€æ¬¡æ€§ç”³è¯·å‰åå°å®šä½æƒé™ï¼Œè¦åˆ†ä¸¤æ¬¡å•ç‹¬ç”³è¯·</li>
<li>åå°ä½ç½®è®¿é—®éœ€è¦è·³è½¬è®¾ç½®é¡µé¢</li>
</ul>
<h5 id="4ã€åŒ…å¯è§æ€§"><a href="#4ã€åŒ…å¯è§æ€§" class="headerlink" title="4ã€åŒ…å¯è§æ€§ "></a>4ã€åŒ…å¯è§æ€§ <br></h5><p>æ¦‚å¿µï¼š <br><br>åœ¨Android-10åŠä»¥å‰çš„ç‰ˆæœ¬é€šè¿‡ queryIntentActivitiesã€getPackageInfoã€getInstalledApplicationså¯ä»¥è·å–æ‰€æœ‰å®‰è£…çš„Appã€‚ä½†æ˜¯åœ¨Android-11ä¹‹ååªèƒ½è·å–åˆ°ä¸€éƒ¨åˆ†å·²å®‰è£…åº”ç”¨åˆ—è¡¨ã€‚<br>è§£å†³æ–¹æ¡ˆï¼š <br></p>
<ul>
<li>é€šè¿‡ <queries> æ ‡ç­¾æŒ‡å®šéœ€è¦äº¤äº’çš„åº”ç”¨</li>
<li>ç”³è¯·æŸ¥çœ‹æ‰€æœ‰å®‰è£…åˆ—è¡¨<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">manifest</span> <span class="attr">package</span>=<span class="string">&quot;com.example.game&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">queries</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- éœ€è¦å’Œä½ åšäº¤äº’çš„app --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">package</span> <span class="attr">android:name</span>=<span class="string">&quot;com.example.store&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">package</span> <span class="attr">android:name</span>=<span class="string">&quot;com.example.service&quot;</span> /&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- ä½ éœ€è¦æŸ¥è¯¢çš„Intent --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">intent</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">action</span> <span class="attr">android:name</span>=<span class="string">&quot;android.intent.action.SEND&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">data</span> <span class="attr">android:mimeType</span>=<span class="string">&quot;image/jpeg&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">intent</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">queries</span>&gt;</span></span><br><span class="line">  ...</span><br><span class="line"><span class="tag">&lt;/<span class="name">manifest</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">&quot;android.permission.QUERY_ALL_PACKAGES&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="ä¸‰ã€å‚è€ƒæ–‡çŒ®"><a href="#ä¸‰ã€å‚è€ƒæ–‡çŒ®" class="headerlink" title="ä¸‰ã€å‚è€ƒæ–‡çŒ®"></a>ä¸‰ã€å‚è€ƒæ–‡çŒ®</h4><p>1ã€<a href="https://developer.android.com/about/versions/11/behavior-changes-11#change-details">å®˜æ–¹æ–‡æ¡£-behavior-changes-11</a> <br><br>2ã€<a href="https://support.google.com/googleplay/android-developer/answer/10467955">GPæ”¿ç­–-MANAGE_EXTERNAL_STORAGE</a> <br><br>3ã€<a href="https://developer.android.com/training/data-storage/manage-all-files">å­˜å‚¨æƒé™-ç®¡ç†æ‰€æœ‰æ–‡ä»¶</a> <br><br>4ã€<a href="https://support.google.com/googleplay/android-developer/answer/10158779?hl=en#zippy=%2Cpermitted-uses-of-the-query-all-packages-permission">GPæ”¿ç­–-all-packages-permission</a> <br> </p>
]]></content>
      <categories>
        <category>è®¡ç®—æœº</category>
      </categories>
      <tags>
        <tag>Android</tag>
      </tags>
  </entry>
  <entry>
    <title>ä¼°å€¼æŒ‡æ ‡</title>
    <url>/base-economic-concept.html</url>
    <content><![CDATA[<table>
<thead>
<tr>
<th>è‹±æ–‡åç§°</th>
<th>ä¸­æ–‡åç§°</th>
<th>è®¡ç®—æ–¹å¼</th>
<th>ç†è§£</th>
</tr>
</thead>
<tbody><tr>
<td>PE = Price-to-Earning Ratio</td>
<td>å¸‚ç›ˆç‡</td>
<td>æ¯è‚¡è‚¡ä»·/æ¯è‚¡ç›ˆä½™ = å¸‚å€¼/å‡€åˆ©æ¶¦</td>
<td>åˆ›é€ è´¢å¯Œçš„èƒ½åŠ›ã€å›æ”¶æˆæœ¬çš„æ—¶é—´</td>
</tr>
<tr>
<td>PS = Price-to-Sales Ratio</td>
<td>å¸‚é”€ç‡</td>
<td>æ¯è‚¡è‚¡ä»·/æ¯è‚¡è¥æ”¶ = å¸‚å€¼/è¥æ”¶</td>
<td>è·å¾—å…¬å¸1å…ƒçš„é”€å”®æ”¶å…¥éœ€è¦æŠ•å…¥å¤šå°‘é’±</td>
</tr>
<tr>
<td>PCF =Price-to-Cash-Flow Ratio</td>
<td>å¸‚ç°ç‡</td>
<td>æ¯è‚¡è‚¡ä»·/æ¯è‚¡ç°é‡‘æµ = å¸‚å€¼/12æœˆç°é‡‘æµ</td>
<td></td>
</tr>
<tr>
<td>PB = Price-to-Book Ratio</td>
<td>å¸‚å‡€ç‡</td>
<td>æ¯è‚¡è‚¡ä»·/æ¯è‚¡å‡€èµ„äº§ = å¸‚å€¼/å‡€èµ„äº§</td>
<td>å‡€èµ„äº§çš„æº¢ä»·ç¨‹åº¦</td>
</tr>
</tbody></table>
<h4 id="ä¸€ã€å¸‚ç›ˆç‡"><a href="#ä¸€ã€å¸‚ç›ˆç‡" class="headerlink" title="ä¸€ã€å¸‚ç›ˆç‡"></a>ä¸€ã€å¸‚ç›ˆç‡</h4><p>1.1 PE - é™æ€å¸‚ç›ˆç‡</p>
<blockquote>
<p>â‘  å¸‚ç›ˆç‡ = å½“æ—¥æ”¶ç›˜ä»· / ä¸Šä¸€å¹´åº¦æ¯è‚¡ç¨ååˆ©æ¶¦  </p>
</blockquote>
<blockquote>
<p>â‘¡ å¸‚ç›ˆç‡ = å½“å‰æ€»å¸‚å€¼ / ä¸Šå¹´åº¦å‡€åˆ©æ¶¦</p>
</blockquote>
<p>ç†è§£ï¼š</p>
<ul>
<li>å…¬å¸éœ€è¦ç´¯è®¡å¤šå°‘å¹´çš„ç›ˆåˆ©æ‰èƒ½è¾¾åˆ°ç›®å‰çš„å¸‚ä»·æ°´å¹³ã€‚</li>
<li>å€¼è¶Šä½è¯´æ˜æŠ•èµ„å›æ”¶æœŸçŸ­ï¼Œé£é™©è¶Šå°ï¼ŒæŠ•èµ„ä»·å€¼è¶Šé«˜ã€‚</li>
<li>å€¼è¶Šå¤§è¯´æ˜ç¿»æœ¬æœŸé•¿ï¼Œé£é™©å¤§ã€‚</li>
</ul>
<p>ç¼ºç‚¹ï¼š</p>
<ul>
<li>å–çš„æ˜¯ä¸Šä¸€å¹´åº¦çš„å‡€åˆ©æ¶¦ï¼Œæ˜¯ä¸€ä¸ªè¿‡å»çš„å€¼ï¼Œæœ‰ç‚¹æ»åã€‚</li>
</ul>
<p>ä¾‹å­ï¼š<br>ä½ èŠ±äº†240wä¹°äº†ä¸€å¥—äºŒæ‰‹æˆ¿ï¼Œæ‰“ç®—è¿›è¡Œå‡ºç§Ÿèµšç‚¹å¤–å¿«ï¼Œå·²çŸ¥å»å¹´å¹³å‡æœˆç§Ÿ2wï¼Œä¸€å¹´æ”¶ç›Šå¤§æ¦‚24wã€‚ä»¥å»å¹´è¿™äº›æ•°æ®ä¸ºå‚è€ƒï¼Œä½ é¢„è®¡<strong>åå¹´å</strong>æ‰èƒ½èµšå›æˆæœ¬240wï¼Œæ‰€ä»¥å¸‚ç›ˆç‡ = 10ã€‚</p>
<p>1.2 åŠ¨æ€å¸‚ç›ˆç‡<br>ä¸ºäº†å¼¥è¡¥é™æ€å¸‚ç›ˆç‡çš„æ»åæ€§ï¼Œå¢åŠ åŠ¨æ€å¸‚ç›ˆç‡ä½œä¸ºå‚è€ƒæŒ‡æ ‡ã€‚</p>
<blockquote>
<p>å¸‚ç›ˆç‡ = å½“å‰æ€»å¸‚å€¼ / X</p>
</blockquote>
<p>æ ¹æ®å½“å‰çš„æ—¶é—´èŠ‚ç‚¹ä¸åŒè®¡ç®—Xçš„å€¼ï¼š<br>X = å½“å¹´æœ€è¿‘ä¸€ä¸ªå­£åº¦çš„å‡€åˆ©æ¶¦ * 4<br>X = æœ€è¿‘åŠå¹´å‡€åˆ©æ¶¦ * 2<br>X = æœ€è¿‘ä¸‰å­£åº¦å‡€åˆ©æ¶¦ * 1.5 </p>
<p>1.3 é™æ€å¸‚ç›ˆç‡ vs åŠ¨æ€å¸‚ç›ˆç‡</p>
<ul>
<li>é™æ€å¸‚ç›ˆç‡åæ˜ çš„æ˜¯è¿‡å»çš„æ•°æ®ï¼ŒåŠ¨æ€å¸‚ç›ˆç‡åæ˜ çš„æ˜¯æœªæ¥çš„é¢„ä¼°</li>
<li>åŠ¨æ€å¸‚ç›ˆç‡ &gt; é™æ€å¸‚ç›ˆç‡ï¼Œè¯´æ˜æœ€è¿‘ï¼ˆä¸€ä¸ªå­£åº¦ã€åŠå¹´ã€ä¸‰ä¸ªå­£åº¦ï¼‰å…¬å¸çš„åˆ©æ¶¦ä¸‹é™äº†ã€‚</li>
</ul>
<p>1.4 TTM-Trailing Twelve Months</p>
<ul>
<li>æœ€è¿‘åäºŒä¸ªæœˆå¸‚ç›ˆç‡ï¼Œä¹Ÿå«æ»šåŠ¨å¸‚ç›ˆç‡ã€‚</li>
<li>å®ƒä¹Ÿæ˜¯ä¸€ä¸ªå¯¹è¿‡å»æƒ…å†µçš„åˆ†æè¯´æ˜ã€‚</li>
</ul>
<h4 id="äºŒã€æ¯è‚¡å‡€å€¼äº§"><a href="#äºŒã€æ¯è‚¡å‡€å€¼äº§" class="headerlink" title="äºŒã€æ¯è‚¡å‡€å€¼äº§"></a>äºŒã€æ¯è‚¡å‡€å€¼äº§</h4><blockquote>
<p>æ¯è‚¡å‡€å€¼äº§ = ï¼ˆæ€»èµ„äº§ - æ€»è´Ÿå€ºï¼‰ / æ€»è‚¡æ•°</p>
</blockquote>
<center>
    <img src="../images/a_b_c.jpeg" width="300"/>
</center>


<h4 id="ä¸‰ã€å¸‚å‡€ç‡"><a href="#ä¸‰ã€å¸‚å‡€ç‡" class="headerlink" title="ä¸‰ã€å¸‚å‡€ç‡"></a>ä¸‰ã€å¸‚å‡€ç‡</h4><p>3.1 PB-å¸‚å‡€ç‡</p>
<blockquote>
<p>å¸‚å‡€ç‡ = æ¯è‚¡å¸‚ä»· / æ¯è‚¡å‡€å€¼äº§<br>æ¯è‚¡å‡€èµ„äº§ = è‚¡ä¸œæƒç›Š / æ€»è‚¡æœ¬</p>
</blockquote>
<p>å¸‚å‡€ç‡è¶Šä½é‚£ä¹ˆå®ƒçš„æŠ•èµ„ä»·å€¼å°±è¶Šé«˜ï¼Œè¿™ä¹Ÿå°±æ„å‘³ç€å®ƒçš„é£é™©è¶Šä½ã€‚</p>
]]></content>
      <categories>
        <category>ç»æµå­¦</category>
      </categories>
      <tags>
        <tag>Economics</tag>
      </tags>
  </entry>
  <entry>
    <title>å¯¹ç§°/éå¯¹ç§°åŠ å¯†å’Œæ•°å­—ç­¾å</title>
    <url>/basic-encryption-algorithm.html</url>
    <content><![CDATA[<h4 id="1-å¯¹ç§°åŠ è§£å¯†çš„è¿‡ç¨‹ï¼š"><a href="#1-å¯¹ç§°åŠ è§£å¯†çš„è¿‡ç¨‹ï¼š" class="headerlink" title="1.å¯¹ç§°åŠ è§£å¯†çš„è¿‡ç¨‹ï¼š"></a>1.å¯¹ç§°åŠ è§£å¯†çš„è¿‡ç¨‹ï¼š</h4><p>ï¼ˆå¤§å®¶ç”¨ç›¸åŒçš„é’¥åŒ™æ¥è¿›è¡ŒåŠ è§£å¯†ï¼‰<br><del>å‘é€ç«¯å’Œæ¥æ”¶ç«¯é¦–å…ˆè¦å…±äº«ç›¸åŒçš„å¯†é’¥k(å³é€šä¿¡å‰åŒæ–¹éƒ½éœ€è¦çŸ¥é“å¯¹åº”çš„å¯†é’¥)æ‰èƒ½è¿›è¡Œé€šä¿¡ã€‚å‘é€ç«¯ç”¨å…±äº«å¯†é’¥kå¯¹æ˜æ–‡pè¿›è¡ŒåŠ å¯†ï¼Œå¾—åˆ°å¯†æ–‡cï¼Œå¹¶å°†å¾—åˆ°çš„å¯†æ–‡å‘é€ç»™æ¥æ”¶ç«¯ï¼Œæ¥æ”¶ç«¯æ”¶åˆ°å¯†æ–‡åï¼Œå¹¶ç”¨å…¶ç›¸åŒçš„å…±äº«å¯†é’¥kå¯¹å¯†æ–‡è¿›è¡Œè§£å¯†ï¼Œå¾—å‡ºæ˜æ–‡pã€‚</del></p>
<p>ä¸€èˆ¬åŠ å¯†å’Œè§£å¯†çš„ç®—æ³•æ˜¯å…¬å¼€çš„ï¼Œéœ€è¦ä¿æŒéšç§˜çš„æ˜¯å¯†é’¥k<br>æµè¡Œçš„å¯¹ç§°åŠ å¯†ç®—æ³•æœ‰ï¼šDESï¼ŒTriple-DESï¼ŒRC2å’ŒRC4ï¼ŒAES</p>
<h5 id="ç¼ºç‚¹ï¼š"><a href="#ç¼ºç‚¹ï¼š" class="headerlink" title="ç¼ºç‚¹ï¼š"></a>ç¼ºç‚¹ï¼š</h5><ul>
<li>å‘é€æ–¹å’Œæ¥æ”¶æ–¹é¦–å…ˆéœ€è¦å…±äº«ç›¸åŒçš„å¯†é’¥ï¼Œå³å­˜åœ¨å¯†é’¥kçš„åˆ†å‘é—®é¢˜ï¼Œå¦‚ä½•å®‰å…¨çš„æŠŠå…±äº«å¯†é’¥åœ¨åŒæ–¹è¿›è¡Œåˆ†äº«ï¼Œè¿™æœ¬èº«ä¹Ÿæ˜¯ä¸€ä¸ªå¦‚ä½•å®‰å…¨é€šä¿¡çš„é—®é¢˜ï¼Œä¸€ç§æ–¹æ³•æ˜¯æå‰åŒæ–¹çº¦å®šå¥½ï¼Œä¸é€šè¿‡å…·ä½“çš„é€šä¿¡è¿›è¡Œåå•†ï¼Œé¿å…è¢«ç›‘å¬å’Œæˆªè·ã€‚å¦å¤–ä¸€ç§æ–¹å¼ï¼Œå°†æ˜¯ä¸‹é¢æˆ‘ä»¬ä»‹ç»çš„é€šè¿‡éå¯¹ç§°åŠ å¯†ä¿¡é“è¿›è¡Œå¯¹ç§°å¯†ç çš„åˆ†å‘å’Œå…±äº«ï¼Œå³æ··åˆåŠ å¯†ç³»ç»Ÿã€‚</li>
<li>å¯†é’¥ç®¡ç†çš„å¤æ‚åº¦é—®é¢˜ã€‚ç”±äºå¯¹ç§°åŠ å¯†çš„å¯†é’¥æ˜¯ä¸€å¯¹ä¸€çš„ä½¿ç”¨æ–¹å¼ï¼Œè‹¥ä¸€æ–¹è¦è·Ÿnæ–¹é€šä¿¡ï¼Œåˆ™éœ€è¦ç»´æŠ¤nå¯¹å¯†é’¥ã€‚</li>
</ul>
<h5 id="ä¼˜ç‚¹ï¼š"><a href="#ä¼˜ç‚¹ï¼š" class="headerlink" title="ä¼˜ç‚¹ï¼š"></a>ä¼˜ç‚¹ï¼š</h5><ul>
<li>åŠ å¯†å’Œè§£å¯†çš„é€Ÿåº¦è¦æ¯”éå¯¹ç§°åŠ å¯†å¿«å¾ˆå¤šï¼Œå› æ­¤å¸¸ç”¨éå¯¹ç§°åŠ å¯†å»ºç«‹çš„å®‰å…¨ä¿¡é“è¿›è¡Œå…±äº«å¯†é’¥çš„åˆ†äº«ï¼Œå®Œæˆåï¼Œå…·ä½“çš„åŠ è§£å¯†åˆ™ä½¿ç”¨å¯¹ç§°åŠ å¯†ã€‚å³æ··åˆåŠ å¯†ç³»ç»Ÿã€‚</li>
</ul>
<p>å¦å¤–ä¸€ä¸ªç‚¹éœ€è¦é‡ç‚¹è¯´æ˜çš„æ˜¯ï¼Œå¯†é’¥kçš„é•¿åº¦å¯¹è§£å¯†ç ´è§£çš„éš¾åº¦æœ‰å¾ˆé‡å¤§çš„å½±å“ï¼Œkçš„é•¿åº¦è¶Šé•¿ï¼Œå¯¹åº”çš„å¯†ç ç©ºé—´å°±è¶Šå¤§ï¼Œé­åˆ°æš´åŠ›ç ´è§£æˆ–è€…è¯å…¸ç ´è§£çš„éš¾åº¦å°±æ›´å¤§ï¼Œå°±æ›´åŠ å®‰å…¨ã€‚</p>
<center>
    <img src="../images/dcjm.png" width="400"/>
</center>

<h4 id="2-æ•°å­—ç­¾åçš„è¿‡ç¨‹ï¼š"><a href="#2-æ•°å­—ç­¾åçš„è¿‡ç¨‹ï¼š" class="headerlink" title="2.æ•°å­—ç­¾åçš„è¿‡ç¨‹ï¼š"></a>2.æ•°å­—ç­¾åçš„è¿‡ç¨‹ï¼š</h4><ul>
<li>å‘é€æ–¹Aé¦–å…ˆå¯¹å˜é•¿çš„æŠ¥æ–‡æå–æˆä¸€ä¸ªå®šé•¿çš„æ‘˜è¦ï¼Œä¸€èˆ¬æ˜¯md5ç­‰</li>
<li>Aå¯¹æ‘˜è¦åº”ç”¨äº†ä¸€ä¸ªç­¾åå‡½æ•°ï¼Œå¹¶ä¸”ç”¨Aè‡ªå·±çš„ç§é’¥ä½œä¸ºå‚æ•°ï¼Œå› ä¸ºåªæœ‰Aæ‰çŸ¥é“ç§é’¥ï¼Œæ‰€ä»¥æ­£ç¡®çš„ç­¾åä¼šè¯´æ˜ç­¾åè€…å°±æ˜¯å…¶æ‰€æœ‰è€…ã€‚</li>
<li>ä¸€æ—¦è®¡ç®—å‡ºç­¾åï¼ŒèŠ‚ç‚¹Aå°±å°†å…¶é™„åŠ åˆ°æŠ¥æ–‡çš„æœ«å°¾ï¼Œå¹¶å°†æŠ¥æ–‡å’Œç­¾åä¸€èµ·éƒ½å‘é€ç»™B</li>
<li>åœ¨æ¥æ”¶ç«¯Bï¼Œé¦–å…ˆä¼šæŒ‰ç…§åŒæ ·çš„ç®—æ³•è®¡ç®—å‡ºæŠ¥æ–‡çš„æ‘˜è¦ï¼Œç„¶åå¯¹ç­¾åç”¨Açš„å…¬é’¥è¿›è¡Œè§£ç ï¼Œå¾—å‡ºè§£ç åçš„æ‘˜è¦ï¼Œä¸¤ä¸ªæ‘˜è¦è¿›è¡Œæ¯”è¾ƒï¼Œåˆ™å¯ä»¥åˆ¤æ–­æ˜¯å¦æ˜¯Aå‘é€çš„ä¸”å†…å®¹æ²¡è¢«ç¯¡æ”¹è¿‡ã€‚</li>
</ul>
<center>
    <img src="../images/szqm.png" width="400"/>
</center>


<h4 id="3-éå¯¹ç§°åŠ è§£å¯†çš„è¿‡ç¨‹ï¼š"><a href="#3-éå¯¹ç§°åŠ è§£å¯†çš„è¿‡ç¨‹ï¼š" class="headerlink" title="3.éå¯¹ç§°åŠ è§£å¯†çš„è¿‡ç¨‹ï¼š"></a>3.éå¯¹ç§°åŠ è§£å¯†çš„è¿‡ç¨‹ï¼š</h4><p>åŠ å¯†ä¸€æ–¹æ‰¾åˆ°æ¥æ”¶æ–¹çš„å…¬é’¥e (å¦‚ä½•æ‰¾åˆ°å‘¢ï¼Ÿå¤§éƒ¨åˆ†çš„å…¬é’¥æŸ¥æ‰¾å·¥ä½œå®é™…ä¸Šéƒ½æ˜¯é€šè¿‡æ•°å­—è¯ä¹¦æ¥å®ç°çš„)ï¼Œç„¶åç”¨å…¬é’¥eå¯¹æ˜æ–‡pè¿›è¡ŒåŠ å¯†åå¾—åˆ°å¯†æ–‡cï¼Œå¹¶å°†å¾—åˆ°çš„å¯†æ–‡å‘é€ç»™æ¥æ”¶æ–¹ï¼Œæ¥æ”¶æ–¹æ”¶åˆ°å¯†æ–‡åï¼Œç”¨è‡ªå·±ä¿ç•™çš„ç§é’¥dè¿›è¡Œè§£å¯†ï¼Œå¾—åˆ°æ˜æ–‡pï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼šç”¨å…¬é’¥åŠ å¯†çš„å¯†æ–‡ï¼Œåªæœ‰æ‹¥æœ‰ç§é’¥çš„ä¸€æ–¹æ‰èƒ½è§£å¯†ï¼Œè¿™æ ·å°±å¯ä»¥è§£å†³åŠ å¯†çš„å„æ–¹å¯ä»¥ç»Ÿä¸€ä½¿ç”¨ä¸€ä¸ªå…¬é’¥å³å¯ã€‚</p>
<p>å¸¸ç”¨çš„éå¯¹ç§°åŠ å¯†ç®—æ³•æœ‰ï¼šRSA</p>
<h5 id="ä¼˜ç‚¹ï¼š-1"><a href="#ä¼˜ç‚¹ï¼š-1" class="headerlink" title="ä¼˜ç‚¹ï¼š"></a>ä¼˜ç‚¹ï¼š</h5><ul>
<li>ä¸å­˜åœ¨å¯†é’¥åˆ†å‘çš„é—®é¢˜ï¼Œè§£ç æ–¹å¯ä»¥è‡ªå·±ç”Ÿæˆå¯†é’¥å¯¹ï¼Œä¸€ä¸ªåšç§é’¥å­˜èµ·æ¥ï¼Œå¦å¤–ä¸€ä¸ªä½œä¸ºå…¬é’¥è¿›è¡Œå‘å¸ƒã€‚</li>
<li>è§£å†³äº†å¯†é’¥ç®¡ç†çš„å¤æ‚åº¦é—®é¢˜ï¼Œå¤šä¸ªåŠ å¯†æ–¹éƒ½å¯ä»¥ä½¿ç”¨ä¸€ä¸ªå·²çŸ¥çš„å…¬é’¥è¿›è¡ŒåŠ å¯†ï¼Œä½†åªæœ‰æ‹¥æœ‰ç§é’¥çš„ä¸€æ–¹æ‰èƒ½è§£å¯†ã€‚</li>
</ul>
<h5 id="ç¼ºç‚¹ï¼š-1"><a href="#ç¼ºç‚¹ï¼š-1" class="headerlink" title="ç¼ºç‚¹ï¼š"></a>ç¼ºç‚¹ï¼š</h5><ul>
<li>éå¯¹ç§°åŠ å¯†ä¸è¶³çš„åœ°æ–¹æ˜¯åŠ è§£å¯†çš„é€Ÿåº¦æ²¡æœ‰å¯¹ç§°åŠ å¯†å¿«ã€‚</li>
</ul>
<p>ç»¼ä¸Šï¼Œåˆ†æäº†å¯¹ç§°åŠ å¯†å’Œéå¯¹ç§°åŠ å¯†å„è‡ªçš„ä¼˜ç¼ºç‚¹åï¼Œæœ‰æ²¡æœ‰ä¸€ç§åŠæ³•æ˜¯å¯ä»¥åˆ©ç”¨ä¸¤è€…çš„ä¼˜ç‚¹ä½†é¿å¼€å¯¹åº”çš„ç¼ºç‚¹å‘¢ï¼Ÿç­”åº”æ˜¯æœ‰çš„ï¼Œå®é™…ä¸Šç”¨å¾—æœ€å¤šçš„æ˜¯æ··åˆåŠ å¯†ç³»ç»Ÿï¼Œæ¯”å¦‚åœ¨ä¸¤ä¸ªèŠ‚ç‚¹é—´é€šè¿‡ä¾¿æ·çš„å…¬å¼€å¯†ç åŠ å¯†æŠ€æœ¯å»ºç«‹èµ·å®‰å…¨é€šä¿¡ï¼Œç„¶åå†ç”¨å®‰å…¨çš„é€šä¿¡äº§ç”Ÿå¹¶å‘é€ä¸´æ—¶çš„éšæœºå¯¹ç§°å¯†é’¥ï¼Œé€šè¿‡æ›´å¿«çš„å¯¹ç§°åŠ å¯†æŠ€æœ¯å¯¹å‰©ä½™çš„æ•°æ®è¿›è¡ŒåŠ å¯†ã€‚</p>
<center>
    <img src="../images/fdcjm.png" width="400"/>
</center>]]></content>
      <categories>
        <category>è®¡ç®—æœº</category>
      </categories>
      <tags>
        <tag>cryptography</tag>
      </tags>
  </entry>
  <entry>
    <title>CPUçš„ç¼“å­˜</title>
    <url>/cpu-cache-overview.html</url>
    <content><![CDATA[<h4 id="ä¸€ã€æ€§èƒ½"><a href="#ä¸€ã€æ€§èƒ½" class="headerlink" title="ä¸€ã€æ€§èƒ½"></a>ä¸€ã€æ€§èƒ½</h4><p>1.1 åœ¨åˆ†å±‚å­˜å‚¨ç»“æ„ä¸­ï¼Œéšç€å­˜å‚¨å®¹é‡çš„å¢åŠ ï¼Œå»¶è¿Ÿä¹Ÿéšä¹‹å¢åŠ ã€‚<a href="https://gist.github.com/jboner/2841832">å‚è€ƒ</a></p>
<p>ä»æ•°æ®å¯ä»¥çœ‹å‡ºï¼ŒL1ç¼“å­˜å’Œä¸»å­˜è®¿é—®é€Ÿåº¦ç›¸å·®200å€ã€‚</p>
<center>
    <img src="../images/cpu_cache_speed.png" width="500"/>
</center>


<h4 id="äºŒã€ç¼“å­˜è¡Œ"><a href="#äºŒã€ç¼“å­˜è¡Œ" class="headerlink" title="äºŒã€ç¼“å­˜è¡Œ"></a>äºŒã€ç¼“å­˜è¡Œ</h4><p>CPUç¼“å­˜çš„åŸºæœ¬å•ä½æ˜¯ç¼“å­˜è¡Œï¼Œä¸»å­˜æ•°æ®å’Œç¼“å­˜çš„æ˜ å°„å­˜åœ¨ä¸‹åˆ—å…³ç³»ï¼š</p>
<h5 id="2-1-ç›´æ¥æ˜ å°„ç¼“å­˜"><a href="#2-1-ç›´æ¥æ˜ å°„ç¼“å­˜" class="headerlink" title="2.1 ç›´æ¥æ˜ å°„ç¼“å­˜"></a>2.1 ç›´æ¥æ˜ å°„ç¼“å­˜</h5><center>
    <img src="../images/cpu_cache_direct_map.jpeg" width="600"/>
</center>

<p>1ã€ indexç”¨äºè®¡ç®—åœ¨å“ªä¸€ä¸ªç¼“å­˜è¡Œ<br>2ã€ offsetç”¨äºè®¡ç®—åœ¨ç¼“å­˜è¡Œçš„å“ªä¸ªå­—èŠ‚<br>3ã€ tagç”¨äºåˆ¤æ–­ç¼“å­˜æ˜¯å¦å‘½ä¸­ï¼ˆå‡è®¾0x7f6601 å’Œ 0x8f6602ä¸¤ä¸ªåœ°å€ï¼Œä½ä½éƒ½ä¸€æ ·ï¼Œç¼“å­˜è¡Œå’Œå­—èŠ‚åç§»éƒ½å‘½ä¸­äº†ï¼Œtagä¸å‘½ä¸­ï¼‰</p>
<p>ç¼ºç‚¹ï¼š<br>å›¾ä¸­ï¼Œcacheç¼“å­˜8è¡Œæ•°æ®ï¼Œå½“è®¿é—®ç¬¬0è¡Œã€ç¬¬8è¡Œã€ç¬¬16è¡Œæ—¶ï¼Œç¼“å­˜æ— æ³•å‘½ä¸­ï¼Œæ¯æ¬¡éƒ½è¦å»ä¸»å­˜åŠ è½½ï¼Œå‘ç”Ÿ<strong>ç¼“å­˜é¢ ç°¸</strong></p>
<h5 id="2-2-å¤šè·¯ç»„ç›¸è¿"><a href="#2-2-å¤šè·¯ç»„ç›¸è¿" class="headerlink" title="2.2 å¤šè·¯ç»„ç›¸è¿"></a>2.2 å¤šè·¯ç»„ç›¸è¿</h5><p>è¿™æ˜¯ä¸€ä¸ªä¸¤è·¯ç»„ç›¸è¿çš„ç¤ºæ„å›¾ï¼š</p>
<center>
    <img src="../images/cpu_cache_n_way.png" width="500"/>
</center>

<p>1ã€indexå®šä½ç»„<br>2ã€ç»„å†…ä¾æ¬¡å¯¹tagè¿›è¡Œå¯¹æ¯”ï¼ˆå¯ä»¥é€šè¿‡ç¡¬ä»¶å¹¶è¡Œæ¯”è¾ƒå¢åŠ æ€§èƒ½ï¼‰</p>
<h4 id="ä¸‰ã€ç¼“å­˜ä¸€è‡´æ€§"><a href="#ä¸‰ã€ç¼“å­˜ä¸€è‡´æ€§" class="headerlink" title="ä¸‰ã€ç¼“å­˜ä¸€è‡´æ€§"></a>ä¸‰ã€ç¼“å­˜ä¸€è‡´æ€§</h4><h5 id="3-1-é—®é¢˜æè¿°ï¼š"><a href="#3-1-é—®é¢˜æè¿°ï¼š" class="headerlink" title="3.1 é—®é¢˜æè¿°ï¼š"></a>3.1 é—®é¢˜æè¿°ï¼š</h5><center>
    <img src="../images/cpu_cache_problem.jpeg" width="500"/>
</center>

<p>å¤„ç†å™¨ 1 è¯» X ï¼šä»å†…å­˜è¯»å–24å¹¶ç¼“å­˜<br>å¤„ç†å™¨ 2 è¯» X ï¼šä»å†…å­˜è¯»å–24å¹¶ç¼“å­˜<br>å¤„ç†å™¨ 1 å†™ X = 32 ï¼šæ›´æ–°è‡ªå·±çš„ç¼“å­˜<br>å¤„ç†å™¨ 3 è¯» X = ï¼Ÿ  </p>
<p>å¦‚ä½•ä¿è¯ç¼“å­˜çš„ä¸€è‡´æ€§ï¼Ÿ<a href="https://people.eecs.berkeley.edu/~pattrsn/252F96/Lecture18.pdf">å‚è€ƒ</a></p>
<h5 id="3-2-è§£å†³æ–¹æ¡ˆ"><a href="#3-2-è§£å†³æ–¹æ¡ˆ" class="headerlink" title="3.2 è§£å†³æ–¹æ¡ˆ"></a>3.2 è§£å†³æ–¹æ¡ˆ</h5><p>3.1.1 å—…æ¢-Snooping Solution(Snoopy Bus)</p>
<p>æ ¹æ®å†™æ“ä½œå¯¹ç¼“å­˜æ•°æ®çš„å½±å“å—…æ¢åè®®å¯åˆ†ä¸ºï¼š<br>Write-invalidateï¼š<br>å½“å¤„ç†å™¨å†™å…¥æ•°æ®æ—¶ï¼Œæ‰€æœ‰çš„ç‹¬ç«‹ç¼“å­˜å°†é€šè¿‡æ€»çº¿å—…æ¢å¾—åˆ°é€šçŸ¥ï¼Œå¹¶æ ‡å¿—è‡ªå·±çš„ç¼“å­˜å¤±æ•ˆã€‚è¿™ä¿è¯äº†å…¨å±€åªæœ‰ä¸€ä»½ç¼“å­˜æ˜¯æœ‰æ•ˆçš„ã€‚</p>
<ul>
<li>MSI</li>
<li>MESI</li>
<li>MOSI</li>
<li>MOESI</li>
<li>MESIF </li>
</ul>
<p>Write-updateï¼š<br>å½“å¤„ç†å™¨å†™å…¥æ•°æ®æ—¶ï¼Œæ‰€æœ‰çš„ç‹¬ç«‹ç¼“å­˜å°†é€šè¿‡æ€»çº¿å—…æ¢å¾—åˆ°é€šçŸ¥ï¼Œå¹¶æ›´æ–°è‡ªå·±çš„ç¼“å­˜ã€‚é€šè¿‡æ€»çº¿å¹¿æ’­ç»™æ‰€æœ‰çš„ç¼“å­˜é€ æˆäº†æ€»çº¿ç¹å¿™ï¼Œæ‰€ä»¥ä¸å¸¸è§ã€‚</p>
<p>3.1.2 ç›®å½•-Directory-Based Schemes</p>
<h5 id="3-2-MESIåè®®å‚è€ƒ"><a href="#3-2-MESIåè®®å‚è€ƒ" class="headerlink" title="3.2 MESIåè®®å‚è€ƒ"></a>3.2 MESIåè®®<a href="https://people.cs.pitt.edu/~melhem/courses/2410p/ch5-4.pdf">å‚è€ƒ</a></h5><p>MESIæ˜¯å››ä¸ªçŠ¶æ€çš„é¦–å­—æ¯ç¼©å†™ï¼Œåœ¨ç¼“å­˜è¡Œä¸­ç”¨2ä¸ªbitæ ‡å¿—è¯¥ç¼“å­˜è¡Œçš„çŠ¶æ€ã€‚</p>
<ul>
<li>M:Modifiedï¼ˆåªå­˜åœ¨å½“å‰ç¼“å­˜è¡Œï¼Œå·²è¢«ä¿®æ”¹ï¼Œå’Œä¸»å­˜ä¸ä¸€è‡´ï¼Œéœ€è¦æ›´æ–°å›ä¸»å­˜ï¼‰</li>
<li>E:Exclusiveï¼ˆåªå­˜åœ¨å½“å‰ç¼“å­˜è¡Œï¼Œå’Œä¸»å­˜ä¸€è‡´ï¼‰</li>
<li>S:Sharedï¼ˆå…¶ä»–ç¼“å­˜è¡Œä¹Ÿå­˜åœ¨è¯¥æ•°æ®ï¼Œå’Œä¸»å­˜ä¸€è‡´ï¼‰</li>
<li>I:Invalidï¼ˆæ­¤ç¼“å­˜è¡Œå¤±æ•ˆï¼‰</li>
</ul>
<p>MESIçš„çŠ¶æ€è¿ç§»ï¼š</p>
<center>
    <img src="../images/cpu_cache_mesi_state.jpeg" width="500"/>
</center>




<h4 id="å››ã€å‚è€ƒæ–‡çŒ®"><a href="#å››ã€å‚è€ƒæ–‡çŒ®" class="headerlink" title="å››ã€å‚è€ƒæ–‡çŒ®"></a>å››ã€å‚è€ƒæ–‡çŒ®</h4><p><a href="https://www.cnkirito.moe/cache-line/#%E4%BB%80%E4%B9%88%E6%98%AF%E7%BC%93%E5%AD%98%E8%A1%8C-Cache-Line-%EF%BC%9F">0.Javaè§’åº¦ç†è§£CPUç¼“å­˜</a><br><a href="https://zhuanlan.zhihu.com/p/102293437">1.Cacheçš„åŸºæœ¬åŸç†</a><br><a href="https://gist.github.com/jboner/2841832">2.æ¯ä¸ªå¼€å‘è€…éœ€è¦çŸ¥é“çš„æ•°æ®</a><br><a href="https://medium.com/fcamels-notes/%E5%BE%9E%E7%A1%AC%E9%AB%94%E8%A7%80%E9%BB%9E%E4%BA%86%E8%A7%A3-memry-barrier-%E7%9A%84%E5%AF%A6%E4%BD%9C%E5%92%8C%E6%95%88%E6%9E%9C-416ff0a64fc1">3.ç¡¬ä»¶è§’åº¦çœ‹å†…å­˜å±éšœ</a><br><a href="https://medium.com/fcamels-notes/%E5%BE%9E-double-checked-locking-%E4%BA%86%E8%A7%A3-memory-barrier-%E7%9A%84%E4%BD%9C%E7%94%A8-bb151a359c1b">4.è½¯ä»¶è§’åº¦å†…å­˜å±éšœ</a><br><a href="https://stackoverflow.com/questions/3928995/how-do-cache-lines-work">5.stackoverflow-How do cache lines work?</a><br><a href="https://courses.cs.duke.edu/spring09/cps104/lectures/2up-lecture17.pdf">6.courses-pdf</a></p>
]]></content>
      <categories>
        <category>è®¡ç®—æœº</category>
      </categories>
      <tags>
        <tag>è®¡ç®—æœºåŸºç¡€</tag>
      </tags>
  </entry>
  <entry>
    <title>CPUæµæ°´çº¿å·¥ä½œåŸç†</title>
    <url>/cpu-pipline-overview.html</url>
    <content><![CDATA[<h5 id="è¯´æ˜ï¼š"><a href="#è¯´æ˜ï¼š" class="headerlink" title="è¯´æ˜ï¼š"></a>è¯´æ˜ï¼š</h5><p>åœ¨<a href="https://www.zhaixue.cc/weixin/weixin-cpu-pipeline.html">å®…å­¦éƒ¨è½</a>è¿™ä¸ªç½‘ç«™çœ‹åˆ°ä¸€ç¯‡è®²CPUæµæ°´çº¿çš„æ–‡ç« ï¼Œå†™çš„éå¸¸å¥½ï¼Œä¸ºäº†ä¾¿äºç¿»é˜…å›é¡¾ï¼Œè½¬è½½ä¹‹ã€‚</p>
<h5 id="æ­£æ–‡ï¼š"><a href="#æ­£æ–‡ï¼š" class="headerlink" title="æ­£æ–‡ï¼š"></a>æ­£æ–‡ï¼š</h5><p>ç°åœ¨çš„CPUå¤„ç†å™¨ä¸€èˆ¬éƒ½æ˜¯è¶…æµæ°´çº¿å·¥ä½œï¼ŒåŠ¨ä¸åŠ¨å°±æ˜¯10çº§ä»¥ä¸Šæµæ°´çº¿ï¼Œè¶…é«˜ä¸»é¢‘ï¼Œè¿™ä¸¤è€…ä¹‹é—´æœ‰ä»€ä¹ˆå…³ç³»å‘¢ï¼Ÿä»Šå¤©å°±è·Ÿå¤§å®¶ç§‘æ™®ä¸‹CPUæµæ°´çº¿çš„å·¥ä½œåŸç†ï¼Œä»¥åŠä»–ä»¬ä¹‹é—´çš„å…³ç³»ã€‚</p>
<p>è¯´åˆ°æµæ°´çº¿ï¼Œå¾ˆå¤šäººä¼šæƒ³åˆ°å¯Œå£«åº·ï¼›è¯´åˆ°å¯Œå£«åº·ï¼Œå¾ˆå¤šäººä¼šæƒ³åˆ°å¼ å…¨è›‹ã€‚ä½œä¸ºå¯Œå£«åº· 3 å·æµæ°´çº¿èµ„æ·±è´¨æ£€å‘˜ï¼Œä¸‹é¢å°±è¯·å¼ å…¨è›‹ç»™å¤§å®¶ç§‘æ™®ä¸‹ä»€ä¹ˆæ˜¯æµæ°´çº¿ï¼Œå¤§å®¶é¼“æŒæ¬¢è¿ã€‚</p>
<h5 id="Micheal-Jack-çœ¼ä¸­çš„æµæ°´çº¿"><a href="#Micheal-Jack-çœ¼ä¸­çš„æµæ°´çº¿" class="headerlink" title="Micheal Jack çœ¼ä¸­çš„æµæ°´çº¿"></a>Micheal Jack çœ¼ä¸­çš„æµæ°´çº¿</h5><blockquote>
<p>å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯å¼ å…¨è›‹ï¼Œè‹±æ–‡åå«Micheal Jackï¼Œæ³•æ–‡åå«éœé›·å‘†-æ°Qèµ–ï¼Œå¤§å®¶ä¹Ÿå¯ä»¥å«æˆ‘æŸ¥ç†ã€‚ä½œä¸ºiPhone æ‰‹æœº 3 å·æµæ°´çº¿çš„èµ„æ·±è´¨æ£€å‘˜ï¼Œæˆ‘å¾ˆå¿™çš„ï¼Œæ¯åˆ†é’Ÿéƒ½æ˜¯å‡ ç™¾ä¸‡çš„ç”Ÿæ„ã€‚åƒæˆ‘ä»¬å¯Œå£«åº·è¿™æ ·çš„transnational enterpriseï¼Œç»å¸¸ä¼šå’Œä¸åŒå›½å®¶çš„å®¢æˆ·è¯´ä¸€äº›æŠ€æœ¯ä¸Šçš„meetingå•Šã€ä¸‹ç­é™ªä»–ä»¬messageå•Šï¼Œéƒ½éœ€è¦è‹±æ–‡çš„ã€‚åƒæˆ‘ä»¬å‚é‡Œä¸ä¼šè¯´è‹±è¯­çš„å•Šï¼Œéƒ½ä¼šè¢«ç»ç† fire æ‰çš„ã€‚åœ¨æˆ‘ä»¬å‚é‡Œï¼Œæµæ°´çº¿å«æ³•å¤ª lowäº†ï¼Œæˆ‘ä»¬éƒ½å« pipelineï¼Œä¸€æ¡pipelineï¼Œæ¯ä¸ªäººåˆ†å·¥ä¸åŒï¼Œä»æ‰‹æœºåŸææ–™åˆ°æˆå“iPhone ï¼Œåªéœ€è¦çŸ­çŸ­å‡ åˆ†é’Ÿã€‚â€”- ã€ŠåµŒå…¥å¼Cè¯­è¨€è‡ªæˆ‘ä¿®å…»ã€‹</p>
</blockquote>
<center>
    <img src="../images/cpu-pipeline-phone.jpeg" width="90%"/>
</center>

<p>æŸ¥ç†å¾ˆå¿™ï¼Œä»‹ç»åˆ°è¿™é‡Œå°±èµ°äº†ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬ç»§ç»­äº†è§£ä¸‹ä»€ä¹ˆå«æµæ°´çº¿ã€‚</p>
<p>æµæ°´çº¿æ˜¯å·¥ä¸šå¤§ç”Ÿäº§ä¸‹çš„äº§ç‰©ã€‚åœ¨å†œä¸šç¤¾ä¼šåšä¸€éƒ¨æ‰‹æœºï¼Œéœ€è¦çš„æ˜¯å·¥åŒ ã€æ‰‹è‰ºäººï¼Œå°±åƒæ•…å®«é‡Œåˆ¶ä½œé’Ÿè¡¨çš„é‚£äº›åŒ äººä¸€æ ·ï¼Œæ˜¯éœ€è¦æ‹œå¸ˆå­¦è‰ºã€æ…¢æ…¢å­¦ä¹ çš„ï¼šä»æ‰‹æœºç»„è£…ã€è´¨æ£€ã€è´´è†œã€åŒ…è£…éƒ½æ˜¯ä¸€ä¸ªäººï¼Œä»€ä¹ˆéƒ½è¦å­¦ã€‚æ‰‹è‰ºäººæ…¢å·¥å‡ºç»†æ´»ï¼Œä½†æˆæœ¬å¾ˆé«˜ï¼Œåˆ°äº†å·¥ä¸šåŒ–ç¤¾ä¼šå°±ä¸ä¸€æ ·äº†ï¼šå¤§å®¶åˆ†å·¥åˆä½œï¼Œå°†åšæ‰‹æœºè¿™ä¸ªå¤æ‚è¿‡ç¨‹æ‹†åˆ†ä¸ºå¤šä¸ªç®€å•æ­¥éª¤ï¼Œæ¯ä¸ªäººè´Ÿè´£ä¸€ä¸ªæ­¥éª¤ï¼Œç»è¿‡åˆ»æ„ï¼ˆæœºæ¢°ï¼‰ç»ƒä¹ å’ŒåŸ¹è®­ï¼Œå°±å¯ä»¥å¾ˆå¿«ä¸Šæ‰‹ã€‚æ¯ä¸ªäººéƒ½åšè‡ªå·±æœ€æ“…é•¿çš„ï¼Œå¯ä»¥å¤§å¤§æé«˜å·¥ä½œæ•ˆç‡ã€‚</p>
<p>å¦‚æœæ¯ä¸ªäººéƒ½å•ç‹¬åšä¸€éƒ¨æ‰‹æœºï¼Œç„Šæ¥ç”µè·¯ã€ç»„è£…æˆå“è¿™ä¸€æ­¥éª¤ä¸€èˆ¬äººéœ€è¦8åˆ†é’Ÿï¼Œæµ‹è¯•æ£€éªŒä¸€èˆ¬éœ€è¦4åˆ†é’Ÿï¼Œè´´è†œåŒ…è£…æˆç›’ä¸€èˆ¬éœ€è¦4åˆ†é’Ÿï¼Œæ€»å…±éœ€è¦16åˆ†é’Ÿã€‚æ¯16åˆ†é’Ÿï¼Œå¦‚æœæœ‰3ä¸ªå·¥äººçš„è¯ï¼Œä¸€å…±å¯ä»¥ç”Ÿäº§3éƒ¨æ‰‹æœºã€‚ä¸€ä¸ªæ–°å‘˜å·¥ä»è¿›å‚å¼€å§‹ï¼Œè¦åŸ¹è®­å­¦ä¹ ä¸‰ä¸ªæœˆæ‰èƒ½æŒæ¡æ‰€æœ‰çš„æŠ€èƒ½ï¼Œæ‰èƒ½ä¸Šå²—ã€‚å¦‚æœå¼•å…¥ç”Ÿäº§æµæ°´çº¿å°±ä¸ä¸€æ ·äº†ï¼Œæ¯ä¸ªäººåªè´Ÿè´£ä¸€ä¸ªå·¥åºï¼Œæ¯”å¦‚èµµé“æŸ±åªè´Ÿè´£ç„Šæ¥ç”µè·¯ã€ç»„è£…æ‰‹æœºï¼Œæå°èŠ±åªè´Ÿè´£è´´è†œï¼Œè¿›å‚åŸ¹è®­3å¤©å°±å¯ä»¥å¿«é€Ÿä¸Šæ‰‹äº†ï¼Œå¯¹å·¥äººçš„æŠ€èƒ½è¦æ±‚å¤§å¤§é™ä½ï¼è€Œä¸”éšç€æ—¶é—´ç§¯ç´¯ï¼Œæ¯ä¸ªäººå¯¹è‡ªå·±æ‰€è´Ÿè´£çš„å·¥åºè¶Šæ¥è¶Šç†Ÿç»ƒï¼Œæ¯é“å·¥åºéœ€è¦çš„æ—¶é—´å¤§å¤§å‡å°‘ï¼šèµµé“æŸ±ç„Šæ¥ç”µè·¯è¶Šæ¥è¶Šé¡ºæ‰‹ï¼ŒèŠ±è´¹æ—¶é—´ä»åŸæ¥çš„8åˆ†é’Ÿç¼©å‡ä¸º4åˆ†é’Ÿï¼›å¼ å…¨è›‹çš„è´¨é‡æ£€éªŒç»ƒå¾—å¦‚ç«çº¯æƒ…ï¼Œæ•´ä¸ªæµç¨‹åšå®Œåªéœ€è¦2åˆ†é’Ÿï¼›æå°èŠ±çš„è´´è†œæŠ€æœ¯ä¹Ÿè¶Šæ¥è¶Šæºœäº†ï¼Œä»è´´è†œåˆ°åŒ…è£…2åˆ†é’Ÿæå®šã€‚æ¯16åˆ†é’Ÿï¼Œèµµé“æŸ±å¯ä»¥ç„Šæ¥4å—ç”µè·¯æ¿ ï¼Œæ•´ä¸ªæµæ°´çº¿å¯ä»¥ç”Ÿäº§å‡º4éƒ¨æ‰‹æœºï¼Œäº§èƒ½æ•´æ•´æå‡äº†33.33%ï¼è€æ¿é«˜å…´ï¼Œèµµé“æŸ±é«˜å…´ï¼Œå¼ å…¨è›‹å’Œæå°èŠ±æ›´é«˜å…´ï¼Œå› ä¸ºæ¯åš2åˆ†é’Ÿï¼Œä»–ä»¬è¿˜å¯ä»¥ä¼‘æ¯2åˆ†é’Ÿï¼Œåˆ·åˆ·å¾®åšæ»‘ä¸ªæŠ–éŸ³ï¼Œå²‚ä¸ä¹å“‰ï¼</p>
<p>çœ‹åˆ°è¿™é‡Œå¯èƒ½æœ‰äººæŠ¬æ äº†ï¼šä½ è¿™ä¹ˆç®—æ˜¯ä¸å¯¹çš„ï¼Œæ¯é“å·¥åºæ‰€ç”¨çš„æ—¶é—´éƒ½å˜ä¸ºåŸæ¥çš„ä¸€åŠï¼Œæ€ä¹ˆå¯èƒ½åšå¾—åˆ°ï¼Ÿå…¶å®è¦åšåˆ°ä¸éš¾çš„ï¼Œåªè¦å·¥åºæ‹†è§£å¾—åˆç†ï¼Œå®¹æ˜“ä¸Šæ‰‹ï¼Œå†åŠ ä¸Šè¶³å¤Ÿæ—¶é—´çš„æœºæ¢°é‡å¤ï¼Œå¾ˆå¤šäººéƒ½å¯ä»¥åšå¾—åˆ°ã€‚åªè¦å¥–é‡‘å‘åˆ°ä½ï¼Œè›‹ç³•åº—é‡Œçš„å°å§å§å¤¹è›‹ç³•çš„é€Ÿåº¦æ¯”ä½ çœ¨çœ¼çš„é€Ÿåº¦éƒ½å¿«ï¼Œé“¶è¡ŒæŸœå°çš„å°ææ•°é’ç¥¨çš„é€Ÿåº¦æ¯”ç‚¹é’æœºéƒ½å¿«ï¼Œä¹°å•æ—¶é¥­åº—å‰å°çš„å°å¦¹æ‘è®¡ç®—å™¨çš„é€Ÿåº¦æ¯”ä½ æé’±çš„é€Ÿåº¦éƒ½å¿«ã€‚</p>
<h5 id="æµæ°´çº¿å·¥ä½œåŸç†"><a href="#æµæ°´çº¿å·¥ä½œåŸç†" class="headerlink" title="æµæ°´çº¿å·¥ä½œåŸç†"></a>æµæ°´çº¿å·¥ä½œåŸç†</h5><p>ä¸€æ¡æŒ‡ä»¤çš„æ‰§è¡Œä¸€èˆ¬è¦ç»è¿‡ï¼šå–æŒ‡ä»¤ã€ç¿»è¯‘æŒ‡ä»¤ã€æ‰§è¡ŒæŒ‡ä»¤ä¸‰ä¸ªåŸºæœ¬æµç¨‹ã€‚CPUå†…éƒ¨çš„ç”µè·¯åˆ†ä¸ºä¸åŒçš„å•å…ƒï¼šå–æŒ‡å•å…ƒã€è¯‘ç å•å…ƒã€æ‰§è¡Œå•å…ƒç­‰ï¼ŒæŒ‡ä»¤çš„æ‰§è¡Œä¹Ÿæ˜¯æŒ‰ç…§æµæ°´çº¿å·¥åºä¸€æ­¥ä¸€æ­¥æ‰§è¡Œçš„ã€‚æˆ‘ä»¬å‡è®¾æ¯ä¸€ä¸ªæ­¥éª¤æ‰§è¡Œæ—¶é—´éƒ½æ˜¯ä¸€ä¸ªæ—¶é’Ÿå‘¨æœŸï¼Œé‚£ä¹ˆä¸€æ¡æŒ‡ä»¤æ‰§è¡Œéœ€è¦3ä¸ªæ—¶é’Ÿå‘¨æœŸã€‚</p>
<center>
    <img src="../images/cpu-arm-pipeline.png" width="50%"/>
</center>


<p>CPU æ‰§è¡ŒæŒ‡ä»¤çš„3ä¸ªæ—¶é’Ÿå‘¨æœŸé‡Œï¼Œå–æŒ‡å•å…ƒåªåœ¨ç¬¬ä¸€ä¸ªæ—¶é’Ÿå‘¨æœŸé‡Œå·¥ä½œï¼Œå…¶ä½™ä¸¤ä¸ªæ—¶é’Ÿå‘¨æœŸéƒ½å¤„äºç©ºé—²çŠ¶æ€ï¼Œå…¶å®ƒä¸¤ä¸ªæ‰§è¡Œå•å…ƒä¹Ÿæ˜¯å¦‚æ­¤ï¼Œæ•ˆç‡å¤ªä½äº†ï¼Œæ¶ˆè´¹è€…æ— æ³•æ¥å—ï¼Œè€æ¿ä¹Ÿä¸èƒ½æ¥å—ã€‚è§£å†³æ–¹æ³•å°±æ˜¯å¼•å…¥æµæ°´çº¿ï¼Œè®©æµæ°´çº¿æ¯ä¸€é¢—èºä¸é’‰éƒ½é©¬ä¸åœè¹„åœ°è¿è½¬èµ·æ¥ï¼Œæœ€å¥½ä¸€åˆ»ä¹Ÿä¸è¦åœã€‚</p>
<center>
    <img src="../images/cpu-pipeline-multi.png" width="50%"/>
</center>


<p>å¼•å…¥æµæ°´çº¿å·¥ä½œæ¨¡å¼åå¯ä»¥çœ‹åˆ°ï¼Œé™¤äº†åˆšå¼€å§‹ç¬¬ä¸€ä¸ªæ—¶é’Ÿå‘¨æœŸå¤§å®¶è¿˜å¯ä»¥å·æ‡’å¤–ï¼Œå…¶ä½™çš„æ—¶é—´éƒ½ä¸èƒ½é—²ç€ï¼šä»ç¬¬äºŒä¸ªæ—¶é’Ÿå‘¨æœŸå¼€å§‹ï¼Œå½“è¯‘ç å•å…ƒåœ¨ç¿»è¯‘æŒ‡ä»¤1æ—¶ï¼Œå–æŒ‡å•å…ƒä¹Ÿä¸èƒ½é—²ç€ï¼Œè¦æ¥ç€å»å–æŒ‡ä»¤2ã€‚åŒæ ·å¦‚æ­¤ï¼Œä»ç¬¬ä¸‰ä¸ªæ—¶é’Ÿå‘¨æœŸå¼€å§‹ï¼Œå½“æ‰§è¡Œå•å…ƒæ‰§è¡ŒæŒ‡ä»¤1æ—¶ï¼Œè¯‘ç å•å…ƒä¹Ÿä¸èƒ½é—²ç€ï¼Œè¦æ¥ç€å»ç¿»è¯‘æŒ‡ä»¤2ï¼Œè€Œå–æŒ‡å•å…ƒè¦å»å–æŒ‡ä»¤3ã€‚ä»ç¬¬å››ä¸ªæ—¶é’Ÿå‘¨æœŸå¼€å§‹ï¼Œæ¯ä¸ªç”µè·¯å•å…ƒéƒ½ä¼šè¿›å…¥æ»¡è·è´Ÿè½½å·¥ä½œçŠ¶æ€ï¼Œåƒå¯Œå£«åº·å·¥å‚é‡Œçš„æµæ°´çº¿ä¸€æ ·ï¼Œæºæºä¸æ–­åœ°æ‰§è¡Œä¸€æ¡æ¡æŒ‡ä»¤ã€‚</p>
<p>å¼•å…¥æµæ°´çº¿åï¼Œè™½ç„¶æ¯ä¸€æ¡æŒ‡ä»¤æ‰§è¡Œæµç¨‹ä¸å˜ï¼Œè¿˜æ˜¯éœ€è¦3ä¸ªæ—¶é’Ÿå‘¨æœŸï¼Œä½†æ˜¯ä»æ•´æ¡æµæ°´çº¿çš„è¾“å‡ºçœ‹æ¥ï¼Œå·®ä¸å¤šå¹³å‡æ¯ä¸ªæ—¶é’Ÿå‘¨æœŸå°±èƒ½æ‰§è¡Œä¸€æ¡æŒ‡ä»¤ã€‚åŸæ¥æ‰§è¡Œä¸€æ¡æŒ‡ä»¤éœ€è¦3ä¸ªæ—¶é’Ÿå‘¨æœŸï¼Œç°åœ¨å¹³å‡åªéœ€è¦1ä¸ªæ—¶é’Ÿå‘¨æœŸï¼ŒCPU æ€§èƒ½æå‡äº†ä¸å°‘ã€‚</p>
<p>æµæ°´çº¿çš„æœ¬è´¨å…¶å®å°±æ˜¯æ‹¿ç©ºé—´èµ„æºæ¢æ—¶é—´ã€‚å°†æ¯æ¡æŒ‡ä»¤åˆ†è§£ä¸ºå¤šæ­¥ï¼ŒæŒ‡ä»¤çš„æ¯ä¸€æ­¥éƒ½æœ‰ç‹¬ç«‹çš„ç”µè·¯æ¥æ‰§è¡Œï¼Œå¹¶è®©ä¸åŒæŒ‡ä»¤çš„å„æ­¥æ“ä½œé‡å ï¼Œä»è€Œå®ç°å‡ æ¡æŒ‡ä»¤å¹¶è¡Œå¤„ç†ï¼Œä»è€ŒåŠ å¿«ç¨‹åºçš„è¿è¡Œã€‚</p>
<p>CPUå†…éƒ¨çš„æµæ°´çº¿å¦‚æ­¤ï¼Œå¯Œå£«åº·å·¥å‚é‡Œçš„iPhoneæµæ°´çº¿ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œé€šè¿‡ä¸æ–­å¾€æµæ°´çº¿å¢åŠ äººæ‰‹æ¥æé«˜æµæ°´çº¿çš„ç”Ÿäº§æ•ˆç‡ï¼Œä¹Ÿå°±æ˜¯ååç‡ã€‚</p>
<h5 id="è¶…æµæ°´çº¿æŠ€æœ¯"><a href="#è¶…æµæ°´çº¿æŠ€æœ¯" class="headerlink" title="è¶…æµæ°´çº¿æŠ€æœ¯"></a>è¶…æµæ°´çº¿æŠ€æœ¯</h5><p>æƒ³çŸ¥é“ä»€ä¹ˆæ˜¯è¶…æµæ°´çº¿ï¼Œè®©æˆ‘ä»¬å†å›åˆ°å¯Œå£«åº·ã€‚</p>
<p>åœ¨å¯Œå£«åº· 3 å· iPhone æµæ°´ç”Ÿäº§çº¿ä¸Šï¼Œå› ä¸ºèµµé“æŸ±å·¥ä½œæ•ˆç‡ä¸é«˜ï¼Œç„Šæ¥ç»„è£…ä¸€æ­¥æ‰‹æœºéœ€è¦ 4 åˆ†é’Ÿï¼Œå¯¼è‡´ç”Ÿäº§ä¸€éƒ¨iPhoneæ‰‹æœºä¹Ÿå¾—éœ€è¦ 4 åˆ†é’Ÿï¼Œä»è€Œæ‹–ç´¯äº†æ•´æ¡ç”Ÿäº§çº¿çš„ç”Ÿäº§æ•ˆç‡ã€‚è€æ¿å¾ˆç”Ÿæ°”ï¼Œåæœå¾ˆä¸¥é‡ï¼Œèµµé“æŸ±æ²¡å¹²åˆ°ä¸€ä¸ªæœˆå°±è¢« fire æ‰äº†ã€‚åé¢å‡ ä¸ªæœˆï¼Œé™†é™†ç»­ç»­æ¥äº†ä¸å°‘äººï¼šå°é»‘ã€çš®è£¤å“¥ã€çº¢å§ï¼Œéƒ½æƒ³è¯•è¯•è¿™ä»½å·¥ä½œï¼Œå¯æƒœå¹²å¾—è¿˜ä¸å¦‚èµµé“æŸ±ï¼ŒæŒ‘æˆ˜ç”µå­å‚å¤±è´¥ï¼Œæ—©å·²ææ¡¶è·‘è·¯ã€‚</p>
<p>è€æ¿æ‹›ä¸åˆ°äººï¼Œæ„Ÿè§‰åˆé”™æ€ªäº†èµµé“æŸ±ï¼Œäºæ˜¯å†³å®šå‡çº§ç”Ÿäº§çº¿ï¼Œå¹¶æ‰¿è¯ºåŠ è–ªé‡æ–°å¬å›äº†èµµé“æŸ±ã€‚</p>
<center>
    <img src="../images/cpu-pipeline-phone2.png" width="50%"/>
</center>

<p>è€æ¿æ‰¾å‡ºäº†ç”Ÿäº§çº¿çš„ç“¶é¢ˆï¼šæ¯é“å·¥åºéƒ½æ˜¯éœ€è¦2åˆ†é’Ÿï¼Œåªæœ‰èµµé“æŸ±è¿™é“å·¥åºè€—æ—¶4åˆ†é’Ÿï¼Œè€æ¿é”™æ€ªäº†è¿™é“æŸ±ï¼Œè¿™ä¸æ˜¯èµµé“æŸ±çš„åŸå› ï¼Œæ˜¯å› ä¸ºè¿™é“å·¥åºå¤ªå¤æ‚ã€‚äºæ˜¯æŠŠè¿™é“å·¥åºè¿›è¡Œäº†æ‹†è§£ä¸º2é“å·¥åºï¼šç„Šæ¥ç”µè·¯æ¿å’Œç»„è£…æ‰‹æœºã€‚ç„Šæ¥ç”µè·¯ä»ç”±èµµé“æŸ±è´Ÿè´£ï¼ŒæŠŠç”µè·¯æ¿ã€æ˜¾ç¤ºå±ã€æ‰‹æœºå¤–å£³ç»„è£…æˆæ‰‹æœºè¿™é“å·¥åºåˆ™ç”±æ–°æ‹›å‘˜å·¥ç‹å»ºå›½è´Ÿè´£ã€‚ç”Ÿäº§æµæ°´çº¿ä¼˜åŒ–åï¼Œèµµé“æŸ±ç„Šæ¥ç”µè·¯åªéœ€è¦2åˆ†é’Ÿï¼Œç‹å»ºå›½ç»„è£…ä¹Ÿåªéœ€è¦ 2 åˆ†é’Ÿï¼Œç”Ÿäº§æ¯éƒ¨ iPhone çš„æ—¶é—´ç”±åŸæ¥çš„ 4 åˆ†é’Ÿç¼©å‡ä¸º 2 åˆ†é’Ÿï¼Œç”Ÿäº§æµæ°´çº¿çš„ç“¶é¢ˆè§£å†³äº†ï¼</p>
<p>è·Ÿå¯Œå£«åº·æµæ°´çº¿ç±»ä¼¼ï¼Œä¼˜åŒ–CPUæµæ°´çº¿ä¹Ÿæ˜¯æå‡CPUæ€§èƒ½çš„æœ‰æ•ˆæ‰‹æ®µã€‚æµæ°´ç”Ÿäº§çº¿å­˜åœ¨æœ¨æ¡¶çŸ­æ¿æ•ˆåº”ï¼Œæˆ‘ä»¬åªéœ€è¦æ‰¾å‡ºCPUæµæ°´çº¿ä¸­çš„æ€§èƒ½ç“¶é¢ˆï¼Œå³è€—æ—¶æœ€é•¿çš„é‚£é“å·¥åºï¼Œç„¶åå†è¿›è¡Œç»†åˆ†ã€ä¼˜åŒ–ä¸ºæ›´å¤šçš„å·¥åºå°±å¯ä»¥äº†ã€‚æ¯ä¸€é“å·¥åºæˆ‘ä»¬ç§°ä¸ºæµæ°´çº¿çš„ä¸€çº§ï¼Œæµæ°´çº¿è¶Šæ·±ï¼Œæ¯ä¸€é“æµæ°´ç”µè·¯å•å…ƒçš„æ‰§è¡Œæ—¶é—´å°±ä¼šå˜å¾—è¶Šå°ï¼Œæˆ‘ä»¬å¤„ç†å™¨çš„æ—¶é’Ÿå‘¨æœŸå°±å¯ä»¥æ›´çŸ­ï¼Œä»è€Œå¯ä»¥é€šè¿‡æå‡CPUä¸»é¢‘æ¥æå‡CPUæ€§èƒ½ã€æé«˜å·¥ä½œæ•ˆç‡ã€‚</p>
<p>åœ¨å¯Œå£«åº·æµæ°´ç”Ÿäº§çº¿ä¸­ï¼Œæ¯é“å·¥åºçš„æœ€é•¿è€—æ—¶æ—¶é—´å†³å®šäº†æ•´æ¡ç”Ÿäº§çº¿çš„ååç‡ã€‚åœ¨CPUå†…éƒ¨ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œæ¯ä¸ªæµæ°´å•å…ƒçš„æ‰§è¡Œæ—¶é—´ï¼ˆå³æ—¶é—´å»¶è¿Ÿï¼‰å†³å®šäº†CPUæµæ°´çº¿çš„æ€§èƒ½ã€‚CPUæµæ°´çº¿ä¸­çš„æ¯ä¸€é“ç”µè·¯å•å…ƒç”±ç»„åˆé€»è¾‘ç”µè·¯å’Œå¯„å­˜å™¨ç»„æˆï¼Œé€»è¾‘å•è·¯ç”¨æ¥æ‰§è¡Œæœ¬é“å·¥åºçš„é€»è¾‘è¿ç®—ï¼Œå¯„å­˜å™¨ç”¨æ¥ä¿å­˜ç»“æœï¼Œå¹¶ä½œä¸ºä¸‹ä¸€é“å·¥åºçš„è¾“å…¥ã€‚</p>
<center>
    <img src="../images/cpu-pipeline-line.png" width="50%"/>
</center>

<p>æµæ°´ç”Ÿäº§çº¿æ˜¯é€šè¿‡å‡å°‘æ¯ä¸€é“å·¥åºçš„è€—è´¹æ—¶é—´æ¥æå‡æ•´æ¡æµæ°´çº¿æ•ˆç‡çš„ã€‚åœ¨CPUå†…éƒ¨ä¹Ÿæ˜¯å¦‚æ­¤ï¼ŒCPUå†…éƒ¨çš„æ•°å­—ç”µè·¯æ˜¯é æ—¶é’Ÿé©±åŠ¨æ¥å·¥ä½œçš„ï¼Œæ—¢ç„¶æ¯æ¡æŒ‡ä»¤çš„æ‰§è¡Œæ—¶é’Ÿå‘¨æœŸæ•°ä¸å˜ï¼Œå³æ‰§è¡Œæ¯æ¡æŒ‡ä»¤éœ€è¦3ä¸ªæ—¶é’Ÿå‘¨æœŸï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡ç¼©çŸ­æ—¶é’Ÿå‘¨æœŸçš„æ–¹æ³•æ¥æå‡æ•ˆç‡ï¼Œå³å‡å°‘æ¯æ¡æŒ‡ä»¤æ‰€è€—è´¹çš„æ—¶é—´ã€‚å‡å°‘æ—¶é’Ÿå‘¨æœŸï¼Œä¹Ÿå°±æ˜¯æå‡CPUä¸»é¢‘ï¼Œä¸€ä¸ªå…³é”®çš„åˆ¶çº¦å› ç´ å°±æ˜¯CPUå†…éƒ¨æ¯ä¸€ä¸ªæ‰§è¡Œå•å…ƒçš„è€—è´¹æ—¶é—´ã€‚è™½ç„¶è¯´ç”µä¿¡å·åœ¨ç”µè·¯ä¸­çš„ä¼ æ’­æ—¶é—´å¾ˆå¿«ï¼Œå¯ä»¥æ¥è¿‘å…‰é€Ÿï¼Œä½†æ˜¯ç»è¿‡æˆåƒä¸Šä¸‡çš„æ™¶ä½“ç®¡ï¼Œä¸åœåœ°ä¿¡å·ç¿»è½¬ï¼Œè¿˜æ˜¯ä¼šå¸¦æ¥ä¸€å®šçš„æ—¶é—´å»¶è¿Ÿï¼Œè¿™ä¸ªæ—¶é—´å»¶è¿Ÿæˆ‘ä»¬å¯ä»¥çœ‹åšè¿™é“å·¥ä½œçš„æ‰§è¡Œæ—¶é—´ã€‚ä»¥ä¸Šå›¾ä¸ºä¾‹ï¼Œå¦‚æœæ¯ä¸ªæ‰§è¡Œå•å…ƒçš„å»¶è¿Ÿæ˜¯ 1.5 çº³ç§’ï¼Œé‚£ä¹ˆä½ çš„æ—¶é’Ÿå‘¨æœŸè‡³å°‘ä¹Ÿå¾—2çº³ç§’ä»¥ä¸Šï¼Œå¦åˆ™ç”µè·¯å°±ä¼šå·¥ä½œå¼‚å¸¸ã€‚å¦‚æœé©±åŠ¨CPUå·¥ä½œçš„æ—¶é’Ÿå‘¨æœŸæ˜¯ 2 çº³ç§’ï¼ŒCPUçš„ä¸»é¢‘å°±æ˜¯ 500 MHzã€‚ç°åœ¨çš„CPUæµæ°´çº¿æ·±åº¦å¯ä»¥åšåˆ°10çº§ä»¥ä¸Šï¼Œæµæ°´çº¿çš„æ¯ä¸€çº§æ—¶é—´å»¶è¿Ÿå¯ä»¥åšåˆ°çš®ç§’çº§åˆ«ï¼Œé©±åŠ¨CPUå·¥ä½œçš„æ—¶é’Ÿå‘¨æœŸå¯ä»¥åšåˆ°æ›´çŸ­ï¼Œå› æ­¤å¯ä»¥æŠŠCPUçš„ä¸»é¢‘é£™åˆ° 5 GHz ä»¥ä¸Šã€‚</p>
<p>æˆ‘ä»¬æŠŠ5çº§ä»¥ä¸Šçš„æµæ°´çº¿ç§°ä¸ºè¶…æµæ°´çº¿ç»“æ„ã€‚é«˜æ€§èƒ½çš„å¤„ç†å™¨ï¼Œä¸ºäº†æå‡CPUä¸»é¢‘ï¼Œä¸€èˆ¬éƒ½ä¼šé‡‡ç”¨è¿™ç§è¶…æµæ°´çº¿ç»“æ„ã€‚Intelçš„ i7 å¤„ç†å™¨æœ‰16çº§æµæ°´çº¿ï¼ŒAMDçš„é€Ÿé¾™64ç³»åˆ—CPUæµæ°´çº¿ä¸º20çº§ã€‚å²ä¸Šå…·æœ‰æœ€é•¿æµæ°´çº¿çš„æ˜¯Intelçš„ç¬¬ä¸‰ä»£å¥”è…¾å››å¤„ç†å™¨ï¼Œæœ‰31çº§çš„æµæ°´çº¿ã€‚</p>
<p>æƒ³è¦æå‡CPUçš„ä¸»é¢‘ï¼Œæ ¹æœ¬åœ¨äºå‡å°‘æµæ°´çº¿ä¸­æ¯ä¸€çº§æµæ°´çš„æ‰§è¡Œæ—¶é—´ï¼Œæ¶ˆé™¤æœ¨æ¡¶çš„çŸ­æ¿æ•ˆåº”ï¼Œæ‰èƒ½æå‡æµæ°´çº¿çš„æ•´ä½“æ€§èƒ½ã€‚è§£å†³æ–¹æ³•æœ‰ä¸‰ä¸ªï¼šä¸€æ˜¯ä¼˜åŒ–æµæ°´çº¿ä¸­å„çº§æµæ°´çº¿çš„æ€§èƒ½ï¼Œå—é™äºå½“å‰é›†æˆç”µè·¯çš„è®¾è®¡æ°´å¹³ï¼Œè¿™ä¸€æ­¥æœ€éš¾ï¼›äºŒæ˜¯ä¾é é›†æˆç”µè·¯çš„åˆ¶é€ å·¥è‰ºï¼Œæ›´å…ˆè¿›çš„çº³ç±³å·¥è‰ºï¼ŒèŠ¯ç‰‡é¢ç§¯è¶Šå°ï¼Œå‘çƒ­è¶Šå°ï¼Œæ›´å®¹æ˜“æå‡ä¸»é¢‘ï¼›ä¸‰æ˜¯ä¸æ–­åœ°å¢åŠ æµæ°´çº¿ï¼Œæµæ°´çº¿è¶Šæ·±ï¼Œæµæ°´çº¿çš„å„çº§å»¶è¿Ÿå°±å¯ä»¥åšå¾—è¶Šå°ï¼Œæ›´å®¹æ˜“æé«˜ä¸»é¢‘ã€‚</p>
<p>æµæ°´çº¿æ˜¯å¦è¶Šæ·±è¶Šå¥½å‘¢ï¼Ÿéä¹Ÿã€‚æµæ°´çº¿çš„æœ¬è´¨æ˜¯æ‹¿ç©ºé—´æ¢æ—¶é—´ï¼Œæµæ°´çº¿è¶Šæ·±ï¼Œç”µè·¯å°±ä¼šè¶Šå¤æ‚ï¼Œéœ€è¦æ›´å¤šçš„ç»„åˆé€»è¾‘ç”µè·¯å’Œå¯„å­˜å™¨ï¼ŒèŠ¯ç‰‡é¢ç§¯ä¹Ÿå°±è¶Šå¤§ï¼ŒåŠŸè€—ä¹Ÿå°±éšä¹‹ä¸Šå‡äº†ã€‚æ‹¿åŠŸè€—å¢é•¿æ¢æ¥æ€§èƒ½æå‡ï¼Œåœ¨PCæœºå’ŒæœåŠ¡å™¨ä¸Šè¿˜è¡Œï¼Œä½†å¯¹äºå¾ˆå¤šé ç”µæ± ä¾›ç”µçš„ç§»åŠ¨è®¾å¤‡çš„å¤„ç†å™¨æ¥è¯´å°±æ— æ³•æ¥å—äº†ï¼ŒCPUè®¾è®¡äººå‘˜éœ€è¦åœ¨æ€§èƒ½å’ŒåŠŸè€—ä¹‹é—´åšä¸€ä¸ªå¾ˆå¥½çš„å¹³è¡¡ã€‚</p>
<p>æµæ°´çº¿è¶Šæ·±ï¼Œå°±è¶Šèƒ½æå‡æ€§èƒ½å—ï¼Ÿä¹Ÿä¸ä¸€å®šã€‚æµæ°´çº¿æ˜¯é æŒ‡ä»¤çš„å¹¶è¡Œæ¥æå‡æ€§èƒ½çš„ï¼Œç¬¬ä¸€æ¡æŒ‡ä»¤è¿˜æ²¡æœ‰æ‰§è¡Œå®Œï¼Œä¸‹é¢çš„ç¬¬äºŒæ¡æŒ‡ä»¤å°±å¼€å§‹å–æŒ‡ã€è¯‘ç äº†ã€‚æ‰§è¡Œçš„ç¨‹åºæŒ‡ä»¤å¦‚æœæ˜¯é¡ºåºç»“æ„ï¼Œæ²¡æœ‰ä¸­æ–­æˆ–è·³è½¬ï¼Œæµæ°´çº¿ç¡®å®å¯ä»¥æé«˜æ‰§è¡Œæ•ˆç‡ã€‚ä½†æ˜¯å½“ç¨‹åºæŒ‡ä»¤ä¸­å­˜åœ¨è·³è½¬ã€åˆ†æ”¯ç»“æ„æ—¶ï¼Œä¸‹é¢é¢„å–çš„æŒ‡ä»¤å¯èƒ½å°±è¦å…¨éƒ¨ä¸¢æ‰äº†ï¼Œéœ€è¦åˆ°è¦è·³è½¬çš„åœ°æ–¹é‡æ–°å–æŒ‡ä»¤æ‰§è¡Œã€‚å¦‚ä¸‹é¢çš„åˆ†æ”¯ï¼Œå¦‚æœBEQæ¡ä»¶ä¸æ»¡è¶³ï¼Œå¤„ç†å™¨å¯èƒ½å°±ä¼šå°†é¢„æœŸçš„ADDæŒ‡ä»¤å…¨éƒ¨ä¸¢å¼ƒï¼Œé‡æ–°åˆ°hereæ ‡ç­¾å¤„å–SUBæŒ‡ä»¤æ‰§è¡Œã€‚</p>
<figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="code"><pre><span class="line">BEQ R1, R2, here</span><br><span class="line">ADD R2, R1, R0</span><br><span class="line">ADD R5, R4, R3</span><br><span class="line">...</span><br><span class="line">here:</span><br><span class="line">SUB R2, R1, R0</span><br><span class="line">SUB R5, R4, R3</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>æµæ°´çº¿è¶Šæ·±ï¼Œä¸€æ—¦é¢„å–æŒ‡ä»¤å¤±è´¥ï¼Œæµªè´¹å’ŒæŸå¤±å°±ä¼šè¶Šä¸¥é‡ï¼Œå› ä¸ºæµæ°´çº¿ä¸­é¢„å–çš„å‡ åæ¡æŒ‡ä»¤å¯èƒ½éƒ½è¦ä¸¢å¼ƒæ‰ï¼Œæµæ°´çº¿å‘ç”Ÿäº†åœé¡¿ï¼Œæ— æ³•æŒ‰ç…§é¢„æœŸç»§ç»­æ‰§è¡Œï¼Œè¿™ç§æƒ…å†µæˆ‘ä»¬ä¸€èˆ¬ç§°ä¹‹ä¸ºæµæ°´çº¿å†’é™©ï¼ˆhazardï¼‰ã€‚åœ¨ç°åœ¨å¾ˆå¤šè¶…æµæ°´çº¿å¤„ç†å™¨ä¸­ï¼Œä¸ºäº†é¿å…è¿™ç§æƒ…å†µå‡ºç°ï¼Œä¼šé‡‡å–å„ç§å„æ ·çš„æ–¹æ³•å»é¿å…è¿™ç§æƒ…å†µï¼Œä»¥å…å½±å“å¤„ç†å™¨çš„æ€§èƒ½ã€‚</p>
<p>æµæ°´çº¿è¶Šæ·±ï¼Œä¸€æ—¦é¢„å–æŒ‡ä»¤å¤±è´¥ï¼Œæµªè´¹å’ŒæŸå¤±å°±ä¼šè¶Šä¸¥é‡ï¼Œå› ä¸ºæµæ°´çº¿ä¸­é¢„å–çš„å‡ åæ¡æŒ‡ä»¤å¯èƒ½éƒ½è¦ä¸¢å¼ƒæ‰ï¼Œæµæ°´çº¿å‘ç”Ÿäº†åœé¡¿ï¼Œæ— æ³•æŒ‰ç…§é¢„æœŸç»§ç»­æ‰§è¡Œï¼Œè¿™ç§æƒ…å†µæˆ‘ä»¬ä¸€èˆ¬ç§°ä¹‹ä¸ºæµæ°´çº¿å†’é™©ï¼ˆhazardï¼‰ã€‚åœ¨ç°åœ¨å¾ˆå¤šè¶…æµæ°´çº¿å¤„ç†å™¨ä¸­ï¼Œä¸ºäº†é¿å…è¿™ç§æƒ…å†µå‡ºç°ï¼Œä¼šé‡‡å–å„ç§å„æ ·çš„æ–¹æ³•å»é¿å…è¿™ç§æƒ…å†µå‘ç”Ÿï¼Œä»¥å…å½±å“å¤„ç†å™¨çš„æ€§èƒ½ã€‚</p>
]]></content>
      <categories>
        <category>è®¡ç®—æœº</category>
      </categories>
      <tags>
        <tag>è®¡ç®—æœºåŸºç¡€</tag>
        <tag>CPU</tag>
      </tags>
  </entry>
  <entry>
    <title>æ•°æ®ç»“æ„ä¹‹å¸ƒéš†è¿‡æ»¤å™¨</title>
    <url>/cs-data-structure-bloomfilter.html</url>
    <content><![CDATA[<hr>
<h4 id="æ¦‚å¿µ"><a href="#æ¦‚å¿µ" class="headerlink" title="æ¦‚å¿µ"></a>æ¦‚å¿µ</h4><p>ä¸€ç§ç©ºé—´é«˜æ•ˆçš„æ¦‚ç‡å‹æ•°æ®ç»“æ„ï¼Œç”¨äºåˆ¤æ–­ä¸€ä¸ªå…ƒç´ æ˜¯å¦å­˜åœ¨äºé›†åˆä¸­ã€‚</p>
<p>ç©ºé—´é«˜æ•ˆï¼šç”¨å‡ ä¸ªæ¯”ç‰¹ä½æ¥æ ‡è¯†å­˜åœ¨ä¸å¦ï¼Œä¸å ç”¨å¤ªå¤šå†…å­˜ç©ºé—´ã€‚<br>æ¦‚ç‡å‹ï¼šæœ‰å‡ ç‡æŠŠä¸€ä¸ªä¸å­˜åœ¨çš„å…ƒç´ åˆ¤å®šä¸ºå­˜åœ¨ã€‚</p>
<p>Hashè¡¨å­˜åœ¨çš„é—®é¢˜ï¼šæ•°æ®é‡å¾ˆå¤§æ—¶ï¼Œå ç”¨å†…å­˜å¤ªå¤šäº†ã€‚</p>
<h4 id="åŸºæœ¬æ“ä½œ"><a href="#åŸºæœ¬æ“ä½œ" class="headerlink" title="åŸºæœ¬æ“ä½œ"></a>åŸºæœ¬æ“ä½œ</h4><h5 id="æ’å…¥æ“ä½œï¼š"><a href="#æ’å…¥æ“ä½œï¼š" class="headerlink" title="æ’å…¥æ“ä½œï¼š"></a>æ’å…¥æ“ä½œï¼š</h5><p>åˆå§‹bitæ•°ç»„A[m-1]å…¨éƒ¨ç½®0ï¼Œé€šè¿‡æ˜ å°„å‡½æ•°ï¼Œå°†è¦æ’å…¥çš„å€¼éšæœºæ˜ å°„åˆ°æ•°ç»„èŒƒå›´å†…ï¼Œå°†è¯¥ä½ç½®ä¸º1</p>
<center>
    <img src="../images/bloom-filters-insert.png" width="50%"/>
</center>


<h5 id="æŸ¥æ‰¾æ“ä½œï¼š"><a href="#æŸ¥æ‰¾æ“ä½œï¼š" class="headerlink" title="æŸ¥æ‰¾æ“ä½œï¼š"></a>æŸ¥æ‰¾æ“ä½œï¼š</h5><p>å°†è¦æŸ¥æ‰¾çš„å…ƒç´ é€šè¿‡æ˜ å°„å‡½æ•°ï¼Œæ˜ å°„åˆ°æ•°ç»„ä¸­ï¼Œåˆ¤æ–­è¯¥bitä½æ˜¯å¦ä¸º1</p>
<center>
    <img src="../images/bloom-filters_03.png" width="50%"/>
</center>



<h4 id="åº”ç”¨ï¼š"><a href="#åº”ç”¨ï¼š" class="headerlink" title="åº”ç”¨ï¼š"></a>åº”ç”¨ï¼š</h4><ul>
<li>ç½‘é¡µçˆ¬è™«å¯¹ URL å»é‡ï¼Œé¿å…çˆ¬å–ç›¸åŒçš„ URL åœ°å€ï¼›</li>
<li>ååƒåœ¾é‚®ä»¶ï¼Œä»æ•°åäº¿ä¸ªåƒåœ¾é‚®ä»¶åˆ—è¡¨ä¸­åˆ¤æ–­æŸé‚®ç®±æ˜¯å¦åƒåœ¾é‚®ç®±ï¼›</li>
</ul>
<p><a href="https://freecontent.manning.com/all-about-bloom-filters/">å›¾ç‰‡æ¥æº</a></p>
]]></content>
      <tags>
        <tag>è®¡ç®—æœº</tag>
      </tags>
  </entry>
  <entry>
    <title>æŠ•èµ„å›æŠ¥ç‡</title>
    <url>/econonmics-roa-roe-roic-roce.html</url>
    <content><![CDATA[<h4 id="ä¸€ã€æ¦‚è¿°"><a href="#ä¸€ã€æ¦‚è¿°" class="headerlink" title="ä¸€ã€æ¦‚è¿°"></a>ä¸€ã€æ¦‚è¿°</h4><ul>
<li>èµ„äº§å›æŠ¥ç‡ï¼ˆROAï¼‰</li>
<li>å‡€èµ„äº§å›æŠ¥ç‡ï¼ˆROEï¼‰</li>
<li>æŠ•å…¥èµ„æœ¬å›æŠ¥ç‡ï¼ˆROICï¼‰</li>
<li>ä½¿ç”¨èµ„æœ¬å›æŠ¥ç‡ï¼ˆROCEï¼‰</li>
</ul>
<p>ä¸åŒçš„å›æŠ¥ç‡ï¼Œå®é™…ä¸Šæ˜¯è¡¡é‡å…¬å¸çš„ä¸åŒè§†è§’ã€‚</p>
<h4 id="äºŒã€èµ„äº§å›æŠ¥ç‡ï¼ˆROAï¼‰"><a href="#äºŒã€èµ„äº§å›æŠ¥ç‡ï¼ˆROAï¼‰" class="headerlink" title="äºŒã€èµ„äº§å›æŠ¥ç‡ï¼ˆROAï¼‰"></a>äºŒã€èµ„äº§å›æŠ¥ç‡ï¼ˆROAï¼‰</h4><h5 id="2-1-åŸºæœ¬æ¦‚å¿µ"><a href="#2-1-åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="2.1 åŸºæœ¬æ¦‚å¿µ"></a>2.1 åŸºæœ¬æ¦‚å¿µ</h5><p><strong>è¿ç”¨å…¨éƒ¨èµ„é‡‘è·å–åˆ©æ¶¦èƒ½åŠ›çš„é›†ä¸­ä½“ç°</strong></p>
<center>
    <img src="../images/ec-roa.png" width="50%"/>
</center>

<p>$$<br>    ROA=\frac{å‡€åˆ©æ¶¦}{æ€»èµ„äº§}<br>$$</p>
<h5 id="2-2-æ¦‚å¿µæ‹†åˆ†"><a href="#2-2-æ¦‚å¿µæ‹†åˆ†" class="headerlink" title="2.2 æ¦‚å¿µæ‹†åˆ†"></a>2.2 æ¦‚å¿µæ‹†åˆ†</h5><p>$$<br>    ROA = å‡€åˆ©æ¶¦ç‡NPM * èµ„äº§åˆ©ç”¨ç‡AU = \frac{å‡€åˆ©æ¶¦}{è¥ä¸šæ€»æ”¶å…¥} * \frac{è¥ä¸šæ€»æ”¶å…¥}{æ€»èµ„äº§} = \frac{ï¼ˆä¸»è¥ä¸šåŠ¡æ”¶å…¥+éä¸»è¥ä¸šåŠ¡æ”¶å…¥ï¼‰}{æ€»èµ„äº§}<br>$$</p>
<h5 id="2-3-æ¦‚å¿µç†è§£"><a href="#2-3-æ¦‚å¿µç†è§£" class="headerlink" title="2.3 æ¦‚å¿µç†è§£"></a>2.3 æ¦‚å¿µç†è§£</h5><p>ROAè¿™ä¸ªå›æŠ¥ç‡è¡¡é‡çš„æ˜¯èµ„äº§çš„å›æŠ¥ç‡ã€‚<br>ä½†æ˜¯ä¸€ä¸ªå…¬å¸èµ„äº§è´Ÿå€ºè¡¨ä¸Šçš„èµ„äº§ä»·å€¼æ›´å¤šçš„æ˜¯åæ˜ äº†å†å²è€Œä¸æ˜¯å½“å‰ï¼Œ<br>è€Œä¸”ä¸åŒçš„è¡Œä¸šçš„ROAå…·æœ‰ä¸å¯æ¯”æ€§ã€‚<br>æœ€ç®€å•çš„ä¾‹å­ï¼Œå¾ˆå¤šç±»é‡‘èä¼ä¸šæœ‰æ— æ¯æµåŠ¨è´Ÿå€ºï¼Œå¢åŠ äº†æ€»èµ„äº§ï¼Œé™ä½äº†ROAï¼Œ<br>ä½†æ˜¯æ— å¿ä½¿ç”¨ä¸Šä¸‹æ¸¸èµ„é‡‘å®é™…ä¸Šæ˜¯å…¬å¸æœ‰ç«äº‰åŠ›çš„ä½“ç°ã€‚</p>
<h4 id="ä¸‰ã€å‡€èµ„äº§å›æŠ¥ç‡ï¼ˆROEï¼‰"><a href="#ä¸‰ã€å‡€èµ„äº§å›æŠ¥ç‡ï¼ˆROEï¼‰" class="headerlink" title="ä¸‰ã€å‡€èµ„äº§å›æŠ¥ç‡ï¼ˆROEï¼‰"></a>ä¸‰ã€å‡€èµ„äº§å›æŠ¥ç‡ï¼ˆROEï¼‰</h4><h5 id="2-1-åŸºæœ¬æ¦‚å¿µ-1"><a href="#2-1-åŸºæœ¬æ¦‚å¿µ-1" class="headerlink" title="2.1 åŸºæœ¬æ¦‚å¿µ"></a>2.1 åŸºæœ¬æ¦‚å¿µ</h5><p>ROEçš„è§†è§’æ˜¯ä»è‚¡ä¸œçš„è§’åº¦çœ‹é—®é¢˜ï¼Œå•çº¯ä»è‚¡æƒçš„è§’åº¦è¡¡é‡å›æŠ¥ï¼Œè€Œä¸è€ƒè™‘å…¬å¸çš„èµ„æœ¬ç»“æ„åŠè´Ÿå€ºæƒ…å†µã€‚è¡¡é‡å…¬å¸èµšé’±çš„æ•ˆç‡ã€‚</p>
<center>
    <img src="../images/ec-roe.png" width="50%"/>
</center>

<p>$$<br>    å‡€èµ„äº§æ”¶ç›Šç‡ = \frac{å‡€åˆ©æ¶¦}{å‡€èµ„äº§}<br>$$</p>
<blockquote>
<p>Aå…¬å¸ï¼š10äº¿å‡€èµ„äº§èµš2äº¿ã€‚ROE = 20%<br>Bå…¬å¸ï¼š50äº¿å‡€èµ„äº§èµš5äº¿ã€‚ROE = 10%</p>
</blockquote>
<h5 id="2-2-æ¦‚å¿µæ‹†åˆ†-1"><a href="#2-2-æ¦‚å¿µæ‹†åˆ†-1" class="headerlink" title="2.2 æ¦‚å¿µæ‹†åˆ†"></a>2.2 æ¦‚å¿µæ‹†åˆ†</h5><p>$$<br>    å‡€èµ„äº§æ”¶ç›Šç‡ = \frac{å‡€åˆ©æ¶¦}{å‡€èµ„äº§} = \frac{å‡€åˆ©æ¶¦}{è¥ä¸šæ”¶å…¥} * \frac{è¥ä¸šæ”¶å…¥}{æ€»èµ„äº§} * \frac{æ€»èµ„äº§}{å‡€èµ„äº§}<br>$$</p>
<p>$$<br>    å‡€èµ„äº§æ”¶ç›Šç‡ = å‡€åˆ©æ¶¦ * èµ„äº§å‘¨è½¬ç‡ * æƒç›Šä¹˜æ•°<br>$$</p>
<p>$$<br>    æƒç›Šä¹˜æ•° = \frac{æ€»èµ„äº§}{å‡€èµ„äº§}<br>$$</p>
<p>$$<br>    èµ„äº§å‘¨è½¬ç‡ = \frac{è¥ä¸šæ”¶å…¥}{æ€»èµ„äº§}<br>$$</p>
<p>å½±å“å› ç´ ï¼š</p>
<ul>
<li>å‡€åˆ©æ¶¦ï¼šååº”ç›ˆåˆ©èƒ½åŠ›</li>
<li>èµ„äº§å‘¨è½¬ç‡ï¼šååº”èµ„äº§ä½¿ç”¨æ•ˆç‡</li>
<li>æƒç›Šä¹˜æ•°ï¼šååº”è´Ÿå€ºç¨‹åº¦</li>
</ul>
<p>æå‡ROEçš„åŠæ³•ï¼š</p>
<ul>
<li>æé«˜å‘¨è½¬ç‡</li>
<li>å»‰ä»·çš„å€ºåŠ¡æ æ†</li>
<li>æ›´é«˜çš„å€ºåŠ¡æ æ†</li>
<li>æ›´ä½çš„æ‰€å¾—ç¨</li>
<li>æ›´é«˜çš„è¿è¥åˆ©æ¶¦ç‡</li>
</ul>
<h5 id="2-3-æ¦‚å¿µç†è§£-1"><a href="#2-3-æ¦‚å¿µç†è§£-1" class="headerlink" title="2.3 æ¦‚å¿µç†è§£"></a>2.3 æ¦‚å¿µç†è§£</h5><p>ROEå¯¹è‚¡ä¸œæ¥è¯´æ„ä¹‰æœ€å¤§ï¼Œæ˜¯è‚¡ç¥¨å¤åˆ©å¢é•¿çš„æºæ³‰ã€‚<br>ROEå¯ä»¥åœ¨ä¸åŒè¡Œä¸šä¸ä¸åŒä¼ä¸šä¹‹é—´æ¨ªå‘æ¯”è¾ƒã€‚<br>ç›¸å½“äºè‚¡ç¥¨è¿™ç§â€œè‚¡æƒå€ºåˆ¸â€çš„æ”¶ç›Šç‡ã€‚<br>å¯¹æŠ•èµ„äººæ¥è¯´æ— è®ºæ˜¯æŠ•èµ„é“è·¯è¿˜æ˜¯äº’è”ç½‘ï¼Œéƒ½ç›¸å½“äºæ˜¯ä¹°äº†â€œè‚¡æƒå€ºåˆ¸â€ã€‚<br>åœ¨åŒç­‰é£é™©æƒ…å†µä¸‹ï¼Œå½“ç„¶æ˜¯æ”¶ç›Šç‡è¶Šé«˜è¶Šå¥½ã€‚<br>è€Œä¸”ï¼ŒROEè¿˜å¯ä»¥ä¸æ”¿åºœå€ºåˆ¸ã€ä¼ä¸šå€ºåˆ¸çš„æ”¶ç›Šç‡è·¨èµ„äº§ç±»åˆ«æ¨ªå‘æ¯”è¾ƒã€‚</p>
<h5 id="ä¸è¶³"><a href="#ä¸è¶³" class="headerlink" title="ä¸è¶³"></a>ä¸è¶³</h5><p>ROEçš„é—®é¢˜åœ¨äºæ— æ³•åæ˜ å€ºåŠ¡æ æ†å¯¹å‡€åˆ©æ¶¦çš„å½±å“ã€‚<br>å¦‚æœä¸€ä¸ªä¼ä¸šå€Ÿæ›´å¤šçš„å€ºï¼Œä¸€èˆ¬å°±èƒ½äº§ç”Ÿæ›´å¤šå‡€åˆ©æ¶¦ï¼ŒROEä¹Ÿä¼šæé«˜ã€‚<br>ä½†æ˜¯è¿™æ ·çš„æé«˜æ˜¯ä»¥ç‰ºç‰²ä¼ä¸šç»è¥ç¨³å¥ç¨‹åº¦ä¸ºä»£ä»·çš„ã€‚<br>å› æ­¤ï¼Œåˆ†æROEä¸€å®šè¦ç»“åˆæœé‚¦å…¬å¼ï¼Œå¹¶ä¸åŒè¡Œä¸šè¿›è¡Œæ¯”è¾ƒã€‚</p>
<hr>
<h4 id="å››ã€æŠ•å…¥èµ„æœ¬å›æŠ¥ç‡ï¼ˆROICï¼‰"><a href="#å››ã€æŠ•å…¥èµ„æœ¬å›æŠ¥ç‡ï¼ˆROICï¼‰" class="headerlink" title="å››ã€æŠ•å…¥èµ„æœ¬å›æŠ¥ç‡ï¼ˆROICï¼‰"></a>å››ã€æŠ•å…¥èµ„æœ¬å›æŠ¥ç‡ï¼ˆROICï¼‰</h4><center>
    <img src="../images/ec-roic-1.png" width="50%"/>
</center>


<p>ROICæ˜¯ä»èµ„æœ¬çš„è§’åº¦çœ‹é—®é¢˜ï¼Œç»¼åˆè€ƒè™‘è‚¡æƒä¸å€ºæƒï¼Œè¡¡é‡æŠ•èµ„çš„æ•ˆç‡ã€‚ä¸ROICå¯¹åº”çš„æ˜¯å¹³å‡èµ„é‡‘æˆæœ¬ï¼ˆWACCï¼‰ã€‚å¦‚æœROICå°äºWACCï¼Œå°±è¯´æ˜æŠ•å…¥èµ„æœ¬çš„å›æŠ¥å°äºå¹³å‡èµ„æœ¬æˆæœ¬ï¼Œå…¬å¸æ˜¯åœ¨æµªè´¹èµ„æœ¬ã€‚</p>
<p>ROIC=æ¯ç¨å‰æ”¶ç›Šï¼ˆEBITï¼‰*ï¼ˆ1-ç¨ç‡ï¼‰/æŠ•å…¥èµ„æœ¬</p>
<p>$$<br>    ROIC = \frac{æ¯ç¨å‰æ”¶ç›Šï¼ˆEBITï¼‰*ï¼ˆ1-ç¨ç‡ï¼‰}{æŠ•å…¥èµ„æœ¬}<br>$$</p>
<p>$$<br>    æŠ•å…¥èµ„æœ¬ = è‚¡ä¸œæƒç›Š + æœ‰æ¯è´Ÿå€º<br>$$</p>
<p>$$<br>    ROIC = \frac{EBITï¼ˆ1-ç¨ç‡ï¼‰}{æœ‰æ¯è´Ÿå€º+æƒç›Šï¼‰}<br>$$</p>
<p>å…¬å¼ä¸­åˆ†å­æ˜¯æŒ‡ä¸€å®¶å…¬å¸å¦‚æœå®Œå…¨ä»¥æƒç›Šç­¹èµ„æ‰€åº”æŠ¥å‘Šçš„å‡€åˆ©æ¶¦ï¼Œåˆ†æ¯æ˜¯æŒ‡å…¬å¸æ‰€æœ‰è¦æ±‚å›æŠ¥çš„ç°é‡‘æ¥æºçš„æ€»å’Œï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå°½ç®¡åº”ä»˜è´¦æ¬¾ä¹Ÿæ˜¯å…¬å¸çš„ä¸€ç§ç°é‡‘æ¥æºï¼Œä½†å› å…¶æœªé™„å¸¦æ˜ç¡®çš„æˆæœ¬è€Œè¢«æ’é™¤åœ¨å¤–ã€‚å®è´¨ä¸Šï¼ŒROICæ˜¯ç”Ÿäº§ç»è¥æ´»åŠ¨ä¸­æ‰€æœ‰æŠ•å…¥èµ„æœ¬èµšå–çš„æ”¶ç›Šç‡ï¼Œè€Œä¸è®ºè¿™äº›æŠ•å…¥èµ„æœ¬æ˜¯è¢«ç§°ä¸ºå€ºåŠ¡è¿˜æ˜¯æƒç›Šã€‚</p>
<center>
    <img src="../images/ec-roic-2.png" width="50%"/>
</center>


<p>æŠ•å…¥èµ„æœ¬å›æŠ¥ç‡æ˜¯EBITï¼ˆç¨åŠåˆ©æ¯å‰ç›ˆåˆ©ï¼‰ç»è¿‡ç¨ç‡è°ƒæ•´æ¯”ä¸ŠæŠ•å…¥çš„èµ„æœ¬ï¼Œä¹Ÿå°±æ˜¯è‚¡ä¸œæƒç›ŠåŠ è´Ÿå€ºå‡å»éè¿è¥ç°é‡‘å’ŒæŠ•èµ„ã€‚ä¹‹æ‰€ä»¥ç”¨EBITå°±æ˜¯å› ä¸ºåˆ©æ¯æ˜¯ç”±å€ºåŠ¡äº§ç”Ÿçš„ï¼Œæ˜¯å¯¹å€ºæƒçš„å›æŠ¥ï¼Œå½“è®¡ç®—å€ºæƒåŠ è‚¡æƒçš„æ€»çš„æŠ•å…¥èµ„æœ¬çš„å›æŠ¥ç‡æ—¶åº”è¯¥æŠŠåˆ©æ¯åŠ å›æ¥ã€‚</p>
<p>æŠ•å…¥èµ„æœ¬ä¹Ÿå¯ä»¥è¡¨ç¤ºä¸ºå‡€è¿è¥èµ„é‡‘ï¼ˆæµåŠ¨è¿è¥èµ„äº§å‡å»æ— æ¯æµåŠ¨è´Ÿå€ºï¼‰åŠ å›ºå®šèµ„äº§ï¼ŒåŠ æ— å½¢èµ„äº§åŠå•†èª‰ï¼ŒåŠ å…¶ä»–è¿è¥èµ„äº§ã€‚</p>
<p>ROICçš„é—®é¢˜åœ¨äºæ²¡æœ‰è€ƒè™‘æ— æ¯æµåŠ¨è´Ÿå€ºçš„å½±å“ã€‚ROICå®é™…ä¸Šæ˜¯è¡¡é‡æŠ•å…¥çš„æ€»èµ„æœ¬çš„ä½¿ç”¨æ•ˆç‡ï¼Œä¸å¹³å‡èµ„é‡‘æˆæœ¬WACCç›¸ç»“åˆå¯ä»¥æ­ç¤ºä¸€ä¸ªä¼ä¸šçš„çœŸæ­£æ•ˆç‡ã€‚ROIC &lt; WACC æ˜¯å–ç©ºå¤§å¸ˆJim Chanosç»å¸¸ç”¨æ¥å¯»æ‰¾å–ç©ºå¯¹è±¡çš„ä¸€ä¸ªé‡è¦æŒ‡æ ‡ã€‚</p>
<p>ä½†æ˜¯ï¼ŒROICå¯¹äºç±»é‡‘èä¼ä¸šçš„åˆ†æä¸å¤ªå®¹æ˜“ã€‚ä¸€äº›ç±»é‡‘èä¼ä¸šå¦‚å›½ç¾ã€è‹å®ã€è”æƒ³ã€æ ¼åŠ›ç­‰ï¼Œå ç”¨äº†å¤§é‡ä¸Šä¸‹æ¸¸èµ„é‡‘ä½œä¸ºæ— æ¯æµåŠ¨è´Ÿå€ºï¼Œå› æ­¤æé«˜äº†EBITã€‚ä½†æ˜¯ï¼Œå’Œæœ‰æ¯è´Ÿå€ºä¸€æ ·ï¼Œæ— æ¯è´Ÿå€ºä¹Ÿå­˜åœ¨é£é™©ã€‚è™½ç„¶ä¸ç”¨ä»˜åˆ©æ¯ï¼Œä½†æ˜¯ä¸€æ—¦ç»è¥å½¢å¼æ”¹å˜ï¼Œè¿™äº›èµ„é‡‘å¾ˆæœ‰å¯èƒ½åƒâ€œçƒ­é’±â€ä¸€æ ·æ’¤èµ°ã€‚å›½ç¾åœ¨é»„å…‰è£•è¢«æ•åå°±é™·å…¥äº†è¿™æ ·çš„å±é™©å¢ƒåœ°ï¼Œåªè¦ä¾›åº”å•†æ’¤èµ„ï¼Œå›½ç¾å°±ä¼šç ´äº§ã€‚è¿™äº›ä¼ä¸šè™½ç„¶ROICå¾ˆé«˜ï¼Œä½†æ˜¯é™æ€ä¸ç¨³å®šï¼ŒåŠ¨æ€ç¨³å®šã€‚</p>
<h4 id="äº”ã€ä½¿ç”¨èµ„æœ¬å›æŠ¥ç‡-ROCE-Return-on-Capital-Employed"><a href="#äº”ã€ä½¿ç”¨èµ„æœ¬å›æŠ¥ç‡-ROCE-Return-on-Capital-Employed" class="headerlink" title="äº”ã€ä½¿ç”¨èµ„æœ¬å›æŠ¥ç‡(ROCE = Return on Capital Employed)"></a>äº”ã€ä½¿ç”¨èµ„æœ¬å›æŠ¥ç‡(ROCE = Return on Capital Employed)</h4><center>
    <img src="../images/ec-roce.png" width="50%"/>
</center>

<p>$$<br>    ROCEè³‡æœ¬é‹ç”¨å ±é…¬ç‡ = \frac{æ¯ç¨å‰æ”¶ç›Šï¼ˆEBITï¼‰}{å·²å‹•ç”¨è³‡æœ¬(Capital Employed)}<br>$$</p>
<p>$$<br>    å·²å‹•ç”¨è³‡æœ¬ = ç¸½è³‡ç”¢ -æµå‹•è² å‚µ<br>$$</p>
<p>ROCEå®è´¨ä¸Šæ˜¯ä»ä¼ä¸šä»·å€¼ï¼ˆEnterpriseValueï¼ŒEVï¼‰çš„è§’åº¦ï¼Œä»å¹¶è´­çš„è§’åº¦çœ‹èµ„æœ¬çš„å›æŠ¥ç‡ã€‚ROCEä¸­çš„ä½¿ç”¨èµ„æœ¬æ˜¯è‚¡ä¸œæƒç›ŠåŠ æœ‰æ¯è´Ÿå€ºå†å‡ç°é‡‘ã€‚è¿™å®è´¨ä¸Šç›¸å½“äº1å€PBå¹¶è´­ä¼ä¸šæ—¶çš„ä¼ä¸šä»·å€¼ã€‚å› ä¸ºå¦‚æœä½ ä»¥1å€PBå¹¶è´­ä¸€ä¸ªä¼ä¸šï¼Œä½ è¦ä»˜çš„ä»·æ ¼å°±æ˜¯è‚¡ä¸œæƒç›Šï¼Œå¹¶ä¸”æ‰¿æ‹…æ‰€æœ‰è´Ÿå€ºï¼Œä½†ä¹Ÿè·å¾—æ‰€æœ‰ç°é‡‘ã€‚</p>
<p>ROCEå®é™…ä¸Šæ˜¯ä»ä¸€ä¸ªå¹¶è´­è€…çš„è§’åº¦çœ‹é—®é¢˜ï¼Œå¦‚æœå¹¶è´­ä¸€ä¸ªä¼ä¸šï¼Œä»˜å‡ºä¼ä¸šä»·å€¼EVåçš„å›æŠ¥ç‡æœ‰å¤šå°‘ï¼Ÿè¿™ä¸ROICæœ€å¤§çš„ä¸åŒæ˜¯ï¼šROICä»ä¼ä¸šçš„æ‹¥æœ‰è€…çš„è§’åº¦çœ‹é—®é¢˜ï¼Œè¡¡é‡æŠ•å…¥èµ„æœ¬çš„ä½¿ç”¨æ•ˆç‡ä¸å›æŠ¥ç‡ã€‚è€ŒROCEæ˜¯ä»æ½œåœ¨å¹¶è´­è€…çš„è§’åº¦çœ‹é—®é¢˜ï¼Œè¡¡é‡å¦‚æœ1å€PBå¹¶è´­ä»˜å‡ºEVåçš„å›æŠ¥ç‡ï¼Œä¹Ÿå°±æ˜¯å¹¶è´­åˆ°åº•å€¼ä¸å€¼çš„é—®é¢˜ã€‚è¿™æ¥è¿‘ä»·å€¼æŠ•èµ„ä¹°è‚¡ç¥¨å°±æ˜¯ä¹°å…¬å¸çš„åŸåˆ™ã€‚</p>
<p>ROCEï¼šä½¿ç”¨èµ„æœ¬å›æŠ¥ç‡æ˜¯EBITï¼ˆç¨åŠåˆ©æ¯å‰ç›ˆåˆ©ï¼‰æ¯”ä¸Šä½¿ç”¨çš„èµ„æœ¬ï¼Œä¹Ÿå°±æ˜¯æ‰€æœ‰æœ‰æ¯è´Ÿå€ºåŠ ä¸Šè‚¡ä¸œæƒç›Šã€‚è¿™ä¸ªæŒ‡æ ‡ä¸ROICç›¸è¿‘ï¼Œä½†æ˜¯ä½¿ç”¨çš„æ˜¯EBITè€Œæ²¡æœ‰ç»è¿‡ç¨ç‡è°ƒæ•´ï¼Œå› æ­¤å¯ä»¥ç”¨æ¥æ¯”è¾ƒä¸åŒç¨ç‡çš„ä¼ä¸šã€‚ROCEä¹Ÿå®¹æ˜“å¿½è§†å…¬å¸æ— æ¯è´Ÿå€ºçš„èèµ„æ•ˆåº”ã€‚</p>
<p>æ€»ä¹‹ï¼Œæœ¬è´¨ä¸Šæ˜¯ä»å››ä¸ªä¸åŒçš„è§†è§’çœ‹é—®é¢˜ï¼Œè¡¡é‡ä¸åŒçš„æŒ‡æ ‡ã€‚åªæœ‰å…¨é¢ç»¼åˆè€ƒè™‘ï¼Œæ‰èƒ½æ›´å…¨é¢çš„çœ‹é—®é¢˜</p>
<h4 id="å…­ã€å‚è€ƒæ¥æº"><a href="#å…­ã€å‚è€ƒæ¥æº" class="headerlink" title="å…­ã€å‚è€ƒæ¥æº"></a>å…­ã€å‚è€ƒæ¥æº</h4><p><a href="https://xueqiu.com/1484348349/107966592">é›ªçƒ-è€éŸ©7</a><br><a href="https://rich01.com/what-is-roce/">ROCEè³‡æœ¬é‹ç”¨å ±é…¬ç‡</a></p>
]]></content>
      <categories>
        <category>ç»æµå­¦</category>
      </categories>
      <tags>
        <tag>ç»æµå­¦</tag>
      </tags>
  </entry>
  <entry>
    <title>æ“ä½œç³»ç»Ÿä¹‹æ–‡ä»¶ç³»ç»Ÿ</title>
    <url>/cs-operating-systems-file-system.html</url>
    <content><![CDATA[<hr>
<h5 id="ä¸€ã€ç£ç›˜çš„ç»“æ„"><a href="#ä¸€ã€ç£ç›˜çš„ç»“æ„" class="headerlink" title="ä¸€ã€ç£ç›˜çš„ç»“æ„"></a>ä¸€ã€ç£ç›˜çš„ç»“æ„</h5><p>ç£ç›˜æŒ‰ç…§ç‰©ç†ç»“æ„å’Œé€»è¾‘ç»“æ„åŒºåˆ†æ¯”è¾ƒå¥½ã€‚</p>
<p>1.1 HDDç‰©ç†ç»“æ„(Hard Disk Drive)</p>
<ul>
<li>Plattersï¼šç›˜ç‰‡</li>
<li>Headï¼šè¯»å†™å¤´</li>
<li>Spindleï¼šä¸»è½´</li>
<li>Actuator Armï¼šæœºæ¢°è‡‚</li>
<li>Cylinder:æŸ±é¢</li>
<li>Sectorï¼šæ‰‡åŒº</li>
<li>Trackï¼šç£é“ï¼š</li>
</ul>
<center>
    <img src="../images/hard-disk-structure.png" width="250"/>
    <img src="../images/hard-disk-structure-2.jpeg" width="250"/>
    <img src="../images/hard-disk-structure-3.jpeg" width="250"/>
</center>

<p>1.2 SSDçš„ç‰©ç†ç»“æ„(Solid State Drive)</p>
<p>1.2.1 åŸºæœ¬å­˜å‚¨å•å…ƒ</p>
<center>
    <img src="../images/ssd-unit.jpg" width="250"/>
</center>

<p>é€šè¿‡å‘è¢«ç»ç¼˜å±‚åŒ…å›´çš„æµ®æ …å±‚å……æ”¾ç”µæ¥å†™å…¥æ“¦é™¤æ•°æ®ã€‚ï¼ˆéæ˜“å¤±å­˜å‚¨å™¨ï¼‰</p>
<p>1.3 é€»è¾‘ç»“æ„</p>
<p>æ–‡ä»¶ç³»ç»Ÿblock -&gt; ç£ç›˜block -&gt; n * æ‰‡åŒº</p>
<center>
    <img src="../images/file_system_ext2_group.jpeg" width="250"/>
</center>

<center>
    <img src="../images/file_system_ext2_block.jpeg" width="250"/>
</center>



<h5 id="äºŒã€æ–‡ä»¶ç³»ç»ŸæŒ‚è½½"><a href="#äºŒã€æ–‡ä»¶ç³»ç»ŸæŒ‚è½½" class="headerlink" title="äºŒã€æ–‡ä»¶ç³»ç»ŸæŒ‚è½½"></a>äºŒã€æ–‡ä»¶ç³»ç»ŸæŒ‚è½½</h5><p>æ–‡ä»¶ç³»ç»Ÿç”Ÿæˆåï¼Œè¿˜ä¸èƒ½ç›´æ¥ä½¿ç”¨ï¼Œéœ€è¦å€ŸåŠ©â€mountâ€æ“ä½œï¼Œå°†è¿™ä¸ªæ–‡ä»¶ç³»ç»ŸåŠ å…¥åˆ°Linuxçš„ç®¡ç†ï¼Œè¿™æ ·ç”¨æˆ·æ‰èƒ½çœ‹åˆ°å¹¶è®¿é—®</p>
<h5 id="ä¸‰ã€è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿ"><a href="#ä¸‰ã€è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿ" class="headerlink" title="ä¸‰ã€è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿ"></a>ä¸‰ã€è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿ</h5><center>
    <img src="../images/file_system_structure.jpg" width="250"/>
</center>


<p>è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿä¸ºå„ç§æ–‡ä»¶ç³»ç»Ÿæä¾›ä¸€ä¸ªé€šç”¨çš„æ¥å£ï¼Œå…¶æ”¯æŒçš„æ–‡ä»¶ç³»ç»Ÿå¯ä»¥åˆ’åˆ†ä¸ºä¸‰ç§ä¸»è¦ç±»å‹ï¼š</p>
<ul>
<li>ç£ç›˜æ–‡ä»¶ç³»ç»Ÿï¼ˆEXT3ã€NTFSï¼‰</li>
<li>ç½‘ç»œæ–‡ä»¶ç³»ç»Ÿ</li>
<li>ç‰¹æ®Šæ–‡ä»¶ç³»ç»Ÿï¼ˆ/procï¼‰</li>
</ul>
<p>è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿé€šè¿‡å¼•å…¥ä¸€å¥—é€šç”¨çš„æ–‡ä»¶æ¨¡å‹æ¥æ”¯æŒæ‰€æœ‰çš„æ–‡ä»¶ç³»ç»Ÿï¼Œé€šç”¨æ¨¡å‹ç”±å››å¤§å¯¹è±¡ç»„æˆï¼š</p>
<ul>
<li>è¶…çº§å—å¯¹è±¡</li>
<li>ç´¢å¼•èŠ‚ç‚¹å¯¹è±¡</li>
<li>ç›®å½•é¡¹å¯¹è±¡</li>
<li>æ–‡ä»¶å¯¹è±¡</li>
</ul>
<p>3.1 è¶…çº§å¿«å¯¹è±¡ï¼šä»£è¡¨ä¸€ä¸ªå…·ä½“çš„å·²å®‰è£…æ–‡ä»¶ç³»ç»Ÿ</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">super_block</span> &#123;</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">super_operations</span> <span class="title">s_op</span>;</span><span class="comment">//æ“ä½œå¯¹è±¡</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>3.2 ç´¢å¼•èŠ‚ç‚¹å¯¹è±¡ï¼šä»£è¡¨ä¸€ä¸ªå…·ä½“çš„æ–‡ä»¶</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">inode</span> &#123;</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">inode_operations</span> *<span class="title">i_op</span>;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>3.3 ç›®å½•é¡¹å¯¹è±¡ï¼šä»£è¡¨ä¸€ä¸ªç›®å½•é¡¹ï¼Œæ˜¯è·¯å¾„çš„ä¸€ä¸ªç»„æˆéƒ¨åˆ†</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">dentry</span> &#123;</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">dentry_operations</span> *<span class="title">d_op</span>;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>3.4 æ–‡ä»¶å¯¹è±¡ï¼šä»£è¡¨ç”±è¿›ç¨‹æ‰“å¼€çš„æ–‡ä»¶</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">file</span> &#123;</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">file_operations</span> *<span class="title">f_op</span>;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h5 id="å››ã€ç›¸å…³ç³»ç»Ÿè°ƒç”¨"><a href="#å››ã€ç›¸å…³ç³»ç»Ÿè°ƒç”¨" class="headerlink" title="å››ã€ç›¸å…³ç³»ç»Ÿè°ƒç”¨"></a>å››ã€ç›¸å…³ç³»ç»Ÿè°ƒç”¨</h5><table>
<thead>
<tr>
<th align="left">ç³»ç»Ÿè°ƒç”¨</th>
<th align="left">è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td align="left">mount() unmount() unmount2()</td>
<td align="left">å®‰è£…å¸è½½æ–‡ä»¶ç³»ç»Ÿ</td>
</tr>
<tr>
<td align="left">mkdir() rmdir()</td>
<td align="left">åˆ›å»ºåˆ é™¤ç›®å½•</td>
</tr>
<tr>
<td align="left">unlink() rename()</td>
<td align="left">å¯¹ç›®å½•é¡¹è¿›è¡Œæ“ä½œ</td>
</tr>
<tr>
<td align="left">mmap() mmap2() munmap()</td>
<td align="left">å¤„ç†æ–‡ä»¶å†…å­˜æ˜ å°„</td>
</tr>
<tr>
<td align="left">read() write()</td>
<td align="left">è¿›è¡Œæ–‡ä»¶IOæ“ä½œ</td>
</tr>
<tr>
<td align="left">select() poll()</td>
<td align="left">ç­‰å¾…ä¸€ç»„æ–‡ä»¶æè¿°ç¬¦ä¸Šå‘ç”Ÿäº‹ä»¶</td>
</tr>
<tr>
<td align="left">open() close() create()</td>
<td align="left">æ‰“å¼€å…³é—­åˆ›å»º</td>
</tr>
<tr>
<td align="left">chmod() fchmod() utime()</td>
<td align="left">æ›´æ”¹æ–‡ä»¶å±æ€§</td>
</tr>
</tbody></table>
<h5 id="äº”ã€å‚è€ƒæ–‡çŒ®"><a href="#äº”ã€å‚è€ƒæ–‡çŒ®" class="headerlink" title="äº”ã€å‚è€ƒæ–‡çŒ®"></a>äº”ã€å‚è€ƒæ–‡çŒ®</h5><p><a href="https://z.itpub.net/article/detail/8ABB71A5EFED33EA9D09353759A91F1C">https://z.itpub.net/article/detail/8ABB71A5EFED33EA9D09353759A91F1C</a></p>
<p><a href="http://chuquan.me/2022/05/01/understand-principle-of-filesystem/">æ·±å…¥ç†è§£ Linux Ext æ–‡ä»¶ç³»ç»Ÿè®¾è®¡åŸç†</a></p>
<p><a href="https://www.cnblogs.com/f-ck-need-u/p/7016077.html#auto_id_4">ç¬¬4ç«  extæ–‡ä»¶ç³»ç»Ÿæœºåˆ¶åŸç†å‰–æ </a></p>
<p><a href="https://www.eet-china.com/mp/a38145.html">Linux è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿå››å¤§å¯¹è±¡ï¼šè¶…çº§å—ã€inodeã€dentryã€fileä¹‹é—´å…³ç³»</a></p>
<p><a href="https://www.cnblogs.com/huxiao-tee/p/4657851.html">ä»å†…æ ¸æ–‡ä»¶ç³»ç»Ÿçœ‹æ–‡ä»¶è¯»å†™è¿‡ç¨‹ </a></p>
]]></content>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title>å¼€å‘è€…ä¸ƒæ¡</title>
    <url>/ep-good-developer-manifesto.html</url>
    <content><![CDATA[<p>è½¯ä»¶å¼€å‘ä¸åªæ˜¯APIè°ƒç”¨å’ŒåŸºç¡€è¯­æ³•ï¼Œä»¥ä¸‹æ˜¯åº”ç”¨å¼€å‘çš„å…¨è²Œï¼š</p>
<h4 id="ä¸€ã€ç›¸ä¿¡æ•°æ®"><a href="#ä¸€ã€ç›¸ä¿¡æ•°æ®" class="headerlink" title="ä¸€ã€ç›¸ä¿¡æ•°æ®"></a>ä¸€ã€ç›¸ä¿¡æ•°æ®</h4><p>å¦‚æœä½ è§‰å¾—ç³»ç»Ÿæ­£å¸¸è¿è½¬ï¼Œä½ åº”è¯¥æ‹¿å‡ºæ•°æ®æ”¯æ’‘ä½ çš„æƒ³æ³•ã€‚æ›´é‡è¦çš„æ˜¯ï¼Œå½“ç ”ç©¶è¯æ˜ä½ æ˜¯é”™çš„æ—¶ï¼Œä½ åº”è¯¥æ¬£ç„¶æ¥å—å®äº‹ã€‚<br>è¿™å°±éœ€è¦åšæµ‹è¯•æ¥éªŒè¯ä½ çš„ä»£ç ï¼Œä¹Ÿéœ€è¦ä¸€äº›æµç¨‹æ¥ç”Ÿæˆå¯¹åº”çš„æ•°æ®ã€‚<br>ä½ åšçš„ä»»ä½•äº‹éƒ½éœ€è¦æ•°æ®æ¥è¾…åŠ©ä½ ä¸‹ä¸€æ­¥çš„å†³ç­–ã€‚å¦åˆ™ä½ å°†ä¸çŸ¥é“è‡ªå·±åšçš„äº‹æ˜¯å¯¹è¿˜æ˜¯é”™ã€‚</p>
<h4 id="äºŒã€è½¯ä»¶å¼€å‘ä¸åªæ˜¯ç¼–ç "><a href="#äºŒã€è½¯ä»¶å¼€å‘ä¸åªæ˜¯ç¼–ç " class="headerlink" title="äºŒã€è½¯ä»¶å¼€å‘ä¸åªæ˜¯ç¼–ç "></a>äºŒã€è½¯ä»¶å¼€å‘ä¸åªæ˜¯ç¼–ç </h4><p>é™¤äº†ç¼–ç ï¼Œå¼€å‘äººå‘˜è¿˜éœ€è¦åè°ƒã€æ²Ÿé€šã€åˆ†æã€è®¾è®¡ã€æµ‹è¯•ã€é¡¹ç›®ç®¡ç†ç­‰</p>
<h4 id="ä¸‰ã€ä»£ç å°±æ˜¯å’Œäººæ²Ÿé€š"><a href="#ä¸‰ã€ä»£ç å°±æ˜¯å’Œäººæ²Ÿé€š" class="headerlink" title="ä¸‰ã€ä»£ç å°±æ˜¯å’Œäººæ²Ÿé€š"></a>ä¸‰ã€ä»£ç å°±æ˜¯å’Œäººæ²Ÿé€š</h4><p>å¦‚æœæˆ‘ä»¬çœŸçš„åªæ˜¯â€œä¸ºè®¡ç®—æœºç¼–ç¨‹â€ï¼Œé‚£ä¹ˆæˆ‘ä»¬éƒ½å°†ç¼–å†™å­—èŠ‚ç ã€‚è®¡ç®—æœºæœ€èƒ½ç†è§£å®ƒã€‚ä½†æˆ‘ä»¬ç”¨çš„æ˜¯ä¸€ç§â€œæŠ˜è¡·â€è¯­è¨€ï¼Œè¿™ç§è¯­è¨€å…¶ä»–äººå¯ä»¥ç†è§£ï¼Œä¹Ÿå¯ä»¥ç¿»è¯‘æˆè®¡ç®—æœºå¯ä»¥ç†è§£çš„ä¸œè¥¿ã€‚</p>
<p>å¥½çš„è½¯ä»¶å¼€å‘æ˜¯ä¸€ä¸ªäº¤æµçš„è¿‡ç¨‹ã€‚è¿™æ˜¯ä¸ºäº†ç¡®ä¿äººä»¬ç†è§£ä½ åœ¨åšä»€ä¹ˆã€‚ä½ çš„å·¥ä½œæ˜¯ä¸ä¸‹ä¸€ä¸ªé˜…è¯»å®ƒçš„äººäº¤æµã€‚æ‰¾åˆ°æœ€å¥½çš„è¡¨è¾¾æ–¹å¼å¯èƒ½éœ€è¦åŒç†å¿ƒã€‚</p>
<h4 id="å››ã€å¥½çš„æµç¨‹å¾ˆé‡è¦"><a href="#å››ã€å¥½çš„æµç¨‹å¾ˆé‡è¦" class="headerlink" title="å››ã€å¥½çš„æµç¨‹å¾ˆé‡è¦"></a>å››ã€å¥½çš„æµç¨‹å¾ˆé‡è¦</h4><p>åº·å¨å®šå¾‹é¢„è¨€ï¼Œä½ çš„è½¯ä»¶æ³¨å®šè¦åæ˜ ä½ çš„å›¢é˜ŸåŠå…¶æ²Ÿé€šç»“æ„ã€‚æµç¨‹æ˜¯æ²Ÿé€šçš„ç»“æ„ã€‚</p>
<p>æƒ³è±¡ä¸€ä¸‹ä¸€æ¶èµ·é£çš„é£æœº:é£è¡Œå‘˜ã€å‰¯é©¾é©¶ã€æœºç»„äººå‘˜å’Œç©ºä¸­äº¤é€šç®¡åˆ¶äººå‘˜ä¹‹é—´æœ‰ä¸€æ®µéå¸¸æœ‰æ¡ç†çš„å¯¹è¯ã€‚è¿™ç¡®ä¿äº†æ¯ä¸ªäººéƒ½å…³æ³¨å…³é”®é—®é¢˜ï¼Œæ¯ä¸ªäººéƒ½æœ‰å‘è¨€æƒã€‚â€œæœºç¿¼è¿˜åœ¨é£æœºä¸Šå—?â€â€â€œæ£€æŸ¥ã€‚â€œæ²¡æœ‰åˆ«çš„é£æœºæŒ¡ä½æˆ‘ä»¬çš„å»è·¯å—?â€â€œå¯ä»¥èµ·é£äº†ã€‚â€</p>
<h4 id="äº”ã€ç”¨ç»“æœè¯æ˜è‡ªå·±ï¼Œè€Œä¸æ˜¯èº«ä»½ä½ä½"><a href="#äº”ã€ç”¨ç»“æœè¯æ˜è‡ªå·±ï¼Œè€Œä¸æ˜¯èº«ä»½ä½ä½" class="headerlink" title="äº”ã€ç”¨ç»“æœè¯æ˜è‡ªå·±ï¼Œè€Œä¸æ˜¯èº«ä»½ä½ä½"></a>äº”ã€ç”¨ç»“æœè¯æ˜è‡ªå·±ï¼Œè€Œä¸æ˜¯èº«ä»½ä½ä½</h4><p>æœ€ç³Ÿç³•çš„å¼€å‘ç»„ç»‡è¦ä¹ˆç­‰çº§æ£®ä¸¥ï¼Œè¦ä¹ˆæ¯ä¸ªå¼€å‘äººå‘˜æœ‰å¤ªå¤šè€æ¿ã€‚è¿™é€šå¸¸åæ˜ äº†ç®¡ç†è€…å¯¹åœ°ä½çš„æ¸´æœ›ã€‚</p>
<p>è€ƒè™‘â€œè§’è‰²â€ï¼Œè€Œä¸æ˜¯â€œåœ°ä½â€ã€‚æˆ‘å·¥ä½œè¿‡çš„æœ€å¥½çš„ç»„ç»‡éƒ½é¦–å…ˆè®¤å¯é‚£äº›æ¨åŠ¨äº‹æƒ…çš„äººï¼Œè€Œä¸ç®¡ä»–ä»¬åœ¨ç»„ç»‡ä¸­æ‰®æ¼”ä»€ä¹ˆè§’è‰²ã€‚</p>
<h4 id="å…­ã€æ¯ä¸ªäººéƒ½èƒ½ä»åˆ«äººé‚£å­¦åˆ°"><a href="#å…­ã€æ¯ä¸ªäººéƒ½èƒ½ä»åˆ«äººé‚£å­¦åˆ°" class="headerlink" title="å…­ã€æ¯ä¸ªäººéƒ½èƒ½ä»åˆ«äººé‚£å­¦åˆ°"></a>å…­ã€æ¯ä¸ªäººéƒ½èƒ½ä»åˆ«äººé‚£å­¦åˆ°</h4><p>å¦‚æœæ‚¨è®¤ä¸ºäººä»¬çš„ç§æ—ã€æ€§åˆ«æˆ–å…¶ä»–å› ç´ æ˜¯åˆ¤æ–­ä»–ä»¬çš„æŠ€èƒ½æˆ–ä»–ä»¬å¿…é¡»æ•™ç»™æ‚¨çš„ä¸œè¥¿çš„å¥½æ–¹æ³•ï¼Œé‚£ä¹ˆæ‚¨å°±é™åˆ¶äº†è‡ªå·±ä½œä¸ºè½¯ä»¶å¼€å‘äººå‘˜çš„å‘å±•ã€‚</p>
<h4 id="ä¸ƒã€æµ‹è¯•ä½ æ‰€æœ‰çš„çŒœæƒ³ï¼Œå¹¶éšæ—¶å‡†å¤‡æ”¹å˜è¿™äº›çŒœæƒ³"><a href="#ä¸ƒã€æµ‹è¯•ä½ æ‰€æœ‰çš„çŒœæƒ³ï¼Œå¹¶éšæ—¶å‡†å¤‡æ”¹å˜è¿™äº›çŒœæƒ³" class="headerlink" title="ä¸ƒã€æµ‹è¯•ä½ æ‰€æœ‰çš„çŒœæƒ³ï¼Œå¹¶éšæ—¶å‡†å¤‡æ”¹å˜è¿™äº›çŒœæƒ³"></a>ä¸ƒã€æµ‹è¯•ä½ æ‰€æœ‰çš„çŒœæƒ³ï¼Œå¹¶éšæ—¶å‡†å¤‡æ”¹å˜è¿™äº›çŒœæƒ³</h4><p>å½“æŒ‡å¯¼å¹´è½»çš„å¼€å‘è€…æ—¶ï¼Œæˆ‘æ€»æ˜¯å¼ºè°ƒä½ ä¸åº”è¯¥è¯æ˜è‡ªå·±æ˜¯å¯¹çš„ï¼Œè€Œåº”è¯¥è¯æ˜è‡ªå·±æ˜¯é”™çš„ã€‚æˆ‘è¿˜é¼“åŠ±ä»–ä»¬ç”¨è¯æ˜è‡ªå·±æ­£ç¡®çš„çƒ­æƒ…å»åšè¿™ä»¶äº‹ã€‚</p>
<p>é€»è¾‘ç†è®ºå¾€å¾€æœ‰ä¸€ç§æ–¹æ³•å¯ä»¥è¯æ˜ä½ æ˜¯é”™çš„ã€‚å¦‚æœæ²¡æœ‰ï¼Œè¿™å¯èƒ½ä¸æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ç†è®ºã€‚å¦‚æœä½ ä¸èƒ½è¯æ˜å®ƒæ˜¯é”™çš„ï¼Œé‚£ä¹ˆï¼Œåªæœ‰é‚£æ—¶ï¼Œä¹Ÿè®¸ä½ å¯ä»¥è¯•ç€è¯æ˜å®ƒæ˜¯å¯¹çš„ã€‚è¿™ä¸â€œç›¸ä¿¡æ•°æ®â€ç±»ä¼¼ï¼Œä½†è¿™ä¸ä»…ä»…æ˜¯å…³äºæ•°æ®ï¼Œè¿˜æœ‰ä½ ä½¿ç”¨æ•°æ®çš„æ–¹å¼ã€‚</p>
<p><a href="https://www.infoworld.com/article/3214481/the-good-software-development-manifesto.html">å‚è€ƒæ¥æº</a></p>
]]></content>
      <tags>
        <tag>è½¯ä»¶å“²å­¦</tag>
      </tags>
  </entry>
  <entry>
    <title>Classæ–‡ä»¶çš„å­˜å‚¨æ ¼å¼</title>
    <url>/file-format-class.html</url>
    <content><![CDATA[<h4 id="ä¸€ã€Classæ–‡ä»¶ç»“æ„æ¦‚è§ˆ"><a href="#ä¸€ã€Classæ–‡ä»¶ç»“æ„æ¦‚è§ˆ" class="headerlink" title="ä¸€ã€Classæ–‡ä»¶ç»“æ„æ¦‚è§ˆ"></a>ä¸€ã€Classæ–‡ä»¶ç»“æ„æ¦‚è§ˆ</h4><h5 id="1-1-æ¦‚è¿°"><a href="#1-1-æ¦‚è¿°" class="headerlink" title="1.1 æ¦‚è¿°"></a>1.1 æ¦‚è¿°</h5><ul>
<li>æ¯ä¸€ä¸ªclassæ–‡ä»¶åŒ…å«ä¸€ä¸ªç±»æˆ–è€…æ¥å£çš„å®šä¹‰</li>
<li>ä»¥å¤§ç«¯æ–¹å¼å­˜å‚¨</li>
<li>u1ã€u2ã€u4åˆ†åˆ«è¡¨ç¤º1ã€2ã€4ä¸ªå­—èŠ‚  </li>
</ul>
<h5 id="1-2-æ•°æ®ç»“æ„"><a href="#1-2-æ•°æ®ç»“æ„" class="headerlink" title="1.2 æ•°æ®ç»“æ„"></a>1.2 æ•°æ®ç»“æ„</h5><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">ClassFile &#123;</span><br><span class="line">    u4             magic;</span><br><span class="line">    u2             minor_version;</span><br><span class="line">    u2             major_version;</span><br><span class="line">    u2             constant_pool_count;</span><br><span class="line">    cp_info        constant_pool[constant_pool_count<span class="number">-1</span>];</span><br><span class="line">    u2             access_flags;</span><br><span class="line">    u2             this_class;</span><br><span class="line">    u2             super_class;</span><br><span class="line">    u2             interfaces_count;</span><br><span class="line">    u2             interfaces[interfaces_count];</span><br><span class="line">    u2             fields_count;</span><br><span class="line">    field_info     fields[fields_count];</span><br><span class="line">    u2             methods_count;</span><br><span class="line">    method_info    methods[methods_count];</span><br><span class="line">    u2             attributes_count;</span><br><span class="line">    attribute_info attributes[attributes_count];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="1-3-å›¾å½¢åŒ–è¡¨ç¤º"><a href="#1-3-å›¾å½¢åŒ–è¡¨ç¤º" class="headerlink" title="1.3 å›¾å½¢åŒ–è¡¨ç¤º"></a>1.3 å›¾å½¢åŒ–è¡¨ç¤º</h5><center>
    <img src="../images/class_file_format.jpeg" width="400"/>
</center>

<h5 id="1-4-ç¤ºä¾‹"><a href="#1-4-ç¤ºä¾‹" class="headerlink" title="1.4 ç¤ºä¾‹"></a>1.4 ç¤ºä¾‹</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Car</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">drive</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BMWCar</span> <span class="keyword">implements</span> <span class="title">Car</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">BMWCar</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        name = <span class="string">&quot;å®é©¬&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">drive</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;BMW car drive.&quot;</span> + name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Last modified 2017-11-10; size 644 bytes</span><br><span class="line">  MD5 checksum ac6d7477d45479490e4ea3f660b1dcdd</span><br><span class="line">  Compiled from &quot;BMWCar.java&quot;</span><br><span class="line">public class BMWCar implements Car</span><br><span class="line">  minor version: 0</span><br><span class="line">  major version: 52</span><br><span class="line">  flags: ACC_PUBLIC, ACC_SUPER</span><br><span class="line">Constant pool:</span><br><span class="line">   #1 = Methodref          #12.#23        // java/lang/Object.&quot;&lt;init&gt;&quot;:()V</span><br><span class="line">   #2 = String             #24            // å®é©¬</span><br><span class="line">   #3 = Fieldref           #11.#25        // BMWCar.name:Ljava/lang/String;</span><br><span class="line">   #4 = Fieldref           #26.#27        // java/lang/System.out:Ljava/io/PrintStream;</span><br><span class="line">   #5 = Class              #28            // java/lang/StringBuilder</span><br><span class="line">   #6 = Methodref          #5.#23         // java/lang/StringBuilder.&quot;&lt;init&gt;&quot;:()V</span><br><span class="line">   #7 = String             #29            // BMW car drive.</span><br><span class="line">   #8 = Methodref          #5.#30         // java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;</span><br><span class="line">   #9 = Methodref          #5.#31         // java/lang/StringBuilder.toString:()Ljava/lang/String;</span><br><span class="line">  #10 = Methodref          #32.#33        // java/io/PrintStream.println:(Ljava/lang/String;)V</span><br><span class="line">  #11 = Class              #34            // BMWCar</span><br><span class="line">  #12 = Class              #35            // java/lang/Object</span><br><span class="line">  #13 = Class              #36            // Car</span><br><span class="line">  #14 = Utf8               name</span><br><span class="line">  #15 = Utf8               Ljava/lang/String;</span><br><span class="line">  #16 = Utf8               &lt;init&gt;</span><br><span class="line">  #17 = Utf8               ()V</span><br><span class="line">  #18 = Utf8               Code</span><br><span class="line">  #19 = Utf8               LineNumberTable</span><br><span class="line">  #20 = Utf8               drive</span><br><span class="line">  #21 = Utf8               SourceFile</span><br><span class="line">  #22 = Utf8               BMWCar.java</span><br><span class="line">  #23 = NameAndType        #16:#17        // &quot;&lt;init&gt;&quot;:()V</span><br><span class="line">  #24 = Utf8               å®é©¬</span><br><span class="line">  #25 = NameAndType        #14:#15        // name:Ljava/lang/String;</span><br><span class="line">  #26 = Class              #37            // java/lang/System</span><br><span class="line">  #27 = NameAndType        #38:#39        // out:Ljava/io/PrintStream;</span><br><span class="line">  #28 = Utf8               java/lang/StringBuilder</span><br><span class="line">  #29 = Utf8               BMW car drive.</span><br><span class="line">  #30 = NameAndType        #40:#41        // append:(Ljava/lang/String;)Ljava/lang/StringBuilder;</span><br><span class="line">  #31 = NameAndType        #42:#43        // toString:()Ljava/lang/String;</span><br><span class="line">  #32 = Class              #44            // java/io/PrintStream</span><br><span class="line">  #33 = NameAndType        #45:#46        // println:(Ljava/lang/String;)V</span><br><span class="line">  #34 = Utf8               BMWCar</span><br><span class="line">  #35 = Utf8               java/lang/Object</span><br><span class="line">  #36 = Utf8               Car</span><br><span class="line">  #37 = Utf8               java/lang/System</span><br><span class="line">  #38 = Utf8               out</span><br><span class="line">  #39 = Utf8               Ljava/io/PrintStream;</span><br><span class="line">  #40 = Utf8               append</span><br><span class="line">  #41 = Utf8               (Ljava/lang/String;)Ljava/lang/StringBuilder;</span><br><span class="line">  #42 = Utf8               toString</span><br><span class="line">  #43 = Utf8               ()Ljava/lang/String;</span><br><span class="line">  #44 = Utf8               java/io/PrintStream</span><br><span class="line">  #45 = Utf8               println</span><br><span class="line">  #46 = Utf8               (Ljava/lang/String;)V</span><br><span class="line">&#123;</span><br><span class="line">  public BMWCar();</span><br><span class="line">    descriptor: ()V</span><br><span class="line">    flags: ACC_PUBLIC</span><br><span class="line">    Code:</span><br><span class="line">      stack=2, locals=1, args_size=1</span><br><span class="line">         0: aload_0</span><br><span class="line">         1: invokespecial #1                  // Method java/lang/Object.&quot;&lt;init&gt;&quot;:()V</span><br><span class="line">         4: aload_0</span><br><span class="line">         5: ldc           #2                  // String å®é©¬</span><br><span class="line">         7: putfield      #3                  // Field name:Ljava/lang/String;</span><br><span class="line">        10: return</span><br><span class="line">      LineNumberTable:</span><br><span class="line">        line 6: 0</span><br><span class="line">        line 7: 4</span><br><span class="line">        line 8: 10</span><br><span class="line"></span><br><span class="line">  public void drive();</span><br><span class="line">    descriptor: ()V</span><br><span class="line">    flags: ACC_PUBLIC</span><br><span class="line">    Code:</span><br><span class="line">      stack=3, locals=1, args_size=1</span><br><span class="line">         0: getstatic     #4                  // Field java/lang/System.out:Ljava/io/PrintStream;</span><br><span class="line">         3: new           #5                  // class java/lang/StringBuilder</span><br><span class="line">         6: dup</span><br><span class="line">         7: invokespecial #6                  // Method java/lang/StringBuilder.&quot;&lt;init&gt;&quot;:()V</span><br><span class="line">        10: ldc           #7                  // String BMW car drive.</span><br><span class="line">        12: invokevirtual #8                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;</span><br><span class="line">        15: aload_0</span><br><span class="line">        16: getfield      #3                  // Field name:Ljava/lang/String;</span><br><span class="line">        19: invokevirtual #8                  // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;</span><br><span class="line">        22: invokevirtual #9                  // Method java/lang/StringBuilder.toString:()Ljava/lang/String;</span><br><span class="line">        25: invokevirtual #10                 // Method java/io/PrintStream.println:(Ljava/lang/String;)V</span><br><span class="line">        28: return</span><br><span class="line">      LineNumberTable:</span><br><span class="line">        line 12: 0</span><br><span class="line">        line 13: 28</span><br><span class="line">&#125;</span><br><span class="line">SourceFile: &quot;BMWCar.java&quot;</span><br></pre></td></tr></table></figure>

<h4 id="äºŒã€å¸¸é‡æ± çš„ç»“æ„"><a href="#äºŒã€å¸¸é‡æ± çš„ç»“æ„" class="headerlink" title="äºŒã€å¸¸é‡æ± çš„ç»“æ„"></a>äºŒã€å¸¸é‡æ± çš„ç»“æ„</h4><p>å¸¸é‡æ± æ˜¯ä¸€ä¸ªcp_infoçš„æ•°ç»„ï¼šé€šè¿‡tagå®šä½åˆ°å…·ä½“çš„æ•°æ®ç»“æ„ï¼Œå†é€šè¿‡æ•°æ®ç»“æ„çš„è¡¨ç¤ºï¼Œåˆ¤æ–­ä¸‹é¢å‡ ä¸ªå­—èŠ‚æ€ä¹ˆè§£æã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cp_info &#123;</span><br><span class="line">    u1 tag; //cp-infoçš„ç±»å‹</span><br><span class="line">    u1 info[];//ç±»å‹å¯¹åº”çš„æ•°ç»„</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>tag</th>
<th>info</th>
<th>æ•°æ®ç»“æ„</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>CONSTANT_Utf8_info</td>
<td>CONSTANT_NameAndType_info {<br>    &nbsp;u1 tag;<br>    &nbsp;u2 name_index;<br>    &nbsp;u2 descriptor_index;<br>}</td>
<td>UTF-8ç¼–ç çš„å­—ç¬¦ä¸²</td>
</tr>
<tr>
<td>3</td>
<td>CONSTANT_Integer_info</td>
<td>CONSTANT_Integer_info {<br>    &nbsp;u1 tag;<br>    &nbsp;u4 bytes;<br>}</td>
<td>æ•´å½¢å­—é¢é‡ï¼Œbooleanã€byteã€charã€shortç­‰ç±»å‹éƒ½ç”¨intå­˜æ”¾</td>
</tr>
<tr>
<td>4</td>
<td>CONSTANT_Float_info</td>
<td>CONSTANT_Float_info {<br>    &nbsp;u1 tag;<br>    &nbsp;u4 bytes;<br>}</td>
<td>æµ®ç‚¹å‹å­—é¢é‡</td>
</tr>
<tr>
<td>5</td>
<td>CONSTANT_Long_info</td>
<td>CONSTANT_Long_info {<br>    &nbsp;u1 tag;<br>    &nbsp;u4 high_bytes;<br>    &nbsp;u4 low_bytes;<br>}</td>
<td>æµ®ç‚¹å‹å­—é¢é‡</td>
</tr>
<tr>
<td>6</td>
<td>CONSTANT_Double_info</td>
<td>CONSTANT_Long_info {<br>    &nbsp;u1 tag;<br>    &nbsp;u4 high_bytes;<br>    &nbsp;u4 low_bytes;<br>}</td>
<td>åŒç²¾åº¦æµ®ç‚¹å‹å­—é¢é‡</td>
</tr>
<tr>
<td>7</td>
<td>CONSTANT_Class_info</td>
<td>CONSTANT_Class_info {<br>    &nbsp;u1 tag;<br>    &nbsp;u2 name_index;<br>}</td>
<td>ç±»æˆ–æ¥å£çš„ç¬¦å·å¼•ç”¨</td>
</tr>
<tr>
<td>8</td>
<td>CONSTANT_String_info</td>
<td>CONSTANT_String_info {<br>    &nbsp;u1 tag;<br>    &nbsp;u2 string_index;<br>}</td>
<td>å­—ç¬¦ä¸²ç±»å‹å­—é¢é‡</td>
</tr>
<tr>
<td>9</td>
<td>CONSTANT_Fieldref_info</td>
<td>CONSTANT_Fieldref_info {<br>    &nbsp;u1 tag;<br>    &nbsp;u2 class_index;//ç´¢å¼•å€¼<br>    &nbsp;u2 name_and_type_index;<br>}</td>
<td>å­—æ®µçš„ç¬¦å·å¼•ç”¨</td>
</tr>
<tr>
<td>10</td>
<td>CONSTANT_Methodref_info</td>
<td>CONSTANT_Methodref_info {<br>    &nbsp;u1 tag;<br>    &nbsp;u2 class_index;;//ç´¢å¼•å€¼<br>    &nbsp;u2 name_and_type_index;<br>}</td>
<td>ç±»ä¸­æ–¹æ³•çš„ç¬¦å·å¼•ç”¨</td>
</tr>
<tr>
<td>11</td>
<td>CONSTANT_InterfaceMethodref</td>
<td>CONSTANT_InterfaceMethodref_info {<br>    &nbsp;u1 tag;<br>    &nbsp;u2 class_index;;//ç´¢å¼•å€¼<br>    &nbsp;u2 name_and_type_index;<br>}</td>
<td>æ¥å£ä¸­æ–¹æ³•çš„ç¬¦å·å¼•ç”¨</td>
</tr>
<tr>
<td>12</td>
<td>CONSTANT_NameAndType_info</td>
<td>CONSTANT_NameAndType_info {<br>    &nbsp;u1 tag;<br>    &nbsp;&nbsp;u2 name_index;<br>    &nbsp;&nbsp;u2 descriptor_index;<br>}</td>
<td>æ¥å£ä¸­æ–¹æ³•çš„ç¬¦å·å¼•ç”¨</td>
</tr>
</tbody></table>
<h4 id="ä¸‰ã€å­—æ®µçš„ç»“æ„"><a href="#ä¸‰ã€å­—æ®µçš„ç»“æ„" class="headerlink" title="ä¸‰ã€å­—æ®µçš„ç»“æ„"></a>ä¸‰ã€å­—æ®µçš„ç»“æ„</h4><p>æ¯ä¸€ä¸ªå­—æ®µç”¨ä¸€ä¸ª field_infoçš„ç»“æ„ä½“è¡¨ç¤º</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">field_info &#123;</span><br><span class="line">    u2             access_flags;</span><br><span class="line">    u2             name_index;//æŒ‡å‘å¸¸é‡æ± çš„indexï¼Œè¡¨ç¤ºå­—æ®µå</span><br><span class="line">    u2             descriptor_index;//æŒ‡å‘å¸¸é‡æ± çš„indeï¼Œå­—æ®µçš„æè¿°ç¬¦</span><br><span class="line">    u2             attributes_count;</span><br><span class="line">    attribute_info attributes[attributes_count];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="å››ã€æ–¹æ³•çš„ç»“æ„"><a href="#å››ã€æ–¹æ³•çš„ç»“æ„" class="headerlink" title="å››ã€æ–¹æ³•çš„ç»“æ„"></a>å››ã€æ–¹æ³•çš„ç»“æ„</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">method_info &#123;</span><br><span class="line">    u2             access_flags;</span><br><span class="line">    u2             name_index;</span><br><span class="line">    u2             descriptor_index;</span><br><span class="line">    u2             attributes_count;</span><br><span class="line">    attribute_info attributes[attributes_count];//Codeå­—èŠ‚ç ä¿¡æ¯</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="äº”ã€å±æ€§çš„ç»“æ„"><a href="#äº”ã€å±æ€§çš„ç»“æ„" class="headerlink" title="äº”ã€å±æ€§çš„ç»“æ„"></a>äº”ã€å±æ€§çš„ç»“æ„</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">attribute_info &#123;</span><br><span class="line">    u2 attribute_name_index;</span><br><span class="line">    u4 attribute_length;</span><br><span class="line">    u1 info[attribute_length];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="å…­ã€å‚è€ƒé“¾æ¥"><a href="#å…­ã€å‚è€ƒé“¾æ¥" class="headerlink" title="å…­ã€å‚è€ƒé“¾æ¥"></a>å…­ã€å‚è€ƒé“¾æ¥</h4><p><a href="https://docs.oracle.com/javase/specs/jvms/se7/html/jvms-4.html#jvms-4.4">Chapter 4. The class File Format</a>  </p>
<p><a href="https://www.jianshu.com/p/ae3f860499aa">Java Classæ–‡ä»¶ç»“æ„è§£æ</a></p>
]]></content>
      <categories>
        <category>è®¡ç®—æœº</category>
      </categories>
      <tags>
        <tag>Java</tag>
        <tag>File</tag>
      </tags>
  </entry>
  <entry>
    <title>é‡å®šä½</title>
    <url>/file-format-elf-relocation.html</url>
    <content><![CDATA[<h4 id="ä¸€ã€å¯é‡å®šä½æ–‡ä»¶"><a href="#ä¸€ã€å¯é‡å®šä½æ–‡ä»¶" class="headerlink" title="ä¸€ã€å¯é‡å®šä½æ–‡ä»¶"></a>ä¸€ã€å¯é‡å®šä½æ–‡ä»¶</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//main.c                    //x.c</span><br><span class="line"></span><br><span class="line">extern void foo(void);      |   #include &lt;stdio.h&gt;</span><br><span class="line">                            |</span><br><span class="line">int main(void)              |   void foo()</span><br><span class="line">&#123;                           |   &#123;</span><br><span class="line">    foo();                  |       printf(&quot;foo\n&quot;);</span><br><span class="line">    return 0;               |   &#125;</span><br><span class="line">&#125;                           |</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&gt; objdump -d main.o</span><br><span class="line">00000000 &lt;main&gt;:</span><br><span class="line">   0:	55                   	push   %ebp</span><br><span class="line">   1:	89 e5                	mov    %esp,%ebp</span><br><span class="line">   3:	83 e4 f0             	and    $0xfffffff0,%esp</span><br><span class="line">   6:	e8 fc ff ff ff       	call   7 &lt;main+0x7&gt;</span><br><span class="line">   b:	b8 00 00 00 00       	mov    $0x0,%eax</span><br><span class="line">  10:	c9                   	leave</span><br><span class="line">  11:	c3                   	ret</span><br></pre></td></tr></table></figure>

<p>åœ¨ç¼–è¯‘å’Œæ±‡ç¼–é˜¶æ®µï¼Œ[main.c -&gt; main.o] æ±‡ç¼–å™¨æ— æ³•ç¡®å®šå¤–éƒ¨å®šä¹‰çš„å‡½æ•°å’Œå…¨å±€å˜é‡çš„åœ°å€ï¼Œæ‰€ä»¥å®ƒåªèƒ½ä½¿ç”¨ä¸€ä¸ªå‡åœ°å€å ä½ï¼Œå¹¶äº§ç”Ÿä¸€æ¡é¢å¤–çš„è®°å½•ï¼Œè®©åé¢çš„é“¾æ¥å™¨ä½¿ç”¨è¿™æ¡è®°å½•å¸®å®ƒå®Œæˆåœ°å€ä¿®æ­£ã€‚è¿™æ¡è®°å½•å¯¹äºä»£ç æ®µæ¥è¯´æ”¾åœ¨[.rel.text] ï¼Œå¯¹äºæ•°æ®æ®µæ¥è¯´æ”¾åœ¨[.rel.data],å®ƒä»¬éƒ½æ˜¯é‡å®šä½æ–‡ä»¶çš„ä¸€ä¸ªsectionã€‚</p>
<p>å¯¹äºæ¯ä¸€æ¡è®°å½•éƒ½å¯¹åº”äºå¦‚ä¸‹çš„ä¸€ä¸ªæ•°æ®ç»“æ„ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">typedef struct &#123;</span><br><span class="line">        Elf32_Addr r_offset;</span><br><span class="line">        uint32_t   r_info;</span><br><span class="line">        int32_t    r_addend;</span><br><span class="line">&#125; Elf32_Rela;</span><br></pre></td></tr></table></figure>


<h4 id="äºŒã€é™æ€é“¾æ¥"><a href="#äºŒã€é™æ€é“¾æ¥" class="headerlink" title="äºŒã€é™æ€é“¾æ¥"></a>äºŒã€é™æ€é“¾æ¥</h4><p>1ã€å¤šä¸ªç›®æ ‡æ–‡ä»¶çš„åˆå¹¶:</p>
<center>
    <img src="../images/elf_obj_file_merge.png" width="500"/>
</center>

<p>2ã€å¯¹ä»£ç æ®µï¼Œæ•°æ®æ®µä»¥åŠå„ç¬¦å·è¿›è¡Œåœ°å€åˆ†é…<br>3ã€æ ¹æ® [relocation entries] é‡æ–°è®¡ç®—ä»£ç å’Œæ•°æ®æ®µä¸­çš„å‡åœ°å€ã€‚</p>
<h4 id="ä¸‰ã€åŠ¨æ€é“¾æ¥"><a href="#ä¸‰ã€åŠ¨æ€é“¾æ¥" class="headerlink" title="ä¸‰ã€åŠ¨æ€é“¾æ¥"></a>ä¸‰ã€åŠ¨æ€é“¾æ¥</h4><h5 id="1ã€é™æ€é“¾æ¥çš„ç¼ºç‚¹"><a href="#1ã€é™æ€é“¾æ¥çš„ç¼ºç‚¹" class="headerlink" title="1ã€é™æ€é“¾æ¥çš„ç¼ºç‚¹"></a>1ã€é™æ€é“¾æ¥çš„ç¼ºç‚¹</h5><ul>
<li>é™æ€é“¾æ¥å°†ä½¿ä¸€äº›å…¬ç”¨ä»£ç å¦‚libcåº“äº§ç”Ÿå†—ä½™ï¼Œæµªè´¹å†…å­˜å’Œç£ç›˜ç©ºé—´</li>
<li>å¦‚æœæ¨¡å—åŒ–å¼€å‘ï¼Œä¸€ä¸ªæ¨¡å—æ›´æ–°å°±å¾—é‡æ–°é“¾æ¥</li>
</ul>
<h5 id="2ã€åŠ¨æ€é“¾æ¥çš„æ¦‚å¿µ"><a href="#2ã€åŠ¨æ€é“¾æ¥çš„æ¦‚å¿µ" class="headerlink" title="2ã€åŠ¨æ€é“¾æ¥çš„æ¦‚å¿µ"></a>2ã€åŠ¨æ€é“¾æ¥çš„æ¦‚å¿µ</h5><p>ç›¸è¾ƒäºé™æ€é“¾æ¥åœ¨ç¼–è¯‘æœŸè¿›è¡Œé“¾æ¥æ“ä½œï¼Œå°†é“¾æ¥è¿‡ç¨‹æ¨è¿Ÿåˆ°è¿è¡Œæ—¶è¿›è¡Œçš„è¿‡ç¨‹å«åŠ¨æ€é“¾æ¥ã€‚</p>
<h5 id="3ã€åŠ¨æ€é“¾æ¥çš„å®ç°"><a href="#3ã€åŠ¨æ€é“¾æ¥çš„å®ç°" class="headerlink" title="3ã€åŠ¨æ€é“¾æ¥çš„å®ç°"></a>3ã€åŠ¨æ€é“¾æ¥çš„å®ç°</h5><p>   3.1 åœ°å€æ— å…³ä»£ç <br>    ç”±äºåœ¨è¿è¡Œæ—¶ï¼Œä»£ç æ®µæ˜¯å…±äº«çš„ï¼Œåªèƒ½è¯»ä¸èƒ½å†™ï¼Œæ‰€ä»¥éœ€è¦å°†æŒ‡ä»¤ä¸­é‚£äº›éœ€è¦ä¿®æ”¹çš„éƒ¨åˆ†åˆ†ç¦»å‡ºæ¥ï¼Œè·Ÿæ•°æ®éƒ¨åˆ†æ”¾åœ¨ä¸€èµ·ï¼Œè¿™æ ·æŒ‡ä»¤éƒ¨åˆ†å°±å¯ä»¥ä¿æŒä¸å˜ï¼Œè€Œæ•°æ®éƒ¨åˆ†å¯ä»¥åœ¨æ¯ä¸€ä¸ªè¿›ç¨‹ä¸­æ‹¥æœ‰ä¸€ä¸ªå‰¯æœ¬ã€‚</p>
<p>   3.2 å…¨å±€åç§»è¡¨ï¼ˆGlobal Offset Tableï¼‰<br>    å½“é“¾æ¥è¿‡ç¨‹å‘ç”Ÿåœ¨è¿è¡ŒæœŸæ—¶ï¼Œå¤–éƒ¨çš„ç¬¦å·è°ƒç”¨åªæœ‰åœ¨è¿è¡Œæ—¶è£…è½½æ¨¡å—åæ‰èƒ½ç¡®å®šæ¨¡å—è¢«è£…è½½çš„åœ°å€ï¼Œä»¥åŠæ¨¡å—å†…ç¬¦å·çš„ç¡®åˆ‡åœ°å€ã€‚æ‰€ä»¥ELFæä¾›äº†ä¸€ä¸ªå…¨å±€åç§»è¡¨ï¼ˆGOTï¼‰æ¥è®°å½•è¿™äº›å¤–éƒ¨æ¨¡å—çš„ç¬¦å·å¼•ç”¨ã€‚å½“æ¨¡å—è¢«è£…è½½æ—¶ï¼Œä¼šæ›´æ–°æ­¤è¡¨çš„å†…å®¹ã€‚</p>
<h4 id="å››ã€å‚è€ƒæ–‡çŒ®"><a href="#å››ã€å‚è€ƒæ–‡çŒ®" class="headerlink" title="å››ã€å‚è€ƒæ–‡çŒ®"></a>å››ã€å‚è€ƒæ–‡çŒ®</h4><p>1.<a href="https://people.cs.pitt.edu/~xianeizhang/notes/Linking.html#symbol">Linking</a><br>2.<a href="https://stac47.github.io/c/relocation/elf/tutorial/2018/03/01/understanding-relocation-elf.html">understanding-relocation-elf</a><br>3.<a href="http://stffrdhrn.github.io/hardware/embedded/openrisc/2019/11/29/relocs.html">ELF Binaries and Relocation Entries</a><br>4.<a href="http://chuquan.me/2018/06/03/linking-static-linking-dynamic-linking/">static-linking-dynamic-linking</a><br>5.<a href="https://blog.csdn.net/ayu_ag/article/details/78655300">ELFå‡½æ•°é‡å®šä½é—®é¢˜</a></p>
]]></content>
      <categories>
        <category>è®¡ç®—æœº</category>
      </categories>
      <tags>
        <tag>C/C++</tag>
      </tags>
  </entry>
  <entry>
    <title>ELFæ–‡ä»¶çš„ç»“æ„</title>
    <url>/file-format-elf.html</url>
    <content><![CDATA[<h4 id="ä¸€ã€æ¦‚è¿°"><a href="#ä¸€ã€æ¦‚è¿°" class="headerlink" title="ä¸€ã€æ¦‚è¿°"></a>ä¸€ã€æ¦‚è¿°</h4><p>ä»£ç æ˜¯è§£å†³é—®é¢˜çš„å·¥å…·ã€‚å½“é€šè¿‡ç¼–ç æ–¹å¼è§£å†³ä¸€ä¸ªé—®é¢˜æ—¶ï¼Œé€šå¸¸æœ‰å¦‚ä¸‹æ­¥éª¤ï¼š</p>
<ul>
<li>å®šä¹‰é—®é¢˜</li>
<li>è®¾è®¡è§£å†³æ–¹æ¡ˆ</li>
<li>ç¼–ç å®ç°æ–¹æ¡ˆ</li>
<li>æµ‹è¯•ç¨‹åº</li>
</ul>
<p>ç¼–ç å®ç°é€šå¸¸æ˜¯æˆ‘ä»¬åˆ©ç”¨è®¡ç®—æœºé«˜çº§è¯­è¨€ä¹¦å†™çš„ï¼Œç¬¦åˆä¸€å®šé€»è¾‘çš„ç¨‹åºä»£ç ï¼Œè¿™ç§å«é€»è¾‘çš„ä»£ç è®¡ç®—æœºæ˜¯æ— æ³•ç†è§£çš„ï¼Œå®ƒèƒ½ç†è§£çš„åªæ˜¯ä¸€æ¡æ¡ç”±0å’Œ1ç»„æˆçš„æŒ‡ä»¤å³æœºå™¨è¯­è¨€ã€‚æ‰€ä»¥è¿™å°±æ¶‰åŠä»é«˜çº§è¯­è¨€åˆ°æœºå™¨è¯­è¨€çš„ç¿»è¯‘å’Œè½¬æ¢è¿‡ç¨‹ï¼Œå¤„ç†è¿™ä¸ªè¿‡ç¨‹çš„ç¨‹åºå«<strong>ç¼–è¯‘å™¨</strong>ã€‚</p>
<p>ç¼–è¯‘å™¨è¿™ä¸ªç¨‹åºï¼Œå¾ˆåºå¤§å¾ˆå¤æ‚ï¼Œä¸ºäº†è®©å®ƒç®€æ´ï¼Œå¥½æ§åˆ¶ï¼Œæˆ‘ä»¬æŠŠå®ƒæ‹†æˆå››ä¸ªéƒ¨åˆ†ï¼š</p>
<ul>
<li>é¢„å¤„ç†å™¨</li>
<li>ç¼–è¯‘å™¨</li>
<li>æ±‡ç¼–å™¨</li>
<li>é“¾æ¥å™¨</li>
</ul>
<p>æ¯ä¸€ä¸ªé˜¶æ®µåŸºæœ¬ä¸Šéƒ½æ˜¯åœ¨ä¸ºä¸‹ä¸€ä¸ªé˜¶æ®µåšå‡†å¤‡ï¼Œå®ƒçš„è¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<center>
    <img src="../images/GCC_CompilationProcess.png" width="500"/>
</center>

<p>é¢„å¤„ç†å™¨ï¼ˆPreprocessorï¼‰å¤„ç†ä»£ç çš„è¿‡ç¨‹å«é¢„å¤„ç†é˜¶æ®µï¼Œå®ƒæ‰€åšçš„å·¥ä½œåŒ…æ‹¬ï¼š</p>
<ul>
<li>#defineå®å®šä¹‰å±•å¼€</li>
<li>å¤„ç†æ¡ä»¶ç¼–è¯‘æŒ‡ä»¤</li>
<li>å¤„ç†#includeæŒ‡ä»¤</li>
<li>åˆ é™¤æ³¨é‡Š</li>
<li>æ·»åŠ è¡Œå·</li>
<li>ä¿ç•™#pragmaæŒ‡ä»¤</li>
</ul>
<p>ç¼–è¯‘å™¨ï¼ˆCompilerï¼‰å¤„ç†ä»£ç çš„è¿‡ç¨‹å«ç¼–è¯‘ï¼Œå®ƒä¸»è¦æ˜¯å°†ä¸Šä¸€æ­¥çš„äº§ç‰©è½¬æ¢æˆæ±‡ç¼–ä»£ç ï¼Œå®ƒçš„å·¥ä½œå†…å®¹åŒ…æ‹¬ï¼š</p>
<ul>
<li>è¯æ³•åˆ†æ</li>
<li>è¯­æ³•åˆ†æ</li>
<li>è¯­ä¹‰åˆ†æ</li>
<li>ä¼˜åŒ–</li>
</ul>
<p>æ±‡ç¼–å™¨ï¼ˆAssemblerï¼‰å¤„ç†ä»£ç çš„è¿‡ç¨‹å«æ±‡ç¼–è¿‡ç¨‹ï¼Œå®ƒä¸»è¦å°†æ±‡ç¼–ä»£ç è½¬æ¢æˆäºŒè¿›åˆ¶çš„æœºå™¨ç </p>
<ul>
<li>æ±‡ç¼–ç åˆ°æœºå™¨ç çš„ç¿»è¯‘</li>
</ul>
<p>é“¾æ¥å™¨ï¼ˆLinkerï¼‰å¤„ç†ä»£ç çš„è¿‡ç¨‹å«é“¾æ¥è¿‡ç¨‹ï¼Œå¤šä¸ªæ–‡ä»¶åˆå¹¶æˆä¸€ä¸ªæ–‡ä»¶</p>
<ul>
<li>ç©ºé—´ä¸åœ°å€åˆ†é…-ç›¸åŒéƒ¨åˆ†åˆå¹¶</li>
<li>ç¬¦å·è§£æå’Œé‡å®šä½-åˆå¹¶åä½ç½®ï¼ˆåç§»é‡ï¼‰è°ƒæ•´</li>
</ul>
<p>ç»¼ä¸Šå¯çŸ¥ï¼Œç›®æ ‡æ–‡ä»¶æ˜¯ç¨‹åºæœªé“¾æ¥å‰çš„ä¸€ä¸ªä¸­é—´æ–‡ä»¶ã€‚ç›®æ ‡æ–‡ä»¶å†…å®¹çš„å­˜å‚¨æ–¹å¼ç¬¦åˆELFæ–‡ä»¶æ ‡å‡†ï¼Œæ‰€ä»¥ä»–æ˜¯ä¸€ç§ç‰¹æ®Šçš„ELFæ–‡ä»¶ã€‚</p>
<h4 id="äºŒã€æ–‡ä»¶ç»“æ„è§£æ"><a href="#äºŒã€æ–‡ä»¶ç»“æ„è§£æ" class="headerlink" title="äºŒã€æ–‡ä»¶ç»“æ„è§£æ"></a>äºŒã€æ–‡ä»¶ç»“æ„è§£æ</h4><p>ç›®æ ‡æ–‡ä»¶å…¶å®æ˜¯ELFæ–‡ä»¶çš„ä¸€ç§ï¼Œå¸¸è§çš„ELFæ–‡ä»¶è¿˜æœ‰.soå’Œ.oatæ–‡ä»¶ç­‰ã€‚ELFæ–‡ä»¶å­˜åœ¨ä¸¤ç§è§‚å¯Ÿè§’åº¦ï¼Œåˆ†åˆ«æ˜¯ç¼–è¯‘è§’åº¦å’Œè¿è¡Œè§’åº¦ã€‚ç¼–è¯‘è§’åº¦æ˜¯æŒ‡ï¼Œåœ¨ä»£ç ç¼–è¯‘é˜¶æ®µçš„å­˜å‚¨æ ¼å¼ã€‚è¿è¡Œè§’åº¦æ˜¯æŒ‡ï¼Œæ–‡ä»¶è¢«åŠ è½½è¿›å†…å­˜æ—¶çš„å­˜å‚¨æ ¼å¼ã€‚<br>ä¸¤ä¸ªè§’åº¦çœ‹åˆ°çš„ç»“æ„ç•¥æœ‰å·®å¼‚ã€‚å¦‚å›¾ï¼š</p>
<center>
    <img src="../images/elf_format_overview.jpeg" width="500"/>
</center>

<p>ä»å›¾ä¸­å¯ä»¥å¾—åˆ°è¿™æ ·ä¸€äº›ä¿¡æ¯ï¼š<br>1ã€Program Header Tableå¯¹äºç¼–è¯‘è§†å›¾æ˜¯å¯é€‰çš„ï¼Œå› ä¸ºå®ƒåªåœ¨ç¨‹åºè¢«åŠ è½½è¿›å†…å­˜æ—¶ä½¿ç”¨åˆ°ã€‚Section Header Tableå¯¹äºæ‰§è¡Œè§†å›¾æ˜¯å¯é€‰çš„ã€‚<br>2ã€ç¼–è¯‘è§†å›¾æ˜¯ä»¥sectionä¸ºç»„ç»‡å•ä½ï¼Œæ‰§è¡Œè§†å›¾æ˜¯ä»¥segmentä¸ºç»„ç»‡å•ä½ï¼ˆå¤šä¸ªsectionä¼šè¢«æ˜ å°„åˆ°åŒä¸€ä¸ªsegmentï¼‰ã€‚</p>
<p>ä¸‹é¢ä»‹ç»ä¸€äº›é‡è¦çš„ç»“æ„ã€‚</p>
<h5 id="ELF-Header-æ–‡ä»¶çš„æ€»ä½“ç»“æ„"><a href="#ELF-Header-æ–‡ä»¶çš„æ€»ä½“ç»“æ„" class="headerlink" title="ELF Header-æ–‡ä»¶çš„æ€»ä½“ç»“æ„"></a>ELF Header-æ–‡ä»¶çš„æ€»ä½“ç»“æ„</h5><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#define EI_NIDENT 16</span><br><span class="line">typedef struct &#123;</span><br><span class="line">    unsigned char e_ident[EI_NIDENT];</span><br><span class="line">    Elf32_Half e_type;               /* æ­¤elfæ–‡ä»¶çš„ç±»å‹è§ä¸‹è¡¨  */</span><br><span class="line">    Elf32_Half e_machine;            /* CPUå¹³å°æ¶æ„  */</span><br><span class="line">    Elf32_Word e_version;            /* æ­¤æ–‡ä»¶çš„ç‰ˆæœ¬  */</span><br><span class="line">    Elf32_Addr e_entry;              /* åŠ è½½å®Œè¯¥ç¨‹åºåçš„æ‰§è¡Œå…¥å£  */</span><br><span class="line">    Elf32_Off e_phoff;               /* program header tableåœ¨æ–‡ä»¶ä¸­çš„åç§»é‡  */</span><br><span class="line">    Elf32_Off e_shoff;               /* section header tableåœ¨æ­¤æ–‡ä»¶ä¸­çš„åç§»é‡ */</span><br><span class="line">    Elf32_Word e_flags;              /* processor-specific flags associated with the file */</span><br><span class="line">    Elf32_Half e_ehsize;             /* the ELF header&#x27;s size in bytes. */</span><br><span class="line">    Elf32_Half e_phentsize;          /* program-header-tableæ•°ç»„ä¸­ä¸€ä¸ªå…ƒç´ çš„å¤§å° */</span><br><span class="line">    Elf32_Half e_phnum;              /* program-header-tableæ•°ç»„å…ƒç´ çš„ä¸ªæ•° */</span><br><span class="line">    Elf32_Half e_shentsize;          /* section header tableæ•°ç»„ä¸­ä¸€ä¸ªå…ƒç´ çš„å¤§å° */</span><br><span class="line">    Elf32_Half e_shnum;              /* section header tableåŒ…å«çš„å…ƒç´ ä¸ªæ•° */</span><br><span class="line">    Elf32_Half e_shstrndx;           /* the section header table index of the entry associated with the section name string table. */</span><br><span class="line"> &#125; Elf32_Ehdr;</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>æ–‡ä»¶ç±»å‹</th>
<th>ç±»å‹æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td>ET_NONE</td>
<td>æœªçŸ¥ç±»å‹ã€‚è¿™ä¸ªæ ‡è®°è¡¨æ˜æ–‡ä»¶ç±»å‹ä¸ç¡®å®šï¼Œæˆ–è€…è¿˜æœªå®šä¹‰ã€‚</td>
</tr>
<tr>
<td>ET_REL</td>
<td>é‡å®šä½æ–‡ä»¶ã€‚ ELF ç±»å‹æ ‡è®°ä¸º relocatable æ„å‘³ç€è¯¥æ–‡ä»¶è¢«æ ‡è®°ä¸ºäº†ä¸€æ®µå¯é‡å®šä½çš„ä»£ç ï¼Œæœ‰æ—¶ä¹Ÿç§°ä¸ºç›®æ ‡æ–‡ä»¶ã€‚å¯é‡å®šä½ ç›®æ ‡æ–‡ä»¶é€šå¸¸æ˜¯è¿˜æœªè¢«é“¾æ¥åˆ°å¯æ‰§è¡Œç¨‹åºçš„ä¸€æ®µä½ç½®ç‹¬ç«‹çš„ä»£ç  ï¼ˆposition independent codeï¼‰ã€‚ åœ¨ç¼–è¯‘å®Œä»£ç ä¹‹åé€šå¸¸å¯ä»¥çœ‹åˆ°ä¸€ ä¸ª.o æ ¼å¼çš„æ–‡ä»¶ï¼Œ è¿™ç§æ–‡ä»¶åŒ…å«äº†åˆ›å»ºå¯æ‰§è¡Œæ–‡ä»¶æ‰€éœ€è¦çš„ä»£ç  å’Œæ•°æ®ã€‚</td>
</tr>
<tr>
<td>ET_EXEC</td>
<td>å¯æ‰§è¡Œæ–‡ä»¶ã€‚ELF ç±»å‹ä¸º executableï¼Œè¡¨æ˜è¿™ä¸ªæ–‡ä»¶è¢«æ ‡ è®°ä¸ºå¯æ‰§è¡Œæ–‡ä»¶ã€‚è¿™ç§ç±»å‹çš„æ–‡ä»¶ä¹Ÿç§°ä¸ºç¨‹åºï¼Œæ˜¯ä¸€ä¸ªè¿›ç¨‹å¼€å§‹æ‰§ è¡Œçš„å…¥å£ã€‚</td>
</tr>
<tr>
<td>ET_DYN</td>
<td>å…±äº«ç›®æ ‡æ–‡ä»¶ã€‚ELF ç±»å‹ä¸º dynamicï¼Œæ„å‘³ç€è¯¥æ–‡ä»¶è¢«æ ‡è®° ä¸ºäº†ä¸€ä¸ªåŠ¨æ€çš„å¯é“¾æ¥çš„ç›®æ ‡æ–‡ä»¶ï¼Œä¹Ÿç§°ä¸ºå…±äº«åº“ã€‚è¿™ç±»å…±äº«åº“ä¼šåœ¨ ç¨‹åºè¿è¡Œæ—¶è¢«è£…è½½å¹¶é“¾æ¥åˆ°ç¨‹åºçš„è¿›ç¨‹é•œåƒä¸­ã€‚</td>
</tr>
<tr>
<td>ET_CORE</td>
<td>æ ¸å¿ƒæ–‡ä»¶ã€‚åœ¨ç¨‹åºå´©æºƒæˆ–è€…è¿›ç¨‹ä¼ é€’äº†ä¸€ä¸ª SIGSEGV ä¿¡ å·ï¼ˆåˆ†æ®µè¿è§„ï¼‰æ—¶ï¼Œä¼šåœ¨æ ¸å¿ƒæ–‡ä»¶ä¸­è®°å½•æ•´ä¸ªè¿›ç¨‹çš„é•œåƒä¿¡æ¯ã€‚å¯ä»¥ ä½¿ç”¨ GDB è¯»å–è¿™ç±»æ–‡ä»¶æ¥è¾…åŠ©è°ƒè¯•å¹¶æŸ¥æ‰¾ç¨‹åºå´©æºƒçš„åŸå› ã€‚</td>
</tr>
</tbody></table>
<blockquote>
<p>file /bin/bash     //executable<br>file /xxx/xx.so   //shared object</p>
</blockquote>
<h5 id="Program-Header-Table"><a href="#Program-Header-Table" class="headerlink" title="Program Header Table"></a>Program Header Table</h5><p>ç¨‹åºè£…è½½æ—¶ï¼Œæ ¹æ®æ­¤ç»“æ„çš„ä¿¡æ¯å¯¹æ–‡ä»¶è¿›è¡Œåˆ†æ®µï¼ˆsegmentï¼‰ã€‚æè¿°äº†ç£ç›˜ä¸Šå¯æ‰§è¡Œæ–‡ä»¶çš„å†…å­˜å¸ƒå±€ä»¥åŠå¦‚ä½•æ˜ å°„åˆ°å†…å­˜ä¸­ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">typedef struct &#123;</span><br><span class="line">   uint32_t   p_type;   /* æ­¤å…ƒç´ æè¿°çš„æ˜¯å“ªç§segmentï¼Œä»¥åŠå¦‚ä½•è§£æ  */</span><br><span class="line">   Elf32_Off  p_offset; /* segmenté¦–å­—èŠ‚åœ¨æ–‡ä»¶ä¸­çš„åç§»å€¼  */</span><br><span class="line">   Elf32_Addr p_vaddr;  /* åº”è¯¥åŠ è½½åˆ°å†…å­˜ä¸­çš„å“ªä¸ªè™šæ‹Ÿåœ°å€ä¸­  */</span><br><span class="line">   Elf32_Addr p_paddr;  /* ç›¸å…³çš„ç‰©ç†åœ°å€ï¼ŒBSDä¸­ä¸º0  */</span><br><span class="line">   uint32_t   p_filesz; /* æ–‡ä»¶çš„å­—èŠ‚æ•°  */</span><br><span class="line">   uint32_t   p_memsz;  /* åŠ è½½åˆ°å†…å­˜ä¸­çš„å­—èŠ‚æ•°  */</span><br><span class="line">   uint32_t   p_flags;  /* segmentç±»å‹æ ‡å¿—ä½  */</span><br><span class="line">   uint32_t   p_align;  /* å†…å­˜å¯¹é½  */</span><br><span class="line">&#125; Elf32_Phdr;</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>p_flags</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td>PF_X</td>
<td>An executable segment.</td>
</tr>
<tr>
<td>PF_W</td>
<td>A writable segment.</td>
</tr>
<tr>
<td>PF_R</td>
<td>A readable segment.</td>
</tr>
</tbody></table>
<h5 id="Section-Header-Table"><a href="#Section-Header-Table" class="headerlink" title="Section Header Table"></a>Section Header Table</h5><p>ç”¨äºå®šä½æ–‡ä»¶ä¸­æ‰€æœ‰çš„sectionï¼Œä¸»è¦ç”¨äºé“¾æ¥å’Œè°ƒè¯•ï¼Œæ²¡æœ‰Section Header Tableç¨‹åºä»ç„¶å¯ä»¥æ­£å¸¸è¿è¡Œï¼Œå› ä¸ºå®ƒæ²¡æœ‰å¯¹å†…å­˜å¸ƒå±€è¿›è¡Œæè¿°ï¼Œå®ƒæ˜¯ä¸€ä¸ªå…ƒç´ ä¸ºElf32_Shdrçš„æ•°ç»„ç»“æ„ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">typedef struct</span><br><span class="line">&#123;</span><br><span class="line">	Elf32_Word sh_name;      /* Section name (string tbl index)   */</span><br><span class="line">	Elf32_Word sh_type;      /* Section type                      */</span><br><span class="line">	Elf32_Word sh_flags;     /* Section flags                     */</span><br><span class="line">	Elf32_Addr sh_addr;      /* Section virtual addr at execution */</span><br><span class="line">	Elf32_Off sh_offset;     /* Section file offset               */</span><br><span class="line">	Elf32_Word sh_size;      /* Section size in bytes             */</span><br><span class="line">	Elf32_Word sh_link;      /* Link to another section           */</span><br><span class="line">	Elf32_Word sh_info;      /* Additional section information    */</span><br><span class="line">	Elf32_Word sh_addralign; /* Section alignment                 */</span><br><span class="line">	Elf32_Word sh_entsize;   /* Entry size if section holds table */</span><br><span class="line">&#125; Elf32_Shdr;</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>Section type</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td>SHT_NULL</td>
<td>This value marks the section header as inactive. It does not have an associated section.  Other members of the section header have undefined values.</td>
</tr>
<tr>
<td>SHT_PROGBITS</td>
<td>This section holds information defined by the program, whose format and meaning are determined solely by the program.</td>
</tr>
<tr>
<td>SHT_SYMTAB</td>
<td>This section holds a symbol table.  Typically, SHT_SYMTAB provides symbols for link editing, though it may also be used for dynamic linking.  As a complete symbol table, it may contain many symbols unnecessary for dynamic linking.  An object file can also contain a SHT_DYNSYM section.</td>
</tr>
<tr>
<td>SHT_STRTAB</td>
<td>This section holds a string table.  An object file may have multiple string table sections.</td>
</tr>
<tr>
<td>SHT_RELA</td>
<td>This section holds relocation entries with explicit addends, such as type Elf32_Rela for the 32-bit class of object files.  An object may have multiple relocation sections.</td>
</tr>
<tr>
<td>SHT_HASH</td>
<td>This section holds a symbol hash table.  An object participating in dynamic linking must contain a symbol hash table.  An object file may have only one hash table.</td>
</tr>
<tr>
<td>SHT_DYNAMIC</td>
<td>This section holds information for dynamic linking. An object file may have only one dynamic section.</td>
</tr>
<tr>
<td>SHT_NOTE</td>
<td>This section holds notes (ElfN_Nhdr).</td>
</tr>
<tr>
<td>SHT_NOBITS</td>
<td>A section of this type occupies no space in the  file but otherwise resembles SHT_PROGBITS. Although this section contains no bytes, the sh_offset member contains the conceptual file offset.</td>
</tr>
<tr>
<td>SHT_REL</td>
<td>This section holds relocation offsets without explicit addends, such as type Elf32_Rel for the 32-bit class of object files.  An object file may have multiple relocation sections.</td>
</tr>
<tr>
<td>SHT_SHLIB</td>
<td>This section is reserved but has unspecified semantics.</td>
</tr>
<tr>
<td>SHT_DYNSYM</td>
<td>This section holds a minimal set of dynamic linking symbols.  An object file can also contain a SHT_SYMTAB section.</td>
</tr>
<tr>
<td>SHT_LOPROC, SHT_HIPROC</td>
<td>Values in the inclusive range [SHT_LOPROC, SHT_HIPROC] are reserved for processor-specific semantics.</td>
</tr>
<tr>
<td>SHT_LOUSER</td>
<td>This value specifies the lower bound of the range of indices reserved for application programs.</td>
</tr>
<tr>
<td>SHT_HIUSER</td>
<td>This value specifies the upper bound of the range of indices reserved for application programs. Section types between SHT_LOUSER and SHT_HIUSER may be used by the application, without conflicting with current or future system-defined section types.</td>
</tr>
</tbody></table>
<h5 id="å­—ç¬¦ä¸²è¡¨å’Œç¬¦å·è¡¨ï¼ˆString-and-symbol-tablesï¼‰"><a href="#å­—ç¬¦ä¸²è¡¨å’Œç¬¦å·è¡¨ï¼ˆString-and-symbol-tablesï¼‰" class="headerlink" title="å­—ç¬¦ä¸²è¡¨å’Œç¬¦å·è¡¨ï¼ˆString and symbol tablesï¼‰"></a>å­—ç¬¦ä¸²è¡¨å’Œç¬¦å·è¡¨ï¼ˆString and symbol tablesï¼‰</h5><p>å­˜æ”¾scetionçš„åå­—ï¼Œä»¥åŠç¬¦å·ä¿¡æ¯ã€‚å…¶ä»–ç»“æ„é€šè¿‡indexè®¿é—®æ­¤ç»“æ„ä¸­çš„å­—ç¬¦ä¸²ä¿¡æ¯ã€‚ç¬¦å·è¡¨ä¿å­˜äº†ç”¨äºå®šä½ç¬¦å·å¼•ç”¨çš„ä¿¡æ¯ã€‚å®ƒæ˜¯ä»¥ä¸‹ç»“æ„çš„æ•°ç»„ï¼š</p>
<center>
    <img src="../images/elf_string_table.jpeg" width="500"/>
</center>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">typedef struct &#123;</span><br><span class="line">       uint32_t      st_name;</span><br><span class="line">       Elf32_Addr    st_value;</span><br><span class="line">       uint32_t      st_size;</span><br><span class="line">       unsigned char st_info;</span><br><span class="line">       unsigned char st_other;</span><br><span class="line">       uint16_t      st_shndx;</span><br><span class="line">&#125; Elf32_Sym;</span><br></pre></td></tr></table></figure>


<h5 id="Relocation-entries-Rel-amp-Rela"><a href="#Relocation-entries-Rel-amp-Rela" class="headerlink" title="Relocation entries (Rel &amp; Rela)"></a>Relocation entries (Rel &amp; Rela)</h5><p>é‡å®šä½æ˜¯è¿æ¥ç¬¦å·å¼•ç”¨ï¼ˆå‡½æ•°çš„åå­—ï¼‰å’Œç¬¦å·å®šä¹‰ï¼ˆå‡½æ•°çš„å®šä¹‰ã€å‡½æ•°çš„å®ç°ï¼‰çš„è¿‡ç¨‹ã€‚é‡å®šä½æ–‡ä»¶å¿…é¡»åŒ…å«å¦‚ä½•ä¿®æ”¹sectionå†…å®¹çš„ä¿¡æ¯ï¼Œæ¥è®©æ‰§è¡Œæ–‡ä»¶æˆ–å…±äº«ç›®æ ‡æ–‡ä»¶æ­£ç¡®çš„è°ƒç”¨å¤–éƒ¨å‡½æ•°ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">typedef struct &#123;</span><br><span class="line">        Elf32_Addr      r_offset;</span><br><span class="line">        Elf32_Word      r_info;</span><br><span class="line">&#125; Elf32_Rel;</span><br><span class="line"> </span><br><span class="line">typedef struct &#123;</span><br><span class="line">        Elf32_Addr      r_offset;</span><br><span class="line">        Elf32_Word      r_info;</span><br><span class="line">        Elf32_Sword     r_addend;</span><br><span class="line">&#125; Elf32_Rela;</span><br></pre></td></tr></table></figure>
<p>r_offsetï¼š<br>å¯¹äºé‡å®šä½æ–‡ä»¶æ¥è¯´ï¼Œæ­¤å€¼è¡¨ç¤ºä»sectionçš„å¼€å§‹åˆ°è¢«ä¿®æ”¹å€¼åœ¨sectionä¸­çš„åç§»é‡ã€‚<br>å¯¹äºæ‰§è¡Œæ–‡ä»¶å’Œå…±äº«åº“æ–‡ä»¶æ¥è¯´ï¼Œæ­¤å€¼è¡¨ç¤ºéœ€è¦è¢«é‡å®šä½çš„è™šæ‹Ÿåœ°å€ã€‚</p>
<p>r_infoï¼š<br>ç¬¦å·è¡¨çš„indexå’Œé‡å®šä½çš„ç±»å‹ã€‚</p>
<p>r_addendï¼š<br>ç”¨äºè®¡ç®—é‡å®šä½å­—æ®µçš„å€¼ã€‚</p>
<h5 id="Dynamic-tagsï¼ˆDynï¼‰"><a href="#Dynamic-tagsï¼ˆDynï¼‰" class="headerlink" title="Dynamic tagsï¼ˆDynï¼‰"></a>Dynamic tagsï¼ˆDynï¼‰</h5><p><code>.dynamic</code>è¿™ä¸ªsectionå­˜å‚¨ä¸€äº›åŒ…å«åŠ¨æ€é“¾æ¥ä¿¡æ¯çš„ç»“æ„</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">typedef struct &#123;</span><br><span class="line">        Elf32_Sword    d_tag;</span><br><span class="line">        union &#123;</span><br><span class="line">            Elf32_Word d_val;</span><br><span class="line">            Elf32_Addr d_ptr;</span><br><span class="line">        &#125; d_un;</span><br><span class="line"> &#125; Elf32_Dyn;</span><br><span class="line">           </span><br><span class="line">extern Elf64_Dyn _DYNAMIC[];</span><br></pre></td></tr></table></figure>

<h4 id="ä¸€äº›å›¾ç¤º"><a href="#ä¸€äº›å›¾ç¤º" class="headerlink" title="ä¸€äº›å›¾ç¤º"></a>ä¸€äº›å›¾ç¤º</h4><center>
    <img src="../images/file/elf_file_format-overview.jpeg" width="500"/>
</center>

<center>
    <img src="../images/file/elf-64-bit-overview.png" width="500"/>
</center>

<h4 id="ä¸‰ã€å‚è€ƒé“¾æ¥"><a href="#ä¸‰ã€å‚è€ƒé“¾æ¥" class="headerlink" title="ä¸‰ã€å‚è€ƒé“¾æ¥"></a>ä¸‰ã€å‚è€ƒé“¾æ¥</h4><p><a href="https://www.man7.org/linux/man-pages/man5/elf.5.html">Linux manual page</a><br><a href="https://www.codetd.com/article/489055">The structure of an ARM ELF image</a><br><a href="https://www3.ntu.edu.sg/home/ehchua/programming/cpp/gcc_make.html">Compiling, Linking and Building</a></p>
]]></content>
      <categories>
        <category>è®¡ç®—æœº</category>
      </categories>
      <tags>
        <tag>File</tag>
      </tags>
  </entry>
  <entry>
    <title>flutterçŠ¶æ€ç®¡ç†ä¹‹BloC</title>
    <url>/flutter-state-bloc.html</url>
    <content><![CDATA[<hr>
<h4 id="ä¸€ã€æ¦‚è¿°"><a href="#ä¸€ã€æ¦‚è¿°" class="headerlink" title="ä¸€ã€æ¦‚è¿°"></a>ä¸€ã€æ¦‚è¿°</h4><p>Bloc = Business Logic Component</p>
<center>
    <img src="../images/flutter/bloc_architecture.png" width="60%"/>
</center>


<h4 id="äºŒã€ç»“æ„"><a href="#äºŒã€ç»“æ„" class="headerlink" title="äºŒã€ç»“æ„"></a>äºŒã€ç»“æ„</h4><p>BloCæœ¬èº«æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„packageã€flutter-blocåŸºäºBloCå’ŒProviderå®ç°ï¼Œå…¶ç»“æ„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<center>
    <img src="../images/flutter/flutter_bloc.png" width="100%"/>
</center>

<h4 id="ä¸‰ã€-å®ç°"><a href="#ä¸‰ã€-å®ç°" class="headerlink" title="ä¸‰ã€ å®ç°"></a>ä¸‰ã€ å®ç°</h4><h5 id="3-1-BloCæ˜¯åŸºäºdartçš„Stream-APIå®ç°çš„å‘å¸ƒè®¢é˜…æ¨¡å¼ã€‚"><a href="#3-1-BloCæ˜¯åŸºäºdartçš„Stream-APIå®ç°çš„å‘å¸ƒè®¢é˜…æ¨¡å¼ã€‚" class="headerlink" title="3.1 BloCæ˜¯åŸºäºdartçš„Stream APIå®ç°çš„å‘å¸ƒè®¢é˜…æ¨¡å¼ã€‚"></a>3.1 BloCæ˜¯åŸºäºdartçš„Stream APIå®ç°çš„å‘å¸ƒè®¢é˜…æ¨¡å¼ã€‚</h5><ul>
<li>é€šè¿‡onæ–¹æ³•è®¢é˜…äº‹ä»¶å¹¶æä¾›å¤„ç†å‡½æ•°ï¼Œæ”¶åˆ°Eventå†å°†Eventè½¬æ¢æˆStateè¿”å›ç»™Bloc</li>
<li>é€šè¿‡addæ–¹æ³•å‘å¸ƒäº‹ä»¶</li>
</ul>
<figure class="highlight dart"><table><tr><td class="code"><pre><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Bloc</span>&lt;<span class="title">Event</span>, <span class="title">State</span>&gt; <span class="keyword">extends</span> <span class="title">BlocBase</span>&lt;<span class="title">State</span>&gt;</span></span><br><span class="line"><span class="class">    <span class="keyword">implements</span> <span class="title">BlocEventSink</span>&lt;<span class="title">Event</span>&gt; </span>&#123;</span><br><span class="line">     <span class="comment">//æ‰€æœ‰çš„è®¢é˜…è€…</span></span><br><span class="line">     <span class="keyword">final</span> _subscriptions = &lt;StreamSubscription&lt;<span class="built_in">dynamic</span>&gt;&gt;[];</span><br><span class="line">     </span><br><span class="line">     <span class="keyword">final</span> _eventController = StreamController&lt;Event&gt;.broadcast();</span><br><span class="line">     </span><br><span class="line">     <span class="comment">//æ·»åŠ è®¢é˜…è€…</span></span><br><span class="line">     <span class="keyword">void</span> <span class="keyword">on</span>&lt;E <span class="keyword">extends</span> Event&gt;(</span><br><span class="line">       EventHandler&lt;E, State&gt; handler, &#123;</span><br><span class="line">       EventTransformer&lt;E&gt;? transformer,</span><br><span class="line">     &#125;) &#123;</span><br><span class="line">        <span class="comment">//è¿™é‡Œå¼€å§‹äº†listen</span></span><br><span class="line">        <span class="keyword">final</span> subscription = xxx.listen(<span class="keyword">null</span>);</span><br><span class="line">        _subscriptions.add(subscription);</span><br><span class="line">     &#125;</span><br><span class="line">     </span><br><span class="line">     <span class="meta">@override</span></span><br><span class="line">     <span class="keyword">void</span> add(Event event) &#123;</span><br><span class="line">       <span class="keyword">try</span> &#123;</span><br><span class="line">         onEvent(event);</span><br><span class="line">         _eventController.add(event);</span><br><span class="line">       &#125; <span class="keyword">catch</span> (error, stackTrace) &#123;</span><br><span class="line">         onError(error, stackTrace);</span><br><span class="line">         <span class="keyword">rethrow</span>;</span><br><span class="line">       &#125;</span><br><span class="line">     &#125;</span><br><span class="line">     </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<center>
    <img src="../images/flutter/flutter-bloc-inner.png" width="50%"/>
</center>


<h5 id="3-1-äº‹ä»¶å’ŒçŠ¶æ€ä¹‹é—´çš„è½¬æ¢"><a href="#3-1-äº‹ä»¶å’ŒçŠ¶æ€ä¹‹é—´çš„è½¬æ¢" class="headerlink" title="3.1 äº‹ä»¶å’ŒçŠ¶æ€ä¹‹é—´çš„è½¬æ¢"></a>3.1 äº‹ä»¶å’ŒçŠ¶æ€ä¹‹é—´çš„è½¬æ¢</h5><ul>
<li>è½¬æ¢é€»è¾‘æœ‰ä¸šåŠ¡å±‚é€šè¿‡on()æ³¨å…¥</li>
<li>å†…éƒ¨çš„æ ¸å¿ƒæ˜¯_Emitterä»¥åŠ <em>_eventController</em> å’Œ <em>_stateController</em></li>
</ul>
<figure class="highlight dart"><table><tr><td class="code"><pre><span class="line">(<span class="built_in">dynamic</span> event) &#123;</span><br><span class="line">       <span class="keyword">void</span> onEmit(State state) &#123;</span><br><span class="line">         <span class="keyword">if</span> (isClosed) <span class="keyword">return</span>;</span><br><span class="line">         <span class="keyword">if</span> (<span class="keyword">this</span>.state == state &amp;&amp; _emitted) <span class="keyword">return</span>;</span><br><span class="line">         onTransition(Transition(</span><br><span class="line">           currentState: <span class="keyword">this</span>.state,</span><br><span class="line">           event: event <span class="keyword">as</span> E,</span><br><span class="line">           nextState: state,</span><br><span class="line">         ));</span><br><span class="line">         emit(state);</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="keyword">final</span> emitter = _Emitter(onEmit);</span><br><span class="line">       <span class="keyword">final</span> controller = StreamController&lt;E&gt;.broadcast(</span><br><span class="line">         <span class="keyword">sync</span>: <span class="keyword">true</span>,</span><br><span class="line">         onCancel: emitter.cancel,</span><br><span class="line">       );</span><br><span class="line"></span><br><span class="line">       <span class="keyword">void</span> handleEvent() <span class="keyword">async</span> &#123;</span><br><span class="line">         <span class="keyword">void</span> onDone() &#123;</span><br><span class="line">           emitter.complete();</span><br><span class="line">           _emitters.remove(emitter);</span><br><span class="line">           <span class="keyword">if</span> (!controller.isClosed) controller.close();</span><br><span class="line">         &#125;</span><br><span class="line"></span><br><span class="line">         <span class="keyword">try</span> &#123;</span><br><span class="line">           _emitters.add(emitter);</span><br><span class="line">           <span class="comment">//äº¤ç»™å¤–éƒ¨å®ç°è½¬æ¢äº‹ä»¶å’ŒçŠ¶æ€</span></span><br><span class="line">           <span class="keyword">await</span> handler(event <span class="keyword">as</span> E, emitter);</span><br><span class="line">         &#125; <span class="keyword">catch</span> (error, stackTrace) &#123;</span><br><span class="line">           onError(error, stackTrace);</span><br><span class="line">           <span class="keyword">rethrow</span>;</span><br><span class="line">         &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">           onDone();</span><br><span class="line">         &#125;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       handleEvent();</span><br><span class="line">       <span class="keyword">return</span> controller.stream;</span><br><span class="line">     &#125;</span><br></pre></td></tr></table></figure>


<h4 id="å››ã€å‚è€ƒ"><a href="#å››ã€å‚è€ƒ" class="headerlink" title="å››ã€å‚è€ƒ"></a>å››ã€å‚è€ƒ</h4><p>ä¸»è¦å‚è€ƒå’Œdebugäº†blocä»“åº“é‡Œé¢examplesä¸­loginçš„ä¾‹å­ï¼š<br><a href="https://github.com/felangel/bloc/tree/master/examples/flutter_login">è¿™é‡Œ</a></p>
]]></content>
      <tags>
        <tag>Flutter</tag>
      </tags>
  </entry>
  <entry>
    <title>FlutterçŠ¶æ€ç®¡ç†ä¹‹Provider</title>
    <url>/flutter-state-provider.html</url>
    <content><![CDATA[<hr>
<h4 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h4><p>å®˜æ–¹æä¾›çš„ä¸€ä¸ªç®€å•çš„çŠ¶æ€ç®¡ç†åº“ã€‚</p>
<p>å…³é”®ç‚¹ï¼š</p>
<ul>
<li>æå–çŠ¶æ€:çŠ¶æ€å˜é‡å’ŒUIåˆ†ç¦»</li>
<li>è®¿é—®çŠ¶æ€:å°†UIå’ŒçŠ¶æ€å»ºç«‹è”ç³»</li>
<li>ä½¿ç”¨çŠ¶æ€:è¯»å–çŠ¶æ€å˜é‡</li>
</ul>
<center>
    <img src="../images/ui-equals-function-of-state.png" width="100%"/>
</center>

<h4 id="å‰ç½®çŸ¥è¯†"><a href="#å‰ç½®çŸ¥è¯†" class="headerlink" title="å‰ç½®çŸ¥è¯†"></a>å‰ç½®çŸ¥è¯†</h4><p>1ã€InheritedWidget</p>
<center>
    <img src="../images/flutter/flutter-inheritedwidget.png" width="100%"/>
</center>

<p>å…³é”®ç‚¹ï¼š</p>
<ul>
<li>ElementæŒæœ‰Widgetå¯¹è±¡</li>
<li>Elementä¹Ÿæ˜¯ä¸€ä¸ªBuildContextå¯¹è±¡</li>
<li>Elementé‡Œé¢æŒæœ‰æ‰€æœ‰çš„<code>InheritedElement</code></li>
</ul>
<p>æ‰€ä»¥ï¼šé€šè¿‡BuildContextå¯¹è±¡å¯ä»¥æ‹¿åˆ°æ‰€éœ€çš„Widgetå¯¹è±¡ï¼Œç„¶åè®¿é—®é‡Œé¢çš„æ•°æ®ã€‚</p>
<p>çˆ¶èŠ‚ç‚¹å­˜æ”¾æ•°æ®</p>
<figure class="highlight dart"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">InheritedShareWidget</span> <span class="keyword">extends</span> <span class="title">InheritedWidget</span> </span>&#123;</span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">int</span> data;<span class="comment">//ç”¨äºå…±äº«çš„æ•°æ®</span></span><br><span class="line">  InheritedShareWidget(&#123;<span class="keyword">this</span>.data, Widget child&#125;) : <span class="keyword">super</span>(child: child);</span><br><span class="line"></span><br><span class="line">  <span class="comment">//å®šä¹‰ä¾¿æ·æ–¹æ³•ï¼Œæ–¹ä¾¿å­æ§ä»¶è·å–å…±äº«æ•°æ®</span></span><br><span class="line">  <span class="keyword">static</span> InheritedShareWidget of(BuildContext context) &#123;</span><br><span class="line">  </span><br><span class="line">    <span class="comment">///<span class="markdown">å½“å­æ§ä»¶ä¾èµ–ä½¿ç”¨äº†æˆ‘ä»¬çš„æ•°æ®æºæ—¶ï¼Œæ•°æ®å˜åŠ¨ä¼šè§¦å‘å­æ§ä»¶ä¸­çš„ didChangeDependencies æ–¹æ³•</span></span></span><br><span class="line">    <span class="keyword">return</span> context.dependOnInheritedWidgetOfExactType&lt;InheritedShareWidget&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="comment">///<span class="markdown">ï¼ˆå‰æï¼šå­æ§ä»¶ä½¿ç”¨äº†æ•°æ®æºï¼‰å­æ§ä»¶ä¸­çš„ didChangeDependencies æ–¹æ³•ä¸ä¼šè¢«è§¦å‘</span></span></span><br><span class="line">    <span class="comment">// return context.getElementForInheritedWidgetOfExactType&lt;InheritedShareWidget&gt;().widget;</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="built_in">bool</span> updateShouldNotify(<span class="keyword">covariant</span> InheritedShareWidget oldWidget) &#123;</span><br><span class="line">    <span class="keyword">return</span> oldWidget.data != <span class="keyword">this</span>.data;<span class="comment">//è¿”å›trueæ—¶ï¼Œæ‰ä¼šé€šçŸ¥å­æ§ä»¶</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>å­èŠ‚ç‚¹è·å–æ•°æ®ï¼š</p>
<figure class="highlight dart"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestShareChildWidget</span> <span class="keyword">extends</span> <span class="title">StatefulWidget</span> </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> TestShareChildWidget(&#123;Key key&#125;) : <span class="keyword">super</span>(key: key);</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  _TestShareChildWidgetState createState() =&gt; _TestShareChildWidgetState();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">_TestShareChildWidgetState</span> <span class="keyword">extends</span> <span class="title">State</span>&lt;<span class="title">TestShareChildWidget</span>&gt; </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="keyword">void</span> didChangeDependencies() &#123;</span><br><span class="line">    <span class="comment">///<span class="markdown">å¦‚build æ–¹æ³•ä¸­æ²¡æœ‰ä½¿ç”¨ InheritedShareWidget çš„æ•°æ®ï¼Œé‚£ä¹ˆå®ƒçš„didChangeDependencies()å°†ä¸ä¼šè¢«è°ƒç”¨</span></span></span><br><span class="line">    <span class="keyword">super</span>.didChangeDependencies();</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;enter didChangeDependencies&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;enter child build&quot;</span>);</span><br><span class="line">    <span class="comment">//è·å–Inheritedçš„å…±äº«æ•°æ®ï¼š</span></span><br><span class="line">    <span class="keyword">final</span> data = InheritedShareWidget.of(context).data.toString();</span><br><span class="line">    <span class="keyword">return</span> Text(data);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>çˆ¶å­èŠ‚ç‚¹åµŒå¥—ï¼š</p>
<figure class="highlight dart"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">_TestInheritedWidgetState</span> <span class="keyword">extends</span> <span class="title">State</span>&lt;<span class="title">TestInheritedWidget</span>&gt; </span>&#123;</span><br><span class="line">  <span class="built_in">int</span> count = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Center(</span><br><span class="line">      child: InheritedShareWidget(</span><br><span class="line">        data: count,</span><br><span class="line">        child: Column(</span><br><span class="line">          mainAxisAlignment: MainAxisAlignment.center,</span><br><span class="line">          children: [</span><br><span class="line">            TestShareChildWidget(),</span><br><span class="line">            RaisedButton(</span><br><span class="line">                child: Text(<span class="string">&#x27;add&#x27;</span>),</span><br><span class="line">                onPressed: () &#123;</span><br><span class="line">                  setState(() &#123;</span><br><span class="line">                    ++count;</span><br><span class="line">                  &#125;);</span><br><span class="line">                &#125;)</span><br><span class="line">          ],),),);&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>2ã€InheritedProvider</p>
<center>
    <img src="../images/flutter/flutter-inheritedprovider.jpg" width="100%"/>
</center>

<p>å…³é”®ç‚¹ï¼š</p>
<ul>
<li>é€šè¿‡<code>InheritedProvider</code>åŠå…¶å­ç±»ï¼ˆå¦‚ï¼šChangeNotifierProviderï¼‰æ¥åŒ…è£¹å…¶ä»–Widgetï¼ˆchildï¼‰ï¼Œå…¶å®æ˜¯å°†childæ”¾å…¥äº†<code>_InheritedProviderScope</code></li>
<li><code>_InheritedProviderScope</code>æ˜¯ä¸€ä¸ª<code>InheritedWidget</code>æ‰€ä»¥ï¼Œ<code>InheritedProvider</code>åŠå…¶å­ç±»å°†ä¼šæŒæœ‰childå¯¹è±¡ï¼ŒåŠå…¶æ•°æ®ã€‚</li>
</ul>
<h4 id="Providerçš„åŸºæœ¬ä½¿ç”¨"><a href="#Providerçš„åŸºæœ¬ä½¿ç”¨" class="headerlink" title="Providerçš„åŸºæœ¬ä½¿ç”¨"></a>Providerçš„åŸºæœ¬ä½¿ç”¨</h4><figure class="highlight dart"><table><tr><td class="code"><pre><span class="line"><span class="comment">///<span class="markdown">è¿™æ˜¯çŠ¶æ€</span></span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> <span class="title">with</span> <span class="title">ChangeNotifier</span> </span>&#123;</span><br><span class="line">  <span class="built_in">String</span> name = <span class="string">&quot;ChangeNotifierProvider&quot;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">void</span> changName(&#123;<span class="keyword">required</span> <span class="built_in">String</span> newName&#125;) &#123;</span><br><span class="line">    name = newName;</span><br><span class="line">    notifyListeners();<span class="comment">//1</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight dart"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MainApp</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> MainApp(&#123;<span class="keyword">super</span>.key&#125;);</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> ChangeNotifierProvider&lt;Person&gt;(<span class="comment">///<span class="markdown">çŠ¶æ€å’ŒUIä¹‹é—´å»ºç«‹è”ç³»</span></span></span><br><span class="line">      create: (ctx) =&gt; Person(),</span><br><span class="line">      child: <span class="keyword">const</span> MaterialApp(</span><br><span class="line">        home: ChangeNotifierProviderDemo(),</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight dart"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ChangeNotifierProviderDemo</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> ChangeNotifierProviderDemo(&#123;Key? key&#125;) : <span class="keyword">super</span>(key: key);</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Scaffold(</span><br><span class="line">      appBar: AppBar(title: <span class="keyword">const</span> Text(<span class="string">&quot;ChangeNotifierProvider&quot;</span>)),</span><br><span class="line">      body: Center(</span><br><span class="line">        child: Column(</span><br><span class="line">          mainAxisAlignment: MainAxisAlignment.spaceEvenly,</span><br><span class="line">          children: [</span><br><span class="line">            Consumer&lt;Person&gt;(<span class="comment">///<span class="markdown">ä½¿ç”¨çŠ¶æ€</span></span></span><br><span class="line">              builder: (ctx, person, child) =&gt; Text(person.name),</span><br><span class="line">            ),</span><br><span class="line">            Consumer&lt;Person&gt;(</span><br><span class="line">              builder: (ctx, person, child) &#123;</span><br><span class="line">                <span class="keyword">return</span> ElevatedButton(</span><br><span class="line">                  onPressed: () =&gt; person.changName(newName: <span class="string">&quot;ChangeNotifierProvideræ›´æ–°äº†&quot;</span>),</span><br><span class="line">                  child: <span class="keyword">const</span> Text(<span class="string">&quot;ç‚¹å‡»æ›´æ–°&quot;</span>),</span><br><span class="line">                );&#125;,),],),),);&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h4 id="Providerçš„ç±»ç»“æ„"><a href="#Providerçš„ç±»ç»“æ„" class="headerlink" title="Providerçš„ç±»ç»“æ„"></a>Providerçš„ç±»ç»“æ„</h4><center>
    <img src="../images/flutter/flutter_provider.png" width="100%"/>
</center>


<p>3.1 InheritedProviderçš„å­ç±»åªæ˜¯å…·ä½“åŠŸèƒ½çš„å®ç°ï¼ŒåŸºç¡€é€»è¾‘å°è£…åœ¨InheritedProviderä¸­<br>3.2 InheritedProviderå°†èŒè´£è½¬å«ç»™_InheritedProviderScopeè€Œ_InheritedProviderScopeæ˜¯ä¸€ä¸ªInheritedWidget</p>
<h4 id="å¦‚ä½•å®ç°ç›‘å¬"><a href="#å¦‚ä½•å®ç°ç›‘å¬" class="headerlink" title="å¦‚ä½•å®ç°ç›‘å¬"></a>å¦‚ä½•å®ç°ç›‘å¬</h4><p>1ã€æ•°æ®å®ç°äº†ChangeNotifierï¼Œå˜æ›´åè°ƒç”¨notifyListeners(),è§¦å‘å›è°ƒã€‚</p>
<p>2ã€ChangeNotifierProviderç»§æ‰¿è‡ªListenableProviderï¼ŒListenableProvideræ„å»ºæ—¶å¼€å¯ç›‘å¬ï¼š</p>
<figure class="highlight dart"><table><tr><td class="code"><pre><span class="line"><span class="keyword">static</span> VoidCallback _startListening(</span><br><span class="line">  InheritedContext e,</span><br><span class="line">  Listenable? value,</span><br><span class="line">) &#123;</span><br><span class="line">  value?.addListener(e.markNeedsNotifyDependents);</span><br><span class="line">  <span class="keyword">return</span> () =&gt; value?.removeListener(e.markNeedsNotifyDependents);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>class InheritedContext extends BuildContext{<br>    void markNeedsNotifyDependents();<br>}</p>
<p>3ã€markNeedsNotifyDependentsæ˜¯<code>InheritedContext</code>ä¸­çš„æ–¹æ³•ï¼Œå…¶å®ç°ç±»æ˜¯<code>_InheritedProviderScopeElement</code></p>
<figure class="highlight dart"><table><tr><td class="code"><pre><span class="line"><span class="meta">@override</span></span><br><span class="line">  <span class="keyword">void</span> markNeedsNotifyDependents() &#123;</span><br><span class="line">    <span class="keyword">if</span> (!_isNotifyDependentsEnabled) &#123;</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    markNeedsBuild();</span><br><span class="line">    _shouldNotifyDependents = <span class="keyword">true</span>;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p>4ã€markNeedsBuildæ˜¯Elementçš„æ–¹æ³•ï¼šæ ‡è®°éœ€è¦é‡æ–°æ„å»º</p>
<figure class="highlight dart"><table><tr><td class="code"><pre><span class="line"><span class="keyword">void</span> markNeedsBuild() &#123;</span><br><span class="line">    ...  </span><br><span class="line">    <span class="keyword">if</span> (dirty) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    _dirty = <span class="keyword">true</span>;</span><br><span class="line">    owner!.scheduleBuildFor(<span class="keyword">this</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h4 id="å±€éƒ¨æ›´æ–°"><a href="#å±€éƒ¨æ›´æ–°" class="headerlink" title="å±€éƒ¨æ›´æ–°"></a>å±€éƒ¨æ›´æ–°</h4><p>Providerçš„<code>Selector</code>æä¾›äº†ç¼“å­˜Widgetçš„åŠŸèƒ½ï¼Œå½“Widgetæ²¡æœ‰å˜åŒ–æ—¶ï¼Œå°†ç›´æ¥è¿”å›ç¼“å­˜ï¼Œå¦åˆ™é‡æ–°buildã€‚</p>
<figure class="highlight dart"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">_Selector0State</span>&lt;<span class="title">T</span>&gt; <span class="keyword">extends</span> <span class="title">SingleChildState</span>&lt;<span class="title">Selector0</span>&lt;<span class="title">T</span>&gt;&gt; </span>&#123;</span><br><span class="line">  T? value;</span><br><span class="line">  Widget? cache;<span class="comment">//è¿™æ˜¯ç¼“å­˜</span></span><br><span class="line">  Widget? oldWidget;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget buildWithChild(BuildContext context, Widget? child) &#123;</span><br><span class="line">    <span class="keyword">final</span> selected = widget.selector(context);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">final</span> shouldInvalidateCache = oldWidget != widget ||</span><br><span class="line">        (widget._shouldRebuild != <span class="keyword">null</span> &amp;&amp;</span><br><span class="line">            widget._shouldRebuild!(value <span class="keyword">as</span> T, selected)) ||</span><br><span class="line">        (widget._shouldRebuild == <span class="keyword">null</span> &amp;&amp;</span><br><span class="line">            !<span class="keyword">const</span> DeepCollectionEquality().equals(value, selected));</span><br><span class="line">    <span class="keyword">if</span> (shouldInvalidateCache) &#123;<span class="comment">//éœ€è¦é‡æ–°æ„å»º</span></span><br><span class="line">      value = selected;</span><br><span class="line">      oldWidget = widget;</span><br><span class="line">      cache = widget.builder(</span><br><span class="line">        context,</span><br><span class="line">        selected,</span><br><span class="line">        child,</span><br><span class="line">      );</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> cache!;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="keyword">void</span> debugFillProperties(DiagnosticPropertiesBuilder properties) &#123;</span><br><span class="line">    <span class="keyword">super</span>.debugFillProperties(properties);</span><br><span class="line">    properties.add(DiagnosticsProperty&lt;T&gt;(<span class="string">&#x27;value&#x27;</span>, value));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h4 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h4><p><a href="https://juejin.cn/post/7067356022272163847#heading-16">https://juejin.cn/post/7067356022272163847#heading-16</a></p>
]]></content>
      <tags>
        <tag>Flutter</tag>
      </tags>
  </entry>
  <entry>
    <title>Flutter Widgetä¹‹Rowã€Column</title>
    <url>/flutter-widget-row.html</url>
    <content><![CDATA[<h4 id="Rowå’ŒColumnåˆ†åˆ«åœ¨æ¨ªå‘å’Œçºµå‘å¯¹å­Widgetè¿›è¡Œå¸ƒå±€ã€‚"><a href="#Rowå’ŒColumnåˆ†åˆ«åœ¨æ¨ªå‘å’Œçºµå‘å¯¹å­Widgetè¿›è¡Œå¸ƒå±€ã€‚" class="headerlink" title="Rowå’ŒColumnåˆ†åˆ«åœ¨æ¨ªå‘å’Œçºµå‘å¯¹å­Widgetè¿›è¡Œå¸ƒå±€ã€‚"></a>Rowå’ŒColumnåˆ†åˆ«åœ¨æ¨ªå‘å’Œçºµå‘å¯¹å­Widgetè¿›è¡Œå¸ƒå±€ã€‚</h4><ul>
<li>å¯¹äºRowæ¥è®²ï¼Œæ¨ªå‘æ˜¯ä¸»è½´ï¼Œçºµå‘æ˜¯äº¤å‰è½´ã€‚</li>
<li>å¯¹äºColumnæ¥è®²ï¼Œæ¨ªå‘æ˜¯äº¤å‰è½´ï¼Œçºµå‘æ˜¯ä¸»è½´ã€‚</li>
</ul>
<p>é’ˆå¯¹ä¸»è½´å’Œäº¤å‰è½´ï¼Œä¸åŒå¤§å°çš„å­Widgetè¯¥å¦‚ä½•å¯¹é½å‘¢ï¼ŸFlutteræä¾›äº†ä¸‹åˆ—å±æ€§ï¼š</p>
<h4 id="MainAxisAlignmentï¼šä¸»è½´å¯¹é½æ–¹å¼"><a href="#MainAxisAlignmentï¼šä¸»è½´å¯¹é½æ–¹å¼" class="headerlink" title="MainAxisAlignmentï¼šä¸»è½´å¯¹é½æ–¹å¼"></a>MainAxisAlignmentï¼šä¸»è½´å¯¹é½æ–¹å¼</h4><table>
<thead>
<tr>
<th>å±æ€§å€¼</th>
<th>è§£é‡Š</th>
<th>å›¾ç¤º</th>
</tr>
</thead>
<tbody><tr>
<td>start</td>
<td>é è¿‘ä¸»è½´çš„å¼€å§‹</td>
<td><center><img src="../images/flutter/flutter_row_start.png"/></center></td>
</tr>
<tr>
<td>end</td>
<td>é è¿‘ä¸»è½´çš„æœ«å°¾</td>
<td><center><img src="../images/flutter/flutter_row_end.png"/></center></td>
</tr>
<tr>
<td>center</td>
<td>é è¿‘ä¸»è½´ä¸­é—´</td>
<td><center><img src="../images/flutter/flutter_row_center.png"/></center></td>
</tr>
<tr>
<td>spaceBetween</td>
<td>å‰©ä½™ç©ºé—´åœ¨å­©å­ä¸­é—´å¹³åˆ†</td>
<td><center><img src="../images/flutter/flutter_row_space_between.png"/></center></td>
</tr>
<tr>
<td>spaceAround</td>
<td>å‰©ä½™ç©ºé—´å›´ç»•å­©å­å¹³åˆ†</td>
<td><center><img src="../images/flutter/flutter_row_space_around.png"/></center></td>
</tr>
<tr>
<td>spaceEvenly</td>
<td>å‰©ä½™ç©ºé—´åœ¨å­©å­ä¹‹é—´å‡ç­‰åˆ†é…</td>
<td><center><img src="../images/flutter/flutter_row_space_evenly.png"/></center></td>
</tr>
</tbody></table>
<h4 id="CrossAxisAlignment-äº¤å‰è½´å¯¹é½æ–¹å¼"><a href="#CrossAxisAlignment-äº¤å‰è½´å¯¹é½æ–¹å¼" class="headerlink" title="CrossAxisAlignment:äº¤å‰è½´å¯¹é½æ–¹å¼"></a>CrossAxisAlignment:äº¤å‰è½´å¯¹é½æ–¹å¼</h4><table>
<thead>
<tr>
<th>å±æ€§å€¼</th>
<th>è§£é‡Š</th>
<th>å›¾ç¤º</th>
</tr>
</thead>
<tbody><tr>
<td>start</td>
<td>å·¦å¯¹é½(Column)æˆ–ä¸Šå¯¹é½(Row)</td>
<td><center><img src="../images/flutter/cross_axis_start.jpeg" width="50%"/></center></td>
</tr>
<tr>
<td>end</td>
<td>å³å¯¹é½(Column)æˆ–ä¸‹å¯¹é½(Row)</td>
<td><center><img src="../images/flutter/cross_axis_end.jpeg" width="50%"/></center></td>
</tr>
<tr>
<td>center</td>
<td>ä¸­é—´å¯¹é½</td>
<td><center><img src="../images/flutter/cross_axis_center.jpeg" width="50%"/></center></td>
</tr>
<tr>
<td>stretch</td>
<td>æ‹‰ä¼¸</td>
<td><center><img src="../images/flutter/cross_axis_stretch.jpeg" width="50%"/></center></td>
</tr>
<tr>
<td>baseline</td>
<td>åŸºçº¿å¯¹é½,éœ€è¦é…åˆtextBaselineå±æ€§ä½¿ç”¨</td>
<td><center><img src="../images/flutter/cross_axis_baseline.jpg" width="50%"/></center></td>
</tr>
</tbody></table>
]]></content>
      <categories>
        <category>è®¡ç®—æœº</category>
      </categories>
      <tags>
        <tag>Flutter</tag>
      </tags>
  </entry>
  <entry>
    <title>Java synchronized</title>
    <url>/java-multithreading-synchronized.html</url>
    <content><![CDATA[<h4 id="ä¸€ã€æ¦‚è¿°"><a href="#ä¸€ã€æ¦‚è¿°" class="headerlink" title="ä¸€ã€æ¦‚è¿°"></a>ä¸€ã€æ¦‚è¿°</h4><p>synchronizedä½œä¸ºJavaå†…å»ºçš„å…³é”®å­—å’Œé”æœºåˆ¶ï¼Œç†è§£å’Œä½¿ç”¨å®ƒæ˜¯å¿…è¦çš„ä¹Ÿæ˜¯æœ‰éš¾åº¦çš„ã€‚ä¸ªäººè®¤ä¸ºæ·±å…¥ç†è§£æ­¤å…³é”®å­—åœ¨äºä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š</p>
<ul>
<li>åŸºç¡€å±‚é¢ï¼šæ­£ç¡®ç†è§£å¯¹è±¡é”å’Œç±»é”ï¼Œå¹¶ç†Ÿç»ƒä½¿ç”¨</li>
<li>èƒ½åŠ›æå‡ï¼š<ul>
<li>äº†è§£å¯¹è±¡çš„å†…å­˜å¸ƒå±€ï¼Œè§‚å¯Ÿé”å¦‚ä½•å½±å“å¯¹è±¡çš„å†…å­˜å¸ƒå±€</li>
<li>äº†è§£é”ä¼˜åŒ–ï¼Œé”å‡çº§åŠå…¶è¿‡ç¨‹</li>
</ul>
</li>
<li>æ›´ä¸Šä¸€å±‚æ¥¼ï¼šOpenJDKæºç èµ°è¯»</li>
</ul>
<p>æœ¬æ–‡åªæ˜¯è®°å½•å’Œç¿»è¯‘äº†ä¸€äº›è‹±æ–‡æ–‡æ¡£çš„å†…å®¹ï¼Œä½œä¸ºç¬”è®°ä»¥åç¿»é˜…ã€‚è¯¦ç»†å†…å®¹å¯çœ‹åŸæ–‡ã€‚</p>
<h4 id="äºŒã€å¯¹è±¡é”å’Œç±»é”"><a href="#äºŒã€å¯¹è±¡é”å’Œç±»é”" class="headerlink" title="äºŒã€å¯¹è±¡é”å’Œç±»é”"></a>äºŒã€å¯¹è±¡é”å’Œç±»é”</h4><p>1.1 å¯¹è±¡é”ï¼šä¿®é¥°ä»£ç å—å’Œå®ä¾‹æ–¹æ³•</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">ObjectLock</span> </span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">synchronized</span> (<span class="keyword">this</span>) &#123;<span class="comment">//æ­¤ä»£ç å—é”ä½å½“å‰å¯¹è±¡</span></span><br><span class="line">                <span class="keyword">int</span> i = <span class="number">5</span>;</span><br><span class="line">                <span class="keyword">while</span> (i-- &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                    System.out.println(Thread.currentThread().getName() + <span class="string">&quot; : &quot;</span> + i);</span><br><span class="line">                    <span class="keyword">try</span> &#123;</span><br><span class="line">                        Thread.sleep(<span class="number">500</span>);</span><br><span class="line">                    &#125; <span class="keyword">catch</span> (InterruptedException ie) &#123;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">test2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">int</span> i = <span class="number">5</span>;</span><br><span class="line">            <span class="keyword">while</span> (i-- &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                System.out.println(Thread.currentThread().getName() + <span class="string">&quot; : &quot;</span> + i);</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    Thread.sleep(<span class="number">500</span>);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (InterruptedException ie) &#123;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p>1.2 ç±»é”:ä¿®é¥°ä»£ç å—å’Œé™æ€æ–¹æ³•</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">ClazzLock</span> </span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">synchronized</span> (ClazzLock.class) &#123;<span class="comment">//æ­¤ä»£ç å—é”ä½classç±»</span></span><br><span class="line">                <span class="keyword">int</span> i = <span class="number">5</span>;</span><br><span class="line">                <span class="keyword">while</span> (i-- &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                    System.out.println(Thread.currentThread().getName() + <span class="string">&quot; : &quot;</span> + i);</span><br><span class="line">                    <span class="keyword">try</span> &#123;</span><br><span class="line">                        Thread.sleep(<span class="number">500</span>);</span><br><span class="line">                    &#125; <span class="keyword">catch</span> (InterruptedException ie) &#123;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * é™æ€æ–¹æ³•å±äºç±»</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">test2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">int</span> i = <span class="number">5</span>;</span><br><span class="line">            <span class="keyword">while</span> (i-- &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                System.out.println(Thread.currentThread().getName() + <span class="string">&quot; : &quot;</span> + i);</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    Thread.sleep(<span class="number">500</span>);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (InterruptedException ie) &#123;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="ä¸‰ã€é”ä¼˜åŒ–"><a href="#ä¸‰ã€é”ä¼˜åŒ–" class="headerlink" title="ä¸‰ã€é”ä¼˜åŒ–"></a>ä¸‰ã€é”ä¼˜åŒ–</h4><p>ä¾æ®ä¸€ï¼šæ•°æ®æ˜¾ç¤ºï¼Œè®¸å¤šé”æœ‰å±€éƒ¨æ€§ç‰¹å¾ï¼Œä¹Ÿå°±æ˜¯è¯´å¾ˆå¤šé”çš„é”å®šå’Œé‡Šæ”¾éƒ½å‘ç”Ÿåœ¨ç‰¹å®šçš„çº¿ç¨‹ä¸Šã€‚<br>ä¾æ®äºŒï¼šæ•°æ®æ˜¾ç¤ºï¼Œå¤§éƒ¨åˆ†Javaå¯¹è±¡ä¸å­˜åœ¨ç«äº‰ã€‚</p>
<ul>
<li>é€‚åº”æ€§è‡ªæ—‹-Adaptive Spinning</li>
<li>é”æ¶ˆé™¤-Lock Elimination</li>
<li>é”ç²—åŒ–-Lock Coarsening</li>
<li>è½»é‡çº§é”-Lightweight Locking</li>
<li>åå‘é”-Biased Locking</li>
</ul>
<h5 id="3-1-åå‘é”"><a href="#3-1-åå‘é”" class="headerlink" title="3.1 åå‘é”"></a>3.1 åå‘é”</h5><p>å½“æˆ‘ä»¬å¼€å‘äº†ä¸€ä¸ªå¤šçº¿ç¨‹ç¯å¢ƒä¸‹çš„æ¨¡å—æ—¶ï¼Œå…¶ä»–äººå¯èƒ½æŠŠå®ƒç”¨åœ¨å•çº¿ç¨‹ç¯å¢ƒä¸‹ï¼Œæ­¤æ—¶åŠ é”é€»è¾‘å°±æ˜¯å¤šä½™çš„ã€‚å³ä½¿ä½¿ç”¨è½»é‡çº§é”ï¼Œæ¯æ¬¡è·å–é”éƒ½æ‰§è¡ŒCASåŸå­æŒ‡ä»¤ä¹Ÿæ˜¯ä¸€ç§æ€§èƒ½æŸè€—ã€‚ä½¿ç”¨åå‘é”ï¼Œçº¿ç¨‹é¦–æ¬¡è·å–é”æ—¶è®°å½•åå‘äºå®ƒè‡ªå·±,å½“æœ‰å…¶ä»–çº¿ç¨‹è·å–é”æ—¶ï¼Œåå‘é”è¦æ’¤é”€ï¼Œä½¿ç”¨å…¶ä»–é”æœºåˆ¶ï¼Œå¦‚è½»é‡çº§é”ã€‚</p>
<p>lock-fieldä¸­æœ‰ä¸€ä¸ªbitç”¨äºè®°å½•æ˜¯å¦åå‘çŠ¶æ€ï¼Œåˆå§‹çŠ¶æ€ä¸‹æ˜¯å¤„äºåå‘é”çŠ¶æ€ï¼Œä½†æ²¡æœ‰è®¾ç½®åå‘çš„çº¿ç¨‹IDã€‚å½“çº¿ç¨‹é¦–æ¬¡è·å–é”æ—¶ï¼Œå‘ç°æ²¡æœ‰æŒ‡å®šåå‘çš„çº¿ç¨‹ï¼Œåˆ™ä½¿ç”¨CASè®¾ç½®åå‘çº¿ç¨‹ï¼Œæ¥é¿å…ç«æ€æ¡ä»¶ã€‚</p>
<h5 id="3-2-è½»é‡çº§é”ï¼ˆThin-Lockï¼‰"><a href="#3-2-è½»é‡çº§é”ï¼ˆThin-Lockï¼‰" class="headerlink" title="3.2 è½»é‡çº§é”ï¼ˆThin Lockï¼‰"></a>3.2 è½»é‡çº§é”ï¼ˆThin Lockï¼‰</h5><p>ç›¸å¯¹äºæ¯æ¬¡å¯¹è±¡é”å®šéƒ½è·å–monitorç»“æ„çš„é‡é‡çº§é”è€Œè¨€ï¼Œè½»é‡çº§é”åªæ˜¯ä½¿ç”¨CASåŸå­æŒ‡ä»¤ä¿®æ”¹lock-fieldï¼ˆé”ä¿¡æ¯å­—æ®µï¼‰ï¼Œå› æ­¤è½»é‡çº§é”ä¸æ”¯æŒwaitå’Œnotifyã€‚å½“å‘ç”Ÿé”ç«äº‰æ—¶ï¼Œè½»é‡çº§é”è†¨èƒ€ï¼ŒåŒæ—¶åˆ†é…monitorç»“æ„ï¼Œlock-fieldæ›´æ–°æˆmonitorçš„æŒ‡é’ˆã€‚</p>
<p>Javaçš„é”æ˜¯å¯é‡å…¥çš„ï¼Œæ‰€ä»¥éœ€è¦è®°å½•å½“å‰é”çš„é‡å…¥æ¬¡æ•°å’Œé”çš„æŒæœ‰è€…ã€‚</p>
<ul>
<li>è®°å½•æ–¹å¼ä¸€ï¼š<br>æœ€ç›´æ¥çš„æ–¹å¼æ˜¯æŠŠlock-fieldåˆ†æˆä¸¤éƒ¨åˆ†ï¼Œä¸€ä¸ªè®°å½•é”çš„æŒæœ‰è€…ï¼Œä¸€ä¸ªè®°å½•é”é‡å…¥æ¬¡æ•°ã€‚ç”±äºlock-fieldå­—æ®µé•¿åº¦å›ºå®šï¼Œæ‰€ä»¥é‡å…¥æ¬¡æ•°è¢«é™åˆ¶äº†ã€‚é‡å…¥æ¬¡æ•°è¾¾åˆ°ä¸Šé™åªèƒ½å‡çº§ä¸ºé‡é‡çº§é”ã€‚</li>
</ul>
<ul>
<li>è®°å½•æ–¹å¼äºŒï¼š<br>å½“çº¿ç¨‹éœ€è¦è·å–é”æ—¶ï¼Œåœ¨è·å–é”çš„çº¿ç¨‹æ ˆä¸­ä¿å­˜lock-recordsè®°å½•ã€‚çº¿ç¨‹è·å–çš„æ‰€æœ‰é”è®°å½•éƒ½å°†ä¿å­˜åœ¨è¿™ä¸ªé›†åˆä¸­ï¼Œå®ƒçš„é¡ºåºå’Œè·å–é”çš„é¡ºåºä¸€è‡´ã€‚</li>
</ul>
<p>è½»é‡çº§é”çš„å˜ç§å’Œæå‡åŒ…å« <em>tasuki-lock</em> å’Œ <em>meta-lock</em> å…¶ç®—æ³•æ€æƒ³æ˜¯ä¸€è‡´çš„ï¼Œå·®å¼‚åœ¨äºå®ç°ç»†èŠ‚ï¼Œ</p>
<p>1ã€è½»é‡çº§é”çš„åŠ é”è¿‡ç¨‹</p>
<p>åœ¨ä»£ç è¿›å…¥åŒæ­¥å—çš„æ—¶ï¼Œå¦‚æœåŒæ­¥å¯¹è±¡é”çŠ¶æ€ä¸ºæ— é”ï¼ˆé”æ ‡å¿—ä½ä¸ºâ€œ01â€ï¼Œåå‘é”ä½ä¸ºâ€œ0â€ï¼‰è™šæ‹Ÿæœºé¦–å…ˆå°†åœ¨å½“å‰çº¿ç¨‹çš„æ ˆå¸§ä¸­å»ºç«‹ä¸€ä¸ªåä¸ºé”è®°å½•ï¼ˆLock Recordï¼‰çš„ç©ºé—´ï¼Œç”¨äºå­˜å‚¨é”å¯¹è±¡ç›®å‰çš„Mark Wordçš„æ‹·è´ï¼ˆå®˜æ–¹ç§°ä¹‹ä¸º Displaced Mark Wordï¼‰ã€‚ç„¶åï¼Œè™šæ‹Ÿæœºå°†ä½¿ç”¨CASæ“ä½œå°è¯•å°†å¯¹è±¡çš„Mark Wordæ›´æ–°ä¸ºæŒ‡å‘Lock Recordçš„æŒ‡é’ˆï¼Œå¹¶å°†Lock recordé‡Œçš„owneræŒ‡é’ˆæŒ‡å‘object mark wordã€‚å¦‚æœè¿™ä¸ªæ›´æ–°åŠ¨ä½œæˆåŠŸäº†ï¼Œé‚£ä¹ˆè¿™ä¸ªçº¿ç¨‹å°±æ‹¥æœ‰äº†è¯¥å¯¹è±¡çš„é”ï¼Œå¹¶ä¸”å¯¹è±¡Mark Wordçš„é”æ ‡å¿—ä½è®¾ç½®ä¸ºâ€œ00â€ï¼Œå³è¡¨ç¤ºæ­¤å¯¹è±¡å¤„äºè½»é‡çº§é”å®šçŠ¶æ€ã€‚</p>
<p>å¦‚æœè¿™ä¸ªæ›´æ–°æ“ä½œå¤±è´¥äº†ï¼Œè™šæ‹Ÿæœºé¦–å…ˆä¼šæ£€æŸ¥å¯¹è±¡çš„Mark Wordæ˜¯å¦æŒ‡å‘å½“å‰çº¿ç¨‹çš„æ ˆå¸§ï¼Œå¦‚æœæ˜¯å°±è¯´æ˜å½“å‰çº¿ç¨‹å·²ç»æ‹¥æœ‰äº†è¿™ä¸ªå¯¹è±¡çš„é”ï¼Œé‚£å°±å¯ä»¥ç›´æ¥è¿›å…¥åŒæ­¥å—ç»§ç»­æ‰§è¡Œã€‚<br>å¦åˆ™è¯´æ˜å¤šä¸ªçº¿ç¨‹ç«äº‰é”ï¼Œè½»é‡çº§é”å°±è¦è†¨èƒ€ä¸ºé‡é‡çº§é”ï¼Œé”æ ‡å¿—çš„çŠ¶æ€å€¼å˜ä¸ºâ€œ10â€ï¼ŒMark Wordä¸­å­˜å‚¨çš„å°±æ˜¯æŒ‡å‘é‡é‡çº§é”ï¼ˆäº’æ–¥é‡ï¼‰çš„æŒ‡é’ˆï¼Œåé¢ç­‰å¾…é”çš„çº¿ç¨‹ä¹Ÿè¦è¿›å…¥é˜»å¡çŠ¶æ€ã€‚<br>è€Œå½“å‰çº¿ç¨‹ä¾¿å°è¯•ä½¿ç”¨è‡ªæ—‹æ¥è·å–é”ï¼Œè‡ªæ—‹å°±æ˜¯ä¸ºäº†ä¸è®©çº¿ç¨‹é˜»å¡ï¼Œè€Œé‡‡ç”¨å¾ªç¯å»è·å–é”çš„è¿‡ç¨‹ã€‚</p>
<center>
    <img src="../images/java-thin-lock-recorder.jpg" width="500"/>
</center>

<pre><code>                 å›¾2.1 è½»é‡çº§é”CASæ“ä½œå‰/åå †æ ˆä¸å¯¹è±¡çš„çŠ¶æ€
</code></pre>
<p>2ã€è½»é‡çº§é”çš„è§£é”è¿‡ç¨‹ï¼š</p>
<p>ï¼ˆ1ï¼‰é€šè¿‡CASæ“ä½œå°è¯•æŠŠçº¿ç¨‹ä¸­å¤åˆ¶çš„Displaced Mark Wordå¯¹è±¡æ›¿æ¢å½“å‰çš„Mark Wordã€‚</p>
<p>ï¼ˆ2ï¼‰å¦‚æœæ›¿æ¢æˆåŠŸï¼Œæ•´ä¸ªåŒæ­¥è¿‡ç¨‹å°±å®Œæˆäº†ã€‚</p>
<p>ï¼ˆ3ï¼‰å¦‚æœæ›¿æ¢å¤±è´¥ï¼Œè¯´æ˜æœ‰å…¶ä»–çº¿ç¨‹å°è¯•è¿‡è·å–è¯¥é”ï¼ˆæ­¤æ—¶é”å·²è†¨èƒ€ï¼‰ï¼Œé‚£å°±è¦åœ¨é‡Šæ”¾é”çš„åŒæ—¶ï¼Œå”¤é†’è¢«æŒ‚èµ·çš„çº¿ç¨‹ã€‚</p>
<h5 id="3-3-é”æ¶ˆé™¤"><a href="#3-3-é”æ¶ˆé™¤" class="headerlink" title="3.3 é”æ¶ˆé™¤"></a>3.3 é”æ¶ˆé™¤</h5><p>é”æ¶ˆé™¤å³åˆ é™¤ä¸å¿…è¦çš„åŠ é”æ“ä½œã€‚æ ¹æ®ä»£ç é€ƒé€¸æŠ€æœ¯ï¼Œå¦‚æœåˆ¤æ–­åˆ°ä¸€æ®µä»£ç ä¸­ï¼Œå †ä¸Šçš„æ•°æ®ä¸ä¼šé€ƒé€¸å‡ºå½“å‰çº¿ç¨‹ï¼Œé‚£ä¹ˆå¯ä»¥è®¤ä¸ºè¿™æ®µä»£ç æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œä¸å¿…è¦åŠ é”ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> <span class="keyword">extends</span> <span class="title">Thread</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        contactString(<span class="string">&quot;aa&quot;</span>, <span class="string">&quot;bb&quot;</span>, <span class="string">&quot;cc&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">contactString</span><span class="params">(String s1, String s2, String s3)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> StringBuffer().append(s1).append(s2).append(s3).toString();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è™½ç„¶StringBufferçš„appendæ˜¯ä¸€ä¸ªåŒæ­¥æ–¹æ³•ï¼Œä½†æ˜¯è¿™æ®µç¨‹åºä¸­çš„StringBufferå±äºä¸€ä¸ªå±€éƒ¨å˜é‡ï¼Œå¹¶ä¸”ä¸ä¼šä»è¯¥æ–¹æ³•ä¸­é€ƒé€¸å‡ºå»ï¼Œæ‰€ä»¥å…¶å®è¿™è¿‡ç¨‹æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå¯ä»¥å°†é”æ¶ˆé™¤ã€‚</p>
<h5 id="3-4-é”ç²—åŒ–"><a href="#3-4-é”ç²—åŒ–" class="headerlink" title="3.4 é”ç²—åŒ–"></a>3.4 é”ç²—åŒ–</h5><p>è™šæ‹Ÿæœºå¯¹è¿ç»­çš„åŠ é”æ“ä½œï¼ˆsynchronized appendï¼‰è¿›è¡ŒèŒƒå›´æ‰©å±•ï¼ˆç²—åŒ–ï¼‰åˆ°æ•´ä¸ªæ“ä½œåºåˆ—çš„å¤–éƒ¨ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">concatString</span><span class="params">(String s1,String s2, String s3)</span></span>&#123;</span><br><span class="line">    StringBuffer sb = <span class="keyword">new</span> StringBUffer();</span><br><span class="line">    sb.append(s1);</span><br><span class="line">    sb.append(s2);</span><br><span class="line">    sb.append(s3);</span><br><span class="line">    <span class="keyword">return</span> sb.toString();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="å››ã€å‚è€ƒèµ„æ–™"><a href="#å››ã€å‚è€ƒèµ„æ–™" class="headerlink" title="å››ã€å‚è€ƒèµ„æ–™"></a>å››ã€å‚è€ƒèµ„æ–™</h4><p>1.Evaluating and improving biased locking in the HotSpot virtual machine<br>2.<a href="https://www.cnblogs.com/paddix/p/5405678.html">Javaå¹¶å‘ç¼–ç¨‹ï¼šSynchronizedåº•å±‚ä¼˜åŒ–ï¼ˆåå‘é”ã€è½»é‡çº§é”ï¼‰</a><br>3.<a href="https://www.cnblogs.com/zhai1997/p/13546652.html">é”ï¼šé”ä¼˜åŒ–ï¼ˆsynchronized é”å‡çº§è¿‡ç¨‹ã€é”æ¶ˆé™¤ã€é”ç²—åŒ–ï¼‰</a><br>4.<a href="https://wiki.openjdk.java.net/display/HotSpot/Synchronization">Synchronization</a></p>
]]></content>
      <categories>
        <category>è®¡ç®—æœº</category>
      </categories>
      <tags>
        <tag>Java</tag>
        <tag>Concurrency</tag>
      </tags>
  </entry>
  <entry>
    <title>å¯¹è±¡çš„å†…å­˜å¸ƒå±€</title>
    <url>/java-object-layout.html</url>
    <content><![CDATA[<h4 id="ä¸€ã€æ¦‚è¿°"><a href="#ä¸€ã€æ¦‚è¿°" class="headerlink" title="ä¸€ã€æ¦‚è¿°"></a>ä¸€ã€æ¦‚è¿°</h4><p>å¾ˆå¤šæ—¶å€™æˆ‘ä»¬éƒ½æœ‰ä¸€ä¸ªç–‘é—®ï¼šä¸€ä¸ªå¯¹è±¡åœ¨å†…å­˜ä¸­å ç”¨å¤šå¤§çš„ç©ºé—´å‘¢ï¼Ÿ</p>
<figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> jdk8-64/java -jar jol-cli.jar internals java.lang.Object</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Running 64-bit HotSpot VM.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Using compressed oop with 3-bit <span class="built_in">shift</span>.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Using compressed klass with 3-bit <span class="built_in">shift</span>.</span></span><br><span class="line"></span><br><span class="line">Instantiated the sample instance via default constructor.</span><br><span class="line"></span><br><span class="line">java.lang.Object object internals:</span><br><span class="line"> OFFSET  SIZE   TYPE DESCRIPTION                  VALUE</span><br><span class="line">      0     4        (object header)              05 00 00 00 # Mark word</span><br><span class="line">      4     4        (object header)              00 00 00 00 # Mark word</span><br><span class="line">      8     4        (object header)              00 10 00 00 # (not mark word)</span><br><span class="line">     12     4        (loss due to the next object alignment)</span><br><span class="line">Instance size: 16 bytes</span><br><span class="line">Space losses: 0 bytes internal + 4 bytes external = 4 bytes total</span><br></pre></td></tr></table></figure>

<p>é€šè¿‡OpenJDKçš„Java-Object-Layoutæˆ‘ä»¬çœ‹åˆ°<code>java.lang.Object</code>çš„ä¸€ä¸ªå®ä¾‹å ç”¨16 bytesã€‚</p>
<p>åŒæ ·çš„<code>java.lang.Boolean</code>ç±»å‹å ç”¨çš„å­—èŠ‚æ•°ï¼š</p>
<figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="code"><pre><span class="line">java.lang.Boolean object internals:</span><br><span class="line"> OFFSET  SIZE      TYPE DESCRIPTION                               VALUE</span><br><span class="line">      0    12           (object header)                           N/A</span><br><span class="line">     12     1   boolean Boolean.value                             N/A</span><br><span class="line">     13     3           (loss due to the next object alignment)</span><br><span class="line">Instance size: 16 bytes</span><br><span class="line">Space losses: 0 bytes internal + 3 bytes external = 3 bytes total</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="code"><pre><span class="line">[HEADER: 12 bytes]  12 </span><br><span class="line">[value:   1 byte ]  13</span><br><span class="line">[padding: 3 bytes]  16</span><br></pre></td></tr></table></figure>

<p>å…¶å®ä¸€ä¸ªå¯¹è±¡é€šå¸¸ç”±ä¸‰å—ç»„æˆï¼Œåˆ†åˆ«æ˜¯ï¼šå¯¹è±¡å¤´ã€å®ä¾‹æ•°æ®å’Œå¯¹é½å¡«å……ã€‚</p>
<h4 id="äºŒã€å¯¹è±¡å¤´ï¼ˆobject-headerï¼‰"><a href="#äºŒã€å¯¹è±¡å¤´ï¼ˆobject-headerï¼‰" class="headerlink" title="äºŒã€å¯¹è±¡å¤´ï¼ˆobject headerï¼‰"></a>äºŒã€å¯¹è±¡å¤´ï¼ˆobject headerï¼‰</h4><p>åœ¨å‰é¢é€šè¿‡JOLæ‰“å°è¾“å‡ºçš„å…³äºjava.lang.Objectä¿¡æ¯ä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ°object headerå ç”¨12å­—èŠ‚ï¼Œä½†æ˜¯è¾“å‡ºå¹¶æ²¡æœ‰åŒ…å«è¯¦ç»†çš„ç»“æ„ä¿¡æ¯ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡<a href="http://hg.openjdk.java.net/jdk/jdk/file/19afeaa0fdbe/src/hotspot/share/oops/oop.hpp#l52">Hotspotçš„æºç </a>äº†è§£åˆ°å¯¹è±¡å¤´åŒ…å«ä¸¤ä¸ªéƒ¨åˆ†ï¼š<strong>mark word</strong>å’Œ<strong>class word</strong>ã€‚</p>
<h5 id="2-1-mark-wordï¼š"><a href="#2-1-mark-wordï¼š" class="headerlink" title="2.1 mark wordï¼š"></a>2.1 <a href="http://hg.openjdk.java.net/jdk/jdk/file/19afeaa0fdbe/src/hotspot/share/oops/markWord.hpp#l33">mark word</a>ï¼š</h5><p>mark wordåœ¨32ä½å’Œ64ä½æœºåˆ†åˆ«å 32ä½å’Œ64ä½ï¼Œå½“å…¶ä¸­é”æ ‡å¿—ä½çš„å€¼ä¸åŒæ—¶ï¼Œå®ƒå‰é¢çš„bitå­˜å‚¨ä¸åŒçš„å«ä¹‰ã€‚</p>
<ul>
<li>å­˜å‚¨å¯¹è±¡çš„gcå¹´é¾„ä¿¡æ¯</li>
<li>å­˜å‚¨Hashcode</li>
<li>å­˜å‚¨é”ä¿¡æ¯</li>
</ul>
<center>
    <img src="../images/mark-word-64bit.png" width="600"/>
</center>

<h5 id="2-2-class-word"><a href="#2-2-class-word" class="headerlink" title="2.2 class word:"></a>2.2 class word:</h5><p>ä»£ç è¿è¡Œçš„æ—¶å€™ï¼Œå¯¹è±¡åªæ˜¯ä¸€ä¸²å­—èŠ‚ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡class-wordè·å–ä¸€äº›å¯¹è±¡çš„å…ƒä¿¡æ¯ï¼Œå®ƒå­˜å‚¨æŒ‡å‘æ–¹æ³•åŒºä¸­è¡¨ç¤ºå¯¹è±¡ç±»å‹çš„æŒ‡é’ˆï¼Œæ¯”å¦‚ä»¥ä¸‹ä½¿ç”¨åœºæ™¯ï¼š</p>
<ul>
<li>è¿è¡Œæ—¶ç±»å‹æ£€æŸ¥</li>
<li>å†³å®šå¯¹è±¡å¤§å°</li>
<li>è®¡ç®—æ¥å£è°ƒç”¨çš„ç›®æ ‡ç±»</li>
</ul>
<h5 id="2-3-æ•°ç»„é•¿åº¦ï¼š"><a href="#2-3-æ•°ç»„é•¿åº¦ï¼š" class="headerlink" title="2.3 æ•°ç»„é•¿åº¦ï¼š"></a>2.3 æ•°ç»„é•¿åº¦ï¼š</h5><p>å¦‚æœæ˜¯æ•°ç»„ç±»å‹ï¼Œå¯¹è±¡å¤´ä¼šé¢å¤–å­˜å‚¨æ•°ç»„çš„é•¿åº¦ä¿¡æ¯ã€‚</p>
<ul>
<li>å¿«é€Ÿè®¡ç®—å¯¹è±¡çš„å¤§å°</li>
<li>æ•°ç»„è¾¹ç•Œæ£€æŸ¥</li>
</ul>
<h4 id="ä¸‰ã€å®ä¾‹æ•°æ®å’Œå¯¹é½å¡«å……"><a href="#ä¸‰ã€å®ä¾‹æ•°æ®å’Œå¯¹é½å¡«å……" class="headerlink" title="ä¸‰ã€å®ä¾‹æ•°æ®å’Œå¯¹é½å¡«å……"></a>ä¸‰ã€å®ä¾‹æ•°æ®å’Œå¯¹é½å¡«å……</h4><p>å®ä¾‹æ•°æ®å³æˆ‘ä»¬åœ¨ä»£ç ä¸­å£°æ˜çš„å˜é‡ç­‰ä¿¡æ¯ï¼Œå®ƒçš„å­˜å‚¨å—åˆ°ä¸€äº›è§„åˆ™çš„çº¦æŸä»¥åŠè™šæ‹Ÿæœºå‚æ•°çš„æ§åˆ¶ã€‚</p>
<h5 id="3-1-æ²¡æœ‰å±æ€§çš„ç±»çš„å†…å­˜å¸ƒå±€"><a href="#3-1-æ²¡æœ‰å±æ€§çš„ç±»çš„å†…å­˜å¸ƒå±€" class="headerlink" title="3.1 æ²¡æœ‰å±æ€§çš„ç±»çš„å†…å­˜å¸ƒå±€"></a>3.1 æ²¡æœ‰å±æ€§çš„ç±»çš„å†…å­˜å¸ƒå±€</h5><blockquote>
<p>è§„åˆ™ä¸€ï¼šæ¯ä¸ªå¯¹è±¡éƒ½æ˜¯å…«å­—èŠ‚å¯¹é½ã€‚</p>
</blockquote>
<p>ä»å‰é¢Objectçš„è¾“å‡ºä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ°ï¼Œå½“ä¸€ä¸ªå¯¹è±¡åªæœ‰å¤´éƒ¨ä¿¡æ¯æ—¶å ç”¨16byteï¼Œåˆšå¥½æ˜¯8çš„æ•´æ•°å€ã€‚</p>
<h5 id="3-2-Objectå­ç±»çš„å†…å­˜å¸ƒå±€"><a href="#3-2-Objectå­ç±»çš„å†…å­˜å¸ƒå±€" class="headerlink" title="3.2 Objectå­ç±»çš„å†…å­˜å¸ƒå±€"></a>3.2 Objectå­ç±»çš„å†…å­˜å¸ƒå±€</h5><p>è·Ÿåœ¨å¯¹è±¡å¤´åé¢çš„ç±»å±æ€§æŒ‰ç…§å®ƒä»¬çš„å¤§å°åœ¨å†…å­˜ä¸­æ’åºï¼Œä¾‹å¦‚ï¼šintæ˜¯4å­—èŠ‚ã€longæ˜¯8å­—èŠ‚ã€‚é‡‡ç”¨å­—èŠ‚å¯¹é½å¯ä»¥æé«˜æ€§èƒ½ï¼Œå› ä¸ºä»å†…å­˜è¯»å–4å­—èŠ‚åˆ°4å­—èŠ‚çš„å¯„å­˜å™¨æ€§èƒ½æ›´å¥½ã€‚</p>
<p>ä¸ºäº†èŠ‚çº¦å†…å­˜ï¼ŒSunçš„è™šæ‹Ÿæœºåœ¨åˆ†é…å¯¹è±¡å­—æ®µçš„æ—¶å€™å’Œå®ƒä»¬å£°æ˜çš„é¡ºåºä¸åŒï¼Œæœ‰å¦‚ä¸‹é¡ºåºè§„åˆ™ï¼š</p>
<p>1ã€doubleå’Œlongç±»å‹<br>2ã€intå’Œfloat<br>3ã€shortå’Œchar<br>4ã€booleanå’Œbyte<br>5ã€reference</p>
<p>ä¸ºä»€ä¹ˆå¯ä»¥ä¼˜åŒ–å†…å­˜å‘¢ï¼Ÿæˆ‘ä»¬çœ‹ä¸€ä¸‹è¿™ä¸ªä¾‹å­ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span> </span>&#123;</span><br><span class="line">    <span class="keyword">byte</span> a;</span><br><span class="line">    <span class="keyword">int</span> c;</span><br><span class="line">    <span class="keyword">boolean</span> d;</span><br><span class="line">    <span class="keyword">long</span> e;</span><br><span class="line">    Object f;        </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å®ƒçš„å¯¹è±¡å¸ƒå±€å¦‚ä¸‹ï¼š</p>
<figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="code"><pre><span class="line">[HEADER:  8 bytes]  8</span><br><span class="line">[a:       1 byte ]  9</span><br><span class="line">[padding: 3 bytes] 12</span><br><span class="line">[c:       4 bytes] 16</span><br><span class="line">[d:       1 byte ] 17</span><br><span class="line">[padding: 7 bytes] 24</span><br><span class="line">[e:       8 bytes] 32</span><br><span class="line">[f:       4 bytes] 36</span><br><span class="line">[padding: 4 bytes] 40</span><br></pre></td></tr></table></figure>
<p>æ€»å…±ä½¿ç”¨äº†40å­—èŠ‚å†…å­˜ï¼Œå…¶ä¸­14ä¸ªç”¨äºå†…å­˜å¯¹é½è€Œæµªè´¹æ‰ã€‚å¦‚æœé‡æ’é¡ºåºåˆ™ï¼š</p>
<figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="code"><pre><span class="line">[HEADER:  8 bytes]  8</span><br><span class="line">[e:       8 bytes] 16</span><br><span class="line">[c:       4 bytes] 20</span><br><span class="line">[a:       1 byte ] 21</span><br><span class="line">[d:       1 byte ] 22</span><br><span class="line">[padding: 2 bytes] 24</span><br><span class="line">[f:       4 bytes] 28</span><br><span class="line">[padding: 4 bytes] 32</span><br></pre></td></tr></table></figure>

<p>ç»è¿‡ä¼˜åŒ–ååªæœ‰6ä¸ªå­—èŠ‚ç”¨äºå¯¹é½å¡«å……ï¼Œæ€»å†…å­˜ä¹Ÿåªæœ‰32byteã€‚</p>
<h5 id="3-3-å­ç±»çš„å†…å­˜å¸ƒå±€"><a href="#3-3-å­ç±»çš„å†…å­˜å¸ƒå±€" class="headerlink" title="3.3 å­ç±»çš„å†…å­˜å¸ƒå±€"></a>3.3 å­ç±»çš„å†…å­˜å¸ƒå±€</h5><blockquote>
<p>è§„åˆ™ä¸‰ï¼šç»§æ‰¿ç»“æ„ä¸­å±äºä¸åŒç±»çš„å­—æ®µä¸æ··åˆåœ¨ä¸€èµ·ã€‚çˆ¶ç±»ä¼˜å…ˆï¼Œå­ç±»å…¶æ¬¡ã€‚</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>&#123;</span><br><span class="line">   <span class="keyword">long</span> a;</span><br><span class="line">   <span class="keyword">int</span> b;</span><br><span class="line">   <span class="keyword">int</span> c;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span> <span class="keyword">extends</span> <span class="title">A</span> </span>&#123;</span><br><span class="line">   <span class="keyword">long</span> d;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Bç±»çš„å¸ƒå±€å¦‚ä¸‹ï¼š</p>
<figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="code"><pre><span class="line">[HEADER:  8 bytes]  8</span><br><span class="line">[a:       8 bytes] 16</span><br><span class="line">[b:       4 bytes] 20</span><br><span class="line">[c:       4 bytes] 24</span><br><span class="line">[d:       8 bytes] 32</span><br></pre></td></tr></table></figure>

<p>å¦‚æœçˆ¶ç±»çš„å­—æ®µä¸ç¬¦åˆ4å­—èŠ‚å¯¹é½ã€‚</p>
<blockquote>
<p>è§„åˆ™å››ï¼šçˆ¶ç±»çš„æœ€åä¸€ä¸ªå­—æ®µå’Œå­ç±»ç¬¬ä¸€ä¸ªå­—æ®µä¹‹é—´å¿…é¡»4å­—èŠ‚å¯¹é½ã€‚</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>&#123;</span><br><span class="line">   <span class="keyword">byte</span> a;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span> </span>&#123;</span><br><span class="line">   <span class="keyword">byte</span> b;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="code"><pre><span class="line">[HEADER:  8 bytes]  8</span><br><span class="line">[a:       1 byte ]  9</span><br><span class="line">[padding: 3 bytes] 12</span><br><span class="line">[b:       1 byte ] 13</span><br><span class="line">[padding: 3 bytes] 16</span><br></pre></td></tr></table></figure>
<p>aåé¢çš„3ä¸ªå­—èŠ‚å°±æ˜¯ä¸ºäº†ä½¿å…¶4å­—èŠ‚å¯¹é½ã€‚è¿™3ä¸ªå­—èŠ‚åªèƒ½æµªè´¹ä¸èƒ½ç»™Bä½¿ç”¨ã€‚</p>
<p>æœ€åä¸€ä¸ªè§„åˆ™å¯ä»¥ç”¨äºèŠ‚çº¦ä¸€äº›å†…å­˜ç©ºé—´ï¼šå½“å­ç±»çš„ç¬¬ä¸€ä¸ªå±æ€§æ˜¯longæˆ–è€…doubleç±»å‹ä¸”çˆ¶ç±»æ²¡æœ‰ä»¥8å­—èŠ‚è¾¹ç•Œç»“æŸã€‚</p>
<blockquote>
<p>è§„åˆ™äº”ï¼šå­ç±»çš„ç¬¬ä¸€ä¸ªå­—æ®µæ˜¯doubelæˆ–longä¸”çˆ¶ç±»æ²¡æœ‰ä»¥8å­—èŠ‚è¾¹ç•Œç»“æŸï¼ŒJVMæ‰“ç ´2çš„è§„åˆ™ï¼Œå…ˆå­˜å‚¨intã€shortã€byteã€referenceæ¥å¡«è¡¥ç©ºç¼ºã€‚</p>
</blockquote>
<p>ä¾‹å¦‚ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>&#123;</span><br><span class="line">  <span class="keyword">byte</span> a;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span> </span>&#123;</span><br><span class="line">  <span class="keyword">long</span> b;</span><br><span class="line">  <span class="keyword">short</span> c;  </span><br><span class="line">  <span class="keyword">byte</span> d;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å†…å­˜å¸ƒå±€å¦‚ä¸‹ï¼š</p>
<figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="code"><pre><span class="line">[HEADER:  8 bytes]  8</span><br><span class="line">[a:       1 byte ]  9</span><br><span class="line">[padding: 3 bytes] 12</span><br><span class="line">[c:       2 bytes] 14</span><br><span class="line">[d:       1 byte ] 15</span><br><span class="line">[padding: 1 byte ] 16</span><br><span class="line">[b:       8 bytes] 24</span><br></pre></td></tr></table></figure>

<p>åœ¨å­—èŠ‚12çš„ä½ç½®ï¼ŒAç±»ç»“æŸäº†ã€‚JVMæ‰“ç ´2çš„è§„åˆ™æ”¾å…¥shortå’Œbyteç±»å‹ï¼ŒèŠ‚çº¦äº†4å­—èŠ‚ä¸­çš„3ä¸ªå­—èŠ‚ï¼Œå¦åˆ™å°†æµªè´¹æ‰ã€‚</p>
<h5 id="3-4-æ•°ç»„çš„å†…å­˜å¸ƒå±€"><a href="#3-4-æ•°ç»„çš„å†…å­˜å¸ƒå±€" class="headerlink" title="3.4 æ•°ç»„çš„å†…å­˜å¸ƒå±€"></a>3.4 æ•°ç»„çš„å†…å­˜å¸ƒå±€</h5><p>æ•°ç»„ç±»å‹æœ‰ä¸€ä¸ªé¢å¤–çš„å¤´éƒ¨å­—æ®µä¿å­˜æ•°ç»„çš„é•¿åº¦ï¼Œæ¥ä¸‹æ¥æ˜¯æ•°ç»„çš„å…ƒç´ ï¼Œæ•°ç»„ä½œä¸ºæ™®é€šå¯¹è±¡ä¹Ÿæ˜¯8å­—èŠ‚å¯¹é½çš„ã€‚</p>
<p>è¿™æ˜¯byte[3]çš„å¸ƒå±€ï¼š</p>
<figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="code"><pre><span class="line">[HEADER:  12 bytes] 12</span><br><span class="line">[[0]:      1 byte ] 13</span><br><span class="line">[[1]:      1 byte ] 14</span><br><span class="line">[[2]:      1 byte ] 15</span><br><span class="line">[padding:  1 byte ] 16</span><br></pre></td></tr></table></figure>

<p>è¿™æ˜¯long[3]çš„å¸ƒå±€:</p>
<figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="code"><pre><span class="line">[HEADER:  12 bytes] 12</span><br><span class="line">[padding:  4 bytes] 16</span><br><span class="line">[[0]:      8 bytes] 24</span><br><span class="line">[[1]:      8 bytes] 32</span><br><span class="line">[[2]:      8 bytes] 40</span><br></pre></td></tr></table></figure>

<h5 id="3-5-å†…éƒ¨ç±»çš„å†…å­˜å¸ƒå±€"><a href="#3-5-å†…éƒ¨ç±»çš„å†…å­˜å¸ƒå±€" class="headerlink" title="3.5 å†…éƒ¨ç±»çš„å†…å­˜å¸ƒå±€"></a>3.5 å†…éƒ¨ç±»çš„å†…å­˜å¸ƒå±€</h5><p>éé™æ€å†…éƒ¨ç±»æœ‰ä¸€ä¸ªé¢å¤–çš„éšè—å­—æ®µï¼ŒæŒæœ‰å¤–éƒ¨ç±»çš„å¼•ç”¨ã€‚è¿™ä¸ªå­—æ®µæ˜¯ä¸€ä¸ªå¸¸è§„çš„å¼•ç”¨,å®ƒç¬¦åˆå¯¹è±¡åœ¨å†…å­˜å¸ƒå±€çš„è§„åˆ™ã€‚å†…éƒ¨ç±»å› æ­¤æœ‰4å­—èŠ‚é¢å¤–çš„å¼€é”€ã€‚</p>
]]></content>
      <categories>
        <category>è®¡ç®—æœº</category>
      </categories>
      <tags>
        <tag>Java</tag>
        <tag>JVM</tag>
      </tags>
  </entry>
  <entry>
    <title>ç”¨Kotlinåç¨‹è§£å†³æ·±åº¦é€’å½’é—®é¢˜</title>
    <url>/kotlin-coroutine-deep-recursion.html</url>
    <content><![CDATA[<p>&ensp;&ensp;&ensp;&ensp;åç¨‹ä¸€èˆ¬ç”¨äºå¼‚æ­¥ç¼–ç¨‹ã€‚åœ¨è§£å†³å¼‚æ­¥ç¼–ç¨‹é—®é¢˜æ–¹é¢ï¼ŒKotlinç¼–è¯‘å™¨åœ¨å¯¹åç¨‹çš„è®¾è®¡å’Œå®ç°æ˜¯é€šç”¨çš„ã€‚æˆ‘ä»¬å¯ä»¥å€ŸåŠ©åç¨‹ä¼˜é›…çš„è§£å†³æ·±åº¦é€’å½’é—®é¢˜ã€‚</p>
<h4 id="ä¸€ã€é—®é¢˜æè¿°"><a href="#ä¸€ã€é—®é¢˜æè¿°" class="headerlink" title="ä¸€ã€é—®é¢˜æè¿°"></a>ä¸€ã€é—®é¢˜æè¿°</h4><p>å®šä¹‰ä»¥ä¸‹äºŒå‰æ ‘çš„ç»“ç‚¹ï¼Œå¹¶æ„é€ ä¸€æ£µåªå«åä¸‡ä¸ªå·¦ç»“ç‚¹çš„æ ‘ï¼Œè¿›è¡Œæ·±åº¦éå†ï¼Œæ±‚æ ‘çš„æ·±åº¦ï¼š  </p>
<center>
    <img src="../images/tree_only_left.png" width="500"/>
</center>

<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="comment">//ç»“ç‚¹å®šä¹‰</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Tree</span></span>(<span class="keyword">val</span> left: Tree?, <span class="keyword">val</span> right: Tree?)</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ„é€ äºŒå‰æ ‘ï¼šä»¥å¶å­ç»“ç‚¹å¼€å§‹ï¼Œé‡å¤æ„é€ çˆ¶ç»“ç‚¹ï¼Œå¹¶æŠŠå½“å‰ç»“ç‚¹ä½œä¸ºçˆ¶ç»“ç‚¹çš„å·¦å­æ ‘</span></span><br><span class="line"><span class="keyword">val</span> n = <span class="number">100_000</span></span><br><span class="line"><span class="keyword">val</span> deepTree = generateSequence(Tree(<span class="literal">null</span>, <span class="literal">null</span>)) &#123; prev -&gt;</span><br><span class="line">    Tree(prev, <span class="literal">null</span>) </span><br><span class="line">&#125;.take(n).last()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="äºŒã€è§£å†³æ–¹æ¡ˆ"><a href="#äºŒã€è§£å†³æ–¹æ¡ˆ" class="headerlink" title="äºŒã€è§£å†³æ–¹æ¡ˆ"></a>äºŒã€è§£å†³æ–¹æ¡ˆ</h4><h5 id="2-1-è§£å†³æ–¹æ¡ˆä¸€ï¼š"><a href="#2-1-è§£å†³æ–¹æ¡ˆä¸€ï¼š" class="headerlink" title="2.1 è§£å†³æ–¹æ¡ˆä¸€ï¼š"></a>2.1 è§£å†³æ–¹æ¡ˆä¸€ï¼š</h5><figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">depth</span><span class="params">(t: <span class="type">Tree</span>?)</span></span>: <span class="built_in">Int</span> =</span><br><span class="line">    <span class="keyword">if</span> (t == <span class="literal">null</span>) <span class="number">0</span> <span class="keyword">else</span> maxOf(</span><br><span class="line">        depth(t.left), <span class="comment">// recursive call one</span></span><br><span class="line">        depth(t.right) <span class="comment">// recursive call two</span></span><br><span class="line">    ) + <span class="number">1</span></span><br></pre></td></tr></table></figure>

<p>åˆ†æï¼š<br>å¯¹æ ‘è¿›è¡Œé€’å½’æ˜¯æœ€ç®€æ´ç›´æ¥çš„è§£å†³æ–¹æ¡ˆã€‚è€Œé€’å½’å°†ä¿å­˜å‡½æ•°çš„è°ƒç”¨æ ˆç”¨äºåç»­çŠ¶æ€æ¢å¤ï¼Œçº¿ç¨‹çš„è°ƒç”¨æ ˆæ˜¯æœ‰å¤§å°é™åˆ¶çš„ï¼Œæ­¤å¤„å°†æŠ›å‡º<code>Exception in thread &quot;main&quot; java.lang.StackOverflowError</code>é”™è¯¯ã€‚</p>
<h5 id="2-2-è§£å†³æ–¹æ¡ˆäºŒï¼š"><a href="#2-2-è§£å†³æ–¹æ¡ˆäºŒï¼š" class="headerlink" title="2.2 è§£å†³æ–¹æ¡ˆäºŒï¼š"></a>2.2 è§£å†³æ–¹æ¡ˆäºŒï¼š</h5><figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">depth</span><span class="params">(t: <span class="type">Tree</span>?)</span></span>: <span class="built_in">Int</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (t == <span class="literal">null</span>) <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">      <span class="class"><span class="keyword">class</span> <span class="title">Frame</span></span>(<span class="keyword">val</span> node: Tree, <span class="keyword">var</span> state: <span class="built_in">Int</span> = <span class="number">0</span>, <span class="keyword">var</span> depth: <span class="built_in">Int</span> = <span class="number">1</span>)</span><br><span class="line">      <span class="keyword">val</span> stack = ArrayList&lt;Frame&gt;()</span><br><span class="line">      <span class="keyword">val</span> root = Frame(t)</span><br><span class="line">      stack.add(root)</span><br><span class="line">      <span class="keyword">while</span> (stack.isNotEmpty()) &#123;</span><br><span class="line">          <span class="keyword">val</span> frame = stack.last()</span><br><span class="line">          <span class="keyword">when</span> (frame.state++) &#123;</span><br><span class="line">              <span class="number">0</span> -&gt; frame.node.left?.let &#123; l -&gt; stack.add(Frame(l)) &#125;</span><br><span class="line">              <span class="number">1</span> -&gt; frame.node.right?.let &#123; r -&gt; stack.add(Frame(r)) &#125;</span><br><span class="line">              <span class="number">2</span> -&gt; &#123;</span><br><span class="line">                  stack.removeLast()</span><br><span class="line">                  stack.lastOrNull()?.let &#123; p -&gt; </span><br><span class="line">                      p.depth = maxOf(p.depth, frame.depth + <span class="number">1</span>) </span><br><span class="line">                  &#125;</span><br><span class="line">              &#125;</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> root.depth</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p>åˆ†æï¼š<br>åŸºäºè§£å†³æ–¹æ¡ˆä¸€ï¼Œæˆ‘ä»¬è€ƒè™‘å°†è°ƒç”¨æ ˆçŠ¶æ€çš„ä¿å­˜è½¬ç§»åˆ°å†…å­˜ç©ºé—´æ›´å¤§çš„å †åŒºï¼Œå¹¶åŠ å…¥äº†çŠ¶æ€æœºå’Œ<code>while</code>å¾ªç¯ã€‚åœ¨æ­¤ä¾‹ä¸­ï¼Œç¨‹åºå¼€å§‹æ—¶å°†å…¨éƒ¨èµ°çŠ¶æ€0ï¼Œå°†æ‰€æœ‰çš„å·¦èŠ‚ç‚¹åŠ å…¥stackã€‚ç„¶åå…¨éƒ¨èµ°çŠ¶æ€2(å› ä¸ºæ²¡æœ‰å³ç»“ç‚¹)ï¼Œç”±ä¸‹åˆ°ä¸Šè®¡ç®—æ¯ä¸€ä¸ªç»“ç‚¹çš„æ·±åº¦ã€‚æœ€åè¿”å›æ ¹èŠ‚ç‚¹çš„æ·±åº¦ã€‚</p>
<h5 id="2-3-è§£å†³æ–¹æ¡ˆä¸‰ï¼š"><a href="#2-3-è§£å†³æ–¹æ¡ˆä¸‰ï¼š" class="headerlink" title="2.3 è§£å†³æ–¹æ¡ˆä¸‰ï¼š"></a>2.3 è§£å†³æ–¹æ¡ˆä¸‰ï¼š</h5><figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">val</span> depth = DeepRecursiveFunction&lt;Tree?, <span class="built_in">Int</span>&gt; &#123; t -&gt;</span><br><span class="line">        <span class="keyword">if</span> (t == <span class="literal">null</span>) <span class="number">0</span> <span class="keyword">else</span> maxOf(</span><br><span class="line">            callRecursive(t.left),</span><br><span class="line">            callRecursive(t.right)</span><br><span class="line">        ) + <span class="number">1</span></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>åˆ†æï¼š<br>æ–¹æ¡ˆäºŒä¸­çš„çŠ¶æ€æœºå°±æ˜¯KotlinæŒ‚èµ·å‡½æ•°çš„å®ç°åŸç†ã€‚æ‰€ä»¥æˆ‘ä»¬ä¹Ÿå¯ä»¥åˆ©ç”¨Kotlinçš„æŒ‚èµ·å‡½æ•°å®ç°æ·±åº¦éå†ã€‚é‚£ä¹ˆæ–¹æ¡ˆä¸‰æ˜¯å¦‚ä½•å®ç°çš„å‘¢ï¼Ÿæˆ‘ä»¬åˆ†æä¸‰ä¸ªæ–¹é¢ï¼š  </p>
<ul>
<li>å¦‚ä½•è°ƒç”¨</li>
<li>å¦‚ä½•è¿›å…¥å¾ªç¯</li>
<li>å¦‚ä½•ä¿å­˜çŠ¶æ€</li>
</ul>
<p>2.3.1 è°ƒç”¨<br><code>DeepRecursiveFunction</code>ç±»å£°æ˜äº†<code>invoke</code>æ“ä½œç¬¦ï¼Œè°ƒç”¨<code>depth</code>å‡½æ•°å°±æ˜¯è°ƒç”¨ä¸‹é¢ğŸ‘‡ğŸ»çš„æ“ä½œç¬¦ã€‚</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="meta">@SinceKotlin(<span class="meta-string">&quot;1.4&quot;</span>)</span></span><br><span class="line"><span class="meta">@ExperimentalStdlibApi</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">operator</span> <span class="function"><span class="keyword">fun</span> <span class="type">&lt;T, R&gt;</span> DeepRecursiveFunction<span class="type">&lt;T, R&gt;</span>.<span class="title">invoke</span><span class="params">(value: <span class="type">T</span>)</span></span>: R =</span><br><span class="line">    DeepRecursiveScopeImpl&lt;T, R&gt;(block, value).runCallLoop()</span><br></pre></td></tr></table></figure>

<p>2.3.2 å¾ªç¯<br>è°ƒç”¨<code>DeepRecursiveFunction</code>åç›´æ¥è¿›å…¥<code>runCallLoop()</code>å¾ªç¯ï¼Œresultçš„é»˜è®¤å€¼ä¸ºUNDEFINED_RESULTï¼Œæ‰€ä»¥ä¼šå¯åŠ¨æˆ‘ä»¬çš„é€’å½’ä¸šåŠ¡é€»è¾‘</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Suppress(<span class="meta-string">&quot;UNCHECKED_CAST&quot;</span>)</span></span><br><span class="line">   <span class="function"><span class="keyword">fun</span> <span class="title">runCallLoop</span><span class="params">()</span></span>: R &#123;</span><br><span class="line">       <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">           <span class="comment">// Note: cont is set to null in DeepRecursiveScopeImpl.resumeWith when the whole computation completes</span></span><br><span class="line">           <span class="keyword">val</span> result = <span class="keyword">this</span>.result</span><br><span class="line">           <span class="keyword">val</span> cont = <span class="keyword">this</span>.cont</span><br><span class="line">               ?: <span class="keyword">return</span> (result <span class="keyword">as</span> Result&lt;R&gt;).getOrThrow() <span class="comment">// done -- final result</span></span><br><span class="line">           <span class="comment">// The order of comparison is important here for that case of rogue class with broken equals</span></span><br><span class="line">           <span class="keyword">if</span> (UNDEFINED_RESULT == result) &#123;</span><br><span class="line">               <span class="comment">// call &quot;function&quot; with &quot;value&quot; using &quot;cont&quot; as completion</span></span><br><span class="line">               <span class="keyword">val</span> r = <span class="keyword">try</span> &#123;</span><br><span class="line">                   <span class="comment">// This is block.startCoroutine(this, value, cont)</span></span><br><span class="line">                   function.startCoroutineUninterceptedOrReturn(<span class="keyword">this</span>, value, cont)</span><br><span class="line">               &#125; <span class="keyword">catch</span> (e: Throwable) &#123;</span><br><span class="line">                   cont.resumeWithException(e)</span><br><span class="line">                   <span class="keyword">continue</span></span><br><span class="line">               &#125;</span><br><span class="line">               <span class="comment">// If the function returns without suspension -- calls its continuation immediately</span></span><br><span class="line">               <span class="keyword">if</span> (r !== COROUTINE_SUSPENDED)</span><br><span class="line">                   cont.resume(r <span class="keyword">as</span> R)</span><br><span class="line">           &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">               <span class="comment">// we returned from a crossFunctionCompletion trampoline -- call resume here</span></span><br><span class="line">               <span class="keyword">this</span>.result = UNDEFINED_RESULT <span class="comment">// reset result back</span></span><br><span class="line">               cont.resumeWith(result)</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>


<p>2.3.3 çŠ¶æ€ä¿å­˜<br>æ¯æ¬¡è°ƒç”¨<code>callRecursive</code>æ—¶å°†ä¿å­˜å½“å‰çš„å€¼å’Œcontï¼ˆcontinuationï¼‰ï¼Œæ³¨æ„è¿™é‡Œcontå¯¹è±¡æ¯æ¬¡éƒ½ä¸æ˜¯åŒä¸€ä¸ªå¯¹è±¡ã€‚å½“è¿›è¡ŒæŒ‚èµ·æ¢å¤æ—¶ï¼Œæ‹¿åˆ°æ—§çš„continuationè¿›è¡Œå›è°ƒã€‚</p>
<center>
    <img src="../images/kotlin_coroutine_resume.jpeg" width="500"/>
</center>

<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">suspend</span> <span class="function"><span class="keyword">fun</span> <span class="title">callRecursive</span><span class="params">(value: <span class="type">T</span>)</span></span>: R = </span><br><span class="line">    suspendCoroutineUninterceptedOrReturn &#123; cont -&gt;</span><br><span class="line">        <span class="keyword">this</span>.cont = cont</span><br><span class="line">        <span class="keyword">this</span>.value = value</span><br><span class="line">        COROUTINE_SUSPENDED</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>


<h4 id="å‚è€ƒï¼š"><a href="#å‚è€ƒï¼š" class="headerlink" title="å‚è€ƒï¼š"></a>å‚è€ƒï¼š</h4><p><a href="https://elizarov.medium.com/deep-recursion-with-coroutines-7c53e15993e3">Deep recursion with coroutines</a></p>
]]></content>
      <categories>
        <category>è®¡ç®—æœº</category>
      </categories>
      <tags>
        <tag>Kotlin</tag>
      </tags>
  </entry>
  <entry>
    <title>Kotlin Flowçš„å·¥ä½œåŸç†</title>
    <url>/kotlin-lang-flow-under-the-hood.html</url>
    <content><![CDATA[<hr>
<p>æˆ‘ä»¬æœ‰ä¸€ä¸ªä¼šè¢«é‡å¤è°ƒç”¨çš„lambdaè¡¨è¾¾å¼ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> kotlin.*</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">val</span> f: () -&gt; <span class="built_in">Unit</span> = &#123;</span><br><span class="line">        print(<span class="string">&quot;A&quot;</span>)</span><br><span class="line">        print(<span class="string">&quot;B&quot;</span>)</span><br><span class="line">        print(<span class="string">&quot;C&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    f() <span class="comment">// ABC</span></span><br><span class="line">    f() <span class="comment">// ABC</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬ç»™è¿™ä¸ªlambdaåŠ ä¸ªå‚æ•°ï¼š<code>(String) -&gt; Unit</code> ,å› ä¸ºå‚æ•°æ˜¯ä¸ªå‡½æ•°ï¼Œä¸ºäº†èƒ½è°ƒç”¨åˆ°å‡½æ•°ï¼Œæˆ‘ä»¬æŠŠå®ƒå«åš<code>emit</code>å§ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> kotlin.*</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">val</span> f: ((String) -&gt; <span class="built_in">Unit</span>) -&gt; <span class="built_in">Unit</span> = &#123; emit -&gt; <span class="comment">// 1</span></span><br><span class="line">        emit(<span class="string">&quot;A&quot;</span>)</span><br><span class="line">        emit(<span class="string">&quot;B&quot;</span>)</span><br><span class="line">        emit(<span class="string">&quot;C&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    f &#123; print(it) &#125; <span class="comment">// ABC</span></span><br><span class="line">    f &#123; print(it) &#125; <span class="comment">// ABC</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ·»åŠ çš„å‚æ•°çœ‹èµ·æ¥æœ‰ç‚¹ä¹±ğŸ¤”ï¼Œç¨å¾®ä¿®æ”¹ä¸€ä¸‹ï¼ŒæŠ½å‡ºæ¥å§ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> kotlin.*</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="keyword">interface</span> FlowCollector &#123;</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">emit</span><span class="params">(value: <span class="type">String</span>)</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">val</span> f: (FlowCollector) -&gt; <span class="built_in">Unit</span> = &#123;</span><br><span class="line">        it.emit(<span class="string">&quot;A&quot;</span>)</span><br><span class="line">        it.emit(<span class="string">&quot;B&quot;</span>)</span><br><span class="line">        it.emit(<span class="string">&quot;C&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    f &#123; print(it) &#125; <span class="comment">// ABC</span></span><br><span class="line">    f &#123; print(it) &#125; <span class="comment">// ABC</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¥½åƒèƒ½æŠŠ<code>it</code>çš„è°ƒç”¨é€»è¾‘å»æ‰ï¼Œè¿™æ ·æ›´ç®€æ´ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> kotlin.*</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="keyword">interface</span> FlowCollector &#123;</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">emit</span><span class="params">(value: <span class="type">String</span>)</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">val</span> f: FlowCollector.() -&gt; <span class="built_in">Unit</span> = &#123;</span><br><span class="line">        emit(<span class="string">&quot;A&quot;</span>)</span><br><span class="line">        emit(<span class="string">&quot;B&quot;</span>)</span><br><span class="line">        emit(<span class="string">&quot;C&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    f &#123; print(it) &#125; <span class="comment">// ABC</span></span><br><span class="line">    f &#123; print(it) &#125; <span class="comment">// ABC</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è°ƒç”¨lambdaè¡¨è¾¾å¼ä¸æ˜¯å¾ˆæ–¹ä¾¿ã€‚å¦‚æœæŠŠå®ƒæŠ½æˆæ¥å£ğŸ¤”</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> kotlin.*</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="keyword">interface</span> FlowCollector &#123;</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">emit</span><span class="params">(value: <span class="type">String</span>)</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Flow</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">collect</span><span class="params">(collector: <span class="type">FlowCollector</span>)</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">val</span> builder: FlowCollector.() -&gt; <span class="built_in">Unit</span> = &#123;</span><br><span class="line">        emit(<span class="string">&quot;A&quot;</span>)</span><br><span class="line">        emit(<span class="string">&quot;B&quot;</span>)</span><br><span class="line">        emit(<span class="string">&quot;C&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">val</span> flow: Flow = <span class="keyword">object</span> : Flow &#123;</span><br><span class="line">        <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">collect</span><span class="params">(collector: <span class="type">FlowCollector</span>)</span></span> &#123;</span><br><span class="line">            collector.builder()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    flow.collect &#123; print(it) &#125; <span class="comment">// ABC</span></span><br><span class="line">    flow.collect &#123; print(it) &#125; <span class="comment">// ABC</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æŠ½æˆå¯ä»¥é‡å¤è°ƒç”¨çš„æ„å»ºå™¨ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> kotlin.*</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="keyword">interface</span> FlowCollector &#123;</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">emit</span><span class="params">(value: <span class="type">String</span>)</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Flow</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">collect</span><span class="params">(collector: <span class="type">FlowCollector</span>)</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">flow</span><span class="params">(builder: <span class="type">FlowCollector</span>.() -&gt; <span class="type">Unit</span>)</span></span> = <span class="keyword">object</span> : Flow &#123;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">collect</span><span class="params">(collector: <span class="type">FlowCollector</span>)</span></span> &#123;</span><br><span class="line">        collector.builder()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">val</span> f: Flow = flow &#123;</span><br><span class="line">        emit(<span class="string">&quot;A&quot;</span>)</span><br><span class="line">        emit(<span class="string">&quot;B&quot;</span>)</span><br><span class="line">        emit(<span class="string">&quot;C&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    f.collect &#123; print(it) &#125; <span class="comment">// ABC</span></span><br><span class="line">    f.collect &#123; print(it) &#125; <span class="comment">// ABC</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ³›å‹åŒ–å‚æ•°æ›´é€šç”¨ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> kotlin.*</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="keyword">interface</span> FlowCollector<span class="type">&lt;T&gt;</span> &#123;</span></span><br><span class="line">    <span class="keyword">suspend</span> <span class="function"><span class="keyword">fun</span> <span class="title">emit</span><span class="params">(value: <span class="type">T</span>)</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Flow</span>&lt;<span class="type">T</span>&gt; </span>&#123;</span><br><span class="line">    <span class="keyword">suspend</span> <span class="function"><span class="keyword">fun</span> <span class="title">collect</span><span class="params">(collector: <span class="type">FlowCollector</span>&lt;<span class="type">T</span>&gt;)</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="type">&lt;T&gt;</span> <span class="title">flow</span><span class="params">(builder: <span class="type">suspend</span> <span class="type">FlowCollector</span>&lt;<span class="type">T</span>&gt;.() -&gt; <span class="type">Unit</span>)</span></span> = <span class="keyword">object</span> : Flow&lt;T&gt; &#123;</span><br><span class="line">    <span class="keyword">override</span> <span class="keyword">suspend</span> <span class="function"><span class="keyword">fun</span> <span class="title">collect</span><span class="params">(collector: <span class="type">FlowCollector</span>&lt;<span class="type">T</span>&gt;)</span></span> &#123;</span><br><span class="line">        collector.builder()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">suspend</span> <span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">val</span> f: Flow&lt;String&gt; = flow &#123;</span><br><span class="line">        emit(<span class="string">&quot;A&quot;</span>)</span><br><span class="line">        emit(<span class="string">&quot;B&quot;</span>)</span><br><span class="line">        emit(<span class="string">&quot;C&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    f.collect &#123; print(it) &#125; <span class="comment">// ABC</span></span><br><span class="line">    f.collect &#123; print(it) &#125; <span class="comment">// ABC</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p><a href="https://kt.academy/article/how-flow-works">å‚è€ƒ</a></p>
]]></content>
      <categories>
        <category>è®¡ç®—æœº</category>
      </categories>
      <tags>
        <tag>Kotlin</tag>
      </tags>
  </entry>
  <entry>
    <title>Kotlin Flow åŸºç¡€</title>
    <url>/kotlin-lang-flow.html</url>
    <content><![CDATA[<h4 id="ä¸€ã€ä»€ä¹ˆæ˜¯Flow"><a href="#ä¸€ã€ä»€ä¹ˆæ˜¯Flow" class="headerlink" title="ä¸€ã€ä»€ä¹ˆæ˜¯Flow"></a>ä¸€ã€ä»€ä¹ˆæ˜¯Flow</h4><h5 id="1ã€å¦‚ä½•é€šè¿‡åŒæ­¥å’Œå¼‚æ­¥æ–¹å¼è¿”å›å¤šä¸ªå€¼ï¼Ÿ"><a href="#1ã€å¦‚ä½•é€šè¿‡åŒæ­¥å’Œå¼‚æ­¥æ–¹å¼è¿”å›å¤šä¸ªå€¼ï¼Ÿ" class="headerlink" title="1ã€å¦‚ä½•é€šè¿‡åŒæ­¥å’Œå¼‚æ­¥æ–¹å¼è¿”å›å¤šä¸ªå€¼ï¼Ÿ"></a>1ã€å¦‚ä½•é€šè¿‡åŒæ­¥å’Œå¼‚æ­¥æ–¹å¼è¿”å›å¤šä¸ªå€¼ï¼Ÿ</h5><p>1.1 åŒæ­¥æ–¹å¼è¿”å›å¤šä¸ªå€¼</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">simple</span><span class="params">()</span></span>: List&lt;<span class="built_in">Int</span>&gt; = listOf(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    simple().forEach &#123; value -&gt; println(value) &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>1.2 åŒæ­¥æ–¹å¼<strong>ä¾æ¬¡</strong>è¿”å›å¤šä¸ªå€¼</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">simple</span><span class="params">()</span></span>: Sequence&lt;<span class="built_in">Int</span>&gt; = sequence &#123; <span class="comment">// sequence builder</span></span><br><span class="line">    <span class="keyword">for</span> (i <span class="keyword">in</span> <span class="number">1.</span><span class="number">.3</span>) &#123;</span><br><span class="line">        Thread.sleep(<span class="number">1000</span>) <span class="comment">// pretend we are computing it</span></span><br><span class="line">        yield(i) <span class="comment">// yield next value</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    simple().forEach &#123; value -&gt; println(<span class="string">&quot;time = <span class="subst">$&#123;System.currentTimeMillis()&#125;</span> ,<span class="variable">$value</span>&quot;</span>) &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p>1.3 å¼‚æ­¥æ–¹å¼è¿”å›å¤šä¸ªå€¼</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">suspend</span> <span class="function"><span class="keyword">fun</span> <span class="title">simple</span><span class="params">()</span></span>: List&lt;<span class="built_in">Int</span>&gt; &#123;</span><br><span class="line">    delay(<span class="number">1000</span>) <span class="comment">// pretend we are doing something asynchronous here</span></span><br><span class="line">    <span class="keyword">return</span> listOf(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> = runBlocking&lt;<span class="built_in">Unit</span>&gt; &#123;</span><br><span class="line">    simple().forEach &#123; value -&gt; println(value) &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>1.4 å¦‚ä½•é€šè¿‡å¼‚æ­¥çš„æ–¹å¼<strong>ä¾æ¬¡</strong>è¿”å›å¤šä¸ªå€¼å‘¢ï¼Ÿ</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">simple</span><span class="params">()</span></span>: Flow&lt;<span class="built_in">Int</span>&gt; = flow &#123; <span class="comment">// flow builder</span></span><br><span class="line">    <span class="keyword">for</span> (i <span class="keyword">in</span> <span class="number">1.</span><span class="number">.3</span>) &#123;</span><br><span class="line">        delay(<span class="number">100</span>) <span class="comment">// pretend we are doing something useful here</span></span><br><span class="line">        emit(i) <span class="comment">// emit next value</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> = runBlocking&lt;<span class="built_in">Unit</span>&gt; &#123;</span><br><span class="line">    <span class="comment">// Launch a concurrent coroutine to check if the main thread is blocked</span></span><br><span class="line">    launch &#123;</span><br><span class="line">        <span class="keyword">for</span> (k <span class="keyword">in</span> <span class="number">1.</span><span class="number">.3</span>) &#123;</span><br><span class="line">            println(<span class="string">&quot;I&#x27;m not blocked <span class="variable">$k</span>&quot;</span>)</span><br><span class="line">            delay(<span class="number">100</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// Collect the flow</span></span><br><span class="line">    simple().collect &#123; value -&gt; println(value) &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>é€šè¿‡flowï¼Œæˆ‘ä»¬å¯ä»¥å®ç°å¼‚æ­¥çš„æ•°æ®æµã€‚</strong></p>
<h5 id="2ã€Flowæ˜¯å†·æ•°æ®æµ"><a href="#2ã€Flowæ˜¯å†·æ•°æ®æµ" class="headerlink" title="2ã€Flowæ˜¯å†·æ•°æ®æµ"></a>2ã€Flowæ˜¯å†·æ•°æ®æµ</h5><p>å†·æ•°æ®æµï¼šæ¯æ¬¡è°ƒç”¨<code>collect</code>å‡½æ•°æ—¶éƒ½ä¼šè§¦å‘æ‰§è¡Œ</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">simple</span><span class="params">()</span></span>: Flow&lt;<span class="built_in">Int</span>&gt; = flow &#123; </span><br><span class="line">    println(<span class="string">&quot;Flow started&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> (i <span class="keyword">in</span> <span class="number">1.</span><span class="number">.3</span>) &#123;</span><br><span class="line">        delay(<span class="number">100</span>)</span><br><span class="line">        emit(i)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> = runBlocking&lt;<span class="built_in">Unit</span>&gt; &#123;</span><br><span class="line">    println(<span class="string">&quot;Calling simple function...&quot;</span>)</span><br><span class="line">    <span class="keyword">val</span> flow = simple()</span><br><span class="line">    println(<span class="string">&quot;Calling collect...&quot;</span>)</span><br><span class="line">    flow.collect &#123; value -&gt; println(value) &#125; </span><br><span class="line">    println(<span class="string">&quot;Calling collect again...&quot;</span>)</span><br><span class="line">    flow.collect &#123; value -&gt; println(value) &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="3ã€Flowçš„å–æ¶ˆ"><a href="#3ã€Flowçš„å–æ¶ˆ" class="headerlink" title="3ã€Flowçš„å–æ¶ˆ"></a>3ã€Flowçš„å–æ¶ˆ</h5><figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">simple</span><span class="params">()</span></span>: Flow&lt;<span class="built_in">Int</span>&gt; = flow &#123; </span><br><span class="line">    <span class="keyword">for</span> (i <span class="keyword">in</span> <span class="number">1.</span><span class="number">.3</span>) &#123;</span><br><span class="line">        delay(<span class="number">100</span>)          </span><br><span class="line">        println(<span class="string">&quot;Emitting <span class="variable">$i</span>&quot;</span>)</span><br><span class="line">        emit(i)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> = runBlocking&lt;<span class="built_in">Unit</span>&gt; &#123;</span><br><span class="line">    withTimeoutOrNull(<span class="number">250</span>) &#123; <span class="comment">// Timeout after 250ms </span></span><br><span class="line">        simple().collect &#123; value -&gt; println(value) &#125; </span><br><span class="line">    &#125;</span><br><span class="line">    println(<span class="string">&quot;Done&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h5 id="4ã€å¦‚ä½•æ„å»ºFlowï¼Ÿ"><a href="#4ã€å¦‚ä½•æ„å»ºFlowï¼Ÿ" class="headerlink" title="4ã€å¦‚ä½•æ„å»ºFlowï¼Ÿ"></a>4ã€å¦‚ä½•æ„å»ºFlowï¼Ÿ</h5><ul>
<li><code>flow&#123; ... &#125;</code></li>
<li><code>flowOf</code></li>
<li><code>.asFlow()</code></li>
</ul>
<h5 id="5ã€Flowæ“ä½œç¬¦"><a href="#5ã€Flowæ“ä½œç¬¦" class="headerlink" title="5ã€Flowæ“ä½œç¬¦"></a>5ã€Flowæ“ä½œç¬¦</h5><p>5.1 ä¸­é—´æ“ä½œç¬¦</p>
<ul>
<li>map</li>
<li>filter</li>
<li>transform</li>
<li>take</li>
</ul>
<p>5.2 ç»ˆæ­¢æ“ä½œç¬¦</p>
<ul>
<li>collect</li>
<li>toList / toSet</li>
<li>first / single</li>
<li>reduce / fold</li>
</ul>
<p>5.3 <code>buffer</code>å½“æµçš„å¤„ç†é€Ÿåº¦æ…¢äºå‘å°„é€Ÿåº¦æ—¶ï¼Œé€šè¿‡bufferæå‰ç¼“å­˜å¯ä»¥æé«˜æ•ˆç‡ï¼š </p>
<p>ä¼˜åŒ–å‰ï¼šè€—æ—¶1200ms</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">simple</span><span class="params">()</span></span>: Flow&lt;<span class="built_in">Int</span>&gt; = flow &#123;</span><br><span class="line">    <span class="keyword">for</span> (i <span class="keyword">in</span> <span class="number">1.</span><span class="number">.3</span>) &#123;</span><br><span class="line">        delay(<span class="number">100</span>) <span class="comment">// pretend we are asynchronously waiting 100 ms</span></span><br><span class="line">        emit(i) <span class="comment">// emit next value</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> = runBlocking&lt;<span class="built_in">Unit</span>&gt; &#123; </span><br><span class="line">    <span class="keyword">val</span> time = measureTimeMillis &#123;</span><br><span class="line">        simple().collect &#123; value -&gt; </span><br><span class="line">            delay(<span class="number">300</span>) <span class="comment">// pretend we are processing it for 300 ms</span></span><br><span class="line">            println(value) </span><br><span class="line">        &#125; </span><br><span class="line">    &#125;   </span><br><span class="line">    println(<span class="string">&quot;Collected in <span class="variable">$time</span> ms&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¼˜åŒ–åï¼šè€—æ—¶1000ms</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">val</span> time = measureTimeMillis &#123;</span><br><span class="line">    simple()</span><br><span class="line">        .buffer() <span class="comment">// buffer emissions, don&#x27;t wait</span></span><br><span class="line">        .collect &#123; value -&gt; </span><br><span class="line">            delay(<span class="number">300</span>) <span class="comment">// pretend we are processing it for 300 ms</span></span><br><span class="line">            println(value) </span><br><span class="line">        &#125; </span><br><span class="line">&#125;   </span><br><span class="line">println(<span class="string">&quot;Collected in <span class="variable">$time</span> ms&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>5.4 <code>conflate</code>å½“ç”Ÿäº§é€Ÿåº¦å¤§äºæ¶ˆè´¹é€Ÿåº¦ï¼Œå¿½ç•¥æœªæ¥å¾—åŠå¤„ç†çš„å€¼</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">val</span> time = measureTimeMillis &#123;</span><br><span class="line">    simple()</span><br><span class="line">        .conflate() <span class="comment">// conflate emissions, don&#x27;t process each one</span></span><br><span class="line">        .collect &#123; value -&gt; </span><br><span class="line">            delay(<span class="number">300</span>) <span class="comment">// pretend we are processing it for 300 ms</span></span><br><span class="line">            println(value) </span><br><span class="line">        &#125; </span><br><span class="line">&#125;   </span><br><span class="line">println(<span class="string">&quot;Collected in <span class="variable">$time</span> ms&quot;</span>)</span><br><span class="line"><span class="comment">//è¾“å‡ºï¼š</span></span><br><span class="line"><span class="comment">//1</span></span><br><span class="line"><span class="comment">//3</span></span><br><span class="line"><span class="comment">//Collected in 758 ms</span></span><br></pre></td></tr></table></figure>

<p>5.5 <code>collectLatest</code> å¦‚æœæ¶ˆè´¹è€…å¾ˆæ…¢ï¼Œå–æ¶ˆå®ƒï¼Œæ–°å€¼è¿‡æ¥æ—¶å†é‡æ–°å¯åŠ¨ã€‚</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">val</span> time = measureTimeMillis &#123;</span><br><span class="line">    simple()</span><br><span class="line">        .collectLatest &#123; value -&gt; <span class="comment">// cancel &amp; restart on the latest value</span></span><br><span class="line">            println(<span class="string">&quot;Collecting <span class="variable">$value</span>&quot;</span>) </span><br><span class="line">            delay(<span class="number">300</span>) <span class="comment">// pretend we are processing it for 300 ms</span></span><br><span class="line">            println(<span class="string">&quot;Done <span class="variable">$value</span>&quot;</span>) </span><br><span class="line">        &#125; </span><br><span class="line">&#125;   </span><br><span class="line">println(<span class="string">&quot;Collected in <span class="variable">$time</span> ms&quot;</span>)</span><br><span class="line"><span class="comment">//output:</span></span><br><span class="line"><span class="comment">//Collecting 1</span></span><br><span class="line"><span class="comment">//Collecting 2</span></span><br><span class="line"><span class="comment">//Collecting 3</span></span><br><span class="line"><span class="comment">//Done 3</span></span><br><span class="line"><span class="comment">//Collected in 741 ms</span></span><br></pre></td></tr></table></figure>

<p>5.6 å¤šä¸ªflowåˆå¹¶ï¼šzip / combine  </p>
<p>ä½¿ç”¨<code>zip</code>æ“ä½œç¬¦</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">val</span> nums = (<span class="number">1.</span><span class="number">.3</span>).asFlow() <span class="comment">// numbers 1..3</span></span><br><span class="line"><span class="keyword">val</span> strs = flowOf(<span class="string">&quot;one&quot;</span>, <span class="string">&quot;two&quot;</span>, <span class="string">&quot;three&quot;</span>) <span class="comment">// strings </span></span><br><span class="line">nums.zip(strs) &#123; a, b -&gt; <span class="string">&quot;<span class="variable">$a</span> -&gt; <span class="variable">$b</span>&quot;</span> &#125; <span class="comment">// compose a single string</span></span><br><span class="line">    .collect &#123; println(it) &#125; <span class="comment">// collect and print</span></span><br><span class="line"><span class="comment">//output:</span></span><br><span class="line"><span class="comment">//1 -&gt; one</span></span><br><span class="line"><span class="comment">//2 -&gt; two</span></span><br><span class="line"><span class="comment">//3 -&gt; three</span></span><br></pre></td></tr></table></figure>

<p>å½“ä¸¤ä¸ªflowä¸åŒæ­¥æ—¶ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="comment">//é€Ÿåº¦ä¸åŒæ­¥æ—¶ï¼Œä½¿ç”¨zipï¼Œåˆ°è¾¾åŒæ­¥ç‚¹æ‰è¾“å‡º</span></span><br><span class="line"><span class="keyword">val</span> nums = (<span class="number">1.</span><span class="number">.3</span>).asFlow().onEach &#123; delay(<span class="number">300</span>) &#125; <span class="comment">// numbers 1..3 every 300 ms</span></span><br><span class="line"><span class="keyword">val</span> strs = flowOf(<span class="string">&quot;one&quot;</span>, <span class="string">&quot;two&quot;</span>, <span class="string">&quot;three&quot;</span>).onEach &#123; delay(<span class="number">400</span>) &#125; <span class="comment">// strings every 400 ms</span></span><br><span class="line"><span class="keyword">val</span> startTime = System.currentTimeMillis() <span class="comment">// remember the start time </span></span><br><span class="line">nums.zip(strs) &#123; a, b -&gt; <span class="string">&quot;<span class="variable">$a</span> -&gt; <span class="variable">$b</span>&quot;</span> &#125; <span class="comment">// compose a single string with &quot;zip&quot;</span></span><br><span class="line">    .collect &#123; value -&gt; <span class="comment">// collect and print </span></span><br><span class="line">        println(<span class="string">&quot;<span class="variable">$value</span> at <span class="subst">$&#123;System.currentTimeMillis() - startTime&#125;</span> ms from start&quot;</span>) </span><br><span class="line">    &#125; </span><br><span class="line"><span class="comment">//output:</span></span><br><span class="line"><span class="comment">//1 -&gt; one at 428 ms from start</span></span><br><span class="line"><span class="comment">//2 -&gt; two at 828 ms from start</span></span><br><span class="line"><span class="comment">//3 -&gt; three at 1230 ms from start</span></span><br></pre></td></tr></table></figure>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="comment">////é€Ÿåº¦ä¸åŒæ­¥æ—¶ï¼Œä½¿ç”¨combineï¼Œæœ‰å€¼åˆ°è¾¾å³è¾“å‡ºï¼Œæ— è§†åŒæ­¥</span></span><br><span class="line"><span class="keyword">val</span> nums = (<span class="number">1.</span><span class="number">.3</span>).asFlow().onEach &#123; delay(<span class="number">300</span>) &#125; <span class="comment">// numbers 1..3 every 300 ms</span></span><br><span class="line"><span class="keyword">val</span> strs = flowOf(<span class="string">&quot;one&quot;</span>, <span class="string">&quot;two&quot;</span>, <span class="string">&quot;three&quot;</span>).onEach &#123; delay(<span class="number">400</span>) &#125; <span class="comment">// strings every 400 ms          </span></span><br><span class="line"><span class="keyword">val</span> startTime = System.currentTimeMillis() <span class="comment">// remember the start time </span></span><br><span class="line">nums.combine(strs) &#123; a, b -&gt; <span class="string">&quot;<span class="variable">$a</span> -&gt; <span class="variable">$b</span>&quot;</span> &#125; <span class="comment">// compose a single string with &quot;combine&quot;</span></span><br><span class="line">    .collect &#123; value -&gt; <span class="comment">// collect and print </span></span><br><span class="line">        println(<span class="string">&quot;<span class="variable">$value</span> at <span class="subst">$&#123;System.currentTimeMillis() - startTime&#125;</span> ms from start&quot;</span>) </span><br><span class="line">    &#125; </span><br><span class="line"><span class="comment">//output:</span></span><br><span class="line"><span class="comment">//1 -&gt; one at 452 ms from start</span></span><br><span class="line"><span class="comment">//2 -&gt; one at 651 ms from start</span></span><br><span class="line"><span class="comment">//2 -&gt; two at 854 ms from start</span></span><br><span class="line"><span class="comment">//3 -&gt; two at 952 ms from start</span></span><br><span class="line"><span class="comment">//3 -&gt; three at 1256 ms from start</span></span><br></pre></td></tr></table></figure>


<p>å‚è€ƒæ–‡æ¡£ï¼š<br><a href="https://kotlinlang.org/docs/flow.html"> 1.å®˜æ–¹æ–‡æ¡£</a></p>
]]></content>
      <categories>
        <category>è®¡ç®—æœº</category>
      </categories>
      <tags>
        <tag>Kotlin</tag>
      </tags>
  </entry>
  <entry>
    <title>Effective Kotlin-48ï¼šä¸ºå‚æ•°åŒ…å«å‡½æ•°çš„æ–¹æ³•å†…è”</title>
    <url>/kotlin-lang-inline-func-param.html</url>
    <content><![CDATA[<h4 id="ä¸€ã€æ¦‚è¿°"><a href="#ä¸€ã€æ¦‚è¿°" class="headerlink" title="ä¸€ã€æ¦‚è¿°"></a>ä¸€ã€æ¦‚è¿°</h4><p>ä½ å¯èƒ½æ³¨æ„åˆ°äº†å‡ ä¹æ‰€æœ‰çš„Kotlinæ ‡å‡†åº“é‡Œé¢çš„é«˜é˜¶å‡½æ•°éƒ½æ˜¯inlineç±»å‹çš„ã€‚</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">inline</span> <span class="function"><span class="keyword">fun</span> <span class="title">repeat</span><span class="params">(times: <span class="type">Int</span>, action: (<span class="type">Int</span>) -&gt; <span class="type">Unit</span>)</span></span> &#123;</span><br><span class="line">    <span class="keyword">for</span> (index <span class="keyword">in</span> <span class="number">0</span> until times) &#123;</span><br><span class="line">        action(index)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">inline</span> <span class="function"><span class="keyword">fun</span> <span class="type">&lt;T, R&gt;</span> Iterable<span class="type">&lt;T&gt;</span>.<span class="title">map</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">    transform: (<span class="type">T</span>) -&gt; <span class="type">R</span></span></span></span><br><span class="line"><span class="params"><span class="function">)</span></span>: List&lt;R&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> mapTo(</span><br><span class="line">        ArrayList&lt;R&gt;(collectionSizeOrDefault(<span class="number">10</span>)),</span><br><span class="line">        transform</span><br><span class="line">    )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">inline</span> <span class="function"><span class="keyword">fun</span> <span class="type">&lt;T&gt;</span> Iterable<span class="type">&lt;T&gt;</span>.<span class="title">filter</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">    predicate: (<span class="type">T</span>) -&gt; <span class="type">Boolean</span></span></span></span><br><span class="line"><span class="params"><span class="function">)</span></span>: List&lt;T&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> filterTo(ArrayList&lt;T&gt;(), predicate)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™äº›å‡½æ•°çš„è°ƒç”¨åœ¨ç¼–è¯‘æ—¶ä¼šè¢«å±•å¼€åˆ°è°ƒç”¨å¤„ã€‚å¦‚ä¸‹æ‰€ç¤º:<code>repeat</code>å‡½æ•°ä¼šè¢«å®ƒæœ¬èº«çš„å‡½æ•°ä½“æ›¿æ¢æ‰ã€‚</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line">repeat(<span class="number">10</span>) &#123;</span><br><span class="line">    print(it)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“</span></span><br><span class="line"><span class="keyword">for</span> (index <span class="keyword">in</span> <span class="number">0</span> until <span class="number">10</span>) &#123;</span><br><span class="line">    print(index)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸€èˆ¬çš„å‡½æ•°è°ƒç”¨é€šå¸¸æ˜¯ï¼šè·³è¿›å‡½æ•°ä½“ï¼Œæ‰§è¡Œä»£ç ï¼Œç„¶åè·³å‡ºå‡½æ•°ä½“ï¼Œå›åˆ°è°ƒç”¨ç‚¹ã€‚è€Œç”¨å‡½æ•°ä½“æ›¿æ¢å‡½æ•°è°ƒç”¨æ˜¯ä¸€ç§å®Œå…¨ä¸åŒçš„æ–¹å¼ï¼Œè¿™ç§æ–¹å¼æœ‰ä»¥ä¸‹ä¸€äº›ä¼˜ç‚¹ï¼š</p>
<ul>
<li>ç±»å‹å‚æ•°å…·ä½“åŒ–</li>
<li>å‚æ•°åŒ…å«å‡½æ•°çš„æ–¹æ³•å†…è”åæ‰§è¡Œæ›´å¿«</li>
<li>ä¸å…è®¸éæœ¬åœ°çš„returnè¯­å¥</li>
</ul>
<p>ä½¿ç”¨inlineæ ‡è¯†ç¬¦ä¹Ÿä¼šæœ‰ä¸€äº›ç¼ºç‚¹ï¼Œä¸‹é¢ğŸ‘‡ğŸ»æˆ‘ä»¬ä¸€èµ·æ¥çœ‹ä¸€ä¸‹å®ƒçš„ä¼˜ç¼ºç‚¹ï¼š</p>
<h5 id="ä¸€ã€ç±»å‹å‚æ•°å…·ä½“åŒ–ï¼š"><a href="#ä¸€ã€ç±»å‹å‚æ•°å…·ä½“åŒ–ï¼š" class="headerlink" title="ä¸€ã€ç±»å‹å‚æ•°å…·ä½“åŒ–ï¼š"></a>ä¸€ã€ç±»å‹å‚æ•°å…·ä½“åŒ–ï¼š</h5><p>æ—©æœŸçš„Javaç‰ˆæœ¬ä¸æ”¯æŒæ³›å‹ï¼Œåœ¨2004å¹´çš„J2SE-5.0æ‰æ”¯æŒã€‚ç”±äºæ³›å‹ä¼šåœ¨ç¼–è¯‘æœŸé—´è¢«æ“¦é™¤ï¼Œæ‰€ä»¥åœ¨å­—èŠ‚ç å±‚é¢æ˜¯ä¸å­˜åœ¨çš„ã€‚ä¾‹å¦‚ï¼š<code>List&lt;Int&gt;</code> ç¼–è¯‘åæˆä¸º <code>List</code> ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦æ£€æŸ¥ä¸€ä¸ªå¯¹è±¡æ˜¯å¦æ˜¯Listå®ä¾‹ï¼Œè€Œä¸ç”¨æ£€æŸ¥å®ƒæ˜¯å¦æ˜¯ä¸€ä¸ª<code>List&lt;Int&gt;</code>ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line">any <span class="keyword">is</span> List&lt;<span class="built_in">Int</span>&gt; <span class="comment">// Error</span></span><br><span class="line">any <span class="keyword">is</span> List&lt;*&gt; <span class="comment">// OK</span></span><br></pre></td></tr></table></figure>

<center>
    <img src="../images/kotlin_type_check.png" width="500"/>
</center>

<p>ç”±äºè¿™ä¸ªåŸå› ï¼Œæˆ‘ä»¬ä¸èƒ½æ“ä½œç±»å‹å‚æ•°ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="type">&lt;T&gt;</span> <span class="title">printTypeName</span><span class="params">()</span></span> &#123;</span><br><span class="line">    print(T::<span class="keyword">class</span>.simpleName) <span class="comment">// ERROR</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>é€šè¿‡å†…è”å‡½æ•°æˆ‘ä»¬å¯ä»¥çªç ´è¿™ç§é™åˆ¶ã€‚ç”±äºå‡½æ•°è°ƒç”¨è¢«å‡½æ•°ä½“æ›¿æ¢ï¼Œé€šè¿‡ä½¿ç”¨<code>reified</code>ä¿®é¥°ç¬¦ï¼Œæ³›å‹è¢«çœŸå®çš„ç±»å‹å‚æ•°æ›¿æ¢ã€‚</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">inline</span> <span class="function"><span class="keyword">fun</span> <span class="type">&lt;<span class="keyword">reified</span> T&gt;</span> <span class="title">printTypeName</span><span class="params">()</span></span> &#123;</span><br><span class="line">    print(T::<span class="keyword">class</span>.simpleName)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Usage</span></span><br><span class="line">printTypeName&lt;<span class="built_in">Int</span>&gt;()    <span class="comment">//â†’print(Int::class.simpleName) // Int</span></span><br><span class="line">printTypeName&lt;<span class="built_in">Char</span>&gt;()   <span class="comment">//â†’print(Char::class.simpleName)// Char</span></span><br><span class="line">printTypeName&lt;String&gt;() <span class="comment">//â†’print(String::class.simpleName)// String</span></span><br></pre></td></tr></table></figure>

<p><code>reified</code>æ˜¯ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„ä¿®é¥°ç¬¦ï¼Œä¾‹å¦‚æ ‡å‡†åº“é‡Œé¢çš„<code>filterIsInstance</code>ç”¨æ¥è¿‡æ»¤æŸä¸€ç§ç±»å‹çš„å…ƒç´ ã€‚</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Worker</span></span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Manager</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">val</span> employees: List&lt;Any&gt; =</span><br><span class="line">    listOf(Worker(), Manager(), Worker())</span><br><span class="line"></span><br><span class="line"><span class="keyword">val</span> workers: List&lt;Worker&gt; =</span><br><span class="line">    employees.filterIsInstance&lt;Worker&gt;()</span><br></pre></td></tr></table></figure>

<p>å®ƒç»å¸¸è¢«ç”¨åœ¨æˆ‘ä»¬è‡ªå·±å†™çš„ä»£ç åº“æˆ–å·¥å…·ç±»ä¸­ã€‚ä¸‹é¢çš„ä¾‹å­æ˜¯ä½¿ç”¨Gsonåº“å®ç°çš„é€šç”¨å‡½æ•°ï¼Œå®ƒèƒ½å¸®åŠ©æˆ‘ä»¬ç®€åŒ–ä¾èµ–æ³¨å…¥å’Œæ¨¡å—ç”³æ˜ã€‚</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">inline</span> <span class="function"><span class="keyword">fun</span> <span class="type">&lt;<span class="keyword">reified</span> T : Any&gt;</span> String.<span class="title">fromJsonOrNull</span><span class="params">()</span></span>: T? =</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        gson.fromJson(json, T::<span class="keyword">class</span>.java)</span><br><span class="line">    &#125; <span class="keyword">catch</span> (e: JsonSyntaxException) &#123;</span><br><span class="line">        <span class="literal">null</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// usage</span></span><br><span class="line"><span class="keyword">val</span> user: User? = userAsText.fromJsonOrNull()</span><br><span class="line"></span><br><span class="line"><span class="comment">// Koin module declaration</span></span><br><span class="line"><span class="keyword">val</span> myModule = module &#123;</span><br><span class="line">    single &#123; Controller(<span class="keyword">get</span>()) &#125; <span class="comment">// get is reified</span></span><br><span class="line">    single &#123; BusinessService() &#125; <span class="comment">// get is reified</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Koin injection</span></span><br><span class="line"><span class="keyword">val</span> service: BusinessService <span class="keyword">by</span> inject()</span><br><span class="line"><span class="comment">// inject is reified</span></span><br></pre></td></tr></table></figure>

<h5 id="äºŒã€å‡½æ•°ç±»å‹çš„å‚æ•°å†…è”åæ‰§è¡Œæ›´å¿«"><a href="#äºŒã€å‡½æ•°ç±»å‹çš„å‚æ•°å†…è”åæ‰§è¡Œæ›´å¿«" class="headerlink" title="äºŒã€å‡½æ•°ç±»å‹çš„å‚æ•°å†…è”åæ‰§è¡Œæ›´å¿«"></a>äºŒã€å‡½æ•°ç±»å‹çš„å‚æ•°å†…è”åæ‰§è¡Œæ›´å¿«</h5><p>æ›´ç¡®åˆ‡çš„è®²ï¼ŒçŸ­å°çš„å‡½æ•°å†…è”ä¼šæ›´å¿«ï¼Œå®ƒæ— éœ€è·³è½¬æ‰§è¡Œå’Œè·Ÿè¸ªè°ƒç”¨æ ˆã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆæ ‡å‡†åº“é‡Œé¢å¾ˆå¤šå°å‡½æ•°éƒ½æ˜¯inlineç±»å‹çš„åŸå› ã€‚</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">inline</span> <span class="function"><span class="keyword">fun</span> <span class="title">print</span><span class="params">(message: <span class="type">Any</span>?)</span></span> &#123;</span><br><span class="line">    System.<span class="keyword">out</span>.print(message)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å½“æ–¹æ³•æ²¡æœ‰å‡½æ•°ç±»å‹çš„å‚æ•°æ—¶ï¼Œæ²¡å¿…è¦å†…è”ä¸”IntelliJä¼šç»™å‡ºä»¥ä¸‹æç¤ºâš ï¸ï¼š</p>
<center>
    <img src="../images/kotlin_intelij_waring_inline.jpeg" width="500"/>
</center>


<p>è¦ç†è§£å…¶ä¸­çš„åŸå› ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦ç†è§£å°†å‡½æ•°ä½œä¸ºå¯¹è±¡è¿›è¡Œæ“ä½œçš„é—®é¢˜æ˜¯ä»€ä¹ˆã€‚è¿™äº›ç±»å‹çš„å¯¹è±¡(ä½¿ç”¨å‡½æ•°å­—é¢é‡åˆ›å»º)éœ€è¦ä»¥æŸç§æ–¹å¼ä¿å­˜ã€‚åœ¨Kotlin/JVMä¸Šï¼Œéœ€è¦ä½¿ç”¨JVMåŒ¿åç±»æˆ–æ™®é€šç±»åˆ›å»ºä¸€äº›å¯¹è±¡ã€‚å› æ­¤ï¼Œä¸‹é¢çš„lambdaè¡¨è¾¾å¼:</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">val</span> lambda: () -&gt; <span class="built_in">Unit</span> = &#123;</span><br><span class="line">    <span class="comment">// code</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å°†ä¼šè¢«ç¼–è¯‘ä¸ºä¸€ä¸ªç±»ã€‚æˆ–JVMåŒ¿åç±»ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Java</span></span><br><span class="line">Function0&lt;Unit&gt; lambda = <span class="keyword">new</span> Function0&lt;Unit&gt;() &#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Unit <span class="title">invoke</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// code</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>æˆ–è€…è¢«ç¼–è¯‘æˆä¸€ä¸ªæ™®é€šçš„ç±»ï¼Œè¢«å®šä¹‰åœ¨ä¸€ä¸ªå•ç‹¬çš„æ–‡ä»¶ä¸­ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Java</span></span><br><span class="line"><span class="comment">// Additional class in separate file</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span>$<span class="title">lambda</span> <span class="keyword">implements</span> <span class="title">Function0</span> &lt; <span class="title">Unit</span> &gt; </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Unit <span class="title">invoke</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// code</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Usage</span></span><br><span class="line">Function0 lambda = <span class="keyword">new</span> Test$lambda();</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸¤ç§æ–¹å¼æ²¡æœ‰ç‰¹åˆ«å¤§çš„åŒºåˆ«ã€‚</p>
<p>æˆ‘ä»¬æ³¨æ„åˆ°ï¼Œè¿™ä¸ªå‡½æ•°ç±»å‹è¢«è½¬æ¢æˆFunction0ç±»å‹ã€‚åœ¨Kotlinä¸­ï¼Œæ— å‚ç±»å‹ä¼šè¢«ç¼–è¯‘å™¨è½¬æ¢æˆFunction0ï¼ŒåŒç†å•å‚æ•°ï¼Œä¸¤å‚æ•°è½¬æ¢æˆFunction1, Function2,Function3ç­‰</p>
<ul>
<li>()-&gt;Unit ç¼–è¯‘æˆ Function0<Unit></li>
<li>()-&gt;Int ç¼–è¯‘æˆ Function0<Int></li>
<li>(Int)-&gt;Int ç¼–è¯‘æˆ Function1&lt;Int, Int&gt;</li>
<li>(Int, Int)-&gt;Int ç¼–è¯‘æˆ Function2&lt;Int, Int, Int&gt;</li>
</ul>
<p>è¿™äº›æ‰€æœ‰çš„æ¥å£éƒ½æ˜¯Kotlinç¼–è¯‘å™¨ç”Ÿæˆçš„ã€‚ä½ ä¸èƒ½åœ¨Kotliné‡Œæ˜¾ç¤ºçš„ä½¿ç”¨ä»–ä»¬ï¼Œå› ä¸ºå®ƒä»¬æ˜¯æŒ‰éœ€ç”Ÿæˆçš„ï¼Œè€Œåº”è¯¥ä½¿ç”¨å‡½æ•°ç±»å‹ã€‚çŸ¥é“å‡½æ•°ç±»å‹åªæ˜¯æ¥å£ä¸ºä½ å¼€å¯äº†å¾ˆå¤šçš„å¯èƒ½æ€§ã€‚æ¯”å¦‚ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">OnClickListener</span> : <span class="type"></span></span>() -&gt; <span class="built_in">Unit</span> &#123;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">invoke</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ­£å¦‚åœ¨<em>é«˜æ•ˆKotlin-47</em>ä¸­æ‰€è¿°ï¼šé¿å…ä¸å¿…è¦çš„å¯¹è±¡åˆ›å»ºï¼ŒæŠŠå‡½æ•°ä½“åŒ…è£…æˆå¯¹è±¡æ‹–æ…¢ä»£ç ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆä¸‹é¢çš„ä»£ç ä¸­ï¼Œç¬¬ä¸€ä¸ªæ›´å¿«ã€‚</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">inline</span> <span class="function"><span class="keyword">fun</span> <span class="title">repeat</span><span class="params">(times: <span class="type">Int</span>, action: (<span class="type">Int</span>) -&gt; <span class="type">Unit</span>)</span></span> &#123;</span><br><span class="line">    <span class="keyword">for</span> (index <span class="keyword">in</span> <span class="number">0</span> until times) &#123;</span><br><span class="line">        action(index)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">repeatNoinline</span><span class="params">(times: <span class="type">Int</span>, action: (<span class="type">Int</span>) -&gt; <span class="type">Unit</span>)</span></span> &#123;</span><br><span class="line">    <span class="keyword">for</span> (index <span class="keyword">in</span> <span class="number">0</span> until times) &#123;</span><br><span class="line">        action(index)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™ç§å·®å¼‚æ˜¯æ˜¾è€Œæ˜“è§çš„ï¼Œä½†åœ¨ç°å®ç”Ÿæ´»ä¸­çš„ä¾‹å­ä¸­å¾ˆå°‘æœ‰æ˜¾è‘—å·®å¼‚ã€‚æˆ‘ä»¬æŠŠæµ‹è¯•ç”¨ä¾‹è®¾è®¡ä¸€ä¸‹ï¼Œæ”¾å¤§è¿™ç§å·®å¼‚ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Benchmark</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">nothingInline</span><span class="params">(blackhole: <span class="type">Blackhole</span>)</span></span> &#123;</span><br><span class="line">    repeat(<span class="number">100_000_000</span>) &#123;</span><br><span class="line">        blackhole.consume(it)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Benchmark</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">nothingNoninline</span><span class="params">(blackhole: <span class="type">Blackhole</span>)</span></span> &#123;</span><br><span class="line">    noinlineRepeat(<span class="number">100_000_000</span>) &#123;</span><br><span class="line">        blackhole.consume(it)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç¬¬ä¸€ä¸ªåœ¨æˆ‘ä»¬ç”µè„‘å¹³å‡è¿è¡Œ189msã€‚ç¬¬äºŒä¸ªå¹³å‡447msã€‚è¿™ç§å·®è·ä½“ç°åœ¨ï¼šç¬¬ä¸€ä¸ªä¾‹å­è¿­ä»£è°ƒç”¨ç©ºå‡½æ•°ã€‚ç¬¬äºŒä¸ªä¾‹å­è¿­ä»£è°ƒç”¨å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡è°ƒç”¨ä¸€ä¸ªç©ºå‡½æ•°ã€‚è¿™é‡Œä½¿ç”¨äº†é¢å¤–çš„å¯¹è±¡ã€‚</p>
<p>çœ‹ä¸€ä¸ªæ›´å…¸å‹çš„ä¾‹å­ã€‚æˆ‘ä»¬æœ‰5000ä¸ªäº§å“ï¼Œè®¡ç®—æˆ‘ä»¬è´­ä¹°ç‰©å“çš„ä»·æ ¼ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line">users.filter &#123; it.bought &#125;.sumByDouble &#123; it.price &#125;</span><br></pre></td></tr></table></figure>

<p>åœ¨æˆ‘çš„æœºå™¨ä¸Šå¹³å‡è€—æ—¶38msã€‚å¦‚æœfilterå’ŒsumByDoubleä¸å†…è”è€—æ—¶å¤šå°‘å‘¢ï¼Ÿå¹³å‡42msï¼çœ‹èµ·æ¥ä¸å¤šï¼Œä½†æ¯æ¬¡è°ƒç”¨ä¹Ÿæœ‰10%çš„å·®å¼‚ã€‚</p>
<p>å†…è”å’Œéå†…è”å‡½æ•°æœ€å¤§çš„åŒºåˆ«åœ¨äºï¼Œå½“æˆ‘ä»¬åœ¨å‡½æ•°å­—é¢é‡é‡Œæ•è·å˜é‡æ—¶ã€‚å˜é‡è¢«ä½¿ç”¨æ—¶éœ€è¦è¢«åŒ…è£…æˆå¯¹è±¡ã€‚ä¾‹å¦‚ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> l = <span class="number">1L</span></span><br><span class="line">noinlineRepeat(<span class="number">100_000_000</span>) &#123;</span><br><span class="line">    l += it</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸€ä¸ªæœ¬åœ°å˜é‡ä¸èƒ½ç›´æ¥åœ¨éå†…è”lambdaä¸­ä½¿ç”¨ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆè¦è¢«åŒ…è£…æˆå¼•ç”¨å¯¹è±¡ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">val</span> a = Ref.LongRef()</span><br><span class="line">a.element = <span class="number">1L</span></span><br><span class="line">noinlineRepeat(<span class="number">100_000_000</span>) &#123;</span><br><span class="line">    a.element = a.element + it</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åŒºåˆ«å¾ˆå¤§æ˜¯å› ä¸ºï¼Œé€šå¸¸è¿™ä¸ªå¯¹è±¡ä¼šè¢«ä½¿ç”¨å¾ˆå¤šæ¬¡ï¼Œä¸Šé¢ä»£ç ä¸­çš„aå˜é‡ä½¿ç”¨äº†ä¸¤æ¬¡ã€‚å› æ­¤ï¼Œé¢å¤–çš„å¯¹è±¡è°ƒç”¨2*100_000_000ã€‚å†çœ‹ä¸€ä¸‹è¿™ä¸ªä¾‹å­ğŸ‘‡ğŸ»ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Benchmark</span></span><br><span class="line"><span class="comment">// On average 30 ms</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">nothingInline</span><span class="params">(blackhole: <span class="type">Blackhole</span>)</span></span> &#123;</span><br><span class="line">    <span class="keyword">var</span> l = <span class="number">0L</span></span><br><span class="line">    repeat(<span class="number">100_000_000</span>) &#123;</span><br><span class="line">        l += it</span><br><span class="line">    &#125;</span><br><span class="line">    blackhole.consume(l)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Benchmark</span></span><br><span class="line"><span class="comment">// On average 274 ms</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">nothingNoninline</span><span class="params">(blackhole: <span class="type">Blackhole</span>)</span></span> &#123;</span><br><span class="line">    <span class="keyword">var</span> l = <span class="number">0L</span></span><br><span class="line">    noinlineRepeat(<span class="number">100_000_000</span>) &#123;</span><br><span class="line">        l += it</span><br><span class="line">    &#125;</span><br><span class="line">    blackhole.consume(l)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç¬¬ä¸€ä¸ªåœ¨æˆ‘ç”µè„‘è¿è¡Œ30msï¼Œç¬¬äºŒä¸ª274msã€‚å·®è·çš„åŸå› æ˜¯ï¼Œå‡½æ•°æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œæœ¬åœ°å˜é‡éœ€è¦è¢«åŒ…è£…ã€‚å°çš„å½±å“ç´¯è®¡æ”¾å¤§äº†ã€‚å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¸çŸ¥é“æœ‰å‡½æ•°ç±»å‹å‚æ•°çš„æ–¹æ³•è¢«å¦‚ä½•ä½¿ç”¨ï¼Œå½“æˆ‘ä»¬å®šä¹‰è¿™ç§å‡½æ•°æ—¶ï¼Œæœ€å¥½å†…è”ä¸€ä¸‹ã€‚è¿™ä¹Ÿæ˜¯æ ‡å‡†åº“ç»å¸¸è¿™ä¹ˆå†™çš„åŸå› ã€‚</p>
<h5 id="ä¸‰ã€ä¸å…è®¸éæœ¬åœ°è¿”å›"><a href="#ä¸‰ã€ä¸å…è®¸éæœ¬åœ°è¿”å›" class="headerlink" title="ä¸‰ã€ä¸å…è®¸éæœ¬åœ°è¿”å›"></a>ä¸‰ã€ä¸å…è®¸éæœ¬åœ°è¿”å›</h5><p>å‰é¢å®šä¹‰çš„<code>repeatNoninline</code>åƒæ˜¯ä¸€ä¸ªæ§åˆ¶ç»“æ„ï¼Œæ‹¿å®ƒå’Œifè¯­å¥æˆ–forå¾ªç¯å¯¹æ¯”ä¸€ä¸‹ã€‚</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (value != <span class="literal">null</span>) &#123;</span><br><span class="line">    print(value)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (i <span class="keyword">in</span> <span class="number">1.</span><span class="number">.10</span>) &#123;</span><br><span class="line">    print(i)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">repeatNoninline(<span class="number">10</span>) &#123;</span><br><span class="line">    print(it)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ˜æ˜¾çš„åŒºåˆ«æ˜¯ï¼Œå†…éƒ¨ä¸èƒ½è¿”å›</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    repeatNoinline(<span class="number">10</span>) &#123;</span><br><span class="line">        print(it)</span><br><span class="line">        <span class="keyword">return</span> <span class="comment">// ERROR: Not allowed</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™æ˜¯å‡½æ•°å­—é¢é‡ç¼–è¯‘çš„ç»“æœã€‚å½“æˆ‘ä»¬çš„ä»£ç å¤„äºå¦å¤–ä¸€ä¸ªç±»æ—¶ï¼Œä¸èƒ½ä»mainå‡½æ•°è¿”å›ã€‚ä½†æ˜¯ï¼Œå½“ä½¿ç”¨å†…è”æ—¶ï¼Œå°±æ²¡é™åˆ¶ã€‚</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    repeat(<span class="number">10</span>) &#123;</span><br><span class="line">        print(it)</span><br><span class="line">        <span class="keyword">return</span> <span class="comment">// OK</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¾—ç›Šäºæ­¤ï¼Œå‡½æ•°å¯ä»¥çœ‹èµ·æ¥æ›´åƒæ§åˆ¶ç»“æ„ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">getSomeMoney</span><span class="params">()</span></span>: Money? &#123;</span><br><span class="line">    repeat(<span class="number">100</span>) &#123;</span><br><span class="line">        <span class="keyword">val</span> money = searchForMoney()</span><br><span class="line">        <span class="keyword">if</span> (money != <span class="literal">null</span>) <span class="keyword">return</span> money</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h5 id="å››ã€å†…è”ä¿®é¥°ç¬¦çš„ç¼ºé™·"><a href="#å››ã€å†…è”ä¿®é¥°ç¬¦çš„ç¼ºé™·" class="headerlink" title="å››ã€å†…è”ä¿®é¥°ç¬¦çš„ç¼ºé™·"></a>å››ã€å†…è”ä¿®é¥°ç¬¦çš„ç¼ºé™·</h5><p>inlineå¾ˆæœ‰ç”¨ï¼Œä½†ä¸åº”è¯¥éšå¤„ä½¿ç”¨ã€‚æœ‰äº›æƒ…å†µä¸‹ä¸å»ºè®®ä½¿ç”¨ã€‚å†æ¥çœ‹çœ‹æœ€é‡è¦çš„é™åˆ¶ã€‚</p>
<ul>
<li>å†…è”å‡½æ•°ä¸èƒ½é€’å½’ï¼Œå¦åˆ™è°ƒç”¨å±•å¼€å°†æ— é™å¾ªç¯ã€‚å‘¨æœŸæ€§å¾ªç¯å°¤å…¶å±é™©ï¼Œå› ä¸ºIntellijä¸æŠ¥é”™ï¼š</li>
</ul>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">inline</span> <span class="function"><span class="keyword">fun</span> <span class="title">a</span><span class="params">()</span></span> &#123;</span><br><span class="line">    b()</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">inline</span> <span class="function"><span class="keyword">fun</span> <span class="title">b</span><span class="params">()</span></span> &#123;</span><br><span class="line">    c()</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">inline</span> <span class="function"><span class="keyword">fun</span> <span class="title">c</span><span class="params">()</span></span> &#123;</span><br><span class="line">    a()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>å†…è”å‡½æ•°ä¸èƒ½ä½¿ç”¨å¯è§æ€§çº¦æŸçš„å…ƒç´ </li>
</ul>
<p>åœ¨<code>public inline fun</code>ä¸­ä¸èƒ½ä½¿ç”¨private ã€internalä¿®é¥°çš„å‡½æ•°æˆ–å±æ€§</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">internal</span> <span class="keyword">inline</span> <span class="function"><span class="keyword">fun</span> <span class="title">read</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">val</span> reader = Reader() <span class="comment">// Error</span></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">Reader</span> </span>&#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆå®ƒä¸èƒ½ç”¨äºéšè—å®ç°ï¼Œå¹¶ä¸”å¾ˆå°‘åœ¨ç±»ä¸­ä½¿ç”¨ã€‚</p>
<ul>
<li>å†…è”å‡½æ•°ä½¿ä»£ç è†¨èƒ€</li>
</ul>
<p>å®šä¹‰ä¸€ä¸ªæ‰“å°3çš„å‡½æ•°ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">inline</span> <span class="function"><span class="keyword">fun</span> <span class="title">printThree</span><span class="params">()</span></span> &#123;</span><br><span class="line">    print(<span class="number">3</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è°ƒç”¨ä¸‰æ¬¡ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">inline</span> <span class="function"><span class="keyword">fun</span> <span class="title">threePrintThree</span><span class="params">()</span></span> &#123;</span><br><span class="line">    printThree()</span><br><span class="line">    printThree()</span><br><span class="line">    printThree()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åˆå®šä¹‰ä¸‹é¢å‡½æ•°ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">inline</span> <span class="function"><span class="keyword">fun</span> <span class="title">threeThreePrintThree</span><span class="params">()</span></span> &#123;</span><br><span class="line">    threePrintThree()</span><br><span class="line">    threePrintThree()</span><br><span class="line">    threePrintThree()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">inline</span> <span class="function"><span class="keyword">fun</span> <span class="title">threeThreeThreePrintThree</span><span class="params">()</span></span> &#123;</span><br><span class="line">    threeThreePrintThree()</span><br><span class="line">    threeThreePrintThree()</span><br><span class="line">    threeThreePrintThree()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>çœ‹ä¸€ä¸‹å®ƒä»¬çš„ç¼–è¯‘ç»“æœï¼Œå‰ä¸¤ä¸ªè¿˜èƒ½çœ‹ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">inline</span> <span class="function"><span class="keyword">fun</span> <span class="title">printThree</span><span class="params">()</span></span> &#123;</span><br><span class="line">    print(<span class="number">3</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">inline</span> <span class="function"><span class="keyword">fun</span> <span class="title">threePrintThree</span><span class="params">()</span></span> &#123;</span><br><span class="line">    print(<span class="number">3</span>)</span><br><span class="line">    print(<span class="number">3</span>)</span><br><span class="line">    print(<span class="number">3</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åä¸¤ä¸ªï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">inline</span> <span class="function"><span class="keyword">fun</span> <span class="title">threeThreePrintThree</span><span class="params">()</span></span> &#123;</span><br><span class="line">    print(<span class="number">3</span>)</span><br><span class="line">    print(<span class="number">3</span>)</span><br><span class="line">    print(<span class="number">3</span>)</span><br><span class="line">    print(<span class="number">3</span>)</span><br><span class="line">    print(<span class="number">3</span>)</span><br><span class="line">    print(<span class="number">3</span>)</span><br><span class="line">    print(<span class="number">3</span>)</span><br><span class="line">    print(<span class="number">3</span>)</span><br><span class="line">    print(<span class="number">3</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">inline</span> <span class="function"><span class="keyword">fun</span> <span class="title">threeThreeThreePrintThree</span><span class="params">()</span></span> &#123;</span><br><span class="line">    print(<span class="number">3</span>)</span><br><span class="line">    print(<span class="number">3</span>)</span><br><span class="line">    print(<span class="number">3</span>)    </span><br><span class="line"> ...</span><br><span class="line">    print(<span class="number">3</span>)</span><br><span class="line">    print(<span class="number">3</span>)</span><br><span class="line">    print(<span class="number">3</span>)</span><br><span class="line">    print(<span class="number">3</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªä¾‹å­å±•ç¤ºäº†å†…è”å‡½æ•°çš„å¼Šç«¯ï¼šè¿‡åº¦ä½¿ç”¨æ—¶ä»£ç è†¨èƒ€ä¸¥é‡ã€‚</p>
<h5 id="äº”ã€crossinline-å’Œnoinline"><a href="#äº”ã€crossinline-å’Œnoinline" class="headerlink" title="äº”ã€crossinline å’Œnoinline"></a>äº”ã€crossinline å’Œnoinline</h5><p>æœ‰æ—¶å€™æˆ‘ä»¬æƒ³å†…è”ä¸€ä¸ªå‡½æ•°ï¼Œç”±äºæŸäº›åŸå› ï¼Œä¸èƒ½å†…è”å…¨éƒ¨çš„å‡½æ•°ç±»å‹å‚æ•°ã€‚è¿™ç§æƒ…å†µä¸‹æˆ‘ä»¬ä½¿ç”¨ä¸‹é¢çš„ä¿®é¥°ç¬¦ï¼š</p>
<p>crossinlineï¼šç”¨äºå†…è”å‡½æ•°çš„å‚æ•°ï¼Œè¡¨ç¤ºæ­¤å‚æ•°å†…è”èŒƒå›´æ‰©å¤§ã€‚å¯¹å†…è”å‡½æ•°å†…éƒ¨çš„lambdaç”Ÿæ•ˆï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">inline</span> <span class="function"><span class="keyword">fun</span> <span class="title">hello</span><span class="params">(postAction:()-&gt;<span class="type">Unit</span>)</span></span>&#123;</span><br><span class="line">    println(<span class="string">&quot;Hello&quot;</span>)</span><br><span class="line">    runOnUiThread &#123; </span><br><span class="line">        postAction()</span><br><span class="line">     &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>noinlineï¼šç”¨äºå†…è”å‡½æ•°çš„å‚æ•°ï¼Œè¡¨ç¤ºæ­¤å‚æ•°ä¸èƒ½è¢«å†…è”ã€‚å¯ä»¥å±€éƒ¨æ€§å…³é—­å†…è”ã€‚</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">inline</span> <span class="function"><span class="keyword">fun</span> <span class="title">requestNewToken</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">    hasToken: <span class="type">Boolean</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">    <span class="keyword">crossinline</span> onRefresh: () -&gt; <span class="type">Unit</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">    <span class="keyword">noinline</span> onGenerate: () -&gt; <span class="type">Unit</span></span></span></span><br><span class="line"><span class="params"><span class="function">)</span></span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (hasToken) &#123;</span><br><span class="line">        httpCall(<span class="string">&quot;get-token&quot;</span>, onGenerate) <span class="comment">// We must use </span></span><br><span class="line">        <span class="comment">// noinline to pass function as an argument to a</span></span><br><span class="line">        <span class="comment">// function that is not inlined</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        httpCall(<span class="string">&quot;refresh-token&quot;</span>) &#123;</span><br><span class="line">            onRefresh() <span class="comment">// We must use crossinline to </span></span><br><span class="line">            <span class="comment">// inline function in a context where </span></span><br><span class="line">            <span class="comment">// non-local return is not allowed</span></span><br><span class="line">            onGenerate()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">httpCall</span><span class="params">(url: <span class="type">String</span>, callback: () -&gt; <span class="type">Unit</span>)</span></span> &#123;</span><br><span class="line">    <span class="comment">/*...*/</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>èƒ½è®°ä½è¿™ä¸¤ä¸ªä¿®é¥°ç¬¦æœ€å¥½ï¼Œè®°ä¸ä½ä¹Ÿæ²¡äº‹ï¼ŒIntelliJä¼šæœ‰æç¤ºï¼š</p>
<h5 id="å…­ã€æ€»ç»“ï¼š"><a href="#å…­ã€æ€»ç»“ï¼š" class="headerlink" title="å…­ã€æ€»ç»“ï¼š"></a>å…­ã€æ€»ç»“ï¼š</h5><p>ä½¿ç”¨inlineçš„ä¸»è¦åœºæ™¯æ˜¯ï¼š</p>
<ul>
<li>ç»å¸¸è¢«ä½¿ç”¨çš„å‡½æ•°</li>
<li>å…·ä½“åŒ–çš„ç±»å‹å‚æ•°ï¼Œåƒï¼š<code>filterIsInstance</code></li>
<li>å®šä¹‰å¸¦æœ‰å‡½æ•°ç±»å‹çš„å‚æ•°çš„é¡¶å±‚å‡½æ•°ã€‚å°¤å…¶æ˜¯è¾…åŠ©å‡½æ•°ï¼Œå¦‚é›†åˆå¤„ç†ï¼ˆmapã€filterï¼‰ã€ä½œç”¨åŸŸå‡½æ•°ï¼ˆalsoã€applyã€letï¼‰ã€é¡¶å±‚å·¥å…·å‡½æ•°ï¼ˆrepeatã€runã€withï¼‰</li>
</ul>
<p>æˆ‘ä»¬å¾ˆå°‘ç”¨inlineå®šä¹‰APIï¼Œæ³¨æ„å†…è”å‡½æ•°è°ƒç”¨å†…è”å‡½æ•°çš„æƒ…æ™¯ã€‚è®°ä½ä»£ç è†¨èƒ€ã€‚</p>
<p>å‚è€ƒï¼š<br><a href="https://kt.academy/article/ek-inline-functions">Effective Kotlin Item 48: Use inline modifier for functions with parameters of functional types</a></p>
]]></content>
      <categories>
        <category>è®¡ç®—æœº</category>
      </categories>
      <tags>
        <tag>Kotlin</tag>
      </tags>
  </entry>
  <entry>
    <title>Kotlinä¸­çš„JVMæ³¨è§£</title>
    <url>/kotlin-lang-jvm-annotation.html</url>
    <content><![CDATA[<p>Kotlinæä¾›äº†ä¸€äº›æ³¨è§£å¯ä»¥å¸®åŠ©å¼€å‘è€…æ›´å¥½åœ°å…¼å®¹Javaã€‚ä¸‹é¢æ¢ç´¢ä¸€ä¸‹Kotlinä¸­JVMæ³¨è§£çš„ä½¿ç”¨ï¼Œä»¥åŠåœ¨Javaä¸­ä½¿ç”¨Kotlinç±»æ—¶æ³¨è§£å¯¹æˆ‘ä»¬çš„å½±å“ã€‚</p>
<h4 id="1ã€-JvmName"><a href="#1ã€-JvmName" class="headerlink" title="1ã€@JvmName"></a>1ã€@JvmName</h4><p>ç”¨äºæ–‡ä»¶ã€å‡½æ•°ã€å±æ€§ã€getterå’Œsetterã€‚</p>
<h5 id="1-1-ç»™æ–‡ä»¶æ·»åŠ -JvmNameæ³¨è§£"><a href="#1-1-ç»™æ–‡ä»¶æ·»åŠ -JvmNameæ³¨è§£" class="headerlink" title="1.1 ç»™æ–‡ä»¶æ·»åŠ @JvmNameæ³¨è§£"></a>1.1 ç»™æ–‡ä»¶æ·»åŠ @JvmNameæ³¨è§£</h5><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œä¸€ä¸ªKotlinæ–‡ä»¶ä¸­çš„<strong>function</strong>å’Œ<strong>properties</strong>ä¼šè¢«ç¼–è¯‘æˆ<em>filenameKt.class</em>ï¼Œå…¶ä¸­çš„<strong>class</strong>ä¼šè¢«ç¼–è¯‘æˆclassname.class:</p>
<table>
    <tr>
        <td><img src="../images/kotlin-annotation-jvmname-1.jpeg" width="100%"/></td>
        <td><img src="../images/kotlin-annotation-jvmname-2.jpeg" width="100%"/></td>
    </tr>
</table>

<h5 id="1-2-ç»™å‡½æ•°åæ·»åŠ -JvmNameæ³¨è§£"><a href="#1-2-ç»™å‡½æ•°åæ·»åŠ -JvmNameæ³¨è§£" class="headerlink" title="1.2 ç»™å‡½æ•°åæ·»åŠ @JvmNameæ³¨è§£"></a>1.2 ç»™å‡½æ•°åæ·»åŠ @JvmNameæ³¨è§£</h5><center>
    <img src="../images/kotlin-annotation-jvmname-3.jpeg" width="500"/>
</center>

<h5 id="1-3-ç»™getterå’Œsettingæ·»åŠ -JvmName"><a href="#1-3-ç»™getterå’Œsettingæ·»åŠ -JvmName" class="headerlink" title="1.3 ç»™getterå’Œsettingæ·»åŠ @JvmName"></a>1.3 ç»™getterå’Œsettingæ·»åŠ @JvmName</h5><figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">@get:JvmName</span>(<span class="string">&quot;getContent&quot;</span>)</span><br><span class="line"><span class="meta">@set:JvmName</span>(<span class="string">&quot;setContent&quot;</span>)</span><br><span class="line"><span class="keyword">var</span> text = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="2ã€-JvmDefault"><a href="#2ã€-JvmDefault" class="headerlink" title="2ã€@JvmDefault"></a>2ã€@JvmDefault</h4><p>å’ŒJava8ä¸€æ ·ï¼ŒKotlinçš„æ¥å£ä¹Ÿæ”¯æŒé»˜è®¤æ–¹æ³•å®ç°ã€‚å³ä½¿é’ˆå¯¹Java7åŠä»¥ä¸‹ç‰ˆæœ¬ï¼Œä»–ä¹Ÿèƒ½æ­£å¸¸ç¼–è¯‘ï¼Œå› ä¸ºKotlinä½¿ç”¨é™æ€å†…éƒ¨ç±»å®ç°é»˜è®¤æ–¹æ³•ã€‚</p>
<center>
    <img src="../images/kotlin-annotation-jvmdefault-1.jpeg" width="500"/>
</center>

<p>å½“åœ¨Javaä¸­å®ç°æ­¤æ¥å£æ—¶ï¼Œéœ€è¦å¤å†™å¯¹åº”çš„æ–¹æ³•ï¼Œå¦åˆ™å°†æŠ¥é”™ã€‚</p>
<center>
    <img src="../images/kotlin-annotation-jvmdefault-2.jpeg" width="100%"/>
</center>

<p>å¦‚æœæˆ‘ä»¬å¸Œæœ›å®ƒåœ¨Java8ä¸­ä¸æŠ¥é”™ï¼Œå¯ä»¥ä½¿ç”¨@JvmDefaultæ³¨è§£æ ‡è¯†æ–¹æ³•ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Document</span> </span>&#123;</span><br><span class="line">    <span class="meta">@JvmDefault</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">getType</span><span class="params">()</span></span> = <span class="string">&quot;document&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="3ã€-JvmStatic"><a href="#3ã€-JvmStatic" class="headerlink" title="3ã€@JvmStatic"></a>3ã€@JvmStatic</h4><p>é’ˆå¯¹<code>object class</code> æˆ–<code>companion object</code>ä½¿ç”¨æ­¤æ³¨è§£,å¯ä»¥é¿å…Javaè®¿é—®æ—¶çš„INSTANCEè°ƒç”¨</p>
<table>
    <tr>
        <td><img src="../images/kotlin-annotation-jvmstatic-1.jpeg" width="100%"/></td>
        <td><img src="../images/kotlin-annotation-jvmstatic-2.jpeg" width="100%"/></td>
    </tr>
</table>

<h4 id="4ã€-JvmOverloads"><a href="#4ã€-JvmOverloads" class="headerlink" title="4ã€@JvmOverloads"></a>4ã€@JvmOverloads</h4><p>Kotlinçš„é»˜è®¤å‚æ•°å¯ä»¥å¸®åŠ©æˆ‘ä»¬å‡å°‘å‡½æ•°é‡è½½ï¼Œç®€åŒ–æ–¹æ³•è°ƒç”¨å‚æ•°ã€‚åœ¨Javaä¸­è°ƒç”¨å«é»˜è®¤å‚æ•°çš„Kotlinå‡½æ•°æ—¶ï¼Œéœ€è¦æä¾›å…¨éƒ¨å‚æ•°ã€‚</p>
<table>
    <tr>
        <td><img src="../images/kotlin-annotation-jvmoverloads-1.jpeg" width="100%"/></td>
        <td><img src="../images/kotlin-annotation-jvmoverloads-2.jpeg" width="100%"/></td>
    </tr>
</table>

<h4 id="5ã€-Throws"><a href="#5ã€-Throws" class="headerlink" title="5ã€@Throws"></a>5ã€@Throws</h4><p>Kotlinæ²¡æœ‰å—æ£€æµ‹å¼‚å¸¸ï¼Œtry-catchæ˜¯éå¿…é¡»çš„ã€‚å¦‚æœå¸Œæœ›åœ¨Javaè°ƒç”¨ä¸­æ£€æµ‹åˆ°å¼‚å¸¸ï¼Œå¯ä»¥ä½¿ç”¨@Throwsæ³¨è§£</p>
<center>
    <img src="../images/kotlin-annotation-jvmthrows.jpeg" width="100%"/>
</center>

<h4 id="6ã€-JvmWildcard-amp-JvmSuppressWildcard"><a href="#6ã€-JvmWildcard-amp-JvmSuppressWildcard" class="headerlink" title="6ã€@JvmWildcard &amp; @JvmSuppressWildcard"></a>6ã€@JvmWildcard &amp; @JvmSuppressWildcard</h4><p>ç•¥</p>
<h4 id="7ã€-JvmMultifileClass"><a href="#7ã€-JvmMultifileClass" class="headerlink" title="7ã€@JvmMultifileClass"></a>7ã€@JvmMultifileClass</h4><p>å½“åœ¨å¤šä¸ªæ–‡ä»¶ä¸­å®šä¹‰çš„é¡¶å±‚å‡½æ•°æˆ–å±æ€§æƒ³è¦åˆå¹¶åˆ°ä¸€ä¸ªç¼–è¯‘çš„classä¸­æ—¶ï¼Œå¯ä»¥ä½¿ç”¨æ­¤æ³¨è§£ã€‚</p>
<center>
    <img src="../images/kotlin-annotation-jvmmultifileclass.jpeg" width="500"/>
</center>


<h4 id="8ã€-JvmPackageName"><a href="#8ã€-JvmPackageName" class="headerlink" title="8ã€@JvmPackageName"></a>8ã€@JvmPackageName</h4><p>å’Œ@JvmNameä¸€æ ·ï¼Œæ­¤æ³¨è§£å¯ä»¥ä¿®æ”¹åŒ…åï¼Œä½†æ˜¯ä»–è¢«æ ‡è®°ä¸ºinternalï¼Œåªèƒ½åœ¨kotlinåº“å†…éƒ¨ä½¿ç”¨ï¼Œè¿™é‡Œä¸åšè¿‡å¤šä»‹ç»ã€‚</p>
<h4 id="9ã€æ³¨è§£ä¸€è§ˆ"><a href="#9ã€æ³¨è§£ä¸€è§ˆ" class="headerlink" title="9ã€æ³¨è§£ä¸€è§ˆ"></a>9ã€æ³¨è§£ä¸€è§ˆ</h4><center>
    <img src="../images/kotlin-annotation-overview.png" width="100%"/>
</center>

<h4 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="[å‚è€ƒ]"></a>[å‚è€ƒ]</h4><p><a href="https://www.baeldung.com/kotlin/jvm-annotations">1.Guide to JVM Platform Annotations in Kotlin</a></p>
]]></content>
      <categories>
        <category>è®¡ç®—æœº</category>
      </categories>
      <tags>
        <tag>Kotlin</tag>
      </tags>
  </entry>
  <entry>
    <title>Kotlinä¹‹JvmStaticå’Œoverrideå†²çªé—®é¢˜</title>
    <url>/kotlin-lang-jvmstatic-with-interface.html</url>
    <content><![CDATA[<h4 id="ä¸€ã€é—®é¢˜"><a href="#ä¸€ã€é—®é¢˜" class="headerlink" title="ä¸€ã€é—®é¢˜"></a>ä¸€ã€é—®é¢˜</h4><p>   ä¸ºäº†æ–¹ä¾¿Javaä»£ç è°ƒç”¨Kotlinçš„objectç±»ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šå¯¹objectç±»çš„æ–¹æ³•æ·»åŠ <code>@JvmStatic</code>æ³¨è§£ã€‚</p>
<table>
    <tr>
        <td><img src="../images/kotlin-annotation-jvmstatic-1.jpeg" width="100%"/></td>
        <td><img src="../images/kotlin-annotation-jvmstatic-2.jpeg" width="100%"/></td>
    </tr>
</table>

<p>ç„¶è€Œã€å½“objectç±»å®ç°æŸä¸ªæ¥å£æ—¶ï¼Œå¯¹åº”çš„æ–¹æ³•å´ä¸èƒ½æ·»åŠ @JvmStaticæ³¨è§£ã€‚</p>
<center>
    <img src="../images/kotlin-annotation-jvmstatic-error.jpg" width="70%"/>
</center>


<h4 id="äºŒã€è§£å†³"><a href="#äºŒã€è§£å†³" class="headerlink" title="äºŒã€è§£å†³"></a>äºŒã€è§£å†³</h4><pre><code>è¦æƒ³è§£å†³ä¸Šè¿°é—®é¢˜ï¼Œåªéœ€è¦å°†objectç±»çš„å®ç°åšä¸€äº›è½¬æ¢ï¼š
</code></pre>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Play2</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">play</span><span class="params">()</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Singleton2</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">companion</span> <span class="keyword">object</span> : Play2 &#123;</span><br><span class="line">        <span class="meta">@JvmStatic</span></span><br><span class="line">        <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">play</span><span class="params">()</span></span> &#123;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="ä¸‰ã€æ€è€ƒ"><a href="#ä¸‰ã€æ€è€ƒ" class="headerlink" title="ä¸‰ã€æ€è€ƒ"></a>ä¸‰ã€æ€è€ƒ</h4><blockquote>
<p>ä¸ºä»€ä¹ˆç¬¬ä¸€ç§æ–¹å¼ä¼šæŠ¥é”™ï¼Œè€Œç¬¬äºŒç§æ–¹å¼æ²¡é—®é¢˜å‘¢ï¼Ÿ</p>
</blockquote>
<p>é€šè¿‡åç¼–è¯‘æŸ¥çœ‹Javaä»£ç æˆ‘ä»¬å‘ç°ï¼šobjectç±»çš„æ–¹æ³•ä¼šè¢«ç›´æ¥ç¼–è¯‘æˆJavaçš„staticæ–¹æ³•</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">Singleton</span> <span class="title">implements</span> <span class="title">Play</span> </span>&#123;</span><br><span class="line">   <span class="keyword">public</span> static <span class="keyword">final</span> Singleton INSTANCE;</span><br><span class="line"></span><br><span class="line">   <span class="meta">@JvmStatic</span></span><br><span class="line">   <span class="keyword">public</span> static void play() &#123;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">private</span> Singleton() &#123;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   static &#123;</span><br><span class="line">      Singleton var0 = new Singleton();</span><br><span class="line">      INSTANCE = var0;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è€Œcompanion objectåˆ™ä¼šè¢«ç¼–è¯‘æˆ<strong>é™æ€å†…éƒ¨ç±»</strong>ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">Singleton2</span> </span>&#123;</span><br><span class="line">   <span class="comment">/** <span class="doctag">@deprecated</span> */</span></span><br><span class="line">   <span class="meta">@Deprecated</span></span><br><span class="line">   <span class="keyword">public</span> static <span class="keyword">final</span> Singleton2.Companion Companion = new Singleton2.Companion((DefaultConstructorMarker)<span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">   <span class="meta">@JvmStatic</span></span><br><span class="line">   <span class="keyword">public</span> static void play() &#123;</span><br><span class="line">      Companion.play();</span><br><span class="line">   &#125;</span><br><span class="line">   </span><br><span class="line">   <span class="keyword">private</span> static <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">Companion</span> <span class="title">implements</span> <span class="title">Play2</span> </span>&#123;</span><br><span class="line">      <span class="meta">@JvmStatic</span></span><br><span class="line">      <span class="keyword">public</span> void play() &#123;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">private</span> Companion() &#123;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// $FF: synthetic method</span></span><br><span class="line">      <span class="keyword">public</span> Companion(DefaultConstructorMarker $constructor_marker) &#123;</span><br><span class="line">         <span class="keyword">this</span>();</span><br><span class="line">      &#125;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ç”±äºstaticæ–¹æ³•æ˜¯ä¸èƒ½é‡å†™ï¼ˆoverrideï¼‰çš„ï¼Œæ‰€ä»¥åŒä¸€ä¸ªå…³é”®å­—ä¸èƒ½ä½œç”¨äºä¸€ä¸ªå‡½æ•°ã€‚è€Œé€šè¿‡é™æ€å†…éƒ¨ç±»çš„æ–¹å¼ï¼Œåœ¨ç±»çš„å±‚æ¬¡å¢åŠ é™æ€èƒ½åŠ›ï¼Œä»è€Œæ¶ˆé™¤äº†æ–¹æ³•çš„staticå…³é”®å­—ã€‚</p>
<h4 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h4><p><a href="https://youtrack.jetbrains.com/issue/KT-21342">issue-KT-21342</a></p>
]]></content>
      <categories>
        <category>è®¡ç®—æœº</category>
      </categories>
      <tags>
        <tag>Java</tag>
        <tag>Kotlin</tag>
      </tags>
  </entry>
  <entry>
    <title>Effective Kotlin-51ï¼šä½¿ç”¨Sequenceä¼˜åŒ–é›†åˆæ“ä½œ</title>
    <url>/kotlin-lang-sequence.html</url>
    <content><![CDATA[<h4 id="ä¸€ã€æ¦‚è¿°"><a href="#ä¸€ã€æ¦‚è¿°" class="headerlink" title="ä¸€ã€æ¦‚è¿°"></a>ä¸€ã€æ¦‚è¿°</h4><p>ä½ å¯èƒ½å¯¹ <code>Iterable</code> å’Œ <code>Sequence</code> å‚»å‚»åˆ†ä¸æ¸…ã€‚çœ‹ä¸€ä¸‹ä»–ä»¬çš„ä»£ç ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Iterable</span>&lt;<span class="type">out T</span>&gt; </span>&#123;</span><br><span class="line">    <span class="keyword">operator</span> <span class="function"><span class="keyword">fun</span> <span class="title">iterator</span><span class="params">()</span></span>: Iterator&lt;T&gt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Sequence</span>&lt;<span class="type">out T</span>&gt; </span>&#123;</span><br><span class="line">    <span class="keyword">operator</span> <span class="function"><span class="keyword">fun</span> <span class="title">iterator</span><span class="params">()</span></span>: Iterator&lt;T&gt;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p>å¥½åƒåªæœ‰åå­—ä¸ä¸€æ ·-_-||ï¼Œä½†ä»–ä»¬å´æœ‰ç€æœ¬è´¨çš„åŒºåˆ«ã€‚<code>Sequence</code>å±äºæ‡’åŠ è½½ï¼Œä¸­é—´æ“ä½œç¬¦ä¸ä¼šè§¦å‘è®¡ç®—ï¼Œä»…ä»…æ˜¯å¯¹å‰ä¸€ä¸ªSequenceçš„è£…é¥°ï¼Œåªæœ‰åœ¨é‡åˆ°toList()æˆ–count()è¿™äº›ç»ˆæ­¢æ“ä½œç¬¦æ—¶æ‰ä¼šæ‰§è¡ŒçœŸæ­£çš„è®¡ç®—å·¥ä½œã€‚è€ŒIterableæ¯ä¸€æ­¥éƒ½è¿”å›ä¸€ä¸ªæ–°çš„é›†åˆã€‚</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">inline</span> <span class="function"><span class="keyword">fun</span> <span class="type">&lt;T&gt;</span> Iterable<span class="type">&lt;T&gt;</span>.<span class="title">filter</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">    predicate: (<span class="type">T</span>) -&gt; <span class="type">Boolean</span></span></span></span><br><span class="line"><span class="params"><span class="function">)</span></span>: List&lt;T&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> filterTo(ArrayList&lt;T&gt;(), predicate)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">fun</span> <span class="type">&lt;T&gt;</span> Sequence<span class="type">&lt;T&gt;</span>.<span class="title">filter</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">    predicate: (<span class="type">T</span>) -&gt; <span class="type">Boolean</span></span></span></span><br><span class="line"><span class="params"><span class="function">)</span></span>: Sequence&lt;T&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> FilteringSequence(<span class="keyword">this</span>, <span class="literal">true</span>, predicate)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸‹å›¾ä¸­filteræ“ä½œç¬¦ä¸åšä»»ä½•è®¡ç®—æ“ä½œï¼Œåªæ˜¯è¿”å›ä¸€ä¸ªè£…é¥°å™¨å¯¹è±¡ï¼Œåœ¨é‡åˆ°toList()æ“ä½œç¬¦æ‰æ‰§è¡Œè®¡ç®—ã€‚</p>
<center>
    <img src="../images/kotlin_sequence_operation.jpeg" width="500"/>
</center>

<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">val</span> seq = sequenceOf(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line"><span class="keyword">val</span> filtered = seq.filter &#123; print(<span class="string">&quot;f<span class="variable">$it</span> &quot;</span>); it % <span class="number">2</span> == <span class="number">1</span> &#125;</span><br><span class="line">println(filtered)  <span class="comment">// FilteringSequence@...</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">val</span> asList = filtered.toList()</span><br><span class="line"><span class="comment">// f1 f2 f3</span></span><br><span class="line">println(asList) <span class="comment">// [1, 3]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">val</span> list = listOf(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line"><span class="keyword">val</span> listFiltered = list</span><br><span class="line">    .filter &#123; print(<span class="string">&quot;f<span class="variable">$it</span> &quot;</span>); it % <span class="number">2</span> == <span class="number">1</span> &#125;</span><br><span class="line"><span class="comment">// f1 f2 f3</span></span><br><span class="line">println(listFiltered) <span class="comment">// [1, 3]</span></span><br></pre></td></tr></table></figure>

<h4 id="äºŒã€ä¼˜åŠ¿"><a href="#äºŒã€ä¼˜åŠ¿" class="headerlink" title="äºŒã€ä¼˜åŠ¿"></a>äºŒã€ä¼˜åŠ¿</h4><p>Sequenceçš„æƒ°æ€§æ‰§è¡Œæœ‰ä»¥ä¸‹å‡ ä¸ªä¼˜ç‚¹ï¼š</p>
<ul>
<li>ä¿è¯æ“ä½œçš„é¡ºåºæ€§</li>
<li>ä¿è¯æ“ä½œæ‰§è¡Œæ¬¡æ•°æœ€å°‘åŒ–</li>
<li>ä»–ä»¬å¯ä»¥æ˜¯æ— é™çš„</li>
<li>æ— éœ€æ¯ä¸€æ­¥åˆ›å»ºæ–°çš„é›†åˆ</li>
</ul>
<p>ä¸‹é¢ä¾æ¬¡è®¨è®ºä¸€ä¸‹è¿™äº›ä¼˜ç‚¹</p>
<h5 id="ä¸€ã€é¡ºåºæ€§å¾ˆé‡è¦"><a href="#ä¸€ã€é¡ºåºæ€§å¾ˆé‡è¦" class="headerlink" title="ä¸€ã€é¡ºåºæ€§å¾ˆé‡è¦"></a>ä¸€ã€é¡ºåºæ€§å¾ˆé‡è¦</h5><table>
    <tr>
        <td>ä½¿ç”¨Sequenceå¤„ç†æ•°æ®æ—¶ï¼Œæ¯ä¸ªå…ƒç´ ä¾æ¬¡æ‰§è¡Œæ‰€æœ‰æ“ä½œç¬¦ã€‚è¿™æ˜¯ä¸€ç§å…ƒç´ æ¥å…ƒç´ çš„å¤„ç†æ–¹å¼ã€‚</td>
        <td>ä½¿ç”¨Iterableå¤„ç†æ•°æ®æ—¶ï¼Œæ¯ä¸ªæ“ä½œç¬¦ä¾æ¬¡æ‰§è¡Œæ‰€æœ‰æ•°æ®ã€‚è¿™æ˜¯ä¸€ç§æ­¥éª¤æ¥æ­¥éª¤çš„å¤„ç†æ–¹å¼ã€‚</td>
    </tr>
     <tr>
            <td>
            <figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line">sequenceOf(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line">    .filter &#123; </span><br><span class="line">        print(<span class="string">&quot;F<span class="variable">$it</span>, &quot;</span>); </span><br><span class="line">        it % <span class="number">2</span> == <span class="number">1</span> </span><br><span class="line">    &#125;</span><br><span class="line">    .map &#123; </span><br><span class="line">        print(<span class="string">&quot;M<span class="variable">$it</span>, &quot;</span>); </span><br><span class="line">        it * <span class="number">2</span> </span><br><span class="line">    &#125;</span><br><span class="line">    .forEach &#123; </span><br><span class="line">        print(<span class="string">&quot;E<span class="variable">$it</span>, &quot;</span>) </span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">// Prints: F1, M1, E2, F2, F3, M3, E6, </span></span><br></pre></td></tr></table></figure>
            </td>
            <td>
            <figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line">listOf(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line">    .filter &#123; </span><br><span class="line">        print(<span class="string">&quot;F<span class="variable">$it</span>, &quot;</span>); </span><br><span class="line">        it % <span class="number">2</span> == <span class="number">1</span> </span><br><span class="line">    &#125;</span><br><span class="line">    .map &#123; </span><br><span class="line">        print(<span class="string">&quot;M<span class="variable">$it</span>, &quot;</span>); </span><br><span class="line">        it * <span class="number">2</span> </span><br><span class="line">    &#125;</span><br><span class="line">    .forEach &#123; </span><br><span class="line">        print(<span class="string">&quot;E<span class="variable">$it</span>, &quot;</span>) </span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">// Prints: F1, F2, F3, M1, M3, E2, E6,</span></span><br></pre></td></tr></table></figure>
            </td>
        </tr>
</table>


<center>
    <img src="../images/kotlin_sequence_order.jpeg" width="500"/>
</center>

<p>å¦‚æœæˆ‘ä»¬ä¸ç”¨é›†åˆå¤„ç†å‡½æ•°ï¼Œè€Œæ˜¯ç”¨å¾ªç¯å’Œæ¡ä»¶è¯­å¥ï¼Œè¿™å’Œsequenceä¸€æ ·ï¼Œä¹Ÿæ˜¯ä¸€ç§å…ƒç´ æ¥å…ƒç´ çš„å¤„ç†æ–¹å¼ã€‚è¿™ä¹Ÿä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ç§ç¼–è¯‘å™¨åº•å±‚ä¼˜åŒ–çš„æ€è·¯ï¼šsequenceæ“ä½œå¯ä»¥è¢«ä¼˜åŒ–æˆå¾ªç¯å’Œæ¡ä»¶ã€‚</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> (e <span class="keyword">in</span> listOf(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)) &#123;</span><br><span class="line">    print(<span class="string">&quot;F<span class="variable">$e</span>, &quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> (e % <span class="number">2</span> == <span class="number">1</span>) &#123;</span><br><span class="line">        print(<span class="string">&quot;M<span class="variable">$e</span>, &quot;</span>)</span><br><span class="line">        <span class="keyword">val</span> mapped = e * <span class="number">2</span></span><br><span class="line">        print(<span class="string">&quot;E<span class="variable">$mapped</span>, &quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// Prints: F1, M1, E2, F2, F3, M3, E6,</span></span><br></pre></td></tr></table></figure>


<h5 id="äºŒã€Sequenceæ‰§è¡Œæœ€å°‘çš„æ“ä½œ"><a href="#äºŒã€Sequenceæ‰§è¡Œæœ€å°‘çš„æ“ä½œ" class="headerlink" title="äºŒã€Sequenceæ‰§è¡Œæœ€å°‘çš„æ“ä½œ"></a>äºŒã€Sequenceæ‰§è¡Œæœ€å°‘çš„æ“ä½œ</h5><p>æˆ‘ä»¬æ²¡å¿…è¦æ¯ä¸€æ­¥éƒ½å¤„ç†æ•´ä¸ªé›†åˆã€‚å‡å¦‚æˆ‘ä»¬æœ‰ä¸€ç™¾ä¸‡ä¸ªæ•°æ®ï¼Œæˆ‘ä»¬åªéœ€è¦å‰åä¸ªï¼Œæ²¡å¿…è¦å¤„ç†åä¸ªä¹‹åçš„æ•°æ®ã€‚æ‰€ä»¥sequenceå¯ä»¥æ‰§è¡Œæœ€å°‘çš„æ“ä½œã€‚</p>
<center>
    <img src="../images/kotlin_sequence_min_op.jpeg" width="500"/>
</center>

<p>çœ‹ä¸‹é¢çš„ä¾‹å­ï¼š</p>
<table>
     <tr>
            <td>
            <figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line">(<span class="number">1.</span><span class="number">.10</span>).asSequence()</span><br><span class="line">    .filter &#123; </span><br><span class="line">        print(<span class="string">&quot;F<span class="variable">$it</span>, &quot;</span>); </span><br><span class="line">        it % <span class="number">2</span> == <span class="number">1</span> </span><br><span class="line">    &#125;</span><br><span class="line">    .map &#123; </span><br><span class="line">        print(<span class="string">&quot;M<span class="variable">$it</span>, &quot;</span>); </span><br><span class="line">        it * <span class="number">2</span> </span><br><span class="line">    &#125;</span><br><span class="line">    .find &#123; </span><br><span class="line">        it &gt; <span class="number">5</span> </span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">// Prints: F1, M1, F2, F3, M3,</span></span><br></pre></td></tr></table></figure>
            </td>
            <td>
            <figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line">(<span class="number">1.</span><span class="number">.10</span>)</span><br><span class="line">    .filter &#123; </span><br><span class="line">        print(<span class="string">&quot;F<span class="variable">$it</span>, &quot;</span>); </span><br><span class="line">        it % <span class="number">2</span> == <span class="number">1</span> </span><br><span class="line">    &#125;</span><br><span class="line">    .map &#123; </span><br><span class="line">        print(<span class="string">&quot;M<span class="variable">$it</span>, &quot;</span>); </span><br><span class="line">        it * <span class="number">2</span> </span><br><span class="line">    &#125;</span><br><span class="line">    .find &#123; </span><br><span class="line">        it &gt; <span class="number">5</span> </span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">// Prints: </span></span><br><span class="line"><span class="comment">//F1, F2, F3, F4, F5, F6, F7, F8, F9, F10, </span></span><br><span class="line"><span class="comment">// M1, M3, M5, M7, M9,         </span></span><br></pre></td></tr></table></figure>
            </td>
        </tr>
</table>

<p>è¿™ä¸ªä¾‹å­ä¸­ï¼Œæœ‰å¾ˆå¤šä¸ªæ“ä½œç¬¦ï¼Œæœ€åçš„ç»ˆæ­¢æ“ä½œç¬¦ä¸éœ€è¦å¤„ç†æ‰€æœ‰çš„æ•°æ®ï¼Œå› æ­¤sequenceæ€§èƒ½æ›´å¥½ã€‚ç±»ä¼¼çš„æ“ä½œç¬¦è¿˜æœ‰ï¼š<code>first</code>, <code>find</code>, <code>take</code>, <code>any</code>, <code>all</code>, <code>none</code> æˆ– <code>indexOf</code>ã€‚</p>
<h5 id="ä¸‰ã€Sequenceæ˜¯æ— é™çš„"><a href="#ä¸‰ã€Sequenceæ˜¯æ— é™çš„" class="headerlink" title="ä¸‰ã€Sequenceæ˜¯æ— é™çš„"></a>ä¸‰ã€Sequenceæ˜¯æ— é™çš„</h5><p>ç”±äºSequenceæŒ‰éœ€å¤„ç†ï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰æ— é™åºåˆ—ã€‚ä¸€ç§å¸¸ç”¨çš„æ–¹å¼æ˜¯ä½¿ç”¨sequenceç”Ÿæˆå™¨ <code>generateSequence</code> æˆ– <code>sequence</code> ã€‚</p>
<p><code>generateSequence</code>éœ€è¦ä¼ å¦‚ç¬¬ä¸€ä¸ªå€¼ï¼Œä»¥åŠå¦‚ä½•äº§ç”Ÿä¸‹ä¸€ä¸ªå€¼ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line">generateSequence(<span class="number">1</span>) &#123; it + <span class="number">1</span> &#125;</span><br><span class="line">    .map &#123; it * <span class="number">2</span> &#125;</span><br><span class="line">    .take(<span class="number">10</span>)</span><br><span class="line">    .forEach &#123; print(<span class="string">&quot;<span class="variable">$it</span>, &quot;</span>) &#125;</span><br><span class="line"><span class="comment">// Prints: 2, 4, 6, 8, 10, 12, 14, 16, 18, 20,</span></span><br></pre></td></tr></table></figure>

<p><code>sequence</code> åˆ™ä½¿ç”¨æŒ‚èµ·å‡½æ•°æŒ‰éœ€ç”Ÿæˆæ•°æ®ã€‚åªè¦æˆ‘ä»¬éœ€è¦æ•°æ®ä»–å°±æ‰§è¡Œï¼Œä¸€ç›´åˆ°è°ƒç”¨yieldæ–¹æ³•ã€‚ç„¶åæŒ‚èµ·ç›´åˆ°ä¸‹æ¬¡å†å‘ä»–è¯·æ±‚æ•°æ®ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªæ— é™ç”Ÿæˆæ–æ³¢é‚£å¥‘æ•°åˆ—çš„ä¾‹å­ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> java.math.BigDecimal</span><br><span class="line"></span><br><span class="line"><span class="keyword">val</span> fibonacci: Sequence&lt;BigDecimal&gt; = sequence &#123;</span><br><span class="line">    <span class="keyword">var</span> current = <span class="number">1.</span>toBigDecimal()</span><br><span class="line">    <span class="keyword">var</span> prev = <span class="number">1.</span>toBigDecimal()</span><br><span class="line">    yield(prev)</span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">        yield(current)</span><br><span class="line">        <span class="keyword">val</span> temp = prev</span><br><span class="line">        prev = current</span><br><span class="line">        current += temp</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    print(fibonacci.take(<span class="number">10</span>).toList())</span><br><span class="line">    <span class="comment">// [1, 1, 2, 3, 5, 8, 13, 21, 34, 55]</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä½¿ç”¨æ— é™åºåˆ—éœ€è¦é™åˆ¶å…ƒç´ çš„æ•°é‡ï¼Œå¦åˆ™å°†æ— é™çš„è¿è¡Œä¸‹å»ã€‚</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line">print(fibonacci.toList()) <span class="comment">// Runs forever</span></span><br></pre></td></tr></table></figure>

<p>ä¸ºäº†ä¸è®©å®ƒæ— é™å¾ªç¯çš„è¿è¡Œï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>take</code>é™åˆ¶å…ƒç´ æ•°é‡ï¼Œæˆ–è€…ä½¿ç”¨firstã€findã€indexOfç­‰ã€‚åœ¨ä¸é™åˆ¶æ•°é‡çš„æƒ…å†µä¸‹ï¼Œä¸è¦ä½¿ç”¨anyã€allã€noneã€‚</p>
<h5 id="å››ã€sequenceæ¯ä¸€æ­¥ä¸äº§ç”Ÿæ–°é›†åˆ"><a href="#å››ã€sequenceæ¯ä¸€æ­¥ä¸äº§ç”Ÿæ–°é›†åˆ" class="headerlink" title="å››ã€sequenceæ¯ä¸€æ­¥ä¸äº§ç”Ÿæ–°é›†åˆ"></a>å››ã€sequenceæ¯ä¸€æ­¥ä¸äº§ç”Ÿæ–°é›†åˆ</h5><p>æ ‡å‡†çš„é›†åˆå¤„ç†å‡½æ•°æ¯ä¸€æ­¥éƒ½è¿”å›æ–°çš„é›†åˆï¼Œå½“æˆ‘ä»¬å¤„ç†å¤§é‡æ•°æ®æ—¶ä¼šåˆ†é…å¾ˆå¤šä¸´æ—¶å†…å­˜ã€‚</p>
<table>
     <tr>
         <td>
            <figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line">num</span><br><span class="line">   .filter &#123;<span class="comment">// 1                   </span></span><br><span class="line">       it % <span class="number">10</span> == <span class="number">0</span> </span><br><span class="line">   &#125; </span><br><span class="line">   .map &#123;<span class="comment">// 2      </span></span><br><span class="line">       it * <span class="number">2</span> </span><br><span class="line">   &#125; </span><br><span class="line">   .sum()</span><br><span class="line"><span class="comment">// In total, 2 collections </span></span><br><span class="line"><span class="comment">// created under the hood</span></span><br></pre></td></tr></table></figure>
         </td>
         <td>
            <figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line">num.asSequence()</span><br><span class="line">   .filter &#123;<span class="comment">//0 </span></span><br><span class="line">      it % <span class="number">10</span> == <span class="number">0</span> </span><br><span class="line">   &#125;</span><br><span class="line">   .map &#123;<span class="comment">//0</span></span><br><span class="line">      it * <span class="number">2</span> </span><br><span class="line">   &#125;</span><br><span class="line">   .sum()</span><br><span class="line"><span class="comment">// No collections created</span></span><br></pre></td></tr></table></figure>
         </td>
     </tr>
</table>

<p>ä¸€ä¸ªæç«¯åˆå¸¸è§çš„ä¾‹å­ï¼šæ–‡ä»¶è¯»å–ã€‚æ–‡ä»¶å¯èƒ½æ˜¯å‡ ä¸ªGï¼Œæ¯æ‰§è¡Œä¸€ä¸ªæ“ä½œç¬¦éƒ½åˆ†é…è¿™ä¹ˆå¤šå†…å­˜æ˜¯ä¸€ç§æå¤§çš„æµªè´¹ã€‚ä¸‹é¢ä¾‹å­æ˜¯è¯»å–å¤§å°1.53Gçš„èŠåŠ å“¥çŠ¯ç½ªè®°å½•ä¸­åŒ…å«æ¯’å“äº¤æ˜“ä¿¡æ¯çš„è®°å½•æ•°é‡ï¼Œå…¶ä¸­readLines è¿”å› List<String>ã€‚</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="comment">// BAD SOLUTION, DO NOT USE COLLECTIONS FOR </span></span><br><span class="line"><span class="comment">// POSSIBLY BIG FILES</span></span><br><span class="line">File(<span class="string">&quot;ChicagoCrimes.csv&quot;</span>)</span><br><span class="line">    .readLines()</span><br><span class="line">    .drop(<span class="number">1</span>) <span class="comment">// Drop descriptions of the columns</span></span><br><span class="line">    .mapNotNull &#123; it.split(<span class="string">&quot;,&quot;</span>).getOrNull(<span class="number">6</span>) &#125;</span><br><span class="line">    <span class="comment">// Find description</span></span><br><span class="line">    .filter &#123; <span class="string">&quot;CANNABIS&quot;</span> <span class="keyword">in</span> it &#125;</span><br><span class="line">    .count()</span><br><span class="line">    .let(::println)</span><br></pre></td></tr></table></figure>
<p>è¿™æ®µç¨‹åºåœ¨æˆ‘ç”µè„‘ä¸Šçš„è¿è¡Œç»“æœæ˜¯ï¼š</p>
<figure class="highlight shell"><figcaption><span>script</span></figcaption><table><tr><td class="code"><pre><span class="line">OutOfMemoryError.n&gt; Exception in thread &quot;main&quot; java.lang.OutOfMemoryError: Java heap space</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªé›†åˆï¼Œä¸­é—´ä¸‰ä¸ªæ“ä½œç¬¦äº§ç”Ÿé›†åˆï¼Œä¸€ä¸ªå››ä¸ªé›†åˆã€‚å…¶ä¸­ä¸‰ä¸ªåŒ…å«æ–‡ä»¶çš„ä¸»è¦ä¸»è¦æ•°æ®è®°å½•ï¼Œä¸€å…±æ¶ˆè€—4.59Gã€‚æ­£ç¡®çš„å®ç°åº”è¯¥ä½¿ç”¨sequenceï¼Œæˆ‘ä»¬ä½¿ç”¨<code>useLines</code>å‡½æ•°ï¼Œæ¯æ¬¡åªæ“ä½œä¸€è¡Œè®°å½•ã€‚</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line">File(<span class="string">&quot;ChicagoCrimes.csv&quot;</span>).useLines &#123; lines -&gt;</span><br><span class="line"><span class="comment">// The type of `lines` is Sequence&lt;String&gt;</span></span><br><span class="line">    lines.drop(<span class="number">1</span>) <span class="comment">// Drop descriptions of the columns</span></span><br><span class="line">        .mapNotNull &#123; it.split(<span class="string">&quot;,&quot;</span>).getOrNull(<span class="number">6</span>) &#125;</span><br><span class="line">        <span class="comment">// Find description</span></span><br><span class="line">        .filter &#123; <span class="string">&quot;CANNABIS&quot;</span> <span class="keyword">in</span> it &#125;</span><br><span class="line">        .count()</span><br><span class="line">        .let &#123; println(it) &#125; <span class="comment">// 318185</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åŒæ ·è¿è¡Œè¿™æ®µä»£ç ï¼Œåªè€—æ—¶8.3sã€‚ä¸ºäº†æ¯”è¾ƒä¸€ä¸‹è¿™ä¸¤ç§æ–¹æ³•çš„æ•ˆç‡ï¼Œæˆ‘åšäº†å¦å¤–ä¸€ä¸ªå®éªŒï¼šåˆ é™¤æ•°æ®ä¸­ä¸å¿…è¦çš„åˆ—ä»¥å‡å°‘æ–‡ä»¶å¤§å°ï¼Œå¾—åˆ°<code>CrimeData.csv</code>åªæœ‰728MBï¼Œç„¶ååšç›¸åŒçš„æ“ä½œã€‚ä½¿ç”¨Collectionå¤„ç†å‡½æ•°ï¼Œè€—æ—¶13sï¼Œä½¿ç”¨sequenceå‡½æ•°ï¼Œè€—æ—¶4.5sã€‚æ­£å¦‚å®éªŒæ•°æ®ï¼Œä½¿ç”¨sequenceå¤„ç†å¤§æ–‡ä»¶ä¸ä»…èŠ‚çº¦å†…å­˜ï¼Œè€Œä¸”æå‡æ€§èƒ½ã€‚</p>
<p>äº‹å®ä¸Šï¼Œåœ¨æ¯ä¸ªæ­¥éª¤ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–°çš„é›†åˆæœ¬èº«ä¹Ÿæ˜¯ä¸€ç§æˆæœ¬ï¼Œå½“æˆ‘ä»¬å¤„ç†åŒ…å«å¤§é‡å…ƒç´ çš„é›†åˆæ—¶ï¼Œè¿™ç§æˆæœ¬å°±ä¼šæ˜¾ç°å‡ºæ¥ã€‚å·®åˆ«å¹¶ä¸å¤§â€”â€”ä¸»è¦æ˜¯å› ä¸ºåœ¨è®¸å¤šæ­¥éª¤ä¸­åˆ›å»ºçš„é›†åˆéƒ½æ˜¯ç”¨é¢„æœŸçš„å¤§å°åˆå§‹åŒ–çš„ï¼Œæ‰€ä»¥å½“æˆ‘ä»¬æ·»åŠ å…ƒç´ æ—¶ï¼Œæˆ‘ä»¬åªéœ€è¦å°†å®ƒä»¬æ”¾åœ¨ä¸‹ä¸€ä¸ªä½ç½®ã€‚å°½ç®¡å³ä½¿æ˜¯å»‰ä»·çš„é›†åˆå¤åˆ¶ä¹Ÿæ¯”å®Œå…¨ä¸å¤åˆ¶è¦æ˜‚è´µï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬åº”è¯¥æ›´å–œæ¬¢å¯¹å…·æœ‰<em>å¤šä¸ªå¤„ç†æ­¥éª¤</em>çš„<em>å¤§é›†åˆ</em>ä½¿ç”¨Sequenceçš„ä¸»è¦åŸå› ã€‚</p>
<blockquote>
<p>å¤§é›†åˆï¼šå…ƒç´ å¤šï¼ˆå«æ•°ä¸‡ä¸ªå…ƒç´ çš„æ•´æ•°åˆ—è¡¨ï¼‰ã€å…ƒç´ å¤§ï¼ˆè¶…é•¿å­—ç¬¦ä¸²ï¼‰</p>
<p>å¤šä¸ªå¤„ç†æ­¥éª¤ï¼šå¤„ç†é›†åˆæ—¶ä½¿ç”¨å¾ˆå¤šæ“ä½œç¬¦ã€‚</p>
</blockquote>
<p>å¦‚æœå¯¹æ¯”ä¸‹é¢ä¸¤ä¸ªå‡½æ•°ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">singleStepListProcessing</span><span class="params">()</span></span>: List&lt;Product&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> productsList.filter &#123; it.bought &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">singleStepSequenceProcessing</span><span class="params">()</span></span>: List&lt;Product&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> productsList.asSequence()</span><br><span class="line">        .filter &#123; it.bought &#125;</span><br><span class="line">        .toList()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä½ ä¼šå‘ç°ï¼Œåœ¨æ€§èƒ½ä¸ŠåŒºåˆ«ä¸å¤§ï¼ˆå®é™…ä¸Šï¼Œç®€å•çš„listå¤„ç†æ›´å¿«ï¼Œå› ä¸ºå®ƒçš„filterå‡½æ•°æ˜¯å†…è”çš„ï¼‰ã€‚ä½†æ˜¯ï¼Œå½“ä½ ä½¿ç”¨å¤šä¸ªæ“ä½œç¬¦ï¼Œå…ˆfilterå†mapï¼Œåœ¨å¤§é›†åˆä¸Šæ€§èƒ½é—®é¢˜å°±è¡Œæ˜¾ç°å‡ºæ¥ã€‚ä¸ºäº†çœ‹åˆ°åŒºåˆ«ï¼Œæˆ‘ä»¬æ¯”è¾ƒä¸€ä¸‹2ä¸ªæ“ä½œç¬¦å’Œ3ä¸ªæ“ä½œç¬¦å¤„ç†5000ä¸ªæ•°æ®çš„æƒ…å†µï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">twoStepListProcessing</span><span class="params">()</span></span>: List&lt;<span class="built_in">Double</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> productsList</span><br><span class="line">        .filter &#123; it.bought &#125;</span><br><span class="line">        .map &#123; it.price &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">twoStepSequenceProcessing</span><span class="params">()</span></span>: List&lt;<span class="built_in">Double</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> productsList.asSequence()</span><br><span class="line">        .filter &#123; it.bought &#125;</span><br><span class="line">        .map &#123; it.price &#125;</span><br><span class="line">        .toList()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">threeStepListProcessing</span><span class="params">()</span></span>: <span class="built_in">Double</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> productsList</span><br><span class="line">        .filter &#123; it.bought &#125;</span><br><span class="line">        .map &#123; it.price &#125;</span><br><span class="line">        .average()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">threeStepSequenceProcessing</span><span class="params">()</span></span>: <span class="built_in">Double</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> productsList.asSequence()</span><br><span class="line">        .filter &#123; it.bought &#125;</span><br><span class="line">        .map &#123; it.price &#125;</span><br><span class="line">        .average()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸‹é¢æ˜¯åœ¨MacBook Pro(Retina, 15-inch, Late 2013)å¤„ç†5000ä¸ªå…ƒç´ çš„å¹³å‡ç»“æœï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">twoStepListProcessing                        81 095 ns</span><br><span class="line">twoStepSequenceProcessing                    55 685 ns</span><br><span class="line">twoStepListProcessingAndAcumulate            83 307 ns</span><br><span class="line">twoStepSequenceProcessingAndAcumulate         6 928 ns</span><br></pre></td></tr></table></figure>

<p>å¾ˆéš¾é¢„æµ‹æˆ‘ä»¬èƒ½æå‡ä½†æ˜¯æ€§èƒ½ï¼Œæ ¹æ®æˆ‘çš„è§‚å¯Ÿï¼Œåœ¨ä¸€ä¸ªåŒ…å«å¤šä¸ªæ­¥éª¤çš„å…¸å‹é›†åˆå¤„ç†ä¸­ï¼Œå¯¹äºè‡³å°‘å‡ åƒä¸ªå…ƒç´ ï¼Œæˆ‘ä»¬å¯ä»¥é¢„æœŸå¤§çº¦20-40%çš„æ€§èƒ½æå‡ã€‚</p>
<h5 id="äº”ã€sequenceä»€ä¹ˆæ—¶å€™æ²¡é‚£ä¹ˆå¿«ï¼Ÿ"><a href="#äº”ã€sequenceä»€ä¹ˆæ—¶å€™æ²¡é‚£ä¹ˆå¿«ï¼Ÿ" class="headerlink" title="äº”ã€sequenceä»€ä¹ˆæ—¶å€™æ²¡é‚£ä¹ˆå¿«ï¼Ÿ"></a>äº”ã€sequenceä»€ä¹ˆæ—¶å€™æ²¡é‚£ä¹ˆå¿«ï¼Ÿ</h5><p>æœ‰äº›æƒ…å†µæˆ‘ä»¬è¦å¤„ç†æ•´ä¸ªé›†åˆï¼Œsequenceå¹¶ä¸èƒ½ç»™æˆ‘ä»¬å¸¦æ¥ä»€ä¹ˆæ”¶ç›Šã€‚å¦‚<code>sorted</code>ï¼ˆå½“å‰æ¥è®²å®ƒæ˜¯å”¯ä¸€ä¸€ä¸ªä¾‹å­ï¼‰ã€‚sortedçš„æœ€ä¼˜å®ç°ï¼šç§¯æ”’Sequenceå¹¶æ”¾å…¥Listï¼Œç„¶åä½¿ç”¨Javaçš„sortå‡½æ•°ã€‚ç¼ºç‚¹æ˜¯ï¼Œä¸<code>Collection.sort</code>ç›¸æ¯”ï¼Œç§¯æ”’è¿‡ç¨‹ä¼šæ¶ˆè€—é¢å¤–çš„æ—¶é—´ã€‚</p>
<p>Sequenceæ˜¯å¦åº”è¯¥æ”¯æŒ<code>sorted</code>å‡½æ•°æ˜¯æœ‰äº‰è®®çš„ï¼Œå› ä¸ºå½“ä¸€ä¸ªåºåˆ—çš„æ–¹æ³•éœ€è¦æ‰€æœ‰å…ƒç´ æ‰èƒ½å®Œæˆè®¡ç®—æ—¶ï¼Œåç»­æ“ä½œåªæ˜¯éƒ¨åˆ†å»¶è¿Ÿï¼Œå¹¶ä¸”å®ƒä¸æ”¯æŒæ— é™åºåˆ—ã€‚ä¹‹æ‰€ä»¥æ·»åŠ sortedæ“ä½œåªæ˜¯å› ä¸ºå®ƒå¾ˆå¸¸ç”¨ï¼Œå¥½ç”¨ã€‚Kotlinå¼€å‘è€…éœ€è¦äº†è§£å®ƒçš„ç¼ºé™·ï¼Œå°¤å…¶æ˜¯å®ƒä¸èƒ½ç”¨äºæ— é™åºåˆ—ã€‚</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line">generateSequence(<span class="number">0</span>) &#123; it + <span class="number">1</span> &#125;.take(<span class="number">10</span>).sorted().toList()</span><br><span class="line"><span class="comment">// [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]</span></span><br><span class="line">generateSequence(<span class="number">0</span>) &#123; it + <span class="number">1</span> &#125;.sorted().take(<span class="number">10</span>).toList()</span><br><span class="line"><span class="comment">// Infinite time. Does not return.</span></span><br></pre></td></tr></table></figure>

<p>åœ¨Collectionä¸Šä½¿ç”¨sortedæ¯”åœ¨Sequenceä¸Šæ›´å¿«åªæ˜¯å°‘æ•°ç‰¹ä¾‹ã€‚å½“æˆ‘ä»¬åªä½¿ç”¨å¾ˆå°‘æ“ä½œç¬¦å‡½æ•°å’Œå•ä¸ªsortedå‡½æ•°æ—¶ï¼Œè¿˜æ˜¯å»ºè®®ä½¿ç”¨sequenceæ¥å¤„ç†ã€‚</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line">productsList.asSequence()</span><br><span class="line">    .filter &#123; it.bought &#125;</span><br><span class="line">    .map &#123; it.price &#125;</span><br><span class="line">    .sorted()</span><br><span class="line">    .take(<span class="number">10</span>)</span><br><span class="line">    .sum()</span><br></pre></td></tr></table></figure>

<h5 id="å…­ã€çœ‹çœ‹Javaçš„Streamæ“ä½œ"><a href="#å…­ã€çœ‹çœ‹Javaçš„Streamæ“ä½œ" class="headerlink" title="å…­ã€çœ‹çœ‹Javaçš„Streamæ“ä½œ"></a>å…­ã€çœ‹çœ‹Javaçš„Streamæ“ä½œ</h5><p>Java 8æ–°å¢äº†é›†åˆå¤„ç†æµçš„ç‰¹æ€§ï¼Œçœ‹èµ·æ¥å’ŒKotlinçš„åºåˆ—å¾ˆåƒã€‚</p>
<table>
     <tr>
         <td>
            <figure class="highlight java"><table><tr><td class="code"><pre><span class="line">productsList.asSequence()</span><br><span class="line">    .filter &#123; it.bought &#125;</span><br><span class="line">    .map &#123; it.price &#125;</span><br><span class="line">    .average()</span><br></pre></td></tr></table></figure>
         </td>
         <td>
            <figure class="highlight java"><table><tr><td class="code"><pre><span class="line">productsList.stream()</span><br><span class="line">    .filter &#123; it.bought &#125;</span><br><span class="line">    .mapToDouble &#123; it.price &#125;</span><br><span class="line">    .average()</span><br><span class="line">    .orElse(<span class="number">0.0</span>)</span><br></pre></td></tr></table></figure>
         </td>
     </tr>
</table>

<p>Java 8çš„Streamä¹Ÿæ˜¯æƒ°æ€§çš„åœ¨æœ€åä¸€ä¸ªæ“ä½œç¬¦è§¦å‘è®¡ç®—ã€‚ä¸Kotlin sequenceçš„åŒºåˆ«ä¸»è¦æ˜¯ï¼š</p>
<ul>
<li>Kotlin sequenceåŒ…å«æ›´å¤šçš„å¤„ç†å‡½æ•°ï¼ˆè¢«å®šä¹‰ä¸ºæ‹“å±•å‡½æ•°ï¼‰ï¼Œä½¿ç”¨ç®€å•: <code>toList()</code> vs <code>collect(Collectors.toList())</code></li>
<li>Java streamå¯ä»¥å¼€å¯å¹¶è¡Œæ¨¡å¼ï¼Œåœ¨å¤šæ ¸å¤„ç†å™¨ä¸Šä¼šæœ‰å¾ˆå¤§çš„æ€§èƒ½æå‡ã€‚</li>
<li>Kotlin sequenceå¯ä»¥ç”¨äºKotlin/JVMã€Kotlin/JSã€Kotlin/Nativeæ¨¡å—ä¸­ã€‚Java streamåªèƒ½ç”¨äºKotlin/JVMï¼Œä¸”JVMç‰ˆæœ¬è‡³å°‘æ˜¯8</li>
</ul>
<p>æ€»ä¹‹ï¼Œæˆ‘ä»¬ä¸ç”¨Java streamå¹¶è¡Œæ¨¡å¼æ—¶å¾ˆéš¾å°†è°çš„æ€§èƒ½æ›´å¥½ï¼Œæˆ‘å»ºè®®å°‘ç”¨Java streamï¼Œåªæœ‰åœ¨å¤„ç†é‡é‡çº§è®¡ç®—é—®é¢˜ä¸­ä½¿ç”¨å¹¶è¡Œæ¨¡å¼å¯ä»¥æ˜¾è‘—å¸¦æ¥æ”¶ç›Šçš„æƒ…å†µä¸‹ä½¿ç”¨ï¼Œå…¶ä»–æƒ…å†µç”¨Kotlinæ ‡å‡†å‡½æ•°èƒ½å¸¦æ¥æ¸…æ™°çš„ä»£ç ç»“æ„å’Œå¤šå¹³å°æ”¯æŒã€‚</p>
<h5 id="ä¸ƒã€è°ƒè¯•Sequence"><a href="#ä¸ƒã€è°ƒè¯•Sequence" class="headerlink" title="ä¸ƒã€è°ƒè¯•Sequence"></a>ä¸ƒã€è°ƒè¯•Sequence</h5><p>Kotlin Sequenceå’ŒJava Streaméƒ½æ”¯æŒdebugæ¯ä¸€æ­¥æ“ä½œã€‚Javaéœ€è¦ä½¿ç”¨â€Java Stream Debuggerâ€æ’ä»¶ï¼ŒKotlinåˆ™éœ€è¦â€Kotlin Sequence Debuggerâ€æ’ä»¶ï¼Œç°åœ¨å·²ç»è¢«é›†æˆåœ¨äº†Kotlinæ’ä»¶ä¸­äº†ã€‚</p>
<center>
    <img src="../images/kotlin_sequence_debug.jpeg" width="500"/>
</center>


<h4 id="ä¸‰ã€æ€»ç»“"><a href="#ä¸‰ã€æ€»ç»“" class="headerlink" title="ä¸‰ã€æ€»ç»“"></a>ä¸‰ã€æ€»ç»“</h4><p>é›†åˆå’Œåºåˆ—éå¸¸ç›¸ä¼¼ï¼Œéƒ½æ”¯æŒç›¸åŒçš„å¤„ç†å‡½æ•°ã€‚ä½†ä»–ä»¬ä¹Ÿæœ‰å¾ˆå¤§çš„åŒºåˆ«ã€‚Sequenceå¤„ç†æ˜¯å›°éš¾çš„ï¼Œå› ä¸ºæˆ‘ä»¬è¦ä¿æŒåŸé›†åˆä¸å˜ï¼Œæ‰§è¡Œç›¸åº”è½¬æ¢åå†æ”¾å›åŸé›†åˆã€‚Sequenceæ˜¯æƒ°æ€§çš„ï¼Œå¸¦æ¥å¾ˆå¤šä¼˜ç‚¹ï¼š</p>
<ul>
<li>ä¿è¯æ“ä½œçš„é¡ºåºæ€§</li>
<li>ä¿è¯æ“ä½œæ‰§è¡Œæ¬¡æ•°æœ€å°‘åŒ–</li>
<li>ä»–ä»¬å¯ä»¥æ˜¯æ— é™çš„</li>
<li>æ— éœ€æ¯ä¸€æ­¥åˆ›å»ºæ–°çš„é›†åˆ</li>
</ul>
<p>åŸºäºè¿™äº›ä¼˜ç‚¹ï¼Œå¯¹äºåŒ…å«å¤šä¸ªå¤„ç†æ­¥éª¤çš„åŒ…å«å¤§å¯¹è±¡æˆ–å…ƒç´ å¾ˆå¤šçš„é›†åˆæ¥è¯´ä½¿ç”¨Sequenceæ›´å¥½ã€‚Sequenceä¹ŸåŒ…å«è°ƒè¯•å™¨ï¼Œèƒ½å¸®åŠ©æˆ‘ä»¬å¯è§†åŒ–çš„åˆ†æå…ƒç´ å¤„ç†è¿‡ç¨‹ã€‚Sequenceä¸æ˜¯ä¸ºäº†å–ä»£ä¼ ç»Ÿçš„é›†åˆå¤„ç†æ–¹å¼ï¼Œä½¿ç”¨å‰åº”è¯¥åˆ†ææ¸…æ¥šè‡ªå·±çš„ç›®çš„å’ŒåŸå› æ‰èƒ½å¸¦æ¥æ€§èƒ½çš„æå‡ä»¥åŠæ›´å°‘çš„å†…å­˜é—®é¢˜ã€‚</p>
<h4 id="å››ã€å‚è€ƒ"><a href="#å››ã€å‚è€ƒ" class="headerlink" title="å››ã€å‚è€ƒ"></a>å››ã€å‚è€ƒ</h4><p><a href="https://kt.academy/article/ek-sequence">Effective Kotlin Item 51: Prefer Sequence for big collections with more than one processing step</a></p>
]]></content>
      <categories>
        <category>è®¡ç®—æœº</category>
      </categories>
      <tags>
        <tag>Kotlin</tag>
      </tags>
  </entry>
  <entry>
    <title>Effective Kotlin-35ï¼šç”¨DSLåˆ›å»ºå¤æ‚å¯¹è±¡</title>
    <url>/kotlin-lang-use-dsl.html</url>
    <content><![CDATA[<h4 id="ä¸€ã€æ¦‚è¿°ï¼š"><a href="#ä¸€ã€æ¦‚è¿°ï¼š" class="headerlink" title="ä¸€ã€æ¦‚è¿°ï¼š"></a>ä¸€ã€æ¦‚è¿°ï¼š</h4><p>åˆ©ç”¨Kotlinçš„è¯­è¨€ç‰¹æ€§å¯ä»¥åˆ›å»ºå¯é…ç½®çš„é¢†åŸŸè¯­è¨€-DSLï¼ˆDomain Specific Languageï¼‰ã€‚è¿™ç§DSLç”¨äºè¡¨ç¤ºå¤æ‚å¯¹è±¡å’Œå¯¹è±¡ç»§æ‰¿ç»“æ„å¾ˆæœ‰ç”¨ï¼Œå®ƒèƒ½éšè—æ¨¡æ¿ä»£ç å’Œå¤æ‚æ€§ï¼Œè®©ä½¿ç”¨è€…æ›´å¥½çš„è¡¨è¾¾è‡ªå·±çš„æ„å›¾ã€‚</p>
<p>ä¾‹å¦‚ï¼Œç”¨Kotlin DSLçš„æ–¹å¼è¡¨ç¤ºHTMLçš„ç»“æ„ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line">body &#123;</span><br><span class="line">    div &#123;</span><br><span class="line">        a(<span class="string">&quot;https://kotlinlang.org&quot;</span>) &#123;</span><br><span class="line">            target = ATarget.blank</span><br><span class="line">            +<span class="string">&quot;Main site&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    +<span class="string">&quot;Some content&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å…¶ä»–å¹³å°çš„è§†å›¾ä¹Ÿå¯ä»¥ä½¿ç”¨DSLæ¥å®šä¹‰ã€‚ä¸‹é¢æ˜¯Androidä¸Šä½¿ç”¨Ankoåº“å®šä¹‰çš„ç•Œé¢ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line">verticalLayout &#123;</span><br><span class="line">    <span class="keyword">val</span> name = editText()</span><br><span class="line">    button(<span class="string">&quot;Say Hello&quot;</span>) &#123;</span><br><span class="line">        onClick &#123; toast(<span class="string">&quot;Hello, <span class="subst">$&#123;name.text&#125;</span>!&quot;</span>) &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åŒæ ·çš„ï¼Œä½¿ç”¨TornadorFXåº“å®šä¹‰çš„æ¡Œé¢åº”ç”¨å¦‚ä¸‹ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HelloWorld</span> : <span class="type">View</span></span>() &#123;</span><br><span class="line">    <span class="keyword">override</span> <span class="keyword">val</span> root = hbox &#123;</span><br><span class="line">        label(<span class="string">&quot;Hello world&quot;</span>) &#123;</span><br><span class="line">            addClass(heading)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        textfield &#123;</span><br><span class="line">            promptText = <span class="string">&quot;Enter your name&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>DSLé€šå¸¸ä¹Ÿè¢«ç”¨äºå®šä¹‰æ•°æ®å’Œé…ç½®ã€‚ä¸‹é¢æ˜¯Ktorå®šä¹‰çš„APIï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> Routing.<span class="title">api</span><span class="params">()</span></span> &#123;</span><br><span class="line">    route(<span class="string">&quot;news&quot;</span>) &#123;</span><br><span class="line">        <span class="keyword">get</span> &#123;</span><br><span class="line">            <span class="keyword">val</span> newsData = NewsUseCase.getAcceptedNews()</span><br><span class="line">            call.respond(newsData)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">get</span>(<span class="string">&quot;propositions&quot;</span>) &#123;</span><br><span class="line">            requireSecret()</span><br><span class="line">            <span class="keyword">val</span> newsData = NewsUseCase.getPropositions()</span><br><span class="line">            call.respond(newsData)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™æ˜¯åœ¨Kotlin Testä¸­å®šä¹‰çš„æµ‹è¯•ç”¨ä¾‹ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyTests</span> : <span class="type">StringSpec</span></span>(&#123;</span><br><span class="line">    <span class="string">&quot;length should return size of string&quot;</span> &#123;</span><br><span class="line">        <span class="string">&quot;hello&quot;</span>.length shouldBe <span class="number">5</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="string">&quot;startsWith should test for a prefix&quot;</span> &#123;</span><br><span class="line">        <span class="string">&quot;world&quot;</span> should startWith(<span class="string">&quot;wor&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬ç”šè‡³å¯ä»¥ä½¿ç”¨Gradle DSLå®šä¹‰Gradleé…ç½®ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line">plugins &#123;</span><br><span class="line">    `java-library`</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">dependencies &#123;</span><br><span class="line">    api(<span class="string">&quot;junit:junit:4.12&quot;</span>)</span><br><span class="line">    implementation(<span class="string">&quot;junit:junit:4.12&quot;</span>)</span><br><span class="line">    testImplementation(<span class="string">&quot;junit:junit:4.12&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">configurations &#123;</span><br><span class="line">    implementation &#123;</span><br><span class="line">        resolutionStrategy.failOnVersionConflict()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">sourceSets &#123;</span><br><span class="line">    main &#123;</span><br><span class="line">        java.srcDir(<span class="string">&quot;src/core/java&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">java &#123;</span><br><span class="line">    sourceCompatibility = JavaVersion.VERSION_11</span><br><span class="line">    targetCompatibility = JavaVersion.VERSION_11</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">tasks &#123;</span><br><span class="line">    test &#123;</span><br><span class="line">        testLogging.showExceptions = <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨DSLç®€åŒ–äº†å±‚æ¬¡ç»“æ„å’Œå¤æ‚å¯¹è±¡çš„åˆ›å»ºã€‚åœ¨DSLæ„å»ºå—ä¸­ï¼Œä½ å¯ä»¥ä½¿ç”¨Kotlinè¯­æ³•å’Œä»£ç æç¤ºã€‚ä¹Ÿè®¸ä½ ç”¨è¿‡Kotlin DSLï¼Œä½†ä½ æ›´åº”è¯¥å­¦ä¼šå¦‚ä½•å®šä¹‰å®ƒã€‚</p>
<h4 id="äºŒã€å®šä¹‰è‡ªå·±çš„DSL"><a href="#äºŒã€å®šä¹‰è‡ªå·±çš„DSL" class="headerlink" title="äºŒã€å®šä¹‰è‡ªå·±çš„DSL"></a>äºŒã€å®šä¹‰è‡ªå·±çš„DSL</h4><p>åœ¨ç†è§£å¦‚ä½•å®šä¹‰DSLå‰ï¼Œå…ˆæ˜ç™½å¸¦æ¥æ”¶è€…çš„å‡½æ•°ç±»å‹ã€‚é¦–å…ˆä»€ä¹ˆæ˜¯å‡½æ•°ç±»å‹å‘¢ï¼Ÿå®ƒæ˜¯ä¸€ä¸ªèƒ½è¢«å½“æˆå‡½æ•°ä½¿ç”¨çš„å¯¹è±¡ã€‚ä¾‹å¦‚ï¼š<code>filter</code>å‡½æ•°ï¼Œå‚æ•°predicateå†³å®šé›†åˆæ˜¯å¦åŒ…å«æ­¤å…ƒç´ ã€‚</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">inline</span> <span class="function"><span class="keyword">fun</span> <span class="type">&lt;T&gt;</span> Iterable<span class="type">&lt;T&gt;</span>.<span class="title">filter</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">    predicate: (<span class="type">T</span>) -&gt; <span class="type">Boolean</span></span></span></span><br><span class="line"><span class="params"><span class="function">)</span></span>: List&lt;T&gt; &#123;</span><br><span class="line">    <span class="keyword">val</span> list = arrayListOf&lt;T&gt;()</span><br><span class="line">    <span class="keyword">for</span> (elem <span class="keyword">in</span> <span class="keyword">this</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (predicate(elem)) &#123;</span><br><span class="line">            list.add(elem)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> list</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å‡½æ•°ç±»å‹çš„ä¾‹å­ï¼š  </p>
<ul>
<li>()-&gt;Unit - æ— å‚å‡½æ•°ï¼Œè¿”å›Unit</li>
<li>(Int)-&gt;Unit - å•å‚Intå‡½æ•°ï¼Œè¿”å›Unit</li>
<li>(Int)-&gt;Int - å•å‚Intå‡½æ•°ï¼Œè¿”å›Int</li>
<li>(Int, Int)-&gt;Int - åŒå‚Intå‡½æ•°ï¼Œè¿”å›Intã€‚</li>
<li>(Int)-&gt;()-&gt;Unit - å•å‚Intå‡½æ•°ï¼Œè¿”å›æ— å‚å‡½æ•°ã€‚ </li>
<li>(()-&gt;Unit)-&gt;Unit - å‚æ•°ä¸ºå‡½æ•°çš„å‡½æ•°ï¼Œè¿”å›Unit</li>
</ul>
<p>åˆ›å»ºå‡½æ•°ç±»å‹å®ä¾‹çš„æ–¹å¼æœ‰ï¼š  </p>
<ul>
<li>ä½¿ç”¨lambdaè¡¨è¾¾å¼</li>
<li>ä½¿ç”¨åŒ¿åå‡½æ•°</li>
<li>ä½¿ç”¨å‡½æ•°å¼•ç”¨</li>
</ul>
<p>ä¾‹å¦‚ï¼Œä¸‹é¢çš„å‡½æ•°</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">plus</span><span class="params">(a: <span class="type">Int</span>, b: <span class="type">Int</span>)</span></span> = a + b</span><br></pre></td></tr></table></figure>
<p>åŒæ ·å¯ä»¥å£°æ˜æˆè¿™æ ·ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">val</span> plus1: (<span class="built_in">Int</span>, <span class="built_in">Int</span>) -&gt; <span class="built_in">Int</span> = &#123; a, b -&gt; a + b &#125;</span><br><span class="line"><span class="keyword">val</span> plus2: (<span class="built_in">Int</span>, <span class="built_in">Int</span>) -&gt; <span class="built_in">Int</span> = <span class="function"><span class="title">fun</span><span class="params">(a, b)</span></span> = a + b</span><br><span class="line"><span class="keyword">val</span> plus3: (<span class="built_in">Int</span>, <span class="built_in">Int</span>) -&gt; <span class="built_in">Int</span> = ::plus</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œç”±äºæŒ‡æ˜äº†å±æ€§çš„ç±»å‹ï¼Œæ‰€ä»¥lambdaå’ŒåŒ¿åå‡½æ•°ä¸­çš„å‚æ•°èƒ½è¢«æ¨å¯¼å‡ºæ¥ã€‚æ¢ä¸€ç§æ–¹å¼è¯´ï¼šå¦‚æœæŒ‡å®šå‚æ•°ç±»å‹ï¼Œå‡½æ•°ç±»å‹å¯ä»¥è¢«æ¨å¯¼ã€‚</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">val</span> plus4 = &#123; a: <span class="built_in">Int</span>, b: <span class="built_in">Int</span> -&gt; a + b &#125;</span><br><span class="line"><span class="keyword">val</span> plus5 = <span class="function"><span class="title">fun</span><span class="params">(a: <span class="type">Int</span>, b: <span class="type">Int</span>)</span></span> = a + b</span><br></pre></td></tr></table></figure>

<p>å‡½æ•°ç±»å‹ä»¥å¯¹è±¡æ¥è¡¨è¾¾å‡½æ•°ï¼ŒåŒ¿åå‡½æ•°ä¹Ÿæ˜¯ä¸€ä¸ªæ™®é€šå‡½æ•°åªæ˜¯æ²¡åå­—è€Œå·²ã€‚lambdaåˆ™æ˜¯åŒ¿åå‡½æ•°çš„ç®€çŸ­ä¹¦å†™æ–¹å¼ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å‡½æ•°ç±»å‹å»è¡¨ç¤ºå‡½æ•°ï¼Œé‚£æ‹“å±•å‡½æ•°å‘¢ï¼Ÿ</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="built_in">Int</span>.<span class="title">myPlus</span><span class="params">(other: <span class="type">Int</span>)</span></span> = <span class="keyword">this</span> + other</span><br></pre></td></tr></table></figure>

<p>ä¹‹å‰æåˆ°åŒ¿åå‡½æ•°åªæ˜¯æ²¡åå­—è€Œå·²ï¼ŒåŒ¿åæ‹“å±•å‡½æ•°ä¹Ÿä¸€æ ·ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="built_in">Int</span>.<span class="title">myPlus</span><span class="params">(other: <span class="type">Int</span>)</span></span> = <span class="keyword">this</span> + other</span><br></pre></td></tr></table></figure>

<p>é‚£æ­¤å‡½æ•°çš„ç±»å‹æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿä¸€ç§è¡¨ç¤ºæ‹“å±•å‡½æ•°çš„ç‰¹æ®Šç±»å‹ï¼Œå«ï¼šå¸¦æ¥æ”¶è€…çš„å‡½æ•°ç±»å‹ã€‚å®ƒçœ‹èµ·æ¥å’Œæ™®é€šå‡½æ•°å¾ˆåƒï¼Œåªæ˜¯åœ¨å‚æ•°ä¹‹å‰é¢å¤–çš„æŒ‡å®šäº†æ¥æ”¶è€…çš„ç±»å‹ï¼Œä»–ä»¬ä¹‹é—´ç”¨ä¸€ä¸ªç‚¹åˆ†å‰²å¼€æ¥ã€‚</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">val</span> myPlus: <span class="built_in">Int</span>.(<span class="built_in">Int</span>) -&gt; <span class="built_in">Int</span> =</span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="built_in">Int</span>.<span class="params">(other: <span class="type">Int</span>)</span></span> = <span class="keyword">this</span> + other</span><br></pre></td></tr></table></figure>

<p>è¿™ç§å‡½æ•°èƒ½é€šè¿‡lambdaè¡¨è¾¾å¼å®šä¹‰ï¼Œå°¤å…¶æ˜¯ä¸€ä¸ªå¸¦æ¥æ”¶è€…çš„lambdaè¡¨è¾¾å¼ï¼Œå› ä¸ºä½œç”¨åŸŸå†…éƒ¨çš„thiså…³é”®å­—å¼•ç”¨äº†æ‹“å±•æ¥æ”¶è€…ã€‚ï¼ˆæ­¤ä¾‹ä¸­æ˜¯ä¸€ä¸ªIntç±»å‹çš„å®ä¾‹ï¼‰ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">val</span> myPlus: <span class="built_in">Int</span>.(<span class="built_in">Int</span>)-&gt;<span class="built_in">Int</span> = &#123; <span class="keyword">this</span> + it &#125;</span><br></pre></td></tr></table></figure>

<p>ç”¨åŒ¿åæ‹“å±•å‡½æ•°æˆ–å¸¦æ¥æ”¶è€…çš„lambdaè¡¨è¾¾å¼åˆ›å»ºçš„å¯¹è±¡èƒ½è¢«ä¸‰ç§æ–¹å¼è°ƒç”¨ï¼š</p>
<ul>
<li>åƒå¯¹è±¡ä¸€æ ·ä½¿ç”¨<code>invoke</code>æ–¹æ³•è°ƒç”¨</li>
<li>åƒéæ‹“å±•å‡½æ•°ä¸€æ ·</li>
<li>å’Œæ™®é€šçš„æ‹“å±•å‡½æ•°ä¸€æ ·</li>
</ul>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line">myPlus.invoke(<span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line">myPlus(<span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line"><span class="number">1.</span>myPlus(<span class="number">2</span>)</span><br></pre></td></tr></table></figure>

<p>å¸¦æ¥æ”¶è€…çš„å‡½æ•°ç±»å‹æœ€å¤§çš„ç‰¹ç‚¹æ˜¯ï¼Œå®ƒæ”¹å˜äº†<code>this</code>çš„æŒ‡å‘ã€‚è¿™ç§ç‰¹ç‚¹å¦‚ä½•ä½¿ç”¨å‘¢ï¼Ÿå‡è®¾ä¸€ä¸ªç±»éœ€è¦ä¾æ¬¡è®¾ç½®å±æ€§ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dialog</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> title: String = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">var</span> text: String = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">show</span><span class="params">()</span></span> &#123; <span class="comment">/*...*/</span> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">val</span> dialog = Dialog()</span><br><span class="line">    dialog.title = <span class="string">&quot;My dialog&quot;</span></span><br><span class="line">    dialog.text = <span class="string">&quot;Some text&quot;</span></span><br><span class="line">    dialog.show()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>é‡å¤å¼•ç”¨æ­¤dialogå¾ˆä¸æ–¹ä¾¿ï¼Œå¦‚æœæˆ‘ä»¬ä½¿ç”¨å¸¦æ¥æ”¶è€…çš„lambdaï¼Œthiså°±æŒ‡å‘dialogï¼Œæˆ‘ä»¬å¯ä»¥çœç•¥thisï¼Œå› ä¸ºæ¥æ”¶è€…èƒ½å¤Ÿéšå¼è°ƒç”¨</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dialog</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> title: String = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">var</span> text: String = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">show</span><span class="params">()</span></span> &#123; <span class="comment">/*...*/</span> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">val</span> dialog = Dialog()</span><br><span class="line">    <span class="keyword">val</span> <span class="keyword">init</span>: Dialog.() -&gt; <span class="built_in">Unit</span> = &#123;</span><br><span class="line">        title = <span class="string">&quot;My dialog&quot;</span></span><br><span class="line">        text = <span class="string">&quot;Some text&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">init</span>.invoke(dialog)</span><br><span class="line">    dialog.show()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æŒ‰ç…§è¿™ä¸ªæ€è·¯ï¼Œä½ å¯ä»¥å®šä¹‰ä¸€ä¸ªåŒ…å«åˆ›å»ºæ­¤dialogå¯¹è±¡æ‰€éœ€çš„æ‰€æœ‰å…¬å…±éƒ¨åˆ†çš„é€»è¾‘ï¼ŒåªæŠŠéœ€è¦å˜åŒ–çš„å±æ€§çš„è®¾ç½®ç»™è°ƒç”¨è€…ã€‚</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dialog</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> title: String = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">var</span> text: String = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">show</span><span class="params">()</span></span> &#123; <span class="comment">/*...*/</span> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">showDialog</span><span class="params">(<span class="keyword">init</span>: <span class="type">Dialog</span>.() -&gt; <span class="type">Unit</span>)</span></span> &#123;</span><br><span class="line">    <span class="keyword">val</span> dialog = Dialog()</span><br><span class="line">    <span class="keyword">init</span>.invoke(dialog)</span><br><span class="line">    dialog.show()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    showDialog &#123;</span><br><span class="line">        title = <span class="string">&quot;My dialog&quot;</span></span><br><span class="line">        text = <span class="string">&quot;Some text&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™å°±æ˜¯æœ€ç®€å•çš„DSLä¾‹å­ã€‚å› ä¸ºå¤§éƒ¨åˆ†è¿™äº›æ„å»ºå‡½æ•°éƒ½æ˜¯é‡å¤çš„ï¼Œå·²ç»è¢«æŠ½å–åˆ°ä¸€ä¸ªapplyå‡½æ•°å†…ï¼Œèƒ½è¢«ç›´æ¥ä½¿ç”¨ï¼Œä¸ç”¨å†å®šä¹‰DSLæ„å»ºå™¨å»è®¾ç½®å±æ€§äº†ã€‚</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">inline</span> <span class="function"><span class="keyword">fun</span> <span class="type">&lt;T&gt;</span> T.<span class="title">apply</span><span class="params">(block: <span class="type">T</span>.() -&gt; <span class="type">Unit</span>)</span></span>: T &#123;</span><br><span class="line">    <span class="keyword">this</span>.block()</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Dialog().apply &#123;</span><br><span class="line">    title = <span class="string">&quot;My dialog&quot;</span></span><br><span class="line">    text = <span class="string">&quot;Some text&quot;</span></span><br><span class="line">&#125;.show()</span><br></pre></td></tr></table></figure>

<p>å¯¹äºDSLæ¥è¯´ï¼Œå¸¦æ¥æ”¶è€…çš„å‡½æ•°ç±»å‹æ˜¯æœ€åŸºæœ¬çš„æ„å»ºå—ã€‚æˆ‘ä»¬ä¸€èµ·æ¥å†™ä¸€ä¸ªç®€å•çš„DSLç”¨äºåˆ›å»ºä¸‹é¢çš„HTMLè¡¨æ ¼ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">createTable</span><span class="params">()</span></span>: TableBuilder = table &#123;</span><br><span class="line">    tr &#123;</span><br><span class="line">        <span class="keyword">for</span> (i <span class="keyword">in</span> <span class="number">1.</span><span class="number">.2</span>) &#123;</span><br><span class="line">            td &#123;</span><br><span class="line">                +<span class="string">&quot;This is column <span class="variable">$i</span>&quot;</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åœ¨DSLå¼€å¤´æˆ‘ä»¬å®šä¹‰äº†tableå‡½æ•°ã€‚ç”±äºæ˜¯æœ€å¤–å±‚å®šä¹‰ï¼Œæ‰€ä»¥å®ƒæ²¡ç”¨æ¥æ”¶è€…ã€‚åœ¨tableçš„å†…éƒ¨å¯ä»¥ä½¿ç”¨trï¼Œæ‰€ä»¥trå‡½æ•°åªèƒ½ç”¨äºtableå†…éƒ¨ã€‚åŒç†ï¼Œtdåªèƒ½ç”¨äºtrå†…éƒ¨ã€‚</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">table</span><span class="params">(<span class="keyword">init</span>: <span class="type">TableBuilder</span>.()-&gt;<span class="type">Unit</span>)</span></span>: TableBuilder &#123;</span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TableBuilder</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">tr</span><span class="params">(<span class="keyword">init</span>: <span class="type">TrBuilder</span>.() -&gt; <span class="type">Unit</span>)</span></span> &#123; <span class="comment">/*...*/</span> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TrBuilder</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">td</span><span class="params">(<span class="keyword">init</span>: <span class="type">TdBuilder</span>.()-&gt;<span class="type">Unit</span>)</span></span> &#123; <span class="comment">/*...*/</span> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TdBuilder</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> text = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">operator</span> <span class="function"><span class="keyword">fun</span> String.<span class="title">unaryPlus</span><span class="params">()</span></span> &#123;</span><br><span class="line">        text += <span class="keyword">this</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç°åœ¨ï¼Œæˆ‘ä»¬å®šä¹‰å¥½äº†DSLã€‚ä¸ºäº†è®©å®ƒè¿è¡Œï¼Œæ¯ä¸€æ­¥æˆ‘ä»¬éƒ½éœ€è¦åˆ›å»ºä¸€ä¸ªbuilderå¹¶ç”¨å‚æ•°é‡Œé¢çš„å‡½æ•°åˆå§‹åŒ–å®ƒï¼ˆä¸‹é¢ä¾‹å­ä¸­çš„<code>init</code>ï¼‰ã€‚builderå°†åŒ…å«æ‰€æœ‰initå‡½æ•°æŒ‡å®šçš„æ•°æ®ã€‚è¿™äº›æ•°æ®æ˜¯æˆ‘ä»¬éœ€è¦çš„ã€‚æˆ‘ä»¬å¯ä»¥ç›´æ¥è¿”å›è¿™ä¸ªæ„å»ºå™¨ä¹Ÿå¯ä»¥è¿”å›å¦ä¸€ä¸ªåŒ…å«è¿™äº›æ•°æ®çš„æ–°å¯¹è±¡ã€‚æ­¤ä¾‹ä¸­æˆ‘ä»¬ç›´æ¥è¿”å›æ„å»ºå™¨ã€‚ä¸‹é¢æ˜¯<code>table</code>å‡½æ•°çš„å®šä¹‰ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">table</span><span class="params">(<span class="keyword">init</span>: <span class="type">TableBuilder</span>.()-&gt;<span class="type">Unit</span>)</span></span>: TableBuilder &#123;</span><br><span class="line">    <span class="keyword">val</span> tableBuilder = TableBuilder()</span><br><span class="line">    <span class="keyword">init</span>.invoke(tableBuilder)</span><br><span class="line">    <span class="keyword">return</span> tableBuilder</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨applyå‡½æ•°ç®€åŒ–å‡½æ•°ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">table</span><span class="params">(<span class="keyword">init</span>: <span class="type">TableBuilder</span>.()-&gt;<span class="type">Unit</span>)</span></span> =</span><br><span class="line">    TableBuilder().apply(<span class="keyword">init</span>)</span><br></pre></td></tr></table></figure>

<p>å…¶ä»–å‡½æ•°ä¹Ÿä½¿ç”¨applyç®€åŒ–ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TableBuilder</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> trs = listOf&lt;TrBuilder&gt;()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">tr</span><span class="params">(<span class="keyword">init</span>: <span class="type">TrBuilder</span>.()-&gt;<span class="type">Unit</span>)</span></span> &#123;</span><br><span class="line">        trs = trs + TrBuilder().apply(<span class="keyword">init</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TrBuilder</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> tds = listOf&lt;TdBuilder&gt;()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">td</span><span class="params">(<span class="keyword">init</span>: <span class="type">TdBuilder</span>.()-&gt;<span class="type">Unit</span>)</span></span> &#123;</span><br><span class="line">        tds = tds + TdBuilder().apply(<span class="keyword">init</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h4 id="ä¸‰ã€ä½•æ—¶ä½¿ç”¨ï¼Ÿ"><a href="#ä¸‰ã€ä½•æ—¶ä½¿ç”¨ï¼Ÿ" class="headerlink" title="ä¸‰ã€ä½•æ—¶ä½¿ç”¨ï¼Ÿ"></a>ä¸‰ã€ä½•æ—¶ä½¿ç”¨ï¼Ÿ</h4><p>DSLç»™äº†æˆ‘ä»¬ä¸€ç§å®šä¹‰ä¿¡æ¯çš„æ–¹å¼ã€‚å®ƒèƒ½ç”¨äºè¡¨è¾¾ä½ æ‰€æƒ³è¡¨è¾¾çš„ä¸œè¥¿ã€‚ä½†æ˜¯å¯¹äºç”¨æˆ·è€Œè¨€è¿™äº›ä¿¡æ¯ä¹‹åå¦‚ä½•ä½¿ç”¨ä¸æ˜¯å¾ˆæ¸…æ™°ã€‚åœ¨Ankoã€TornadoFXæˆ–HTML DSLä¸­ï¼Œæˆ‘ä»¬ç›¸ä¿¡è§†å›¾ä¼šæ ¹æ®æˆ‘ä»¬çš„å®šä¹‰å½¢å¼è¢«æ„å»ºï¼Œä½†å¾ˆéš¾è·Ÿè¸ªå‡†ç¡®è·Ÿè¸ªå¦‚ä½•æ„å»ºã€‚ä¸€äº›å¤æ‚çš„ä½¿ç”¨æ–¹å¼å¾ˆéš¾å‘ç°ã€‚ç”¨æ³•ä¹Ÿä¼šè®©é‚£äº›ä¸ä¹ æƒ¯çš„äººæ„Ÿåˆ°å›°æƒ‘ã€‚æ›´ä¸ç”¨è¯´ç»´æŠ¤äº†ã€‚å®ƒä»¬çš„å®šä¹‰æ–¹å¼å¯èƒ½æ˜¯ä¸€ç§æˆæœ¬â€”â€”åœ¨å¼€å‘äººå‘˜å›°æƒ‘å’Œæ€§èƒ½æ–¹é¢éƒ½æ˜¯å¦‚æ­¤ã€‚å½“æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å…¶ä»–æ›´ç®€å•çš„ç‰¹æ€§æ—¶ï¼Œdslå°±å¤ªè¿‡äº†ã€‚è™½ç„¶å½“æˆ‘ä»¬éœ€è¦è¡¨è¾¾ä¸‹é¢çš„å†…å®¹æ—¶ï¼Œå®ƒä»¬çœŸçš„å¾ˆæœ‰ç”¨:</p>
<ul>
<li>å¤æ‚çš„æ•°æ®ç»“æ„</li>
<li>ç»§æ‰¿ç»“æ„</li>
<li>å¤§é‡æ•°æ®</li>
</ul>
<p>æè¿°äº‹ç‰©ä¸æ­¢DSLæ–¹å¼ï¼Œè¿˜å¯ä»¥ç”¨builderã€æˆ–åªç”¨æ„é€ å™¨ä»£æ›¿ã€‚dslæ˜¯å…³äºæ­¤ç±»ç»“æ„çš„æ¨¡æ¿ä»£ç æ¶ˆé™¤ã€‚å½“æ‚¨çœ‹åˆ°å¯é‡å¤çš„æ ·æ¿ä»£ç ï¼Œå¹¶ä¸”æ²¡æœ‰æ›´ç®€å•çš„Kotlinç‰¹æ€§å¯ä»¥æä¾›å¸®åŠ©æ—¶ï¼Œæ‚¨åº”è¯¥è€ƒè™‘ä½¿ç”¨DSLã€‚</p>
<h4 id="å››ã€æ€»ç»“ï¼š"><a href="#å››ã€æ€»ç»“ï¼š" class="headerlink" title="å››ã€æ€»ç»“ï¼š"></a>å››ã€æ€»ç»“ï¼š</h4><p>DSLæ˜¯è¯­è¨€ä¸­çš„ä¸€ç§ç‰¹æ®Šå½¢å¼ã€‚å®ƒå¯ä»¥éå¸¸ç®€å•åœ°åˆ›å»ºå¤æ‚çš„å¯¹è±¡ï¼Œç”šè‡³æ•´ä¸ªå¯¹è±¡å±‚æ¬¡ç»“æ„ï¼Œå¦‚HTMLä»£ç æˆ–å¤æ‚çš„é…ç½®æ–‡ä»¶ã€‚å¦ä¸€æ–¹é¢ï¼ŒDSLå®ç°å¯èƒ½ä¼šè®©æ–°å¼€å‘äººå‘˜æ„Ÿåˆ°å›°æƒ‘æˆ–å›°éš¾ã€‚å®ƒä»¬ä¹Ÿå¾ˆéš¾å®šä¹‰ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆåªæœ‰å½“å®ƒä»¬æä¾›çœŸæ­£çš„ä»·å€¼æ—¶æ‰åº”è¯¥ä½¿ç”¨å®ƒä»¬çš„åŸå› ã€‚ä¾‹å¦‚ï¼Œç”¨äºåˆ›å»ºä¸€ä¸ªçœŸæ­£å¤æ‚çš„å¯¹è±¡ï¼Œæˆ–è€…å¯èƒ½ç”¨äºå¤æ‚çš„å¯¹è±¡å±‚æ¬¡ç»“æ„ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæœ€å¥½åœ¨åº“ä¸­è€Œä¸æ˜¯åœ¨é¡¹ç›®ä¸­å®šä¹‰å®ƒä»¬çš„åŸå› ã€‚åˆ¶ä½œä¸€ä¸ªå¥½çš„DSLå¹¶ä¸å®¹æ˜“ï¼Œä½†æ˜¯ä¸€ä¸ªå®šä¹‰è‰¯å¥½çš„DSLå¯ä»¥è®©æˆ‘ä»¬çš„é¡¹ç›®åšå¾—æ›´å¥½ã€‚</p>
<p>å‚è€ƒï¼š<br><a href="https://kt.academy/article/ek-dsl">Effective Kotlin Item 35: Consider defining a DSL for complex object creation</a></p>
]]></content>
      <categories>
        <category>è®¡ç®—æœº</category>
      </categories>
      <tags>
        <tag>Kotlin</tag>
      </tags>
  </entry>
  <entry>
    <title>Effective Kotlin-56ï¼šè€ƒè™‘ä½¿ç”¨å¯å˜é›†åˆ</title>
    <url>/kotlin-lang-use-mutable-collection.html</url>
    <content><![CDATA[<p>ä¸ä¸å¯å˜é›†åˆç›¸æ¯”ï¼Œä½¿ç”¨å¯å˜é›†åˆæœ€å¤§çš„ä¼˜ç‚¹æ˜¯æ€§èƒ½æ›´å¿«ã€‚å‘ä¸å¯å˜é›†åˆæ·»åŠ å…ƒç´ éœ€è¦æ–°å»ºé›†åˆå†æ‹·è´æ‰€æœ‰å…ƒç´ ï¼Œä¸‹é¢æ˜¯kotlinæ ‡å‡†åº“ç°åœ¨çš„å®ç°ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">operator</span> <span class="function"><span class="keyword">fun</span> <span class="type">&lt;T&gt;</span> Iterable<span class="type">&lt;T&gt;</span>.<span class="title">plus</span><span class="params">(element: <span class="type">T</span>)</span></span>: List&lt;T&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span> <span class="keyword">is</span> Collection) <span class="keyword">return</span> <span class="keyword">this</span>.plus(element)</span><br><span class="line">    <span class="keyword">val</span> result = ArrayList&lt;T&gt;()</span><br><span class="line">    result.addAll(<span class="keyword">this</span>)</span><br><span class="line">    result.add(element)</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å½“é›†åˆå¾ˆå¤§æ—¶ï¼Œæ‹·è´æ“ä½œå°±æ¯”è¾ƒè€—æ€§èƒ½äº†ã€‚æ‰€ä»¥å¯¹äºéœ€è¦æ·»åŠ å…ƒç´ çš„é›†åˆä½¿ç”¨å¯å˜é›†åˆæ€§èƒ½æ›´å¥½ã€‚æˆ‘ä»¬çŸ¥é“ï¼Œä¸å¯å˜é›†åˆæ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚ä½†æ˜¯å¯¹äºä¸éœ€è¦åŒæ­¥çš„å±€éƒ¨å˜é‡æ¥è¯´åˆ™ä¸é€‚ç”¨ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆå¯¹äºå±€éƒ¨å¤„ç†ï¼Œä½¿ç”¨å¯å˜é›†åˆé€šå¸¸æ›´æœ‰æ„ä¹‰ã€‚è¿™ä¸ªäº‹å®å¯ä»¥åœ¨æ ‡å‡†åº“ä¸­åæ˜ å‡ºæ¥ï¼Œåœ¨æ ‡å‡†åº“ä¸­ï¼Œæ‰€æœ‰çš„é›†åˆå¤„ç†å‡½æ•°éƒ½æ˜¯ä½¿ç”¨å¯å˜é›†åˆå†…éƒ¨å®ç°çš„:</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">inline</span> <span class="function"><span class="keyword">fun</span> <span class="type">&lt;T, R&gt;</span> Iterable<span class="type">&lt;T&gt;</span>.<span class="title">map</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">    transform: (<span class="type">T</span>) -&gt; <span class="type">R</span></span></span></span><br><span class="line"><span class="params"><span class="function">)</span></span>: List&lt;R&gt; &#123;</span><br><span class="line">    <span class="keyword">val</span> size =</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">this</span> <span class="keyword">is</span> Collection&lt;*&gt;) <span class="keyword">this</span>.size <span class="keyword">else</span> <span class="number">10</span></span><br><span class="line">    <span class="keyword">val</span> destination = ArrayList&lt;R&gt;(size)</span><br><span class="line">    <span class="keyword">for</span> (item <span class="keyword">in</span> <span class="keyword">this</span>)</span><br><span class="line">        destination.add(transform(item))</span><br><span class="line">    <span class="keyword">return</span> destination</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è€Œä¸æ˜¯ä¸å¯å˜é›†åˆï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="comment">// This is not how map is implemented</span></span><br><span class="line"><span class="keyword">inline</span> <span class="function"><span class="keyword">fun</span> <span class="type">&lt;T, R&gt;</span> Iterable<span class="type">&lt;T&gt;</span>.<span class="title">map</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">    transform: (<span class="type">T</span>) -&gt; <span class="type">R</span></span></span></span><br><span class="line"><span class="params"><span class="function">)</span></span>: List&lt;R&gt; &#123;</span><br><span class="line">    <span class="keyword">var</span> destination = listOf&lt;R&gt;()</span><br><span class="line">    <span class="keyword">for</span> (item <span class="keyword">in</span> <span class="keyword">this</span>)</span><br><span class="line">        destination += transform(item)</span><br><span class="line">    <span class="keyword">return</span> destination</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p>æ€»ç»“ï¼š<br>å¦‚æœæ˜¯å¢åŠ å…ƒç´ ï¼Œå¯å˜é›†åˆæ˜¯å¾ˆå¿«çš„ï¼Œè€Œä¸å¯å˜é›†åˆåˆ™ç»™æˆ‘ä»¬ç»™å¤šçš„æ§åˆ¶ï¼ŒçŸ¥é“é›†åˆæ˜¯å¦‚ä½•å˜åŒ–çš„ã€‚ä½†å¯¹äºæœ¬åœ°ä½œç”¨åŸŸæ¥è®²ï¼Œæˆ‘ä»¬ä¸éœ€è¦è¿™ç§æ§åˆ¶ï¼Œæ‰€ä»¥ä½¿ç”¨å¯å˜é›†åˆæ›´å¥½ã€‚å°¤å…¶åœ¨ä¸€äº›å·¥å…·ç±»ï¼Œæ’å…¥æ“ä½œå¯èƒ½å¾ˆé¢‘ç¹ã€‚</p>
]]></content>
      <categories>
        <category>è®¡ç®—æœº</category>
      </categories>
      <tags>
        <tag>Kotlin</tag>
      </tags>
  </entry>
  <entry>
    <title>LeetCode ä¸¤æ•°ç›¸åŠ </title>
    <url>/leetcode-list-add.html</url>
    <content><![CDATA[<h3 id="Leetode-2-ä¸¤æ•°ç›¸åŠ "><a href="#Leetode-2-ä¸¤æ•°ç›¸åŠ " class="headerlink" title="Leetode-2 ä¸¤æ•°ç›¸åŠ "></a>Leetode-2 ä¸¤æ•°ç›¸åŠ </h3><blockquote>
<p>ç»™ä½ ä¸¤ä¸ªÂ éç©º çš„é“¾è¡¨ï¼Œè¡¨ç¤ºä¸¤ä¸ªéè´Ÿçš„æ•´æ•°ã€‚å®ƒä»¬æ¯ä½æ•°å­—éƒ½æ˜¯æŒ‰ç…§Â é€†åºÂ çš„æ–¹å¼å­˜å‚¨çš„ï¼Œå¹¶ä¸”æ¯ä¸ªèŠ‚ç‚¹åªèƒ½å­˜å‚¨Â ä¸€ä½Â æ•°å­—ã€‚è¯·ä½ å°†ä¸¤ä¸ªæ•°ç›¸åŠ ï¼Œå¹¶ä»¥ç›¸åŒå½¢å¼è¿”å›ä¸€ä¸ªè¡¨ç¤ºå’Œçš„é“¾è¡¨ã€‚ä½ å¯ä»¥å‡è®¾é™¤äº†æ•°å­— 0 ä¹‹å¤–ï¼Œè¿™ä¸¤ä¸ªæ•°éƒ½ä¸ä¼šä»¥ 0Â å¼€å¤´ã€‚</p>
</blockquote>
<span id="more"></span>

<center>
    <img src="../images/add_two_6.jpeg" width="400" alt="åˆå§‹çŠ¶æ€"/>
</center>

<br>

<h4 id="é—®é¢˜åˆ†æï¼š"><a href="#é—®é¢˜åˆ†æï¼š" class="headerlink" title="é—®é¢˜åˆ†æï¼š"></a>é—®é¢˜åˆ†æï¼š</h4><h5 id="å½“ä¸¤ä¸ªé“¾è¡¨é•¿åº¦ç›¸ç­‰æ—¶ï¼Œæˆ‘ä»¬åªéœ€è¦ä¸æ–­çš„ç›¸åŠ ï¼Œå†ç§»åŠ¨ä¸¤ä¸ªæŒ‡é’ˆï¼Œç›´è‡³é“¾è¡¨æœ«å°¾ã€‚"><a href="#å½“ä¸¤ä¸ªé“¾è¡¨é•¿åº¦ç›¸ç­‰æ—¶ï¼Œæˆ‘ä»¬åªéœ€è¦ä¸æ–­çš„ç›¸åŠ ï¼Œå†ç§»åŠ¨ä¸¤ä¸ªæŒ‡é’ˆï¼Œç›´è‡³é“¾è¡¨æœ«å°¾ã€‚" class="headerlink" title="å½“ä¸¤ä¸ªé“¾è¡¨é•¿åº¦ç›¸ç­‰æ—¶ï¼Œæˆ‘ä»¬åªéœ€è¦ä¸æ–­çš„ç›¸åŠ ï¼Œå†ç§»åŠ¨ä¸¤ä¸ªæŒ‡é’ˆï¼Œç›´è‡³é“¾è¡¨æœ«å°¾ã€‚"></a>å½“ä¸¤ä¸ªé“¾è¡¨é•¿åº¦ç›¸ç­‰æ—¶ï¼Œæˆ‘ä»¬åªéœ€è¦ä¸æ–­çš„ç›¸åŠ ï¼Œå†ç§»åŠ¨ä¸¤ä¸ªæŒ‡é’ˆï¼Œç›´è‡³é“¾è¡¨æœ«å°¾ã€‚</h5><center>
    <img src="../images/add_two_7.jpeg" width="400"/>
</center>


<h5 id="å½“ä¸¤ä¸ªé“¾è¡¨é•¿åº¦ä¸ç­‰æ—¶ï¼Œå‰åŠéƒ¨åˆ†èµ°é“¾è¡¨ç›¸ç­‰é€»è¾‘ï¼ŒååŠéƒ¨åˆ†å…¶å®æ˜¯ä¸€ä¸ªå•é“¾è¡¨å’Œè¿›ä½ç›¸åŠ çš„é€»è¾‘ã€‚"><a href="#å½“ä¸¤ä¸ªé“¾è¡¨é•¿åº¦ä¸ç­‰æ—¶ï¼Œå‰åŠéƒ¨åˆ†èµ°é“¾è¡¨ç›¸ç­‰é€»è¾‘ï¼ŒååŠéƒ¨åˆ†å…¶å®æ˜¯ä¸€ä¸ªå•é“¾è¡¨å’Œè¿›ä½ç›¸åŠ çš„é€»è¾‘ã€‚" class="headerlink" title="å½“ä¸¤ä¸ªé“¾è¡¨é•¿åº¦ä¸ç­‰æ—¶ï¼Œå‰åŠéƒ¨åˆ†èµ°é“¾è¡¨ç›¸ç­‰é€»è¾‘ï¼ŒååŠéƒ¨åˆ†å…¶å®æ˜¯ä¸€ä¸ªå•é“¾è¡¨å’Œè¿›ä½ç›¸åŠ çš„é€»è¾‘ã€‚"></a>å½“ä¸¤ä¸ªé“¾è¡¨é•¿åº¦ä¸ç­‰æ—¶ï¼Œå‰åŠéƒ¨åˆ†èµ°é“¾è¡¨ç›¸ç­‰é€»è¾‘ï¼ŒååŠéƒ¨åˆ†å…¶å®æ˜¯ä¸€ä¸ªå•é“¾è¡¨å’Œè¿›ä½ç›¸åŠ çš„é€»è¾‘ã€‚</h5><center>
    <img src="../images/add_two_8.jpeg" width="400"/>
</center>


<center>
    <img src="../images/ad_two_9.jpeg" width="400"/>
</center>


<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¸¤ä¸ªé“¾è¡¨ç›¸åŠ </span></span><br><span class="line"><span class="comment">     * å¤ç”¨ä¸€ä¸ªé“¾è¡¨çš„ç»“ç‚¹</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> l1 ç¬¬ä¸€ä¸ªé“¾è¡¨</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> l2 ç¬¬äºŒä¸ªé“¾è¡¨</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ListNode <span class="title">addTwoNumbers</span><span class="params">(ListNode l1, ListNode l2)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">boolean</span> carry = <span class="keyword">false</span>;<span class="comment">//è¿›ä½</span></span><br><span class="line">        ListNode l1Prev = <span class="keyword">null</span>, l2Prev = <span class="keyword">null</span>, result = l1;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//ä¸¤ä¸ªé“¾è¡¨éƒ½æœ‰å€¼ï¼Œç›¸åŠ ç›´åˆ°ä¸€ä¸ªé“¾è¡¨æœ«å°¾</span></span><br><span class="line">        <span class="keyword">while</span> (l1 != <span class="keyword">null</span> &amp;&amp; l2 != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">int</span> add = l1.val + l2.val + (carry ? <span class="number">1</span> : <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">            l1.val = add % <span class="number">10</span> ;</span><br><span class="line">            carry = add &gt; <span class="number">9</span>;</span><br><span class="line"></span><br><span class="line">            l1Prev = l1;</span><br><span class="line">            l2Prev = l2;</span><br><span class="line">            l1 = l1.next;</span><br><span class="line">            l2 = l2.next;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æœ‰ä¸€ä¸ªé“¾è¡¨å·²ç»èµ°åˆ°å¤´ï¼Œ</span></span><br><span class="line">        <span class="keyword">if</span> (l1 == <span class="keyword">null</span> &amp;&amp; l2 != <span class="keyword">null</span>) &#123;</span><br><span class="line">            addSingleList(l1Prev, l2, carry);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (l1 != <span class="keyword">null</span> &amp;&amp; l2 == <span class="keyword">null</span>) &#123;</span><br><span class="line">            addSingleList(l2Prev, l1, carry);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (l1 == <span class="keyword">null</span> &amp;&amp; l2 == <span class="keyword">null</span> &amp;&amp; carry)&#123;</span><br><span class="line">            l1Prev.next = <span class="keyword">new</span> ListNode(<span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å•é“¾è¡¨å’Œè¿›ä½ç›¸åŠ </span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">addSingleList</span><span class="params">(ListNode l1, ListNode l2, <span class="keyword">boolean</span> carry)</span> </span>&#123;</span><br><span class="line">        l1.next = l2;</span><br><span class="line">        <span class="keyword">while</span> (l2 != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">int</span> add = l2.val + (carry ? <span class="number">1</span> : <span class="number">0</span>);</span><br><span class="line">            l2.val = add % <span class="number">10</span>;</span><br><span class="line">            carry = add &gt; <span class="number">9</span>;</span><br><span class="line">            l1 = l2;</span><br><span class="line">            l2 = l2.next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (carry) &#123;</span><br><span class="line">            l1.next = <span class="keyword">new</span> ListNode(<span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>è®¡ç®—æœº</category>
      </categories>
      <tags>
        <tag>LeetCode</tag>
        <tag>ç®—æ³•</tag>
        <tag>é“¾è¡¨</tag>
      </tags>
  </entry>
  <entry>
    <title>LeetCode åè½¬å•é“¾è¡¨</title>
    <url>/leetcode-reverse-list.html</url>
    <content><![CDATA[<h3 id="LeetCode-206-åè½¬å•é“¾è¡¨"><a href="#LeetCode-206-åè½¬å•é“¾è¡¨" class="headerlink" title="LeetCode-206 åè½¬å•é“¾è¡¨"></a>LeetCode-206 åè½¬å•é“¾è¡¨</h3><blockquote>
<p>ç»™ä½ å•é“¾è¡¨çš„å¤´ç»“ç‚¹ headï¼Œè¯·ä½ åè½¬é“¾è¡¨ï¼Œå¹¶è¿”å›åè½¬åçš„é“¾è¡¨ã€‚</p>
</blockquote>
<p>é—®é¢˜åˆ†æï¼š</p>
<p>è¿™æ˜¯åˆå§‹çŠ¶æ€çš„é“¾è¡¨</p>
<center>
    <img src="../images/revert_list_0.png" width="400"/>
</center>
ç”±äºåè½¬é“¾è¡¨å **head** ç»“ç‚¹å°†æŒ‡å‘ç©ºï¼ˆnullï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥å‡è®¾å­˜åœ¨è¿™ä¹ˆä¸€ä¸ªä¸ºç©ºçš„ç»“ç‚¹prevã€‚  

<p>å°è¯•ä¸€æ¬¡åè½¬åï¼Œæˆ‘ä»¬å‘ç°ï¼Œåç»­ç»“ç‚¹ä¿¡æ¯ä¸¢å¤±äº†ï¼æˆ‘ä»¬ä¸å¾—ä¸å£°æ˜ä¸€ä¸ªæ–°çš„å˜é‡ä¿å­˜åŸé“¾è¡¨çš„ä¿¡æ¯ã€‚</p>
<center>
    <img src="../images/revert_list_7.png" width="400"/>
</center>

<p>æ‰€ä»¥ï¼Œæˆ‘ä»¬ä¸€å…±éœ€è¦ä¸‰ä¸ªæŒ‡é’ˆæ¥è®°å½•è½¬æ¢è¿‡ç¨‹  </p>
<ul>
<li>prevã€ head ç”¨äºäº¤æ¢</li>
<li>next ç”¨äºè®°å½•  </li>
</ul>
<p>åˆ†æåˆ°è¿™é‡Œï¼Œæˆ‘ä»¬å†å›åˆ°åˆå§‹çŠ¶æ€  ï¼š</p>
<center>
    <img src="../images/revert_list_4.png" width="400"/>
</center>

<p>æ¥ä¸‹æ¥æˆ‘ä»¬è¿›è¡Œç¬¬ä¸€æ¬¡åè½¬ï¼Œ<strong>head.next</strong> æŒ‡å‘è™šæ‹Ÿçš„ç©ºç»“ç‚¹ï¼Œä¸”åç»­é“¾è¡¨ä¿¡æ¯æ²¡æœ‰ä¸¢å¤±ã€‚</p>
<center>
    <img src="../images/revert_list_5.png" width="400"/>
</center>

<p>ä¸‰ä¸ªæŒ‡é’ˆä¸€èµ·å¾€åç§»åŠ¨ä¸€ä¸ªå•ä½ã€‚æˆ‘ä»¬å‘ç°æ­¤æ—¶é“¾è¡¨åˆå›åˆ°äº†æœ€åˆçš„çŠ¶æ€ã€‚</p>
<center>
    <img src="../images/revert_list_6.png" width="400"/>
</center>


<p>è‡³æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•å†™å‡ºå¦‚ä¸‹ä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ListNode <span class="title">reverseIteratively</span><span class="params">(ListNode head)</span> </span>&#123;</span><br><span class="line">    ListNode pre = <span class="keyword">null</span>;</span><br><span class="line">    ListNode next = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (head != <span class="keyword">null</span>) &#123;</span><br><span class="line">        next = head.next;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ”¹å˜æŒ‡é’ˆæ–¹å‘ï¼Œå¯¹ç¬¬ä¸€ä¸ªèŠ‚ç‚¹æ¥è¯´ï¼Œä»–çš„å‰ä¸€ä¸ªèŠ‚ç‚¹æ˜¯null</span></span><br><span class="line">        head.next = pre;</span><br><span class="line">        <span class="comment">//å‘å‰ç§»åŠ¨ä¸¤ä¸ªæŒ‡é’ˆ</span></span><br><span class="line">        pre = head;</span><br><span class="line">        head = next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> pre;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p>æ€è€ƒï¼š<br>ä½ èƒ½ä½¿ç”¨é€’å½’çš„æ–¹å¼æ”¹å†™ä¸Šè¿°ä»£ç é€»è¾‘å—ï¼Ÿ</p>
]]></content>
      <categories>
        <category>è®¡ç®—æœº</category>
      </categories>
      <tags>
        <tag>LeetCode</tag>
        <tag>ç®—æ³•</tag>
        <tag>List</tag>
      </tags>
  </entry>
  <entry>
    <title>æ— ç­‰çº§CSPä¸­çš„æ­»é”</title>
    <url>/model-csp-deadlocks.html</url>
    <content><![CDATA[<h4 id="ç®€ä»‹ï¼š"><a href="#ç®€ä»‹ï¼š" class="headerlink" title="ç®€ä»‹ï¼š"></a>ç®€ä»‹ï¼š</h4><p>æœ¬æ–‡æ˜¯ Roman Elizarov å…³äºCSPä¸­äº§ç”Ÿæ­»é”é—®é¢˜çš„è®¨è®ºï¼Œè§£é‡Šäº†å…¶ä¸­çš„åŸå› ï¼Œå¹¶é€æ­¥ç»™å‡ºäº†ä¸€ç§è§£å†³æ–¹æ¡ˆã€‚éƒ¨åˆ†ç¿»è¯‘ä¸æ°å½“çš„å¯å‚è€ƒ<a href="https://elizarov.medium.com/deadlocks-in-non-hierarchical-csp-e5910d137cc">åŸæ–‡</a></p>
<h4 id="åŸæ–‡ï¼š"><a href="#åŸæ–‡ï¼š" class="headerlink" title="åŸæ–‡ï¼š"></a>åŸæ–‡ï¼š</h4><p>ä¼—æ‰€å‘¨çŸ¥ï¼Œä½¿ç”¨é”ä¿æŠ¤å…±äº«å¯å˜çŠ¶æ€å¯èƒ½ä¼šå¯¼è‡´æ­»é”ï¼Œä½†å¾ˆå°‘æœ‰äººçŸ¥é“ï¼Œä½¿ç”¨æ— å…±äº«å¯å˜çŠ¶æ€çš„CSPæˆ–actoræ¨¡å‹ä¹Ÿä¼šå¯¼è‡´æ­»é”ï¼Œå°½ç®¡å®ƒä»¬å¹¶ä¸ä½¿ç”¨é”ã€‚å®ƒçš„æ­»é”ä»¥å¦ä¸€ç§æ–¹å¼è¡¨ç°ï¼šé€šä¿¡æ­»é”ã€‚</p>
<p>è¦çŸ¥é“ï¼Œæ­»é”çš„æ­£å¼å®šä¹‰å¹¶æ²¡æœ‰ç›´æ¥ä¸é”è”ç³»åœ¨ä¸€èµ·ã€‚å½“æ¯ä¸ªè¿›ç¨‹éƒ½åœ¨å¾ªç¯ç­‰å¾…ä¸‹ä¸€ä¸ªè¿›ç¨‹æ—¶ï¼Œè¿™ç»„è¿›ç¨‹(çº¿ç¨‹/åç¨‹/å‚ä¸è€…)å°±å¤„äºæ­»é”çŠ¶æ€ã€‚åé¢æˆ‘ä»¬ä¼šçœ‹ä¸ªä¾‹å­ï¼Œè¿™é‡Œå…ˆé“ä¸ªæ­‰ï¼Œä¹‹å‰æ²¡å¼ºè°ƒè¿™ä¸ªé—®é¢˜ã€‚</p>
<h4 id="The-stage"><a href="#The-stage" class="headerlink" title="The stage"></a>The stage</h4><p>åœ¨2018å¹´çš„KotlinConfæˆ‘å‘è¡¨äº†é¢˜ä¸ºâ€Kotlinåç¨‹å®è·µâ€çš„æ¼”è®²ï¼Œå…¶ä¸­è®²åˆ°äº†å¯¹äºæ„å»ºå¯ä¿¡èµ–è½¯ä»¶æ¥è¯´ç»“æ„æ€§å¹¶å‘æ˜¯é‡è¦çš„ï¼Œä¸”ä»‹ç»äº†CSPçš„ä¸€äº›é«˜çº§æ¦‚å¿µã€‚å…¶ä¸­ä¸€ä¸ªéƒ¨åˆ†æœ‰ç‚¹é—®é¢˜ã€‚å¦‚æœä½ æŒ‰ç…§æ¼”è®²ä¸­ä¸€å­—ä¸å·®çš„å†™å®Œä»£ç ä¼šå¯¼è‡´ä¸€ä¸ªæ­»é”ã€‚ä¸çŸ¥ä½•æ•…ï¼Œæˆ‘æ‰è¿›äº†è¿™ä¸ªé™·é˜±ï¼Œä»¥ä¸ºå®ƒå¯¹æˆ‘æ¥è¯´æ˜¯å®‰å…¨çš„ï¼Œä½†ä¸æ˜¯ã€‚è®©æˆ‘ä»¬æ¥åˆ†æä¸€ä¸‹</p>
<p>é¦–å…ˆæ¥è®²ï¼Œå¦‚æœåº”ç”¨è¢«ç»„ç»‡æˆæ•°æ®å¤„ç†ç®¡é“ï¼Œæ¶ˆæ¯è¿›å…¥ç³»ç»Ÿï¼Œè¢«ä¸åŒçš„åç¨‹é¡ºåºå¤„ç†ï¼Œæœ€åè¢«é€å‡ºç³»ç»Ÿï¼Œé‚£ä¹ˆè¿™ç§CSPé£æ ¼çš„æ¶æ„ï¼ŒåŒ…æ‹¬actoræ¨¡å¼ï¼Œéƒ½æ˜¯å®‰å…¨çš„ã€‚æ›´å¹¿æ³›åœ°è¯´ï¼Œåªè¦ä»£ç å…·æœ‰åç¨‹çš„å±‚æ¬¡ç»“æ„(æˆ–æœ‰å‘æ— ç¯å›¾)ï¼Œä¸Šæ¸¸åç¨‹åªå‘ä¸‹æ¸¸å‘é€æ¶ˆæ¯ï¼Œä¸”æ¯ä¸ªåç¨‹åœ¨åŒä¸€ä¸ªåœ°æ–¹æ¥æ”¶ä¼ è¿‡æ¥çš„æ¶ˆæ¯å¹¶å‘ä¸‹æ¸¸ä¼ é€’å“åº”æ¶ˆæ¯ï¼Œä»£ç å°±ä¸ä¼šå‡ºç°æ­»é”ã€‚</p>
<center>
    <img src="../images/deadlock-dga.png" width="500"/>
</center>


<p>ç„¶è€Œåœ¨æˆ‘çš„æ¼”è®²ä¸­ï¼Œæˆ‘è‰æ‹Ÿäº†ä¸€ä¸ªæ•°æ®å¤„ç†å¾ªç¯çš„æ¶æ„ï¼Œä¸‹è½½å™¨åç¨‹å‘ä»»åŠ¡æ± å‘é€<code>locations</code>ï¼Œå¹¶ä»ä»»åŠ¡æ± è·å–ç»“æœï¼š</p>
<center>
    <img src="../images/deadlock-csp-downloader.png" width="500"/>
</center>

<p>æˆ‘æ¼”è®²ä¸­çš„ä¾‹å­çš„æ¶æ„åŸºäº3ä¸ªchannelï¼š<code>references</code>ã€<code>locations</code>ã€<code>contents</code>ã€‚ä¸‹è½½åç¨‹åŒ…å«ä»¥ä¸‹é€»è¾‘ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">    select&lt;<span class="built_in">Unit</span>&gt; &#123;                                   </span><br><span class="line">        references.onReceive &#123; ref -&gt;                <span class="comment">// (1)</span></span><br><span class="line">            <span class="keyword">val</span> loc = ref.resolveLocation()</span><br><span class="line">            ... </span><br><span class="line">            locations.send(loc)                      <span class="comment">// (2)</span></span><br><span class="line">        &#125;</span><br><span class="line">        contents.onReceive &#123; (loc, content) -&gt; ... &#125; <span class="comment">// (3)</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Downloaderä»<code>references</code>é€šé“(1)æ¥æ”¶ï¼Œè§£æå¯¹ä½ç½®çš„å¼•ç”¨å¹¶å°†å®ƒä»¬å‘é€åˆ°<code>locations</code>é€šé“(2)ã€‚å®ƒè¿˜é€šè¿‡ä»<code>contents</code>é€šé“(3)æ¥æ”¶æ¥è‡ªworkersçš„ç»“æœæ¥æ›´æ–°å…¶çŠ¶æ€ã€‚å¦å¤–ï¼Œworksæœ‰ä»¥ä¸‹ä»£ç :</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> (loc <span class="keyword">in</span> locations) &#123;                             <span class="comment">// (4)</span></span><br><span class="line">    <span class="keyword">val</span> content = downloadContent(loc)         </span><br><span class="line">    contents.send(LocContent(loc, content))          <span class="comment">// (5)</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä»<code>locations</code>é€šé“æ¥æ”¶æ¶ˆæ¯ï¼ˆ4ï¼‰ï¼Œå¹¶å‘é€ä¸‹è½½åçš„å†…å®¹å»<code>contents</code>é€šé“ï¼ˆ5ï¼‰</p>
<p>å³ä½¿åœ¨ä¸¤æ®µé€šä¿¡çš„ä»£ç ä¸­ä¹Ÿå¾ˆéš¾éµå¾ªé€»è¾‘ï¼Œä½†åœ¨CSPä¸­æœ‰ä¸€ç§æ–¹ä¾¿çš„æ–¹æ³•æ¥å¯è§†åŒ–å®ƒã€‚æˆ‘ä»¬å¯ä»¥ç”¨é€šä¿¡æœ‰é™çŠ¶æ€æœº(CFSM)è¡¨ç¤ºæˆ‘ä»¬çš„ç³»ç»Ÿã€‚è¿™äº›çŠ¶æ€ç›¸å½“äºæŒ‚èµ·ç‚¹å’Œå‘é€šä¿¡çš„è½¬å˜è¿‡ç¨‹:</p>
<center>
    <img src="../images/deadlock-csp-cfsm.png" width="500"/>
</center>

<p>ä¸ºäº†ç®€æ´èµ·è§ï¼Œä¸Šå›¾ä¸­é€šé“åç®€å†™ã€‚receive -&gt; rcvã€send -&gt; snd ã€‚ä¸‹è½½å™¨ä¸»å¾ªç¯ä¸­çš„<code>select</code>è¯­å¥ç›¸å½“äºD0çŠ¶æ€ï¼Œå®ƒèƒ½æ¥æ”¶æ¥è‡ª<code>references</code>é€šé“çš„æ¶ˆæ¯(1)æˆ–è€…æ¥è‡ª<code>contents</code>é€šé“çš„æ¶ˆæ¯(3)ï¼Œå½“æ¥æ”¶åˆ°æ¥è‡ª<code>references</code>æ¶ˆæ¯ï¼Œåˆ‡æ¢åˆ°çŠ¶æ€D1ï¼Œç­‰å¾…å‘é€æ¶ˆæ¯å»<code>locations</code>é€šé“ï¼Œå¦‚å›¾ä¸­ï¼š(2)l.snd</p>
<h4 id="Deadlock-Demo"><a href="#Deadlock-Demo" class="headerlink" title="Deadlock Demo"></a>Deadlock <a href="https://github.com/elizarov/DeadlocksInCSP">Demo</a></h4><p>æˆ‘ç”¨æ¨¡æ‹Ÿæ•°æ®ç±»çš„æ–¹å¼å®Œå–„äº†æ¼”è®²ä¸­çš„ä»£ç ï¼ŒåŠ å…¥äº†<code>delay(10)</code>çš„<code>downloadContent</code>æ–¹æ³•ã€‚mainå‡½æ•°åˆ™æŒç»­å‘é€è¯·æ±‚ç»™ä¸‹è½½å™¨çš„<code>references</code>é€šé“ï¼Œå®ƒæœ‰4ä¸ªworkersä¸”å¸¦3ç§’è¶…æ—¶é™åˆ¶ã€‚æ­¤é¡¹ç›®å¯ä»¥å®Œæ•´çš„è¿è¡Œ,æ­£å¸¸æƒ…å†µä¸‹3såº”è¯¥å¤„ç†1000æ¬¡è¯·æ±‚ã€‚</p>
<p>å½“ä½ è¿è¡Œè¯¥é¡¹ç›®æ—¶ï¼Œä½ ä¼šå‘ç°åªå¤„ç†äº†4æ¬¡è¯·æ±‚ï¼ˆå’Œæˆ‘ä»¬å®šä¹‰çš„workeræ•°é‡ä¸€æ ·ï¼‰å°±æŒ‚èµ·äº†ï¼Œç›´åˆ°3sè¶…æ—¶ã€‚æ­¤å¤–ï¼Œå®ƒæ²¡æœ‰ä»»ä½•éšæœºæ€§ï¼Œå› ä¸ºå®ƒæ˜¯åœ¨å•çº¿ç¨‹çš„runBlockingä¸Šä¸‹æ–‡ä¸­è¿è¡Œçš„ã€‚</p>
<p>ä¸ºäº†è¯´æœä½ ï¼ˆè¿˜æœ‰æˆ‘è‡ªå·±ï¼‰ï¼Œè¿™æ˜¯CSPå†…åœ¨çš„è¡Œä¸ºè€Œä¸æ˜¯Kotlinå®ç°çš„bugï¼Œæˆ‘ç”¨Goè¯­è¨€å®ç°äº†ä¸€éã€‚Goè¯­è¨€å†…å»ºçš„æ­»é”æ£€æµ‹å™¨ç«‹å³ç»™å‡ºäº†æç¤ºï¼š<em>all goroutines are asleep â€” deadlock</em> ï¼Œåˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆå‘¢ï¼Ÿ</p>
<p>å¼€å§‹æ—¶æ‰€æœ‰çš„workerå®Œæˆåˆå§‹åŒ–å¤„äºW1çŠ¶æ€ï¼Œç„¶åå°è¯•å‘é€å›å¤ä¸‹è½½å™¨çš„æ¶ˆæ¯å»<code>contents</code>é€šé“(5)ï¼Œä½†å®ƒæ˜¯ä¸€ä¸ªå¯¹æ¥é€šé“ï¼Œä¸‹è½½å™¨ä¸èƒ½ç«‹é©¬æ”¶åˆ°ã€‚ä¸‹è½½å™¨å¤„äºD1æ­£å°è¯•å‘é€æ¶ˆæ¯å»<code>locations</code>é€šé“(2)ï¼Œä½†ç”±äºworkeréƒ½åœ¨å°è¯•å‘é€æ‰€ä»¥æ— æ³•æ¥æ”¶ã€‚æ­»é”å‘ç”Ÿäº†ï¼Œæ‰€æœ‰çš„åç¨‹éƒ½åœ¨ç­‰å¾…ã€‚</p>
<center>
    <img src="../images/deadlock-csp-why.png" width="500"/>
</center>

<h4 id="Solutions-that-do-not-work"><a href="#Solutions-that-do-not-work" class="headerlink" title="Solutions that do not work"></a>Solutions that do not work</h4><p>é—®é¢˜å¥½åƒå‡ºåœ¨<code>select</code>è¡¨è¾¾å¼ã€‚ä¿®å¤å®ƒå¾ˆç®€å•ã€‚ç›¸å¯¹äºç”±ä¸‹è½½å™¨é€šè¿‡selectå¤„ç†æ¥è‡ª<code>references</code>å’Œ<code>contents</code>çš„æ¶ˆæ¯ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨actoræ¨¡å‹ä½œä¸ºåç¨‹é‡å†™ä¸‹è½½å™¨ï¼Œå®ƒæœ‰ç‹¬ç«‹çš„mailboxé€šé“æ¥å¤„ç†å‘é€è¿‡æ¥çš„æ¶ˆæ¯ã€‚</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> (msg <span class="keyword">in</span> mailbox) &#123;</span><br><span class="line">    <span class="keyword">when</span> (msg) &#123;</span><br><span class="line">        <span class="keyword">is</span> Reference -&gt; ...</span><br><span class="line">        <span class="keyword">is</span> LocContent -&gt; ...</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç„¶è€Œï¼Œactoræ¨¡å‹ä¹Ÿä¸èƒ½é¿å…æ­»é”ï¼Œè¿™ç§æ–¹å¼å’ŒåŸæ¥ä¸€æ ·ä»£ç å¾ˆå¿«è¢«æŒ‚èµ·ã€‚ä»–ä»¬çš„é€šè®¯çŠ¶æ€æœºæ˜¯ç›¸åŒçš„ã€‚</p>
<p>å¦ä¸€ä¸ªå¯èƒ½è¢«æŒ‡è´£çš„æ˜¯é›†åˆä¿¡é“â€”â€”æ²¡æœ‰ç¼“å†²åŒºçš„ä¿¡é“ï¼Œå› ä¸ºå®ƒä»¬åœ¨å¦ä¸€ç«¯æ²¡æœ‰æ¥æ”¶å™¨çš„æƒ…å†µä¸‹ä¼šæš‚åœå‘é€ã€‚å³ä½¿æˆ‘ä»¬ç»™<code>contents</code>å’Œ<code>locations</code>æ·»åŠ bufferä¹Ÿä¸èƒ½è§£å†³æ­¤é—®é¢˜ï¼Œåªæ˜¯å‡å°‘äº†é—®é¢˜å‡ºç°çš„æ¦‚ç‡æˆ–å»¶è¿Ÿå‡ºç°ã€‚bufferè¶Šå¤§å‡ºç°çš„æ¦‚ç‡è¶Šä½ï¼Œä½†æ— æ³•å®Œå…¨é¿å…æ­»é”çš„å‘ç”Ÿï¼Œä¸€æ—¦bufferæ»¡äº†å‘é€å™¨è¿˜æ˜¯ä¼šæŒ‚èµ·å¹¶å‘ç”Ÿæ­»é”ã€‚</p>
<h4 id="Unlimited-capacity-channels"><a href="#Unlimited-capacity-channels" class="headerlink" title="Unlimited-capacity channels"></a>Unlimited-capacity channels</h4><p>ä¸€ç§æ˜ç¡®çš„é¿å…æ­»é”çš„è§£å†³æ–¹æ¡ˆæ˜¯å¯¹è¢«é€šè®¯æ­»é”å½±å“çš„channelä¸­çš„è‡³å°‘ä¸€ä¸ªä½¿ç”¨ä¸é™å¤§å°çš„bufferï¼Œ<a href="https://github.com/elizarov/DeadlocksInCSP/blob/master/src/DownloaderWithUnlimitedBuffer.kt#L49">è¿™é‡Œ</a> çš„ä»£ç å¯¹<code>contents</code>é€šé“ä½¿ç”¨äº†æ— é™åˆ¶bufferï¼Œä¼¼ä¹èƒ½æ­£å¸¸å·¥ä½œã€‚</p>
<p>ç„¶è€Œï¼Œé€šè¿‡å–æ¶ˆé€šé“ç¼“å†²åŒºçš„é™åˆ¶ï¼Œæˆ‘ä»¬ä¸§å¤±äº†CPSç¼–ç¨‹é£æ ¼çš„åˆ©æ¶¦ä¸°åšçš„å±æ€§-è‡ªåŠ¨èƒŒå‹ä¼ æ’­.å¦‚æœæ¥è‡ªé€šé“çš„æ¶ˆæ¯çš„æ¥æ”¶æ–¹æ¯”å‘é€æ–¹æ…¢ï¼Œåˆ™å‘é€æ–¹å°†æŒ‚èµ·åœ¨å…¨ç¼“å†²åŒºä¸Šä»¥è‡ªåŠ¨å‡æ…¢é€Ÿåº¦ã€‚æœ‰äº†æ— é™å®¹é‡çš„é€šé“ï¼Œå°±ä¸ä¼šå‘ç”Ÿè¿™ç§æƒ…å†µï¼Œç®¡ç†èƒŒå‹çš„ä»»åŠ¡å®Œå…¨ç”±åº”ç”¨ç¨‹åºå¼€å‘äººå‘˜æ‰¿æ‹…ã€‚å¦‚æœä¸èƒ½ç®¡ç†èƒŒå‹ï¼Œç³»ç»Ÿæœ€ç»ˆå¯èƒ½ä¼šè€—å°½å†…å­˜ï¼Œåœ¨å…¶ç¼“å†²åŒºä¸­æ”¶é›†è¶Šæ¥è¶Šå¤šçš„æ¶ˆæ¯ã€‚</p>
<p>åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼ŒæŠŠ<code>locations</code>é€šé“è®¾ç½®æˆæ— é™bufferä¼šå®Œå…¨ç§»é™¤å¯¹ä¼ å…¥å¼•ç”¨çš„èƒŒå‹ç®¡ç†ï¼Œå› ä¸ºå³ä½¿æ‰€æœ‰çš„workeréƒ½å¤„äºå¿™ç¢ŒçŠ¶æ€ï¼Œä¸‹è½½å™¨ä¹Ÿå°†å‘é€æ‰€æœ‰çš„æ¶ˆæ¯å»<code>locations</code>é€šé“ã€‚<br>æŠŠcontentsé€šé“è®¾ç½®æˆæ— é™bufferä¼šæ›´å®‰å…¨ï¼Œå› ä¸ºå®ƒåªå½±å“ä¸‹è½½å†…å®¹çš„æœ€ç»ˆå¤„ç†ã€‚ç„¶è€Œï¼Œåœ¨æ— é™å®¹é‡çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬é¢ä¸´çš„é£é™©æ˜¯ï¼Œä¸‹è½½å™¨ä¼šè¢«ä¼ å…¥çš„<code>references</code>æ·¹æ²¡ï¼Œæ°¸è¿œæ— æ³•å¤„ç†ä¸‹è½½çš„å†…å®¹ã€‚è¿™ä½¿æˆ‘ä»¬ç¦»æœ€ç»ˆè§£å†³æ–¹æ¡ˆæ›´è¿‘ä¸€æ­¥ã€‚</p>
<h4 id="Solutions-that-do-work"><a href="#Solutions-that-do-work" class="headerlink" title="Solutions that do work"></a>Solutions that do work</h4><p>æˆ‘ä»¬è°ƒæ•´ä¸€ä¸‹ä¸‹è½½å™¨åç¨‹ä¸­<code>select</code>è¡¨è¾¾å¼çš„é¡ºåºï¼Œä»¥ä¾¿å…ˆæ£€æŸ¥<code>contents</code>é€šé“ï¼Œä¹Ÿå°±æ˜¯è¯´<code>contents</code>é€šé“çš„æ¶ˆæ¯ä¼˜å…ˆçº§é«˜äº<code>references</code>é€šé“ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line">select&lt;<span class="built_in">Unit</span>&gt; &#123;</span><br><span class="line">    contents.onReceive &#123; ... &#125;</span><br><span class="line">    references.onReceive &#123; </span><br><span class="line">        ... </span><br><span class="line">        locations.send(loc)                      <span class="comment">// (2)</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>å®ƒæœ¬èº«å¹¶æ²¡æœ‰è§£å†³è¿™ä¸ªé—®é¢˜(ä½ å¯ä»¥åœ¨è¿™é‡ŒéªŒè¯ä»£ç ),ä½†å®ƒç»™äº†ä¸€ä¸ªæœ‰ç”¨çš„å±æ€§â€”â€”<br>ä¸‹è½½å™¨åªæœ‰åœ¨æ²¡æœ‰workerè¢«æŒ‚èµ·ä¸”workerå‡†å¤‡å‘é€æ¶ˆæ¯å»<code>contents</code>é€šé“æ—¶ï¼Œæ‰å‘é€æ¶ˆæ¯å»<code>locations</code>é€šé“(2)ã€‚ç°åœ¨ï¼Œæä¾›è‡³å°‘ä¸€ä¸ªbufferç»™<code>contents</code>é€šé“å°±è¶³å¤Ÿäº†ï¼Œä»¥ç¡®ä¿è‡³å°‘æœ‰ä¸€ä¸ªworkerå¯ä»¥åœ¨(5)å‘é€å…¶å†…å®¹ï¼Œå¹¶åœ¨(4)å†æ¬¡å¼€å§‹ä»<code>locations</code>æ¥æ”¶ï¼Œä»è€Œå…è®¸ä¸‹è½½ç¨‹åºç»§ç»­è¿›è¡Œ:</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">val</span> contents = Channel&lt;LocContent&gt;(<span class="number">1</span>)</span><br></pre></td></tr></table></figure>

<p><a href="https://github.com/elizarov/DeadlocksInCSP/blob/master/src/DownloaderFixedPriority.kt">è¿™é‡Œ</a> æ˜¯èƒ½è¿è¡Œçš„ä»£ç ã€‚</p>
<p>æ³¨æ„ï¼Œå®ƒæ˜¯å¦‚ä½•åœ¨3ç§’å†…å¤„ç†æ¯”ä¹‹å‰çš„æ— é™æ¸ é“â€œè§£å†³æ–¹æ¡ˆâ€æ›´å¤šçš„ä¸‹è½½çš„ã€‚æ­¤å¤–ï¼Œç”±äº<code>contents</code>é€šé“å¤„ç†å…·æœ‰æœ€é«˜ä¼˜å…ˆçº§ï¼Œç°åœ¨å¯ä»¥å®‰å…¨åœ°æ‹¥æœ‰æ— é™å®¹é‡çš„<code>contents</code>é€šé“ã€‚å®ƒåœ¨ç¼“å†²åŒºä¸­ä¿å­˜çš„æ¶ˆæ¯æ°¸è¿œä¸ä¼šè¶…è¿‡å·¥ä½œäººå‘˜çš„æ•°é‡åŠ 1(ä¸ºä»€ä¹ˆæ˜¯åŠ 1 ?è¿™æ˜¯ç•™ç»™è¯»è€…çš„ç»ƒä¹ )ã€‚</p>
<p>è¿˜æœ‰ä¸€ç§æ›¿ä»£è§£å†³æ–¹æ¡ˆï¼Œå®ƒå®Œå…¨ä¸ä½¿ç”¨ç¼“å†²é€šé“ï¼Œå¯ä»¥å®Œç¾åœ°ä¸ä»»ä½•å®¹é‡çš„é€šé“ä¸€èµ·å·¥ä½œã€‚å®ƒåŠ å€<code>select</code>ï¼Œä»¥é¿å…åœ¨<code>locations.send(loc)</code>ä¸ŠæŒ‚èµ·ä¸‹è½½ç¨‹åºï¼Œå°†è¿™ä¸ªå‘é€æ“ä½œæŠ˜å ä¸ºä¸€ä¸ª<code>select</code>ã€‚å®ƒå®é™…ä¸Šæ˜¯CFSMæ¨¡å‹ä¸­è¡¨ç¤ºå’Œåˆ†æçš„æœ€ç®€å•çš„ä¸€ä¸ªï¼Œä½†æ˜¯æˆ‘ç°åœ¨ä¸ä¼šè¯¦ç»†ä»‹ç»å®ƒï¼ŒæŠŠå®ƒç•™ç»™å°†æ¥çš„æ•…äº‹ã€‚ä½ å¯ä»¥çœ‹ä¸€ä¸‹<a href="https://github.com/elizarov/DeadlocksInCSP/blob/master/src/DownloaderFixedSelect.kt#L16">è¿™é‡Œ</a> å¯¹åº”çš„ä»£ç å¹¶åœ¨playgroundä¸­è¿è¡Œå®ƒã€‚</p>
<h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><p>é€šä¿¡å¾ªç¯(éDAGæ¨¡å¼)å¯èƒ½å¹¶å°†å¯¼è‡´é€šé“å®¹é‡æœ‰é™çš„é€šä¿¡æ­»é”ï¼Œé™¤éä½¿ç”¨ä¸€äº›æ­»é”é¢„é˜²ç­–ç•¥ã€‚å¦‚æœåœ¨åº”ç”¨ç¨‹åºä¸­é‡åˆ°æ­»é”ï¼Œåœ¨äº†è§£å‘ç”Ÿäº†ä»€ä¹ˆä¹‹å‰ï¼Œä¸è¦å°è¯•ä½¿ç”¨ç¼“å†²é€šé“è§£å†³å®ƒï¼Œå¦åˆ™å¯èƒ½ä¼šæŠŠé—®é¢˜æ©ç›–èµ·æ¥ã€‚</p>
<p>è¯·åœ¨æœ¬æ–‡çš„è¯„è®ºä¸­åˆ†äº«æ›´å¤šè§£å†³è¿™ç§ç‰¹æ®Šé€šä¿¡å¾ªç¯æ­»é”çš„æœ‰æ•ˆè§£å†³æ–¹æ¡ˆã€‚Kotlinå’Œå…¶ä»–CSP/actorè¿è¡Œæ—¶ä¸­çš„ä»£ç éƒ½æ˜¯å—æ¬¢è¿çš„(è¯·æä¾›é“¾æ¥ï¼Œä¸è¦å°†ä»£ç ç²˜è´´åˆ°è¯„è®ºä¸­)ã€‚</p>
<h4 id="Credits"><a href="#Credits" class="headerlink" title="Credits"></a>Credits</h4><p>æˆ‘è¦æ„Ÿè°¢Alexey Seminï¼Œä»–é€šè¿‡<a href="https://github.com/Kotlin/kotlinx.coroutines/issues/797">è¿™ä¸ª</a> github-issueæŠ¥å‘Šäº†è¿™ä¸ªé—®é¢˜ï¼Œå¹¶æ„Ÿè°¢Alexander Goryninåœ¨Kotlin Slacké‡Œè”ç³»äº†æˆ‘ã€‚è¿˜è¦æ„Ÿè°¢Simon Wirtzå’ŒSean McQuillanå¯¹æœ¬æ–‡è‰ç¨¿çš„æœ‰ç”¨è¯„è®ºã€‚</p>
]]></content>
      <categories>
        <category>è®¡ç®—æœº</category>
      </categories>
      <tags>
        <tag>Kotlin</tag>
        <tag>Concurrency</tag>
      </tags>
  </entry>
  <entry>
    <title>ä¸€å‘¨å·¥ä½œæ€»ç»“</title>
    <url>/my-work-of-this-week-01.html</url>
    <content><![CDATA[<h5 id="æ—¶é—´ï¼š2021-11-22-è‡³-2021-11-26"><a href="#æ—¶é—´ï¼š2021-11-22-è‡³-2021-11-26" class="headerlink" title="æ—¶é—´ï¼š2021-11-22 è‡³ 2021-11-26"></a>æ—¶é—´ï¼š2021-11-22 è‡³ 2021-11-26</h5><h6 id="2021-11-22-å‘¨ä¸€ï¼š"><a href="#2021-11-22-å‘¨ä¸€ï¼š" class="headerlink" title="2021-11-22 å‘¨ä¸€ï¼š"></a>2021-11-22 å‘¨ä¸€ï¼š</h6><ul>
<li>å®Œæˆæ•°æ®è¿ç§»é€»è¾‘<ul>
<li>å†…å¤–ç½®SDå¡å…¼å®¹</li>
<li>å­ä¸»è´¦å·å…¼å®¹</li>
<li>Android-11å…¼å®¹</li>
</ul>
</li>
<li>æ–‡ä»¶æ¢å¤é€»è¾‘æ”¯æŒæ—§æ–‡ä»¶</li>
<li>ä¼˜åŒ–æ–‡ä»¶æ¢å¤ä¸äº§ç”Ÿæ–°æ•°æ®åº“è®°å½•</li>
</ul>
<h6 id="2021-11-23-å‘¨äºŒï¼š"><a href="#2021-11-23-å‘¨äºŒï¼š" class="headerlink" title="2021-11-23 å‘¨äºŒï¼š"></a>2021-11-23 å‘¨äºŒï¼š</h6><ul>
<li>å„æ¥å£åŸŸåæ¢æ–°</li>
<li>è°ƒæ•´å„é€»è¾‘è‡³è¿ç§»å®Œæˆåæ‰§è¡Œ</li>
</ul>
<h6 id="2021-11-24-å‘¨ä¸‰ï¼š"><a href="#2021-11-24-å‘¨ä¸‰ï¼š" class="headerlink" title="2021-11-24 å‘¨ä¸‰ï¼š"></a>2021-11-24 å‘¨ä¸‰ï¼š</h6><ul>
<li>å´©æºƒæ—¥å¿—ä¸ŠæŠ¥åœ°å€</li>
<li>deeplinkåè®®æ›¿æ¢</li>
</ul>
<h6 id="2021-11-25-å‘¨å››ï¼š"><a href="#2021-11-25-å‘¨å››ï¼š" class="headerlink" title="2021-11-25 å‘¨å››ï¼š"></a>2021-11-25 å‘¨å››ï¼š</h6><ul>
<li>åˆå¹¶é©¬ç”²åŒ…åˆ†æ”¯ä¸äº‘ç›˜åˆ†æ”¯ï¼Œåˆå¹¶æ•°æ®åº“å‡çº§ä¸æ•°æ®è¿ç§»é€»è¾‘</li>
<li>æ›¿æ¢åº”ç”¨åç§°</li>
</ul>
<h6 id="2021-11-26-å‘¨äº”ï¼š"><a href="#2021-11-26-å‘¨äº”ï¼š" class="headerlink" title="2021-11-26 å‘¨äº”ï¼š"></a>2021-11-26 å‘¨äº”ï¼š</h6><ul>
<li>é©¬ç”²åŒ…å»æ‰æ¸ é“å’Œå‘è¾¾å›½å®¶çš„ç‰¹æœ‰é€»è¾‘ï¼Œèµ°å¸¸è§„é€»è¾‘</li>
<li>Facebookä¸‰æ–¹ç™»å½•åº”ç”¨æ³¨å†Œè·å–fb-app-id</li>
<li>æ¸…ç†ä¸å¿…è¦çš„æ‰“åŒ…äº§ç‰©</li>
<li>å¯ç”¨å¸¸é‡å†…è”å’ŒRæ–‡ä»¶å†…è”</li>
</ul>
<h6 id="æ€»ç»“ï¼š"><a href="#æ€»ç»“ï¼š" class="headerlink" title="æ€»ç»“ï¼š"></a>æ€»ç»“ï¼š</h6><p>æœ¬å‘¨å·¥ä½œå›´ç»•é©¬ç”²åŒ…ä¸Šçº¿å±•å¼€ï¼Œå·¥ä½œçç¢ä¸”ç¹æ‚ï¼Œéœ€è¦æ€è€ƒç»†èŠ‚é¿å…é—æ¼å’Œè€ƒè™‘ä¸å‘¨ã€‚</p>
]]></content>
      <categories>
        <category>å·¥ä½œ</category>
      </categories>
      <tags>
        <tag>å·¥ä½œ</tag>
      </tags>
  </entry>
  <entry>
    <title>ç»æµå­¦çš„åå¤§åŸç†</title>
    <url>/principles-of-economics.html</url>
    <content><![CDATA[<h4 id="ä¸€ã€äººä»¬å¦‚ä½•åšå‡ºå†³ç­–"><a href="#ä¸€ã€äººä»¬å¦‚ä½•åšå‡ºå†³ç­–" class="headerlink" title="ä¸€ã€äººä»¬å¦‚ä½•åšå‡ºå†³ç­–"></a>ä¸€ã€äººä»¬å¦‚ä½•åšå‡ºå†³ç­–</h4><h5 id="1-1-äººä»¬é¢ä¸´æƒè¡¡å–èˆ"><a href="#1-1-äººä»¬é¢ä¸´æƒè¡¡å–èˆ" class="headerlink" title="1.1 äººä»¬é¢ä¸´æƒè¡¡å–èˆ"></a>1.1 äººä»¬é¢ä¸´æƒè¡¡å–èˆ</h5><p>é€‰æ‹©ä¸€æ ·ä¸œè¥¿å°±æ„å‘³ç€ä½ è¦æ”¾å¼ƒå¦å¤–ä¸€æ ·ä¸œè¥¿ã€‚è®¤è¯†åˆ°ç”Ÿæ´»ä¸­çš„æƒè¡¡æ˜¯é‡è¦çš„ï¼Œå› ä¸ºäººä»¬åªæœ‰äº†è§£ä»–ä»¬å¯ä»¥å¾—åˆ°çš„é€‰æ‹©ï¼Œæ‰èƒ½ä½œå‡ºè‰¯å¥½çš„å†³ç­–ã€‚</p>
<h5 id="1-2-æŸç§ä¸œè¥¿çš„æˆæœ¬æ˜¯ä¸ºäº†å¾—åˆ°å®ƒè€Œæ”¾å¼ƒçš„ä¸œè¥¿"><a href="#1-2-æŸç§ä¸œè¥¿çš„æˆæœ¬æ˜¯ä¸ºäº†å¾—åˆ°å®ƒè€Œæ”¾å¼ƒçš„ä¸œè¥¿" class="headerlink" title="1.2 æŸç§ä¸œè¥¿çš„æˆæœ¬æ˜¯ä¸ºäº†å¾—åˆ°å®ƒè€Œæ”¾å¼ƒçš„ä¸œè¥¿"></a>1.2 æŸç§ä¸œè¥¿çš„æˆæœ¬æ˜¯ä¸ºäº†å¾—åˆ°å®ƒè€Œæ”¾å¼ƒçš„ä¸œè¥¿</h5><p>ä¸€ç§ä¸œè¥¿çš„æœºä¼šæˆæœ¬æ˜¯ä¸ºäº†å¾—åˆ°è¿™ç§ä¸œè¥¿æ‰€æ”¾å¼ƒçš„ä¸œè¥¿</p>
<h5 id="1-3-ç†æ€§äººè€ƒè™‘è¾¹é™…é‡"><a href="#1-3-ç†æ€§äººè€ƒè™‘è¾¹é™…é‡" class="headerlink" title="1.3 ç†æ€§äººè€ƒè™‘è¾¹é™…é‡"></a>1.3 ç†æ€§äººè€ƒè™‘è¾¹é™…é‡</h5><p>ç”Ÿæ´»ä¸­çš„è®¸å¤šå†³ç­–æ¶‰åŠåˆ°å¯¹ç°æœ‰è¡ŒåŠ¨è®¡åˆ’è¿›è¡Œå¾®å°çš„å¢é‡è°ƒæ•´ã€‚ ç»æµå­¦å®¶æŠŠè¿™äº›è°ƒæ•´ç§°ä¸ºè¾¹é™…å˜åŠ¨ã€‚<br>ä¸ªäººå’Œä¼ä¸šé€šè¿‡è€ƒè™‘è¾¹é™…é‡å°†ä¼šä½œå‡ºæ›´å¥½çš„å†³ç­–ã€‚åªæœ‰ä¸€ç§è¡ŒåŠ¨çš„è¾¹é™…æ”¶ç›Šå¤§äºè¾¹é™…æˆæœ¬ï¼Œä¸€ä¸ªç†æ€§å†³ç­–è€…æ‰ ä¼šé‡‡å–è¿™é¡¹è¡ŒåŠ¨ã€‚</p>
<h5 id="1-4-äººä»¬ä¼šå¯¹æ¿€åŠ±ä½œå‡ºååº”"><a href="#1-4-äººä»¬ä¼šå¯¹æ¿€åŠ±ä½œå‡ºååº”" class="headerlink" title="1.4 äººä»¬ä¼šå¯¹æ¿€åŠ±ä½œå‡ºååº”"></a>1.4 äººä»¬ä¼šå¯¹æ¿€åŠ±ä½œå‡ºååº”</h5><ul>
<li>ç”±äºç†æ€§äººé€šè¿‡æ¯”è¾ƒæˆæœ¬ä¸æ”¶ç›ŠğŸ‰åšå‡ºå†³ç­–ï¼Œæ‰€ä»¥ä»–ä»¬ä¼šå¯¹æ¿€åŠ±åšå‡ºååº”ã€‚</li>
<li>åœ¨åˆ†æä»»ä½•ä¸€ç§æ”¿ç­–æ—¶ï¼Œä¸ä»…åº”è¯¥è€ƒè™‘ç›´æ¥å½±å“ï¼Œè€Œä¸”è¿˜åº”è¯¥è€ƒ è™‘æ¿€åŠ±å‘ç”Ÿä½œç”¨çš„é—´æ¥å½±å“ã€‚</li>
<li>å¦‚æœæ”¿ç­–æ”¹å˜äº†æ¿€åŠ±ï¼Œå®ƒå°±å°†ä½¿äººä»¬æ”¹ å˜è‡ªå·±çš„è¡Œä¸ºã€‚</li>
</ul>
<h4 id="äºŒã€äººä»¬å¦‚ä½•ç›¸äº’å½±å“"><a href="#äºŒã€äººä»¬å¦‚ä½•ç›¸äº’å½±å“" class="headerlink" title="äºŒã€äººä»¬å¦‚ä½•ç›¸äº’å½±å“"></a>äºŒã€äººä»¬å¦‚ä½•ç›¸äº’å½±å“</h4><h5 id="2-1-è´¸æ˜“èƒ½ä½¿æ¯ä¸ªäººçš„çŠ¶å†µå˜å¾—æ›´å¥½"><a href="#2-1-è´¸æ˜“èƒ½ä½¿æ¯ä¸ªäººçš„çŠ¶å†µå˜å¾—æ›´å¥½" class="headerlink" title="2.1 è´¸æ˜“èƒ½ä½¿æ¯ä¸ªäººçš„çŠ¶å†µå˜å¾—æ›´å¥½"></a>2.1 è´¸æ˜“èƒ½ä½¿æ¯ä¸ªäººçš„çŠ¶å†µå˜å¾—æ›´å¥½</h5><p>è´¸æ˜“ä½¿å„å›½å¯ä»¥ä¸“ é—¨ä»äº‹è‡ªå·±æœ€æ“…é•¿æ´»åŠ¨ï¼Œå¹¶äº«æœ‰å¾ˆå¤šçš„å„ç§å„æ ·ç‰©å“ä¸åŠ³åŠ¡</p>
<h5 id="2-2-å¸‚åœºé€šå¸¸æ˜¯ç»„ç»‡ç»æµæ´»åŠ¨çš„ä¸€ç§å¥½æ–¹æ³•"><a href="#2-2-å¸‚åœºé€šå¸¸æ˜¯ç»„ç»‡ç»æµæ´»åŠ¨çš„ä¸€ç§å¥½æ–¹æ³•" class="headerlink" title="2.2 å¸‚åœºé€šå¸¸æ˜¯ç»„ç»‡ç»æµæ´»åŠ¨çš„ä¸€ç§å¥½æ–¹æ³•"></a>2.2 å¸‚åœºé€šå¸¸æ˜¯ç»„ç»‡ç»æµæ´»åŠ¨çš„ä¸€ç§å¥½æ–¹æ³•</h5><ul>
<li>åœ¨å¸‚åœºç»æµä¸­ï¼Œä¸­å¤®è®¡åˆ’è€…çš„å†³ç­–è¢«åƒç™¾ä¸‡ä¼ä¸šå’Œå®¶åº­çš„å†³ç­–æ‰€å–ä»£ã€‚</li>
<li>ä»·æ ¼å’Œåˆ©å·±å¼•å¯¼äººä»¬å†³ç­–</li>
<li>ä»·æ ¼å°±æ˜¯çœ‹ä¸è§çš„æ‰‹ç”¨æ¥æŒ‡å¼•ç»æµæ´»åŠ¨çš„å·¥å…·</li>
<li>å½“æ”¿åºœé˜»æ­¢ä»·æ ¼æ ¹æ®ä¾›æ±‚çŠ¶å†µè‡ªå‘è°ƒæ•´æ—¶ï¼Œä»–å°±é™åˆ¶äº†çœ‹ä¸è§çš„æ‰‹ğŸ¤šå¯¹ç»„æˆç»æµçš„åƒç™¾ä¸‡å®¶åº­ğŸ‘ªå’Œä¼ä¸šçš„å†³ç­–è¿›è¡Œåè°ƒçš„èƒ½åŠ›</li>
</ul>
<h5 id="2-3-æ”¿åºœæœ‰æ—¶å¯ä»¥æ”¹å–„å¸‚åœºç»“æœ"><a href="#2-3-æ”¿åºœæœ‰æ—¶å¯ä»¥æ”¹å–„å¸‚åœºç»“æœ" class="headerlink" title="2.3 æ”¿åºœæœ‰æ—¶å¯ä»¥æ”¹å–„å¸‚åœºç»“æœ"></a>2.3 æ”¿åºœæœ‰æ—¶å¯ä»¥æ”¹å–„å¸‚åœºç»“æœ</h5><ul>
<li>åªæœ‰åœ¨æ”¿åºœå®æ–½è§„åˆ™å¹¶ç»´æŠ¤å¯¹å¸‚åœºç»æµè‡³å…³é‡è¦çš„åˆ¶åº¦æ—¶ï¼Œçœ‹ä¸è§çš„æ‰‹æ‰èƒ½æ–½å±•å…¶é­”åŠ›ã€‚</li>
<li>çœ‹ä¸è§çš„æ‰‹ğŸ¤šæ˜¯å¼ºæœ‰åŠ›çš„ï¼Œä½†å¹¶ä¸æ˜¯æ— æ‰€ä¸èƒ½çš„ã€‚æ”¿åºœå¹²é¢„ç»æµçš„åŸå› æœ‰ä¸¤ç±»ï¼šä¿ƒè¿›æ•ˆç‡å’Œä¿ƒè¿›å¹³ç­‰ã€‚</li>
</ul>
<h4 id="ä¸‰ã€æ•´ä½“ç»æµå¦‚ä½•è¿è¡Œ"><a href="#ä¸‰ã€æ•´ä½“ç»æµå¦‚ä½•è¿è¡Œ" class="headerlink" title="ä¸‰ã€æ•´ä½“ç»æµå¦‚ä½•è¿è¡Œ"></a>ä¸‰ã€æ•´ä½“ç»æµå¦‚ä½•è¿è¡Œ</h4><h5 id="3-1-ä¸€å›½çš„ç”Ÿæ´»æ°´å¹³å–å†³äºå®ƒç”Ÿäº§ç‰©å“ä¸æœåŠ¡çš„èƒ½åŠ›"><a href="#3-1-ä¸€å›½çš„ç”Ÿæ´»æ°´å¹³å–å†³äºå®ƒç”Ÿäº§ç‰©å“ä¸æœåŠ¡çš„èƒ½åŠ›" class="headerlink" title="3.1 ä¸€å›½çš„ç”Ÿæ´»æ°´å¹³å–å†³äºå®ƒç”Ÿäº§ç‰©å“ä¸æœåŠ¡çš„èƒ½åŠ›"></a>3.1 ä¸€å›½çš„ç”Ÿæ´»æ°´å¹³å–å†³äºå®ƒç”Ÿäº§ç‰©å“ä¸æœåŠ¡çš„èƒ½åŠ›</h5><p>ç”Ÿäº§ç‡ï¼šæ¯å•ä½åŠ³åŠ¨æŠ•å…¥æ‰€ç”Ÿäº§çš„ç‰©å“ä¸æœåŠ¡æ•°é‡ã€‚</p>
<h5 id="3-2-å½“æ”¿åºœå‘è¡Œäº†è¿‡å¤šè´§å¸æ—¶ï¼Œç‰©ä»·ä¸Šå‡"><a href="#3-2-å½“æ”¿åºœå‘è¡Œäº†è¿‡å¤šè´§å¸æ—¶ï¼Œç‰©ä»·ä¸Šå‡" class="headerlink" title="3.2 å½“æ”¿åºœå‘è¡Œäº†è¿‡å¤šè´§å¸æ—¶ï¼Œç‰©ä»·ä¸Šå‡"></a>3.2 å½“æ”¿åºœå‘è¡Œäº†è¿‡å¤šè´§å¸æ—¶ï¼Œç‰©ä»·ä¸Šå‡</h5><h5 id="3-3-ç¤¾ä¼šé¢ä¸´é€šè´§è†¨èƒ€ä¸å¤±ä¸šä¹‹é—´çš„çŸ­æœŸæƒè¡¡å–èˆ"><a href="#3-3-ç¤¾ä¼šé¢ä¸´é€šè´§è†¨èƒ€ä¸å¤±ä¸šä¹‹é—´çš„çŸ­æœŸæƒè¡¡å–èˆ" class="headerlink" title="3.3 ç¤¾ä¼šé¢ä¸´é€šè´§è†¨èƒ€ä¸å¤±ä¸šä¹‹é—´çš„çŸ­æœŸæƒè¡¡å–èˆ"></a>3.3 ç¤¾ä¼šé¢ä¸´é€šè´§è†¨èƒ€ä¸å¤±ä¸šä¹‹é—´çš„çŸ­æœŸæƒè¡¡å–èˆ</h5><ul>
<li>è´§å¸çš„å¢åŠ åˆºæ¿€ç¤¾ä¼šçš„æ•´ä½“æ”¯å‡ºæ°´å¹³ï¼Œä»è€Œå¢åŠ å¯¹ç‰©å“ä¸æœåŠ¡çš„éœ€æ±‚</li>
<li>éœ€æ±‚çš„å¢åŠ éšç€æ—¶é—´çš„æ¨ç§»ï¼Œä¼šå¼•èµ·ä¼ä¸šæé«˜ç‰©ä»·ï¼ŒåŒæ—¶å®ƒä¹Ÿé¼“åŠ±ä¼ä¸šé›‡ä½£æ›´å¤šçš„å·¥äººğŸ‘·ï¼Œå¹¶ç”Ÿäº§æ›´å¤šçš„ç‰©å“ä¸æœåŠ¡</li>
<li>é›‡ä½£æ›´å¤šçš„å·¥äººğŸ‘·æ„å‘³ç€æ›´å°‘çš„å¤±ä¸šã€‚</li>
</ul>
]]></content>
      <categories>
        <category>ç»æµå­¦</category>
      </categories>
      <tags>
        <tag>ç»æµå­¦</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€Šå¼‚ç±»-ä¸ä¸€æ ·çš„æˆåŠŸå¯ç¤ºå½•ã€‹</title>
    <url>/%E3%80%8A%E5%BC%82%E7%B1%BB-%E4%B8%8D%E4%B8%80%E6%A0%B7%E7%9A%84%E6%88%90%E5%8A%9F%E5%90%AF%E7%A4%BA%E5%BD%95%E3%80%8B.html</url>
    <content><![CDATA[<h4 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h4><h6 id="ä¹¦ç±ç®€ä»‹"><a href="#ä¹¦ç±ç®€ä»‹" class="headerlink" title="ä¹¦ç±ç®€ä»‹"></a>ä¹¦ç±ç®€ä»‹</h6><table>
    <tr>
        <td><img src="../images/books/book-cover-yilei.jpg" width="100"/></td>
        <td>å¼‚ç±»ï¼šä¸ä¸€æ ·çš„æˆåŠŸå¯ç¤ºå½•</td>
    </tr>
</table>

<h6 id="å…³äºä½œè€…"><a href="#å…³äºä½œè€…" class="headerlink" title="å…³äºä½œè€…"></a>å…³äºä½œè€…</h6><p>é©¬å°”ç§‘å§†Â·æ ¼æ‹‰å¾·å¨å°”ï¼ˆMalcolm Gladwellï¼‰ï¼ˆ1963å¹´9æœˆ3æ—¥ï¼‰æ¯•ä¸šäºå¤šä¼¦å¤šå¤§å­¦çš„ä¸‰ä¸€å­¦é™¢ï¼Œä¸»ä¿®å†å²å­¦ï¼Œæ˜¯ä¸€ä½åŠ æ‹¿å¤§ä½œå®¶ã€è®°è€…å’Œæ¼”è®²è€…ï¼Œä»¥å…¶ç•…é”€ä¹¦å’Œåœ¨ã€Šçº½çº¦å®¢ã€‹æ‚å¿—ä¸Šçš„æ–‡ç« è€Œé—»åã€‚ä»–çš„ä½œå“é€šå¸¸æ¢è®¨ç¤¾ä¼šç§‘å­¦ã€å¿ƒç†å­¦å’Œè¡Œä¸ºç»æµå­¦çš„ä¸»é¢˜ï¼Œé€šè¿‡ç”ŸåŠ¨çš„æ•…äº‹å’Œæ·±åˆ»çš„è§è§£å¯å‘è¯»è€…ã€‚</p>
<p>å…¶ä»–å‡ºç‰ˆç‰©ï¼š<br>ã€Šå¼•çˆ†ç‚¹ã€‹ï¼ˆThe Tipping Point, 2000ï¼‰ï¼šæ¢è®¨äº†å¦‚ä½•é€šè¿‡å°‘æ•°å…³é”®å› ç´ å¼•å‘å¤§çš„å˜åŒ–ï¼Œä¹¦ä¸­å¼•å…¥äº†â€œå¼•çˆ†ç‚¹â€çš„æ¦‚å¿µã€‚<br>ã€Šå†³æ–­ä¸¤ç§’é—´ã€‹ï¼ˆBlink, 2005ï¼‰ï¼šç ”ç©¶äº†äººä»¬åœ¨ç¬é—´å†³ç­–ä¸­çš„æ½œæ„è¯†è¿‡ç¨‹å’Œç›´è§‰åˆ¤æ–­ã€‚<br>ã€Šå¼‚ç±»ã€‹ï¼ˆOutliers, 2008ï¼‰ï¼šæ¢è®¨äº†æˆåŠŸèƒŒåçš„éå‡¡å› ç´ ï¼Œæå‡ºäº†â€œ1ä¸‡å°æ—¶å®šå¾‹â€ç­‰æ¦‚å¿µã€‚<br>ã€Šå¤§å¼€çœ¼ç•Œã€‹ï¼ˆWhat the Dog Saw, 2009ï¼‰ï¼šè¿™æœ¬ä¹¦æ˜¯ä»–åœ¨ã€Šçº½çº¦å®¢ã€‹æ‚å¿—ä¸Šå‘è¡¨çš„æ–‡ç« çš„é›†åˆï¼Œæ¶µç›–äº†å„ç§ä¸»é¢˜ã€‚<br>ã€Šå¤§å«ä¸æ­Œåˆ©äºšã€‹ï¼ˆDavid and Goliath, 2013ï¼‰ï¼šè®¨è®ºäº†åœ¨äººä»¬è®¤ä¸ºä¸åˆ©çš„æ¡ä»¶ä¸‹å¦‚ä½•å–å¾—æˆåŠŸã€‚<br>ã€Šè°ˆè¯çš„åŠ›é‡ã€‹ï¼ˆTalking to Strangers, 2019ï¼‰ï¼šæ¢è®¨äº†äººä»¬åœ¨ä¸é™Œç”Ÿäººäº¤æµæ—¶å¸¸çŠ¯çš„é”™è¯¯åŠå…¶åæœ</p>
<h4 id="ç¬¬ä¸€éƒ¨åˆ†ï¼šæœºé‡"><a href="#ç¬¬ä¸€éƒ¨åˆ†ï¼šæœºé‡" class="headerlink" title="ç¬¬ä¸€éƒ¨åˆ†ï¼šæœºé‡"></a>ç¬¬ä¸€éƒ¨åˆ†ï¼šæœºé‡</h4><h5 id="é©¬å¤ªæ•ˆåº”ï¼šè‹±è¶…çƒå‘˜çš„ä¼˜åŠ¿ç§¯ç´¯"><a href="#é©¬å¤ªæ•ˆåº”ï¼šè‹±è¶…çƒå‘˜çš„ä¼˜åŠ¿ç§¯ç´¯" class="headerlink" title="é©¬å¤ªæ•ˆåº”ï¼šè‹±è¶…çƒå‘˜çš„ä¼˜åŠ¿ç§¯ç´¯"></a>é©¬å¤ªæ•ˆåº”ï¼šè‹±è¶…çƒå‘˜çš„ä¼˜åŠ¿ç§¯ç´¯</h5><p>è¿™ä¸€èŠ‚åˆ†æˆå…­ä¸ªéƒ¨åˆ†ï¼š</p>
<ul>
<li>æˆåŠŸé ä»€ä¹ˆï¼šæˆåŠŸé çš„æ˜¯ä¸ªäººæ„æ„¿å’Œèƒ½åŠ›ä¼˜åŠ¿ï¼Œåªèƒ½é è‡ªå·±è€Œä¸æ˜¯ä»–äººçš„å¸®åŠ©ã€‚<strong>çœŸçš„æ˜¯è¿™æ ·å—ï¼Ÿ</strong></li>
<li>æˆåŠŸè€…ä¹‹å¹¸</li>
<li>ç”Ÿäºå¹´åˆï¼šèŒä¸šé’å¹´é˜Ÿç»å¤§å¤š æ•°çƒå‘˜çš„ç”Ÿæ—¥é›†ä¸­åœ¨1æœˆã€2æœˆå’Œ3æœˆ</li>
<li>ä¼˜åŠ¿ç§¯ç´¯ï¼šä¸€ä¸ª1æœˆ1æ—¥å‡ºç”Ÿçš„é€‰æ‰‹ï¼Œæ˜¯åœ¨è·Ÿè®¸å¤šå¹´çºªæ¯”å…¶å°çš„é˜Ÿå‹äº‰å¤ºæ™‹çº§æƒã€‚æ™‹çº§åæ¥å—æ›´å¥½çš„è®­ç»ƒã€‚</li>
<li>æˆ‘ä»¬è¦åšæ€æ ·çš„æ”¹å˜ï¼šåˆ¶åº¦æ”¹é©ã€‚<ul>
<li>é¢†å…ˆä¼˜åŠ¿é€ å°±äº†å¤©æ‰ä»¬è¾‰ç…Œçš„æˆå°±ã€‚</li>
<li>åœ¨ç¤¾ä¼šå­¦é¢†åŸŸï¼Œæ‰€è°“çš„æˆåŠŸå°±æ˜¯â€œä¼˜åŠ¿ç§¯ç´¯â€çš„ç»“æœ</li>
<li>å¾ˆå¤šåˆ¶åº¦ç”šè‡³è¿‡æ—©åœ°å°†ä¸€éƒ¨åˆ†äººåˆ’å…¥äº†å¤±è´¥è€…çš„è¡Œåˆ—ï¼Œé˜»ç¢äº†è¿™äº›äººæˆæ‰</li>
</ul>
</li>
<li>ç¦»ç»å¯¹è€å¤§åªå‰©ä¸‰å¤©ï¼šå‡ºç”Ÿåœ¨1æœˆ4æ—¥ï¼Œåªå·®3å¤©ä»–å°±æ˜¯åŒé¾„é˜Ÿå‘˜ä¸­ç»å¯¹çš„è€å¤§äº†</li>
</ul>
<p>è¯»ä¹¦ç¬”è®°ï¼š<strong>æœ‰æ„è¯†çš„æå‰å»ºç«‹ä¼˜åŠ¿ï¼Œå¹¶ä¸æ–­ç§¯ç´¯ä¼˜åŠ¿æ˜¯æˆåŠŸçš„å…³é”®ã€‚</strong></p>
<h5 id="1ä¸‡å°æ—¶å®šå¾‹ï¼šç”Ÿäº1955å¹´çš„ä¹”å¸ƒæ–¯å’Œæ¯”å°”ç›–èŒ¨"><a href="#1ä¸‡å°æ—¶å®šå¾‹ï¼šç”Ÿäº1955å¹´çš„ä¹”å¸ƒæ–¯å’Œæ¯”å°”ç›–èŒ¨" class="headerlink" title="1ä¸‡å°æ—¶å®šå¾‹ï¼šç”Ÿäº1955å¹´çš„ä¹”å¸ƒæ–¯å’Œæ¯”å°”ç›–èŒ¨"></a>1ä¸‡å°æ—¶å®šå¾‹ï¼šç”Ÿäº1955å¹´çš„ä¹”å¸ƒæ–¯å’Œæ¯”å°”ç›–èŒ¨</h5><p>è¿™ä¸€èŠ‚åˆ†æˆå…­ä¸ªéƒ¨åˆ†ï¼š</p>
<ul>
<li>å¤©æ‰åˆ›å§‹äººï¼šè®¡ç®—æœºç§‘å­¦å®¶æ¯”å°”Â·ä¹”ä¼Šã€‚</li>
<li>ä¸€ä¸‡å°æ—¶æœ‰å¤šä¹…ï¼šä¸€ä¸‡å°æ—¶è®­ç»ƒæ˜¯æˆä¸ºä¼˜ç§€çš„å¿…è¦æ¡ä»¶ã€‚</li>
<li>å®‰å¨œå ¡è®¡ç®—æœºä¸­å¿ƒçš„æ—¥æ—¥å¤œå¤œï¼š<blockquote>
<p>ç°åœ¨ï¼Œ è®©æˆ‘ä»¬ç†ä¸€ç†æ¯”å°”Â·ä¹”ä¼Šçš„æœºé‡é“¾å§ã€‚<br>ä»–æœ‰å¹¸è€ƒå…¥ä½œä¸ºè®¡ç®—æœºå­¦ ç§‘é¢†è·‘è€…çš„å¯†æ­‡æ ¹å¤§å­¦ï¼›<br>æœ‰å¹¸ç¬¬ä¸€æ‰¹ä½¿ç”¨åˆ†æ—¶ç³»ç»Ÿï¼Œè€Œä¸æ˜¯é”®ç›˜æ‰“å­”æœºï¼›<br>åˆæ°å·§å¯†æ­‡æ ¹å¤§å­¦çš„æœºæˆ¿ç®¡ç†ç³»ç»Ÿæœ‰æ¼æ´ï¼Œ ä»–å¾—ä»¥æƒ³å­¦å¤šé•¿æ—¶é—´å°±å­¦å¤šé•¿æ—¶é—´ï¼›<br>å› ä¸ºè®¡ç®—æœºä¸­å¿ƒ24å°æ—¶å¼€æ”¾ï¼Œä»–åˆå¾—ä»¥å¤œä»¥ç»§æ—¥åœ°å­¦ä¹ ï¼›<br>ä»–è·å¾—äº†å……åˆ†çš„æ—¶é—´ç»ƒä¹ ç¼–ç¨‹ï¼Œæ‰€ä»¥å½“æ”¹é€ UNI;ç³»ç»Ÿé¡¹ç›®å¼€å§‹çš„æ—¶å€™ï¼Œä»–é¡ºç†æˆç« åœ°è¿›å…¥äº†é¡¹ç›®ç»„ã€‚<br>æ¯”å°”Â·ä¹”ä¼Šçš„ç¡®èªæ˜ç»é¡¶ï¼Œä»–ä¹Ÿçƒ­çˆ±å­¦ä¹ ï¼Œè¿™æ˜¯ä»–æˆåŠŸçš„ä¸€å¤§å› ç´ ã€‚<br>ä½†æ˜¯ï¼Œåœ¨ä»–æˆä¸ºä¸“å®¶ä»¥å‰ï¼Œä»–é¦–å…ˆä¾é è¿æ°”è·å¾—äº†æˆä¸ºä¸“å®¶çš„æœºä¼šã€‚</p>
</blockquote>
</li>
<li>ç”²å£³è™«ä¹é˜Ÿçš„æ±‰å ¡ä¹‹è¡Œ:æ­£æ˜¯åœ¨æ±‰å ¡çš„è¶…é‡è®­ç»ƒæ‰ä½¿ç”²å£³è™«ä¹é˜Ÿè„±é¢–è€Œå‡ºçš„ã€‚</li>
<li>1968å¹´çš„ç”µè„‘:æ¯”å°”ç›–èŒ¨çš„æœºé‡å’Œæ›´å¤šä½¿ç”¨ç”µè„‘çš„æœºä¼šã€‚</li>
<li>æ—¶åŠ¿é€ æˆåŠŸï¼šæœºé‡é€ å°±äº†æˆåŠŸã€‚</li>
</ul>
<p>è¯»ä¹¦ç¬”è®°ï¼šæˆåŠŸ = æ—¶ä»£æœºé‡ + åŠªåŠ›</p>
<h5 id="æ™ºå•†å’Œæœºé‡ï¼šæ›¼ç‰¹äººçš„è°¬è¯¯"><a href="#æ™ºå•†å’Œæœºé‡ï¼šæ›¼ç‰¹äººçš„è°¬è¯¯" class="headerlink" title="æ™ºå•†å’Œæœºé‡ï¼šæ›¼ç‰¹äººçš„è°¬è¯¯"></a>æ™ºå•†å’Œæœºé‡ï¼šæ›¼ç‰¹äººçš„è°¬è¯¯</h5><p>è¿™ä¸€èŠ‚åˆ†æˆäº”ä¸ªéƒ¨åˆ†ï¼š</p>
<ul>
<li>å…¨ç¾æœ€èªæ˜çš„äººï¼šæ™ºå•†195çš„å…°æ ¹å‚åŠ ã€Šä»¥ä¸€æ•Œç™¾ã€‹èŠ‚ç›®ã€‚</li>
<li>è¶…å¸¸â€œç‰¹æ›¼äººâ€<blockquote>
<p>è¿™äº›è¢«æŒ‘é€‰å‡ºæ¥çš„å¤©æ‰å°‘å¹´ï¼Œæ­£å¼æˆä¸ºå†å²ä¸Šæœ€è‘—åçš„å¿ƒç†å­¦ç ”ç©¶çš„ç ”ç©¶å¯¹è±¡ï¼Œä»–ä»¬è¢«ç»Ÿç§°ä¸ºâ€œç‰¹æ›¼ äººâ€ã€‚</p>
</blockquote>
</li>
<li>æ™ºå•†çš„é—¨æ§›æ•ˆåº”<blockquote>
<p>æ™ºå•†ä¸æˆåŠŸåªåœ¨ä¸€å®šç¨‹åº¦ä¸Šç›¸äº’å…³è”ï¼Œ ä¸€æ—¦æŸ äººçš„æ™ºå•†è¶…è¿‡120åˆ†ï¼Œæ­¤æ—¶æ›´é«˜çš„æ™ºå•†å¹¶ä¸æ„å‘³ç€ä¼šåŒæ¯”è½¬åŒ–æˆæ›´å¤šçš„ç°å®ä¼˜</p>
</blockquote>
</li>
<li>å……æ»¡æƒ³è±¡åŠ›çš„å¿ƒçµ:å‘æ•£æ€§æ€ç»´æµ‹è¯•è¦æ±‚ä½ è¿ç”¨æƒ³è±¡åŠ›ï¼Œå¯»æ‰¾å°½é‡å¤šçš„ä¸åŒçš„å¯èƒ½æ€§ã€‚</li>
<li>äº‹ä¸æ„¿è¿çš„è¯•éªŒç»“æœ:ç‰¹æ›¼å¿½ç•¥äº†ä¸€ä¸ªäº‹å®â€”â€”æ™ºåŠ›åœ¨ç°å®ä¸­çš„ä½œç”¨å¹¶ æ²¡æœ‰é‚£ä¹ˆå¤§ã€‚</li>
</ul>
<h5 id="ç¤¾äº¤ä¸å®¶åº­ï¼šå¤©æ‰å…°æ ¹çš„å¿§ä¼¤"><a href="#ç¤¾äº¤ä¸å®¶åº­ï¼šå¤©æ‰å…°æ ¹çš„å¿§ä¼¤" class="headerlink" title="ç¤¾äº¤ä¸å®¶åº­ï¼šå¤©æ‰å…°æ ¹çš„å¿§ä¼¤"></a>ç¤¾äº¤ä¸å®¶åº­ï¼šå¤©æ‰å…°æ ¹çš„å¿§ä¼¤</h5><p>è¿™ä¸€èŠ‚åˆ†æˆå…­ä¸ªéƒ¨åˆ†ï¼š</p>
<ul>
<li>ä»¤äººå¿ƒç¢çš„å¤©æ‰å‘½è¿ï¼šå¤©æ‰å…°æ ¹å®¶åº­ç¯å¢ƒä¸å¥½ï¼Œå³ä½¿æ˜¯å¤©æ‰ï¼Œæœ€åç»“å±€ä¹Ÿå¾ˆä¸€èˆ¬ã€‚</li>
<li>å¦ä¸€ä½å¤©æ‰çš„å‘½è¿ï¼šå¤©æ‰å¥¥æœ¬æµ·é»˜ï¼Œå®¶åº­ç¯å¢ƒå¥½ï¼Œç»“å±€æˆåŠŸã€‚</li>
<li>å®è·µæ™ºåŠ›ä»å“ªæ¥ï¼šä¸¤ä¸ªå¤©æ‰çš„ç»“å±€ä¸ºä½•å¦‚æ­¤ä¸åŒï¼Ÿå®è·µæ™ºåŠ›ä¸åŒï¼</li>
<li>ååŒåŸ¹å…»çš„å…¸èŒƒï¼šå¥¥æœ¬æµ·é»˜æ˜¯ååŒåŸ¹å…»çš„å…¸èŒƒã€‚</li>
<li>ååŒåŸ¹å…»ä¸è‡ªç„¶æˆé•¿</li>
<li>å¦‚ä½•é¿å…æ‚²å‰§é‡æ¼”</li>
</ul>
<blockquote>
<p>å®¶å¢ƒå¯Œè£•çš„çˆ¶æ¯æ€»æ˜¯è®©å­©å­ä¸€åˆ»ä¹Ÿä¸èƒ½é—²ç€ï¼Œ è®©å­©å­ç©¿æ¢­äºå„é¡¹æ´»åŠ¨ä¹‹ é—´ï¼Œå¹¶å¬å–å­©å­å¯¹è€å¸ˆã€æ•™ç»ƒæˆ–æ˜¯é˜Ÿå‹çš„è¯„ä»·<br>è€Œç©·äººå®¶å­©å­çš„ç”Ÿæ´»ä¸­å®Œå…¨æ²¡æœ‰è¿™ç§ç´§å¼ çš„æ—¶é—´å®‰æ’ï¼Œ ä»–ä»¬çš„æ´»åŠ¨ä¸ä¼š æ˜¯æ¯å‘¨ä¸¤æ¬¡è¶³çƒè®­ç»ƒï¼Œè€Œæ˜¯å’Œäº²æˆšæˆ–è€…é‚»å±…å®¶çš„å­©å­åœ¨å¤–é¢ç©è€ã€‚</p>
</blockquote>
<p>è¯»ä¹¦ç¬”è®°ï¼šå®¶åº­æ•™è‚²å¾ˆé‡è¦ï¼Œè®©å­©å­é«˜æ•ˆåˆ©ç”¨æ—¶é—´æ·±åº¦å‚ä¸åˆ°æœ‰æ„ä¹‰çš„ç¤¾ä¼šæ´»åŠ¨ä¸­ï¼Œé¼“åŠ±å­©å­è¡¨è¾¾è‡ªå·±çš„æƒ³æ³•ï¼ŒæŒ‘æˆ˜æƒå¨ï¼Œæ•¢äºè¡¨ç°è‡ªå·±ã€‚</p>
<h5 id="æœ€ä½³æ—¶ä»£ï¼šä¹”-å¼—æ´›å§†çš„å¾‹å¸ˆç”Ÿæ¶¯"><a href="#æœ€ä½³æ—¶ä»£ï¼šä¹”-å¼—æ´›å§†çš„å¾‹å¸ˆç”Ÿæ¶¯" class="headerlink" title="æœ€ä½³æ—¶ä»£ï¼šä¹”-å¼—æ´›å§†çš„å¾‹å¸ˆç”Ÿæ¶¯"></a>æœ€ä½³æ—¶ä»£ï¼šä¹”-å¼—æ´›å§†çš„å¾‹å¸ˆç”Ÿæ¶¯</h5><p>è¿™ä¸€èŠ‚åˆ†ä¸ºä¸ƒä¸ªéƒ¨åˆ†ï¼š</p>
<ul>
<li>å¾‹å¸ˆäº‹åŠ¡æ‰€ä¹‹ç¿˜æ¥šï¼šè´«ç©·çš„ç§»æ°‘ï¼Œè¢«æ­§è§†çš„çŠ¹å¤ªäººï¼šä¹”-å¼—æ´›å§†ï¼Œä»ä¸–è¾¾å¾‹å¸ˆäº‹åŠ¡æ‰€çš„åŠ©ç†åˆ°åˆä¼™äººï¼Œä»å‡ ä¸ªäººåˆ°å‡ åƒäººã€‚<strong>è¿™æ˜¯æ—¶ä»£é€ å°±äº†è¡Œä¸š</strong>ã€‚</li>
<li>çº½çº¦ç§»æ°‘åŒºçš„æ•…äº‹ï¼šå¼—æ´›å§†æˆé•¿ç¯å¢ƒä¸‹çš„å‡ ä¸ªå°æ•…äº‹ã€‚<ul>
<li>å¯ç¤ºä¸€ï¼šèº«ä¸ºçŠ¹å¤ªäººçš„é‡è¦æ€§ï¼š<br>åœ¨é‚£ä¸ªå¹´ä»£ï¼Œå¦‚æœä½ çš„å®¶åº­èƒŒæ™¯ã€å®—æ•™ä¿¡ä»°ã€ç¤¾ä¼šåœ°ä½ä¸ç¬¦åˆè¦ æ±‚ï¼Œ å³ä¾¿ä½ æ˜¯ä»æ³•å­¦é™¢æ¯•ä¸šçš„ï¼Œ ä½ ä¹Ÿåªèƒ½å»é‚£äº›äºŒæµçš„ã€ åˆšèµ·æ­¥çš„å°äº‹åŠ¡æ‰€ï¼Œæˆ–è€…è‡ªå·±åˆ›ä¸šã€‚</li>
<li>å¯ç¤ºäºŒï¼šç”Ÿè‚²æ½®ä½è°·ä¹‹å¹¸<br>å—20ä¸–çºª30å¹´ä»£çš„ç»æµå¤§è§æ¡å’Œç¬¬äºŒæ¬¡ä¸–ç•Œå¤§æˆ˜ï¼ˆ1939â€”1945å¹´ï¼‰çš„å½±å“ï¼Œä¸åŒé˜¶æ®µå‡ºç”Ÿçš„äººçš„å‘½è¿æˆªç„¶ä¸åŒã€‚</li>
<li>å¯ç¤ºä¸‰ï¼šæœè£…å‚ä¸æœ‰æ„ä¹‰çš„å·¥ä½œ<br>è·¯æ˜“æ–¯Â·æ³¢å‰å°¼ç‰¹å’Œç‘å‰å¨œÂ·æ³¢å‰å°¼ç‰¹å¤«å¦‡ç§»æ°‘ç¾å›½åå–å›´è£™æˆé•¿èµ·æ¥çš„æ•…äº‹ã€‚</li>
</ul>
</li>
<li>ä¸€ä»£æ–°äººèƒœæ—§äºº</li>
<li>æˆåŠŸä¸æ˜¯éšæœºäº‹ä»¶</li>
</ul>
<p>è¯»ä¹¦ç¬”è®°ï¼šå—æ­§è§†çš„ä¹”-å¼—æ´›å§†è¿›ä¸äº†å¤§å…¬å¸åªèƒ½è¿›å°å…¬å¸ï¼Œè‡ªå·±åˆ›ä¸šï¼Œå¤„ç†é‚£äº›åˆ«äººä¸æ„¿å¤„ç†çš„æ¡ˆå­ã€‚éšç€æ—¶ä»£æˆ–æ”¿ç­–çš„è½¬å˜ä¸šåŠ¡æ¿€å¢ï¼ŒäºŒæµå¾‹å¸ˆæ‘‡èº«ä¸€å˜æˆä¸ºä¸€æµã€‚å¼—æ´›å§†å¹¶ä¸ æ˜¯å…‹æœäº†é€†å¢ƒï¼Œè€Œæ˜¯åŸå…ˆçš„é€†å¢ƒå¿½ç„¶ä¹‹é—´å˜æˆäº†æœºé‡ã€‚</p>
<h4 id="ç¬¬äºŒéƒ¨åˆ†ï¼šæ–‡åŒ–ä¼ æ‰¿"><a href="#ç¬¬äºŒéƒ¨åˆ†ï¼šæ–‡åŒ–ä¼ æ‰¿" class="headerlink" title="ç¬¬äºŒéƒ¨åˆ†ï¼šæ–‡åŒ–ä¼ æ‰¿"></a>ç¬¬äºŒéƒ¨åˆ†ï¼šæ–‡åŒ–ä¼ æ‰¿</h4><h5 id="æ–‡åŒ–å·®å¼‚ï¼šå°é•‡å“ˆä¼¦"><a href="#æ–‡åŒ–å·®å¼‚ï¼šå°é•‡å“ˆä¼¦" class="headerlink" title="æ–‡åŒ–å·®å¼‚ï¼šå°é•‡å“ˆä¼¦"></a>æ–‡åŒ–å·®å¼‚ï¼šå°é•‡å“ˆä¼¦</h5><p>è¿™ä¸€èŠ‚åˆ†ä¸ºå››éƒ¨åˆ†ï¼š</p>
<ul>
<li>è¡€æŸ“å“ˆä¼¦<br>å“ˆä¼¦å¿åŸä¸¤å¤§å®¶æ—çŸ›ç›¾å’Œæªæˆ˜ã€‚</li>
<li>è£èª‰æ–‡åŒ–<blockquote>
<p>â€œè£èª‰æ–‡åŒ–â€æ¤æ ¹äºé«˜åœ°æˆ–å¯Œåº¶åœ°åŒºçš„è¾¹ç¼˜åœ°å¸¦ï¼Œå¦‚æ„å¤§åˆ©çš„è¥¿è¥¿é‡Œå²› å’Œè¥¿ç­ç‰™çš„å·´æ–¯å…‹å±±åŒºã€‚è¿™ç§è§£é‡Šçš„é€»è¾‘æ˜¯ï¼Œå½“äººä»¬å±…ä½åœ¨å¤šå²©çŸ³çš„å±±å¡åœ° å¸¦æ—¶ï¼Œç”±äºé‚£é‡Œçš„åœŸåœ°å¾ˆéš¾è€•ç§ï¼Œäººä»¬å¤§å¤šä¼šä¾é æ”¾ç‰§ç”Ÿæ´»ã€‚æ¸¸ç‰§æ–‡æ˜å’Œè€• ç§æ–‡æ˜å¤§ç›¸å¾„åº­ã€‚<br>ä»äº‹è€•ç§çš„å†œæ°‘è¦æƒ³ç»´æŒç”Ÿè®¡ä¾é çš„æ˜¯äººä¸äººä¹‹é—´çš„åˆ ä½œï¼Œè€Œä»äº‹æ¸¸ç‰§çš„ç‰§æ°‘æ‰€ä¾é çš„æ›´å¤šçš„æ˜¯è‡ªå·±ã€‚å†œæ°‘ä¸å¿…æ‹…å¿ƒä»–ä»¬çš„åº„ç¨¼ä¸€ å¤œä¹‹é—´å°±è¢«äººå…¨éƒ¨å·èµ°ï¼Œé™¤éç›—è´¼æœ‰æœ¬äº‹ä¸€ä¸ªæ™šä¸Šå°±æŠŠåœ°é‡Œçš„æ‰€æœ‰åº„ç¨¼æ”¶å‰² å®Œã€‚ä½†æ˜¯ç‰§æ°‘å°±æœ‰è¿™æ ·çš„æ‹…å¿§ã€‚<br>å®é™…ä¸Šï¼Œä»–ä»¬ä¸€ç›´ç”Ÿæ´»åœ¨ç‰²å£è¢«å·ï¼Œæ•´ä¸ªç”Ÿ æ´»è¢«æ¯çš„ææƒ§ä¹‹ä¸‹ã€‚æ‰€ä»¥ä»–ä»¬å…»æˆäº†å¥½æ–—çš„æ€§æƒ…ï¼šä»–ä»¬å¿…é¡»é€šè¿‡è‡ªå·±çš„è¨€è¡Œ è¡¨æ˜è‡ªå·±ä¸æ˜¯å¼±è€…ï¼Œè¦å¯¹å±åŠä»–ä»¬åèª‰çš„å“ªæ€•æ˜¯æœ€è½»å¾®çš„æŒ‘æˆ˜äºˆä»¥æœ€åšå†³çš„ åå‡»â€”â€”è¿™å°±æ˜¯â€œè£èª‰æ–‡åŒ–â€çš„å«ä¹‰ã€‚åœ¨æ¸¸ç‰§æ–‡åŒ–æ‰€åœ¨çš„åœ°æ–¹ï¼Œè£èª‰æ„Ÿå¾€å¾€æ˜¯å½“åœ°ç”·æ€§çš„å­˜åœ¨æ„Ÿä¸è‡ªæˆ‘ä»·å€¼çš„ä¸­å¿ƒã€‚</p>
</blockquote>
</li>
<li>é—æ³½ç™¾ä¸–<br>å¿ƒç†å­¦å®¶åšå®éªŒï¼Œå‘ç°ï¼š<blockquote>
<p>æœ‰äº›äººçš„å›åº”è¢«å…¶ä¹‹å‰é­åˆ°çš„ä¾®è¾±å½±å“ï¼Œæœ‰äº›äººçš„åˆ™æ²¡æœ‰ã€‚å¿—æ„¿è€…çš„è¡Œä¸ºæ˜¯å¦æ”¹å˜ï¼Œå¹¶ä¸å–å†³äºä»–ä»¬çš„æƒ…ç»ªæ˜¯å¦ç¨³å®šï¼Œä¹Ÿä¸å–å†³äºä»–ä»¬æ˜¯çŸ¥è¯†åˆ†å­è¿˜æ˜¯è¿åŠ¨å‘˜ï¼Œ åŒæ ·ä¹Ÿä¸å–å†³äºä»–ä»¬çš„ç›¸è²Œã€‚ è¿™å…¶ä¸­çš„å†³å®šæ€§å› ç´ â€”â€”æˆ‘æƒ³ä½ ä¸€å®šå·²ç» çŒœåˆ°äº†â€”â€”æ˜¯ä»–ä»¬æ¥è‡ªä½•æ–¹ã€‚</p>
</blockquote>
</li>
<li>æ–‡åŒ–ä¼ æ‰¿çš„åŠ›é‡<blockquote>
<p>æ–‡åŒ–ä¼ æ‰¿æ˜¯äº‹ä»¶èƒŒåæ›´å¼ºå¤§çš„åŠ›é‡ï¼Œ å®ƒæ ¹æ·±è’‚å›ºï¼Œå½±å“é•¿å­˜ã€‚ ç»è¿‡æ•°ä»£ ä¼ æ‰¿ï¼Œå³ä¾¿å¡‘é€ æ–‡åŒ–çš„ç»æµã€ç¤¾ä¼šã€äººå£ç­‰æ¡ä»¶å·²ç»æ¶ˆå¤±ï¼Œè¿™ç§æ–‡åŒ–ä¹Ÿä¼šä¸€ ç›´å®Œå¥½æ— æŸåœ°ç•™ä¼ ä¸‹æ¥ã€‚æ–‡åŒ–ç›´æ¥å†³å®šäº†æˆ‘ä»¬çœ‹å¾…ä¸–ç•Œçš„æ–¹æ³•å’Œè¡Œä¸ºæ¨¡å¼ï¼Œå…¶ä½œç”¨å¦‚æ­¤å·¨å¤§ï¼Œä»¥è‡³äºæ²¡æœ‰å®ƒï¼Œæˆ‘ä»¬å°†æ— æ³•è®¤è¯†ä¸–ç•Œã€‚</p>
</blockquote>
</li>
</ul>
<h5 id="æƒåŠ›è·ç¦»æŒ‡æ•°ï¼šéŸ©å›½é£æœºå¤±äº‹ç‡"><a href="#æƒåŠ›è·ç¦»æŒ‡æ•°ï¼šéŸ©å›½é£æœºå¤±äº‹ç‡" class="headerlink" title="æƒåŠ›è·ç¦»æŒ‡æ•°ï¼šéŸ©å›½é£æœºå¤±äº‹ç‡"></a>æƒåŠ›è·ç¦»æŒ‡æ•°ï¼šéŸ©å›½é£æœºå¤±äº‹ç‡</h5><blockquote>
<p>æƒåŠ›è·ç¦»æ˜¯æŒ‡äººä»¬å¯¹å¾…æ¯”è‡ªå·±æ›´é«˜ç­‰çº§é˜¶å±‚çš„æ€åº¦ï¼Œç‰¹åˆ«æ˜¯æŒ‡å¯¹æƒå¨çš„é‡è§†å’Œå°Šé‡çš„ç¨‹åº¦ã€‚</p>
</blockquote>
<ul>
<li>å¤§éŸ©èˆªç©º801èˆªç­ï¼šå¤§éŸ©èˆªç©ºç©ºéš¾çš„æ•…äº‹ã€‚</li>
<li>ç¥¸ä¸å•è¡Œï¼šå¤§éŸ©èˆªç©ºæ˜¯å¦‚ä½•ä»ä¸€å®¶å®‰å…¨è®°å½•ç³Ÿç³•çš„å…¬å¸è½¬å˜æˆä¸–ç•Œæœ€å¥½çš„èˆªç©ºå…¬å¸ä¹‹ä¸€çš„ã€‚</li>
<li>é˜¿ç»´å®‰å¡èˆªç©º052èˆªç­ï¼šç‡ƒæ²¹è€—å°½å¯¼è‡´çš„ç©ºéš¾ã€‚</li>
<li>åˆæ¢052èˆªç­å æ¯ï¼šé£æœºæœ¬èº«æ“ä½œéš¾åº¦å¤§ï¼Œæœºé•¿å¤šæ¬¡è¯¯åˆ¤ï¼Œå‰¯æœºé•¿ç¼ºä¹å’Œå¡”å°çš„æ²Ÿé€š</li>
<li>æˆåŠŸåŒ–è§£ç©ºä¸­å±æœºçš„æ¡ˆä¾‹ï¼šè€äººæœºä¸Šæ™•å¥ï¼Œéœ€è¦ç´§æ€¥é™è½ï¼Œæœºé•¿å†³ç­–å„ç§æƒ…å†µï¼Œå’ŒåŒäº‹æ²Ÿé€šæœ€åå®Œç¾é™è½ã€‚<blockquote>
<p>è¿™æ¬¡é™è½è¦æ±‚æ‹‰ç‰¹ç“¦ç‰¹å¿…é¡»å…·å¤‡ä¸€å®š çš„æ²Ÿé€šç´ è´¨ã€‚è¿™é‡Œçš„æ²Ÿé€šä¸ä»…æ„å‘³ç€å‘æœºç»„ä¸‹è¾¾é™è½æŒ‡ä»¤ï¼Œè¿˜æ„å‘³ç€é¼“åŠ±ã€ å®‰æŠšã€è¯´æœä»–äººï¼Œä¸ä»–äººå•†è®¨ï¼Œä»¥åŠç”¨æ¸…æ™°æ— è¯¯çš„è¯­è¨€ä¸ä»–äººå…±äº«ä¿¡æ¯ã€‚</p>
</blockquote>
</li>
<li>å†æ¢052èˆªç­å æ¯äº‹ä»¶:æ²Ÿé€šå’Œè¡¨è¾¾å­˜åœ¨é—®é¢˜ã€‚<blockquote>
<p>é‚£æ™šä¸052èˆªç­é€šè¿‡è¯çš„å¦ä¸€ä¸ªèˆªç©ºç®¡åˆ¶å‘˜å½¢å®¹å…‹æ´›èŒ¨â€œè¯­è°ƒå†·æ·¡â€¦â€¦å£°éŸ³ä¸­ä¸æ¯«å¬ä¸å‡ºç´§æ€¥ä¹‹æ„â€ã€‚</p>
</blockquote>
</li>
<li>ä¸¥ç¦å®¢å¥—ï¼šä¸ç¼“å’Œæ€§è¯­æ°”åšæ–—äº‰ï¼Œ æˆä¸ºè¿‡å»15å¹´é—´å•†ä¸šèˆªç©ºä¸šçš„ä¸»è¦æˆ˜å½¹</li>
<li>052èˆªç­çš„æœ€åæ—¶åˆ»ï¼š</li>
<li>ä¸‰æ¢052èˆªç­å æ¯ï¼š</li>
<li>ç©ºéš¾çš„æ·±å±‚åŸå› ï¼š<ul>
<li>è¿™æ¬¡äº‹æ•…åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šæºäºå“¥ä¼¦æ¯”äºšäººé•¿ä¹…ä»¥æ¥å¯¹æƒå¨çš„æ•¬ç•ä¸æœä»</li>
<li>å‰¯æœºé•¿åªæŠŠè‡ªå·±å®šä½ä¸ºä¸‹å±ï¼Œæ—¢ç„¶æ˜¯ä¸‹å±å…³é”®æ€§çš„å†³å®šå°±ä¸åº”ç”±è‡ªå·±åšå‡ºï¼Œè¿™ä¸ªå†³å®šåº”ç”±æœºé•¿åšå‡ºã€‚</li>
</ul>
</li>
<li>ä¸æ–­ç§¯ç´¯çš„å°é—®é¢˜:å…·å¤‡é£æœºå¤±äº‹çš„3ä¸ªå…¸å‹å‰æï¼šè½»å¾®çš„æŠ€æœ¯æ•…éšœã€åå¤©æ°”ã€ç–²æƒ«çš„é£è¡Œå‘˜</li>
<li>é«˜æƒåŠ›è·ç¦»æŒ‡æ•°ä¹‹æ¶ï¼š(æˆ‘è§‰å¾—æ‰€è°“çš„é«˜æƒå¨ï¼Œå…¶å®å°±æ˜¯ä¸€ç§ç­‰çº§åˆ¶åº¦)<blockquote>
<p>é«˜æƒåŠ›è·ç¦»æŒ‡æ•°æ–‡åŒ–çš„è¿™ç§å¯¹è¯æ–¹å¼ï¼Œåªæœ‰åœ¨è†å¬è€…æœ‰æ¡ä»¶æ£æ‘© å¯¹æ–¹è¯è¯­çš„æƒ…å†µä¸‹æ‰æ˜¯é€‚å®œçš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒåŒæ–¹å¾—æœ‰è¶³å¤Ÿçš„æ—¶é—´ç›¸äº’æ£æ‘©ã€‚ è¿™ç§æ–¹å¼ç»ä¸åº”è¯¥åœ¨æš´é£é›¨çš„å¤œæ™šï¼Œåœ¨ç²¾ç–²åŠ›ç«­çš„æœºé•¿å‡†å¤‡æŠŠé£æœºé™è½åœ¨ä¸€ ä¸ªä¸‹æ»‘è§’æŒ‡ç¤ºç¯æœ‰æ•…éšœçš„æœºåœºæ—¶ä½¿ç”¨ã€‚</p>
</blockquote>
</li>
<li>å¸ä¸‹é‡æ‹…ï¼š</li>
</ul>
<p>è¯»ä¹¦ç¬”è®°ï¼šå®¢æœºå¤±äº‹çš„ä¸»è¦åŸå› åœ¨äºæƒåˆ©æŒ‡æ•°åœ¨å‰¯é©¾é©¶å’Œä¸»é©¾é©¶ä¹‹é—´å‘æŒ¥ç€ä½œç”¨ã€‚è¿™æ˜¯ä¸€ç§æ–‡åŒ–ç‰¹å¾ï¼Œæ˜¯ä¸€ç§ä¸Šä¸‹çº§çš„é˜¶çº§å…³ç³»ã€‚æˆ‘ä»¬åº”è¯¥å¯¹äº‹ä¸å¯¹äººï¼Œå®¢è§‚è¾©è¯çš„å¤„ç†é—®é¢˜ï¼Œä¸å±ˆæœäºæƒå¨ã€‚</p>
<h5 id="å†…åœ¨ä¼˜åŠ¿ï¼šäºšæ´²äººç²¾ç¥"><a href="#å†…åœ¨ä¼˜åŠ¿ï¼šäºšæ´²äººç²¾ç¥" class="headerlink" title="å†…åœ¨ä¼˜åŠ¿ï¼šäºšæ´²äººç²¾ç¥"></a>å†…åœ¨ä¼˜åŠ¿ï¼šäºšæ´²äººç²¾ç¥</h5><p>è¿™ä¸€èŠ‚åˆ†ä¸º6ä¸ªéƒ¨åˆ†ï¼š</p>
<ul>
<li>æ•°å­—ä¼˜åŠ¿ï¼šäºšæ´²äººåœ¨æ•°å­—æ–¹é¢æœ‰ä¼˜åŠ¿ï¼Œä¸€æ–¹é¢æ˜¯å› ä¸ºä»–ä»¬å¯¹æ•°å­—çš„å‘éŸ³æ›´çŸ­ï¼Œå¦ä¸€æ–¹é¢å¾—ç›Šäºæ—è£”æ–‡åŒ–ã€‚</li>
<li>ç¨»ç”°ä¸­çš„è¾›åŠ³ï¼šç§æ¤æ°´ç¨»çš„äºšæ´²å†œæ°‘ä¸€å¹´çš„å·¥ä½œæ—¶é•¿çº¦ä¸º3000å°æ—¶ã€‚</li>
<li>ç¨»ç”°ç²¾ç¥ï¼šåŠªåŠ›å·¥ä½œçš„ç²¾ç¥å“è´¨åœ¨äºšæ´²äººèº«ä¸Šå¾ˆå¸¸è§ã€‚</li>
<li>æ–œç‡éš¾é¢˜ï¼šä¸€ä¸ªè®¡ç®—ç›´çº¿çš„æ–œç‡çš„å®éªŒã€‚</li>
<li>æ€æ ·åšæ‰ç®—æ˜¯å‹¤å¥‹ï¼šæ€åº¦æ¯”èƒ½åŠ›æ›´é‡è¦ã€‚ åªè¦ä½ æœ‰æ„æ„¿ï¼Œä½ å°±èƒ½é©¾é©­æ•°å­¦ã€‚</li>
<li>åŠ³æœ‰æ‰€å¾—ï¼šå“ªä¸ªå›½å®¶å’Œåœ°åŒºçš„å­¦ ç”Ÿæ›´æ„¿æ„èŠ±æ—¶é—´ä»”ç»†å›ç­”å†—é•¿çš„é—®å·ï¼Œå“ªä¸ªå›½å®¶å’Œåœ°åŒºçš„å­¦ç”Ÿåœ¨TIMSSè€ƒè¯•ä¸­çš„æˆç»©å°±æ›´å¥½ã€‚</li>
</ul>
<p>è¯»ä¹¦ç¬”è®°ï¼šäºšæ´²äººç²¾ç¥:åƒè‹¦è€åŠ³ï¼Œè€å¿ƒï¼ŒæŒä¹‹ä»¥æ’ã€‚</p>
<h5 id="æ‰­è½¬é£æ°”ï¼šç›ä¸½å¡”ä¹‹å¹¸"><a href="#æ‰­è½¬é£æ°”ï¼šç›ä¸½å¡”ä¹‹å¹¸" class="headerlink" title="æ‰­è½¬é£æ°”ï¼šç›ä¸½å¡”ä¹‹å¹¸"></a>æ‰­è½¬é£æ°”ï¼šç›ä¸½å¡”ä¹‹å¹¸</h5><p>è¿™ä¸€èŠ‚åˆ†ä¸º6ä¸ªéƒ¨åˆ†ï¼š</p>
<ul>
<li>é£æ°”ä¹‹å…ˆï¼šKIPPé¡¹ç›®ä»£è¡¨äº†ç¾å›½æ•™è‚²çš„æ–°ç†å¿µï¼Œå®ƒçš„æˆåŠŸå¹¶éä¾é ç¯å¢ƒã€å¸ˆèµ„æˆ–åˆ¶åº¦åˆ›æ–°ã€‚</li>
<li>è¥¿æ–¹æ•™è‚²çš„ä¼ ç»Ÿï¼š<ul>
<li>äºšæ´²ï¼šæ°´ç¨»è€•ç§æ¬¡æ•°è¶Šå¤šæ”¶è·è¶Šå¤š -&gt; å­¦ä¹ è¶ŠåŠªåŠ›æ”¶è·è¶Šå¤š</li>
<li>è¥¿æ–¹ï¼šå°éº¦éœ€è¦ä¼‘è€•è®©åœŸåœ°ä¿æŒè‚¥æ²ƒ -&gt; è¿‡åº¦å­¦ä¹ ä¼šå¯¹å­¦ç”Ÿä¸ªæ€§ç”Ÿæ´»ä¹ æƒ¯é€ æˆæ¶åŠ£å½±å“</li>
</ul>
</li>
<li>æˆç»©åˆ°åº•å·®åœ¨å“ªå„¿ï¼šå‡æœŸæ—¶é—´å¯¼è‡´ä½æ”¶å…¥å®¶åº­å­©å­æˆç»©æ²¡é•¿è¿›ï¼Œè€Œé«˜æ”¶å…¥å®¶åº­å­©å­åœ¨å‡æœŸåšçš„äº‹æƒ…æ›´æœ‰æ„ä¹‰ã€‚</li>
<li>å¯¹ç—‡ä¸‹è¯ï¼šæ›´å¤šçš„å­¦ä¹ æ—¶é—´ï¼Œæ›´æ…¢çš„èŠ‚å¥ï¼Œæ›´å¤šç†è§£å’Œæ€è€ƒã€‚</li>
<li>æŒ‘æˆ˜è‡ªæˆ‘ï¼šKIPPå­¦å›­çš„å­¦ç”Ÿ(ç›ä¸½å¡”)ï¼šå¤šå‡º50%-60%çš„æ—¶é—´å­¦ä¹ ï¼Œæ—©ä¸Š5ç‚¹å°±èµ·åºŠï¼Œå¾ˆæ™šæ‰ç¡ã€‚</li>
<li>æœºé‡ä¹‹æ­Œï¼šç›ä¸½å¡”éœ€è¦çš„å…¶å®åªæœ‰ä¸€æ ·ä¸œè¥¿â€”â€”æœºé‡.(ç›ä¸½å¡”æ”¾å¼ƒä¸€äº›è‡ªç”±æ—¶é—´ï¼Œæ”¾å¼ƒä¸€äº›ä¸ªæ€§ï¼Œé€šè¿‡æ›´å¤šçš„å­¦ä¹ æ—¶é—´å’ŒåŠªåŠ›æ”¹å˜è‡ªå·±çš„å‘½è¿ï¼ŒåŸæœ¬ä¸Šä¸äº†å¤§å­¦ï¼Œç°åœ¨æœ‰æœºä¼šäº†)<blockquote>
<p>â€œå¼‚ç±»â€æ˜¯é‚£äº›è·å¾—ç‰¹æ®Šæœºé‡ä¹‹äººï¼Œæ˜¯é‚£äº›è€å¿ƒç­‰å¾…ï¼Œå½“æœºé‡åˆ°æ¥æ—¶å°±å½“ä»ä¸è®©åœ°æŠŠæ¡ä½çš„äººã€‚<br>å¯¹äºåŠ æ‹¿å¤§çš„å†°çƒè¿åŠ¨ å‘˜æ¥è¯´ï¼Œç”Ÿäº1æœˆå°±æ˜¯ä»–ä»¬è¿›å…¥å…¨æ˜æ˜Ÿé˜Ÿçš„æœºé‡ã€‚<br>å¯¹äºç”²å£³è™«ä¹é˜Ÿæ¥è¯´ï¼Œæ±‰å ¡ ä¹‹æ—…å°±æ˜¯ä»–ä»¬æˆåçš„æœºé‡ã€‚<br>å¯¹äºæ¯”å°”Â·ç›–èŒ¨æ¥è¯´ï¼Œä»–çš„ç‰¹æ®Šæœºé‡å°±æ˜¯ç”Ÿåœ¨æ­£ ç¡®çš„å¹´ä»£ï¼Œå¹¶åœ¨åˆä¸­æ—¶ä»£å°±è·å¾—ç”µè„‘ç»ˆç«¯ã€‚<br>å¯¹äºå¼—æ´›å§†å’Œæ²ƒåˆ‡å°”Â·åˆ©æ™®é¡¿Â· ç½—æ£®Â·å¡èŒ¨å¾‹å¸ˆè¡Œçš„åˆ›å§‹äººæ¥è¯´ï¼Œæœºé‡æ˜¯å¤šé‡çš„ï¼šä»–ä»¬å‡ºç”Ÿäºæœ€ä½³å¹´ä»£ï¼Œæœ‰ç€èƒ½ç»™ä»–ä»¬æœ€å‹¤å‹‰æ¿€åŠ±çš„çˆ¶æ¯ï¼›ä»–ä»¬æ‹¥æœ‰å°‘æ•°æ—è£”èº«ä»½ï¼Œè¿™ç§èº«ä»½å¸®åŠ©ä»–ä»¬åœ¨çº½çº¦å…¶ä»–ä¼ ç»Ÿå¾‹å¸ˆäº‹åŠ¡æ‰€æ¶‰è¶³å…¬å¸å¹¶è´­å®˜å¸ä»¥å‰ï¼Œå°±å·²åœ¨è¿™ä¸ªé¢†åŸŸå®è·µäº†20å¹´ã€‚<br>æœ€åæ˜¯å¤§éŸ©èˆªç©ºï¼Œç›´åˆ°å…¬å¸å¸®åŠ©é£è¡Œå‘˜çªç ´åŸæœ‰æ–‡åŒ–çš„ç¦é”¢ï¼Œä»–ä»¬æ‰æœ€ç»ˆæ‰­è½¬äº†å±€åŠ¿ã€‚</p>
</blockquote>
</li>
</ul>
]]></content>
  </entry>
  <entry>
    <title>ã€Šæ€è€ƒï¼Œå¿«ä¸æ…¢ã€‹ ç¬¬7ç«  å­—æ¯Bä¸æ•°å­—13</title>
    <url>/%E3%80%8A%E6%80%9D%E8%80%83%EF%BC%8C%E5%BF%AB%E4%B8%8E%E6%85%A2%E3%80%8B-%E7%AC%AC7%E7%AB%A0-%E5%AD%97%E6%AF%8DB%E4%B8%8E%E6%95%B0%E5%AD%9713.html</url>
    <content><![CDATA[<p>æœ¬ç« åŒ…å«ä¸‰èŠ‚ï¼š</p>
<ul>
<li>æ˜¯ä»€ä¹ˆè®©ä½ ç›¸ä¿¡äº†é‚£äº›è’è°¬ä¹‹è¾</li>
<li>å…‰ç¯æ•ˆåº”ä¸ç¾¤ä½“æ™ºæ…§</li>
<li>çœ¼è§ä¸ºå®çš„æƒ³æ³•å¾€å¾€è®©æˆ‘ä»¬ä»“ä¿ƒä½œå‡ºå†³å®š</li>
</ul>
<h4 id="å¼€ç¯‡"><a href="#å¼€ç¯‡" class="headerlink" title="å¼€ç¯‡"></a>å¼€ç¯‡</h4><center>
    <img src="../images/b_and_13.jpg" width="50%"/>
</center>

<blockquote>
<p>â€œåŒæ ·çš„å½¢çŠ¶åœ¨å­—æ¯çš„ç¯å¢ƒä¸‹å°±å®¹æ˜“è¢«çœ‹åšæ˜¯å­—æ¯ï¼Œåœ¨æ•°å­—çš„ç¯å¢ƒä¸‹å°±å®¹æ˜“è¢«çœ‹åšæ˜¯æ•°å­—â€</p>
</blockquote>
<blockquote>
<p>â€œä½ è¿‡æ—©åœ°å¯¹å®ƒçš„â€œèº«ä»½â€ä¸‹äº†ç»“è®ºï¼Œå¹¶ä¸”æ ¹æœ¬æ„è¯†ä¸åˆ°ä½ å·²ç»èµ‹äºˆäº†æŸç§æ­§ä¹‰ä»¥è§£é‡Šã€‚â€</p>
</blockquote>
<blockquote>
<p>â€œä½ ä½œäº†ä¸€ä¸ªç¡®åˆ‡çš„é€‰æ‹©ï¼Œä½†è‡ªå·±å´æ²¡æœ‰æ„è¯†åˆ°è‡ªå·±è¿™æ ·åšäº†â€</p>
</blockquote>
<h4 id="æ˜¯ä»€ä¹ˆè®©ä½ ç›¸ä¿¡äº†é‚£äº›è’è°¬ä¹‹è¾"><a href="#æ˜¯ä»€ä¹ˆè®©ä½ ç›¸ä¿¡äº†é‚£äº›è’è°¬ä¹‹è¾" class="headerlink" title="æ˜¯ä»€ä¹ˆè®©ä½ ç›¸ä¿¡äº†é‚£äº›è’è°¬ä¹‹è¾"></a>æ˜¯ä»€ä¹ˆè®©ä½ ç›¸ä¿¡äº†é‚£äº›è’è°¬ä¹‹è¾</h4><blockquote>
<p>è”æƒ³è®°å¿†çš„è¿ä½œæ˜¯å¯¼è‡´â€œç¡®è®¤åè¯¯â€çš„åŸå› ä¹‹ä¸€</p>
</blockquote>
<p>â€œä½ è¯•è¯•ä»–ç»™å‡ºçš„ä¾‹å­ï¼šâ€œç™½é±¼åƒç³–æœã€‚â€<br>ä½ æœ‰å¯èƒ½æ„è¯†åˆ°ä¸€ä¸ªå…³äºé±¼å’Œç³–æœçš„æ¨¡ç³Šå°è±¡ï¼Œè¿™ä¸ªå°è±¡çš„äº§ç”Ÿè¿‡ç¨‹ï¼Œå°±æ˜¯è”æƒ³è®°å¿†è‡ªåŠ¨æœç´¢â€œé±¼â€å’Œâ€œç³–æœâ€è¿™ä¸¤ä¸ªæ¦‚å¿µä¹‹é—´å„ç§è”ç³»çš„è¿‡ç¨‹ï¼Œè¿™ä¸€è¿‡ç¨‹ä¼šä½¿è¿™ç§å¾ˆè’å”çš„è¯´æ³•çœ‹èµ·æ¥ç«Ÿæœ‰äº›é“ç†äº†ã€‚</p>
<h4 id="å…‰ç¯æ•ˆåº”ä¸ç¾¤ä½“æ™ºæ…§"><a href="#å…‰ç¯æ•ˆåº”ä¸ç¾¤ä½“æ™ºæ…§" class="headerlink" title="å…‰ç¯æ•ˆåº”ä¸ç¾¤ä½“æ™ºæ…§"></a>å…‰ç¯æ•ˆåº”ä¸ç¾¤ä½“æ™ºæ…§</h4><p>â€œå¦‚æœä½ èµåŒä¸€ä¸ªæ€»ç»Ÿçš„æ”¿è§ï¼Œä½ å¯èƒ½ä¹Ÿä¼šå–œçˆ±ä»–çš„å£°éŸ³åŠç€è£…ã€‚å–œçˆ±ï¼ˆæˆ–è®¨åŒï¼‰æŸä¸ªäººå°±ä¼šå–œçˆ±ï¼ˆæˆ–è®¨åŒï¼‰è¿™ä¸ªäººçš„å…¨éƒ¨â€”åŒ…æ‹¬ä½ è¿˜æ²¡æœ‰è§‚å¯Ÿåˆ°çš„æ–¹é¢â€”è¿™ç§å€¾å‘å°±å«åšå…‰ç¯æ•ˆåº”â€</p>
<p>Alanï¼šèªæ˜â€”å‹¤å¥‹â€”å†²åŠ¨â€”çˆ±æŒ‘å‰”â€”å›ºæ‰§â€”å¿Œå¦’å¿ƒå¼º<br>Benï¼šå¿Œå¦’å¿ƒå¼ºâ€”å›ºæ‰§â€”çˆ±æŒ‘å‰”â€”å†²åŠ¨â€”å‹¤å¥‹â€”èªæ˜</p>
<p>â€œå…‰ç¯æ•ˆåº”æ³¨é‡ç¬¬ä¸€å°è±¡ï¼Œè€Œåç»­ä¿¡æ¯åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šéƒ½è¢«æ¶ˆè§£æ‰äº†â€</p>
<h4 id="çœ¼è§ä¸ºå®çš„æƒ³æ³•å¾€å¾€è®©æˆ‘ä»¬ä»“ä¿ƒä½œå‡ºå†³å®š"><a href="#çœ¼è§ä¸ºå®çš„æƒ³æ³•å¾€å¾€è®©æˆ‘ä»¬ä»“ä¿ƒä½œå‡ºå†³å®š" class="headerlink" title="çœ¼è§ä¸ºå®çš„æƒ³æ³•å¾€å¾€è®©æˆ‘ä»¬ä»“ä¿ƒä½œå‡ºå†³å®š"></a>çœ¼è§ä¸ºå®çš„æƒ³æ³•å¾€å¾€è®©æˆ‘ä»¬ä»“ä¿ƒä½œå‡ºå†³å®š</h4><p>â€œæ‰€æœ‰å—è¯•è€…éƒ½å……åˆ†äº†è§£äº†æ•´ä¸ªè¿‡ç¨‹ï¼Œé‚£äº›åªå¬åˆ°å…¶ä¸­ä¸€æ–¹è¾©è¯çš„å—è¯•è€…èƒ½å¤Ÿå¾ˆè½»æ¾åœ°ä¸ºå¦ä¸€æ–¹å†™å‡ºè¾©è¯ã€‚ç„¶è€Œï¼Œç‰‡é¢çš„è¯æ®é™ˆè¿°å¯¹åˆ¤æ–­æœ‰ç€é‡å¤§å½±å“ã€‚<br>å¦å¤–ï¼ŒåªæŒæ¡ä¸€æ–¹è¯æ®çš„å—è¯•è€…æ¯”æŒæ¡äº†åŒæ–¹è¯æ®çš„å—è¯•è€…æ›´æœ‰è‡ªä¿¡ã€‚â€</p>
<p>â€œè¿™æ­£è¯´æ˜äººä»¬æ ¹æ®å·²æœ‰ä¿¡æ¯â€œå‹¾å‹’å‡ºçš„æ•…äº‹çš„è¿è´¯æ€§å¢å¼ºäº†ä»–ä»¬çš„è‡ªä¿¡å¿ƒã€‚ä¸€ä¸ªå¥½æ•…äº‹æœ€é‡è¦çš„æ˜¯ä¿¡æ¯çš„å‰åä¸€è‡´æ€§ï¼Œè€Œä¸æ˜¯å…¶å®Œæ•´æ€§ã€‚<br>çš„ç¡®ï¼Œä½ å¸¸ä¼šå‘ç°ï¼šçŸ¥é“å¾—å¾ˆå°‘åè€Œå¯ä»¥æŠŠå·²çŸ¥çš„æ‰€æœ‰äº‹ç‰©éƒ½å›Šæ‹¬è¿›è¿è´¯çš„æ€ç»´æ¨¡å¼ä¸­ã€‚</p>
<p>â€œçœ¼è§å³ä¸ºäº‹å®çš„ç†å¿µæœ‰åŠ©äºè¾¾æˆè¿è´¯æ€§å’Œè®¤çŸ¥æ”¾æ¾çš„çŠ¶æ€ï¼Œä»è€Œä½¿æˆ‘ä»¬ç›¸ä¿¡æŸä¸ªé™ˆè¿°æ˜¯çœŸå®çš„ã€‚è¿™ä¸€ç†å¿µè§£é‡Šäº†æˆ‘ä»¬èƒ½å¤Ÿå¿«é€Ÿæ€è€ƒçš„åŸå› ï¼Œè§£é‡Šäº†æˆ‘ä»¬æ˜¯å¦‚ä½•å¼„æ¸…æ¥šä¸€ä¸ªå¤æ‚é¢†åŸŸä¸­é‚£äº›ä¿¡æ¯ç‰‡æ®µçš„å«ä¹‰çš„ã€‚å¾ˆå¤šæ—¶å€™ï¼Œæˆ‘ä»¬æ‹¼å‡‘å‡ºçš„è¿è´¯æƒ…èŠ‚ä¸äº‹å®æ˜¯æ— é™æ¥è¿‘çš„ï¼Œå®Œå…¨å¯ä»¥ç”¨æ¥æ”¯æŒç†æ€§æ´»åŠ¨â€</p>
]]></content>
      <categories>
        <category>Reading</category>
      </categories>
      <tags>
        <tag>Reading</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€Šæ…¢æ€è€ƒã€‹</title>
    <url>/%E3%80%8A%E6%85%A2%E6%80%9D%E8%80%83%E3%80%8B.html</url>
    <content><![CDATA[<h4 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h4><h6 id="ä¹¦ç±ç®€ä»‹"><a href="#ä¹¦ç±ç®€ä»‹" class="headerlink" title="ä¹¦ç±ç®€ä»‹"></a>ä¹¦ç±ç®€ä»‹</h6><table>
    <tr>
        <td><img src="../images/books/slow-thinking.jpg" width="100"/></td>
        <td>æ…¢æ€è€ƒï¼šå¤§è„‘è¶…è½½æ—¶ä»£çš„æ€è€ƒå­¦</td>
    </tr>
</table>

<h4 id="å…³äºä½œè€…"><a href="#å…³äºä½œè€…" class="headerlink" title="å…³äºä½œè€…"></a>å…³äºä½œè€…</h4><p><a href="https://www.amazon.com/stores/author/B004N70U74/about">ç‰¹å¥¥Â·åº·æ™®è¯ºåˆ©ï¼ˆTeo Compagnoliï¼‰</a>æ•™æˆæ˜¯ä¸€ä½åœ¨åŒ»å­¦ã€ç¥ç»ç²¾ç¥ç—…å­¦ã€å¿ƒç†æ²»ç–—å’Œå•†ä¸šå’¨è¯¢é¢†åŸŸéƒ½é¢‡æœ‰å»ºæ ‘çš„ä¸“å®¶ã€‚</p>
<ul>
<li>æ¯”åˆ©æ—¶çš„é²æ±¶å¤©ä¸»æ•™å¤§å­¦è·å¾—åŒ»å­¦åšå£«</li>
<li>è·å…°çš„é˜¿å§†æ–¯ç‰¹ä¸¹å¤§å­¦è·å¾—åšå£«</li>
</ul>
<p>å…¶ä»–å‡ºç‰ˆç‰©ï¼š</p>
<ul>
<li>ã€Šå‹åŠ›ï¼šæœ‹å‹å’Œæ•Œäººã€‹</br></li>
</ul>
<h4 id="æœ¬ä¹¦çš„ç»“æ„"><a href="#æœ¬ä¹¦çš„ç»“æ„" class="headerlink" title="æœ¬ä¹¦çš„ç»“æ„"></a>æœ¬ä¹¦çš„ç»“æ„</h4><ol>
<li>ç¬¬ä¸€éƒ¨åˆ†ï¼šè§£é‡Šäº†å¤§è„‘çš„å·¥ä½œæœºåˆ¶</li>
<li>ç¬¬äºŒéƒ¨åˆ†ï¼šå¿½è§†å¤§è„‘çš„ä¼˜åŠ¿åŠ£åŠ¿å°±ä¼šç»™å¤§è„‘å¥—ä¸Šæ— å½¢çš„é”é“¾</li>
<li>ç¬¬ä¸‰éƒ¨åˆ†ï¼šè§£å¼€å¤§è„‘é”é“¾çš„æ–¹æ¡ˆâ€”â€”æ…¢æ€è€ƒ</li>
</ol>
<h4 id="å¯¼è¯»"><a href="#å¯¼è¯»" class="headerlink" title="å¯¼è¯»"></a>å¯¼è¯»</h4><p>äººçš„å¤§è„‘æœ‰ä¸‰å¥—è´Ÿè´£è®¤çŸ¥å†³ç­–çš„è„‘ç³»ç»Ÿï¼š</p>
<ul>
<li>åå°„è„‘ï¼šå¿«é€ŸåŸå§‹æ— æ„è¯†å¤„ç†é—®é¢˜</li>
<li>æ€è€ƒé—¹ï¼šæ…¢è€Œæˆç†Ÿæ¶ˆè€—å¤§é‡èƒ½é‡</li>
<li>å­˜å‚¨é—¹ï¼šå­˜å‚¨ä¿¡æ¯æ¿€å‘åˆ›æ„</li>
</ul>
<p>å¦‚ä½•ä¿æŒä¸“æ³¨ï¼š</p>
<ul>
<li>ç¬¬ä¸€ï¼Œå½»åº•ç¦»çº¿ï¼šæŠ½å‡ºå›ºå®šçš„ä¸å—æ‰“æ‰°çš„æ—¶é—´å®Œæˆä¸“æ³¨å·¥ä½œå’Œå¯¹è¯</li>
<li>ç¬¬äºŒï¼Œæ‰¹é‡å¤„ç†ï¼šå°½é‡å‡å°‘åˆ‡æ¢æ¬¡æ•°</li>
<li>ç¬¬ä¸‰ï¼Œæ¢å¤æ­£å¸¸çš„ç¡çœ æ¨¡å¼</li>
<li>ç¬¬å››ï¼Œç§‘å­¦åº”å¯¹è´Ÿé¢å‹åŠ›</li>
</ul>
<h4 id="ç¬¬ä¸€éƒ¨åˆ†ï¼šç¥å¥‡å¤§è„‘ä¸€ä¸ªç®€å•è€Œè¿·äººçš„ç§‘å­¦çœŸç›¸"><a href="#ç¬¬ä¸€éƒ¨åˆ†ï¼šç¥å¥‡å¤§è„‘ä¸€ä¸ªç®€å•è€Œè¿·äººçš„ç§‘å­¦çœŸç›¸" class="headerlink" title="ç¬¬ä¸€éƒ¨åˆ†ï¼šç¥å¥‡å¤§è„‘ä¸€ä¸ªç®€å•è€Œè¿·äººçš„ç§‘å­¦çœŸç›¸"></a>ç¬¬ä¸€éƒ¨åˆ†ï¼šç¥å¥‡å¤§è„‘ä¸€ä¸ªç®€å•è€Œè¿·äººçš„ç§‘å­¦çœŸç›¸</h4><ul>
<li>ç¬¬ä¸€ç« ï¼Œå…³äºå¤§è„‘çš„æƒŠäººçœŸç›¸<br>  å¤§è„‘é‡Œå¸®åŠ©æˆ‘ä»¬å¤„ç†æ•°æ®çš„ç»†èƒæ€»æ•°å…±æœ‰1600äº¿ä¸ªï¼Œå¤§è„‘å¹¶ä¸åƒæœºå™¨ä¸€æ ·ç”±ä¸€ä¸ªä¸ªç‹¬ç«‹éƒ¨ä»¶ç»„æˆï¼Œè€Œæ˜¯ä¸€å¥—å±‚å±‚å å çš„å¤æ‚ç½‘ç»œï¼Œä»–æ²¡æœ‰ä¸­æ¢å†³ç­–å™¨å®˜ã€‚æ–°ç»†èƒçš„äº§å‡ºä¼šéšç€å¹´é¾„çš„å¢é•¿è€Œå‡å°‘ä½†ä¸ä¼šå½»åº•åœæ­¢ã€‚<br>  å¤§è„‘èƒ½å¤Ÿä¸èº«ä½“é‡Œçš„50ä¸‡äº¿ï½100ä¸‡äº¿ä¸ªç»†èƒè¿›è¡Œç›´æ¥çš„åŒå‘é€šä¿¡ï¼Œè¿™äº›ç»†èƒç»„æˆäº†æˆ‘ä»¬çš„â€œèº«ä½“è„‘â€ã€‚<br>  èº«ä½“è„‘é€šè¿‡ä¸‰å¥—ç³»ç»Ÿå½±å“å…¨èº«æ‰€æœ‰ç»†èƒï¼š<ul>
<li>ååº”æå…¶è¿…é€Ÿçš„ç¥ç»ç³»ç»Ÿ</li>
<li>ååº”è¾ƒæ…¢çš„å†…åˆ†æ³Œç³»ç»Ÿã€‚</li>
<li>å…ç–«ç³»ç»Ÿã€‚</li>
</ul>
</li>
<li>ç¬¬äºŒç« ï¼Œæœå£³é‡Œçš„ä¸‰ç§è„‘<ul>
<li>æ…¢è€Œæˆç†Ÿçš„æ€è€ƒè„‘<ul>
<li>é€Ÿåº¦æ…¢ï¼Œéœ€è¦ä¸“æ³¨ï¼Œæ¶ˆè€—å¤§é‡èƒ½é‡ï¼Œæ˜“ç–²åŠ³ï¼Œä¸²è¡Œå¤„ç†ï¼Œåˆ¶å®šè¿œæœŸç›®æ ‡å¹¶æå‰åšå‡ºé¢„åˆ¤ã€‚</li>
</ul>
</li>
<li>å¿«è€ŒåŸå§‹çš„åå°„è„‘<ul>
<li>é€Ÿåº¦å¿«ï¼Œè‡ªå‘æ— æ„è¯†ï¼Œæƒ…æ„Ÿç½‘ç»œä¹Ÿå±äºåå°„è„‘çš„ä¸€éƒ¨åˆ†ã€‚</li>
</ul>
</li>
<li>æ—¶åˆ»ç­‰å¾…ç©ºé—²çš„å­˜å‚¨è„‘<ul>
<li>ä¿¡æ¯åˆ†ç±»å­˜å‚¨ï¼Œä¸»è¦ä»¥è”æƒ³æ–¹å¼ä¿å­˜ä¿¡æ¯ï¼Œå¹´é¾„å¢åŠ ä¿¡æ¯æ£€ç´¢æ—¶é—´å¢åŠ ï¼Œä¸æ€è€ƒè„‘ä¿æŒå¹³è¡¡ï¼Œå…¶ä¸­ä¸€ä¸ªæ¿€æ´»å¦ä¸€ä¸ªå°±ä¼‘æ¯ã€‚</li>
</ul>
</li>
</ul>
</li>
<li>ç¬¬ä¸‰ç« ï¼Œæ€è€ƒè„‘ï¼šä¸èƒ½ä¸€å¿ƒäºŒç”¨</li>
<li>ç¬¬å››ç« ï¼Œåå°„è„‘ï¼šæ€»å–œæ¬¢æŠ„æ·å¾„</li>
<li>ç¬¬äº”ç« ï¼Œå­˜å‚¨é—¹ï¼šè‡³å…³é‡è¦çš„æ”¾æ¾</li>
<li>ç¬¬å…­ç« ï¼Œå¦‚ä½•åœ¨æ‰å¹³çš„ä¸–ç•Œæ·±å…¥æ€è€ƒ</li>
</ul>
<h4 id="ç¬¬äºŒéƒ¨åˆ†ï¼šè„‘é”é“¾å¦‚ä½•ä¸è‡ªè§‰åœ°æ‘§æ¯è‡ªå·±çš„å¤§è„‘"><a href="#ç¬¬äºŒéƒ¨åˆ†ï¼šè„‘é”é“¾å¦‚ä½•ä¸è‡ªè§‰åœ°æ‘§æ¯è‡ªå·±çš„å¤§è„‘" class="headerlink" title="ç¬¬äºŒéƒ¨åˆ†ï¼šè„‘é”é“¾å¦‚ä½•ä¸è‡ªè§‰åœ°æ‘§æ¯è‡ªå·±çš„å¤§è„‘"></a>ç¬¬äºŒéƒ¨åˆ†ï¼šè„‘é”é“¾å¦‚ä½•ä¸è‡ªè§‰åœ°æ‘§æ¯è‡ªå·±çš„å¤§è„‘</h4><ul>
<li>ç¬¬ä¸ƒç« ï¼Œ1å·é”é“¾ï¼šéšæ—¶åœ¨çº¿<ul>
<li>ç°ä»£æŠ€æœ¯è®©æˆ‘ä»¬è¢«çŸ­ä¿¡é‚®ä»¶é€šçŸ¥ç”µè¯ç­‰å¤–éƒ¨äº‹ä»¶æ‰€å¸å¼•ï¼Œå¯¼è‡´ç²¾åŠ›åˆ†æ•£ã€‚</li>
<li>ä¿¡æ¯è¶…è½½ï¼Œä¿¡æ¯çš„å……æ²›æ¶ˆè€—èµ„æºï¼Œæ¶ˆè€—ä»€ä¹ˆèµ„æºå‘¢ï¼Ÿæ¥æ”¶è€…çš„æ³¨æ„åŠ›ï¼</li>
<li>å†³ç­–ç–²åŠ³ï¼šç»è¿‡ä¸€æ®µæ—¶é—´æŒç»­çš„è‡ªæˆ‘æ§åˆ¶æˆ–æ˜¯åšå‡ºå¤§é‡çš„å°é€‰æ‹©ä»¥åï¼Œäºº çš„è‡ªæ§åŠ›ã€æ¯…åŠ›ã€é¢å¯¹å¤±è´¥æ—¶çš„éŸ§æ€§éƒ½ä¼šæœ‰æ‰€è¡°é€€ï¼Œæ‹–å»¶æƒ…å†µåŠ å‰§ï¼Œ æ•°å­¦è®¡ç®—çš„æ•°é‡å’Œè´¨é‡ä¸‹é™ï¼Œå†³ç­–èƒ½åŠ›ä¹Ÿä¼šå˜å·®ã€‚</li>
</ul>
</li>
<li>ç¬¬å…«ç« ï¼Œ2å·é”é“¾ï¼šå¤šä»»åŠ¡å¹¶è¡Œ</li>
<li>ç¬¬ä¹ç« ï¼Œ3å·é”é“¾ï¼šä½æ°´å¹³å‹åŠ›</li>
<li>ç¬¬åç« ï¼Œ4å·é”é“¾ï¼šç¡çœ ä¸è¶³</li>
<li>ç¬¬åä¸€ç« ï¼Œç¦»çº¿æ€è€ƒä¸ºä½•å¦‚æ­¤å›°éš¾<ul>
<li>æ·±å…¥é˜…è¯»æ˜¯æ€è€ƒä¸å¯æˆ–ç¼ºçš„å‰æ</li>
<li>çœŸæ­£çš„å¯¹è¯å¯¹æ€è€ƒè‡³å…³é‡è¦<ul>
<li>level1 = é—²èŠï¼šé‡ç‚¹ä¸åœ¨äºå†…å®¹ï¼Œåœ¨äºç»´æŠ¤å…³ç³»</li>
<li>level2 = è®¨è®ºï¼šè¯´æ˜è‡ªå·±çš„ä¸»è§‚çœ‹æ³•ã€è§‚ç‚¹ã€æ„è§ã€ä¿¡å¿µå’Œä»·å€¼åˆ¤æ–­</li>
<li>level3 = çœŸæ­£å¯¹è¯ï¼šç»¼åˆå½¼æ­¤çœ‹æ³•åˆ›é€ å‡ºæ–°æ„ä¹‰å¹¶ç”±æ­¤å»ºç«‹æ›´ç¨³å›ºçš„å…³ç³»ã€‚èƒ½å¤Ÿå‘èµ·å¹¶å¼•å¯¼çœŸæ­£çš„å¯¹è¯ï¼Œè¿™æ˜¯æ™ºå•†å’Œæƒ…å•†çš„é‡è¦å…ƒç´ ã€‚</li>
</ul>
</li>
<li>åˆ†æ•£æ³¨æ„åŠ›çš„ç½ªé­ç¥¸é¦–<center>
<img src="../images/books/xinxi_and_sikao.jpg" width="400"/>
</center></li>
</ul>
</li>
</ul>
<h4 id="ç¬¬ä¸‰éƒ¨åˆ†ï¼šæ…¢æ€è€ƒå¦‚ä½•è§£æ”¾ä½ çš„å¤§è„‘"><a href="#ç¬¬ä¸‰éƒ¨åˆ†ï¼šæ…¢æ€è€ƒå¦‚ä½•è§£æ”¾ä½ çš„å¤§è„‘" class="headerlink" title="ç¬¬ä¸‰éƒ¨åˆ†ï¼šæ…¢æ€è€ƒå¦‚ä½•è§£æ”¾ä½ çš„å¤§è„‘"></a>ç¬¬ä¸‰éƒ¨åˆ†ï¼šæ…¢æ€è€ƒå¦‚ä½•è§£æ”¾ä½ çš„å¤§è„‘</h4><ul>
<li>ç¬¬åäºŒç« ï¼Œ1å·è§£é”ç§˜è¯€ï¼šç¦»çº¿æ€è€ƒ<ul>
<li>æŠ½å‡ºå›ºå®šçš„ä¸å—æ‰“æ‰°çš„æ—¶é—´ï¼Œæ¥å®Œæˆä¸“æ³¨çš„å·¥ä½œå’Œå¯¹è¯ã€‚çŠ¶æ€æœ€å¥½çš„æ—¶é—´æ®µï¼ˆæ—©ä¸Šï¼Ÿæ™šä¸Šï¼Ÿï¼‰ã€‚</li>
<li>æ¯å‘¨æ—¥æ™šæŠ½å‡º20åˆ†é’Ÿè®¡åˆ’ä¸€å‘¨çš„å·¥ä½œï¼Œæ¯å¤©ç¡å‰æŠ½10åˆ†é’Ÿå®‰æ’ç¬¬äºŒå¤©çš„å·¥ä½œï¼Œè¿™æ ·ï¼Œç¡è§‰æ—¶ï¼Œå­˜å‚¨è„‘ä¼šæå‰å·¥ä½œã€‚</li>
<li>çº¸è´¨é˜…è¯»æ›´åˆ©äºç†è§£ã€é˜…è¯»é€Ÿåº¦æ›´å¿«ã€ä¹Ÿæ›´ä¸å®¹æ˜“ç–²åŠ³</li>
</ul>
</li>
<li>ç¬¬åä¸‰ç« ï¼Œ2å·è§£é”ç§˜è¯€ï¼šæ‰¹é‡å¤„ç†</li>
</ul>
<p>13.1 è‰¾æ£®è±ªå¨å°”åŸç†ï¼ˆäº‹æƒ…çš„é‡è¦æ€§ã€ç´§æ€¥æ€§å››è±¡é™ï¼‰</p>
<center>
    <img src="../images/books/important_urgent_things.jpg" width="400"/>
</center>


<p>13.2 å¸•ç´¯æ‰˜æ³•åˆ™ï¼ˆ20%çš„æ´»åŠ¨åˆ›é€ 80%æ•ˆç›Šï¼Œè¦æé«˜æ•ˆç‡ï¼Œä½ çš„æ‰¾å‡ºé‚£äº›é«˜ä»·å€¼çš„æ´»åŠ¨æ¥ï¼‰</p>
<center>
    <img src="../images/books/paleituo.jpg" width="400"/>
</center>

<ul>
<li>é€’è¿›å¸•ç´¯æ‰˜æ³•åˆ™ï¼ˆå¹³æ–¹ï¼š4%çš„æ´»åŠ¨äº§ç”Ÿ64%çš„ä»·å€¼ï¼Œä¸‰æ¬¡æ–¹ï¼‰</li>
<li>å¿«ä¹çš„å¸•ç´¯æ‰˜æ³•åˆ™ï¼ˆåšç§¯ææœ‰æ„ä¹‰è®©ä½ å¿«ä¹çš„äº‹æƒ…ï¼‰</li>
</ul>
<p>13.3 æ‰¹é‡å¤„ç†ï¼š<br>13.4 åˆç†å®‰æ’æ¯ä¸ªäººçš„ä»»åŠ¡ï¼š<br>13.5 ä»æ ¹æºæ¶ˆé™¤å¤šä»»åŠ¡ï¼šç®¡ç†è€…åœ¨è§„åˆ’å·¥ä½œæµç¨‹å’Œé¡¹ç›®æ—¶åº”è¯¥å°½é‡é¿å…å¤šä»»åŠ¡å¹¶è¡Œã€‚<br>13.6 å¦‚ä½•æ‰“è´¥é‚®ä»¶æ€ªå…½ï¼šé‚®ä»¶ä¼šè¿‡åº¦åˆ†æ•£æˆ‘ä»¬çš„ä¸“æ³¨åŠ›ï¼Œè¦é›†ä¸­æ‰¹é‡æŠŠå®ƒå¤„ç†äº†ã€‚ï¼ˆè¿™å¯èƒ½æ˜¯å¤–å›½äººç”Ÿæ´»çš„ä¸€éƒ¨åˆ†å§ï¼‰</p>
<ul>
<li>ç¬¬åå››ç« ï¼Œ3å·è§£é”ç§˜è¯€ï¼šæ¢å¤æ­£å¸¸çš„ç¡çœ æ¨¡å¼<ul>
<li>ä¿è¯8å°æ—¶ç¡çœ </li>
<li>æ¯å¤©åŒæ ·çš„æ—¶é—´å°±å¯èµ·åºŠï¼ŒåŒ…æ‹¬å‘¨æœ«ï¼ˆè¡¥è§‰åº”è¯¥æ—©ç‚¹ä¸ŠåºŠè€Œä¸æ˜¯æ™šèµ·ï¼‰</li>
</ul>
</li>
<li>ç¬¬åäº”ç« ï¼Œ4å·è§£é”ç§˜è¯€ï¼šç§‘å­¦åº”å¯¹è´Ÿé¢å‹åŠ›<ul>
<li>çŸ­æš‚å‹åŠ›èƒ½åˆºæ¿€æ™ºåŠ›ç”Ÿäº§åŠ›ï¼Œå‹åŠ›è¿‡å¤§æŒç»­æ—¶é—´è¿‡é•¿ä¼šæ‘§æ¯ä½ çš„æ™ºåŠ›ç”Ÿäº§åŠ›ã€‚</li>
<li>é¢‘ç¹ä»»åŠ¡åˆ‡æ¢å¯¼è‡´çš„æ…¢æ€§å‹åŠ›ä¼šç§¯å‹æˆå¤§å‹åŠ›å¯¼è‡´æ€è€ƒç²¾ç–²åŠ›å°½</li>
</ul>
</li>
</ul>
<center>
    <img src="../images/books/yali.jpg" width="400"/>
</center>

<ul>
<li>ç¬¬åå…­ç« ï¼ŒABCæ¨¡å¼ï¼šå¦‚ä½•æŠŠåä¹ æƒ¯å˜æˆå¥½ä¹ æƒ¯</li>
</ul>
<h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><p>è¿™æœ¬ä¹¦çš„ä¸­æ–‡åç¿»è¯‘ï¼Œçƒ‚é€äº†ï¼åŸä¹¦åï¼šã€Šè„‘é“¾ï¼šåœ¨é«˜åº¦äº’è”çš„å¤šä»»åŠ¡ä¸–ç•Œä¸­é‡Šæ”¾ä½ çš„æ½œèƒ½ã€‹æ ¸å¿ƒæ€æƒ³æ˜¯è®©ä½ æå‡å¤§è„‘åˆ©ç”¨ç‡ï¼Œé«˜æ•ˆå·¥ä½œç”Ÿæ´»ï¼Œçç¢å·¥ä½œé›†ä¸­å¤„ç†ï¼Œä¸“æ³¨ã€‚<br>ç¬¬ä¸€éƒ¨åˆ†ä»‹ç»å¤§è„‘çš„å·¥ä½œæœºåˆ¶ï¼Œç¬¬äºŒéƒ¨åˆ†ä»‹ç»äº†ä¸€äº›å¯¼è‡´æˆ‘ä»¬å¤§è„‘æ•ˆç‡ä½ä¸‹çš„é—®é¢˜ï¼Œç¬¬ä¸‰éƒ¨åˆ†ä»‹ç»ä¸€äº›æ–¹æ³•è§£å†³è¿™äº›é—®é¢˜ã€‚</p>
]]></content>
      <categories>
        <category>Reading</category>
      </categories>
      <tags>
        <tag>Reading</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€Šè®¤çŸ¥å¤©æ€§ã€‹</title>
    <url>/%E3%80%8A%E8%AE%A4%E7%9F%A5%E5%A4%A9%E6%80%A7%E3%80%8B.html</url>
    <content><![CDATA[<h4 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h4><h6 id="ä¹¦ç±ç®€ä»‹"><a href="#ä¹¦ç±ç®€ä»‹" class="headerlink" title="ä¹¦ç±ç®€ä»‹"></a>ä¹¦ç±ç®€ä»‹</h6><table>
    <tr>
        <td><img src="../images/books/renzhitianxing.jpg" width="100"/></td>
        <td>è®¤çŸ¥å¤©æ€§ : è®©å­¦ä¹ è½»è€Œæ˜“ä¸¾çš„å¿ƒç†å­¦è§„å¾‹</td>
    </tr>
</table>

<h6 id="å…³äºä½œè€…"><a href="#å…³äºä½œè€…" class="headerlink" title="å…³äºä½œè€…"></a>å…³äºä½œè€…</h6><p>ä¸‰ä½ä½œè€…ï¼š</p>
<ul>
<li>å½¼å¾—Â·å¸ƒæœ—ï¼ˆPeter C. Brownï¼‰<br>ä¸€ä½ä½œå®¶å’Œç‹¬ç«‹å‡ºç‰ˆäººï¼Œä¸“æ³¨äºæ’°å†™å†å²ã€å•†ä¸šå’Œå¿ƒç†å­¦æ–¹é¢çš„ä¹¦ç±ã€‚ä»–åœ¨ã€Šè®¤çŸ¥å¤©æ€§ã€‹ä¸­æ‹…ä»»ä¸»è¦æ’°ç¨¿äººï¼Œè´Ÿè´£å°†ç§‘å­¦å®¶ä»¬çš„ç ”ç©¶æˆæœè½¬åŒ–ä¸ºæ˜“äºç†è§£å’Œåº”ç”¨çš„å†…å®¹</li>
<li>äº¨åˆ©Â·å‹’è¿ªæ ¼ï¼ˆHenry L. Roediger IIIï¼‰<br>åç››é¡¿å¤§å­¦å¿ƒç†ä¸è„‘ç§‘å­¦ç³»çš„æ•™æˆã€‚ä»–çš„ç ”ç©¶ä¸»è¦é›†ä¸­åœ¨è®°å¿†å’Œå­¦ä¹ æ–¹é¢ï¼Œå°¤å…¶æ˜¯è®°å¿†çš„æå–å’Œæµ‹è¯•æ•ˆåº”ï¼ˆtesting effectï¼‰ã€‚å‹’è¿ªæ ¼æ•™æˆåœ¨è®¤çŸ¥å¿ƒç†å­¦é¢†åŸŸå‘è¡¨äº†å¤§é‡çš„ç ”ç©¶è®ºæ–‡ï¼Œå¹¶è·å¾—äº†å¤šé¡¹è£èª‰å’Œå¥–é¡¹ã€‚</li>
<li>é©¬å…‹Â·éº¦å…‹ä¸¹å°¼å°”ï¼ˆMark A. McDanielï¼‰<br>åç››é¡¿å¤§å­¦å¿ƒç†ä¸è„‘ç§‘å­¦ç³»çš„æ•™æˆï¼Œä¸“æ³¨äºè®¤çŸ¥å¿ƒç†å­¦å’Œæ•™è‚²å¿ƒç†å­¦ã€‚ä»–çš„ç ”ç©¶å…´è¶£åŒ…æ‹¬è®°å¿†ã€å­¦ä¹ ç­–ç•¥å’Œå¦‚ä½•åœ¨å®é™…æ•™è‚²ç¯å¢ƒä¸­åº”ç”¨è¿™äº›ç­–ç•¥ã€‚éº¦å…‹ä¸¹å°¼å°”æ•™æˆä¹Ÿåœ¨è®¤çŸ¥å¿ƒç†å­¦é¢†åŸŸå‘è¡¨äº†è®¸å¤šé‡è¦çš„ç ”ç©¶æˆæœï¼Œå¹¶ä¸å‹’è¿ªæ ¼æ•™æˆå…±åŒå¼€å±•äº†å¤§é‡çš„åˆä½œç ”ç©¶ã€‚</li>
</ul>
<h5 id="ç»“æ„"><a href="#ç»“æ„" class="headerlink" title="ç»“æ„"></a>ç»“æ„</h5><ul>
<li>å­¦ä¹ æ˜¯æŒ‘æˆ˜å¤©æ€§çš„å¿…é¡»è¯¾</li>
<li>å­¦ä¹ çš„æœ¬è´¨ï¼šçŸ¥è¯†é“¾å’Œè®°å¿†ç»“</li>
<li>â€œååˆ»æ„ç»ƒä¹ â€æ—¶ä»£çš„åˆ°æ¥</li>
<li>çŸ¥è¯†çš„â€œæ»šé›ªçƒâ€æ•ˆåº”</li>
<li>æ‰“é€ é€‚åˆè‡ªå·±çš„å¿ƒæ™ºæ¨¡å‹</li>
<li>é€‰æ‹©é€‚åˆè‡ªå·±çš„å­¦ä¹ é£æ ¼</li>
<li>ç»ˆèº«å­¦ä¹ è€…åŸºæœ¬çš„åŸºæœ¬</li>
<li>å†™ç»™å¤§å®¶çš„å­¦ä¹ ç­–ç•¥</li>
</ul>
<h5 id="å†…å®¹"><a href="#å†…å®¹" class="headerlink" title="å†…å®¹"></a>å†…å®¹</h5><ul>
<li>1ã€å­¦ä¹ æ˜¯æŒ‘æˆ˜å¤©æ€§çš„å¿…é¡»è¯¾<ul>
<li>å¤©æ€§æ‡’æƒ°å­•è‚²äº†è®¤çŸ¥è§„å¾‹å’Œå¿ƒæ™ºæ¨¡å‹<ul>
<li>è€—è´¹å¿ƒè¡€çš„å­¦ä¹ æ‰æ˜¯æ·±å±‚æ¬¡çš„ï¼Œæ•ˆæœä¹Ÿæ›´æŒä¹…ã€‚ä¸èŠ±åŠ›æ°”çš„å­¦ä¹ å°±åƒåœ¨æ²™å­ä¸Šå†™å­—ï¼Œä»Šå¤©å†™ä¸Šï¼Œæ˜å¤©å­—å°±æ¶ˆå¤±äº†ã€‚</li>
<li>ä¸åå¤é˜…è¯»è¿™ç§å¤ä¹ æ–¹æ³•ç›¸æ¯”ï¼Œ<strong>å›æƒ³äº‹å®ã€æ¦‚å¿µæˆ–äº‹ä»¶</strong>ä¼šæ›´æœ‰æ•ˆã€‚è¿™ç§æ–¹æ³•è¢«ç§°ä¸ºæ£€ç´¢å¼ç»ƒä¹ ã€‚</li>
</ul>
</li>
<li>ç§‘å­¦â€œç…§å¦–é•œâ€ä¸‹çš„å­¦ä¹ æ–¹æ³•<ul>
<li>èƒŒè¯µã€ä¸æ–­é‡å¤ã€åå¤é˜…è¯»ã€<strong>åŠŸåˆ©æ€§è®°å¿†</strong>ã€é›†ä¸­ç»ƒä¹ ç­‰æ–¹å¼ï¼Œçœ‹èµ·æ¥å¾ˆåˆ»è‹¦ï¼Œå…¶å®æ•ˆæœä¸å¥½ï¼Œå¾ˆå¿«è¢«å¿˜è®°ã€‚</li>
<li>å¯¹æ–‡å­—è¶Šç†Ÿæ‚‰ã€è¶Šæµç•…é˜…è¯»ï¼Œä¼šé€ æˆä¸€ç§æŒæ¡çš„å‡è±¡ã€‚</li>
<li>å½“äº‹å…³é‡å¤§æ—¶ï¼Œå½“æŠ½è±¡çš„äº‹åŠ¡è¢«å½¢è±¡åŒ–æ—¶ï¼Œå½“äº‹æƒ…å’Œä¸ªäººæ¯æ¯ç›¸å…³æ—¶ï¼Œä½ å°±ä¼šæŠŠå­¦åˆ°çš„ä¸œè¥¿è®°å¾—æ›´ç‰¢ã€‚</li>
<li>è½»æ˜“æ¥å—åˆ«äººçš„è§‚ç‚¹ï¼Œä¸ç»™è‡ªå·±æé—®é¢˜ï¼Œæ²¡æœ‰å»æƒ³ä»€ä¹ˆæ˜¯è‡ªå·±ä¸çŸ¥é“çš„</li>
</ul>
</li>
<li>çŸ¥è¯†å¤šä¸ç­‰äºå­¦ä¹ èƒ½åŠ›å¼º<ul>
<li>å­¦ä¹ çŸ¥è¯†ä¸èƒ½æ±‚å¿«ï¼Œè¦æ±‚æ‰å®ï¼Œå¾ªåºæ¸è¿›ç†è§£ã€‚</li>
</ul>
</li>
<li>è€ƒè¯•æ˜¯æœ€æœ‰æ•ˆçš„å­¦ä¹ ç­–ç•¥ä¹‹ä¸€<ul>
<li>ä¸è¦æŠŠè€ƒè¯•å½“åšè¡¡é‡å­¦ä¹ æˆæœçš„æ ‡å°ºï¼Œè€Œæ˜¯è®°å¿†æ£€ç´¢çš„ç»ƒä¹ ï¼Œä¸€ç§å­¦ä¹ å·¥å…·ã€‚</li>
<li>ä¸»åŠ¨æ£€ç´¢ï¼ˆè€ƒè¯•ï¼‰å¯ä»¥å¼ºåŒ–è®°å¿†ï¼Œè€Œä¸”æ£€ç´¢èŠ±è´¹çš„å¿ƒæ€è¶Šå¤šï¼Œå—ç›Šå°±è¶Šå¤šã€‚</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>è¯»ä¹¦ç¬”è®°ï¼šä¸è¦æ— æ„è¯†çš„é‡å¤ï¼Œé›†ä¸­ç»ƒä¹ ã€æŠŠæŠ½è±¡å½¢è±¡åŒ–ï¼Œæ‰¾åˆ°çŸ¥è¯†ä¸è‡ªå·±çš„å…³è”ã€‚åˆ«å¤ªåœ¨æ„è€ƒè¯•çš„æˆç»©ã€‚</p>
<ul>
<li>2ã€å­¦ä¹ çš„æœ¬è´¨ï¼šçŸ¥è¯†é“¾å’Œè®°å¿†ç»“<ul>
<li>çŸ¥è¯†æœ€ç»ˆå°†å˜æˆæ¡ä»¶åå°„<ul>
<li>å¯ä»¥å¸¦æ¥æ›´å¥½çš„å­¦ä¹ æ•ˆæœï¼šä»è®°å¿†ä¸­æ£€ç´¢çŸ¥è¯†æˆ–æ˜¯æ—©æœŸçš„è®­ç»ƒå†…å®¹ï¼ŒæŠŠè¿™äº›å’Œæ–°ä½“éªŒè”ç³»èµ·æ¥ï¼Œå€ŸåŠ©è§‚å¯Ÿå’Œæ€è€ƒï¼Œé¢„å…ˆæ¼”ç»ƒä½ ä¸‹æ¬¡å¯èƒ½é‡‡å–çš„ä¸åŒåšæ³•ã€‚</li>
</ul>
</li>
<li>è‡ªæˆ‘æ£€æŸ¥ï¼šç»™çŸ¥è¯†é“¾æ‰“ä¸Šè®°å¿†ç»“<ul>
<li>é‡å¤æ£€ç´¢èƒ½è®©è®°å¿†æ›´æ¸…é€ï¼Œè€Œä¸”å®ƒæŠŠè®°å¿†è¿™æ¡ç»³å­åˆç¼ äº†ä¸€åœˆï¼Œä½¿å…¶å˜å¾— æ›´ç‰¢é ã€‚</li>
</ul>
</li>
<li>åªéœ€ä¸€æ¬¡è‡ªæµ‹ï¼šä¸€å‘¨åå›å¿†ç‡28%è·ƒè¿ä¸º39%<ul>
<li>è‡ªæµ‹æ˜¯ä¸€ç§æ£€ç´¢å¼å­¦ä¹ ï¼Œå¯ä»¥å¼ºåŒ–è®°å¿†ã€‚</li>
</ul>
</li>
<li>å¦‚ä½•æˆä¸ºä¸€åä¸»åŠ¨å­¦ä¹ è€…</li>
<li>ä¸ºä½•å­¦ä¹ è¶Šè½»æ¾æ•ˆæœè¶Šä¸å¥½</li>
</ul>
</li>
</ul>
<p>è¯»ä¹¦ç¬”è®°ï¼šä¸æ–­å›é¡¾çŸ¥è¯†ï¼ˆè€ƒè¯•ï¼‰å¯ä»¥åŠ æ·±å°è±¡ï¼Œå‡å°‘é—å¿˜ã€‚åæ€ä¹Ÿæ˜¯ä¸€ç§è®°å¿†æ£€ç´¢ã€‚</p>
<ul>
<li>3ã€â€œååˆ»æ„ç»ƒä¹ â€æ—¶ä»£çš„åˆ°æ¥<ul>
<li>é¢‘ç¹çš„é›†ä¸­ç»ƒä¹ åªä¼šäº§ç”ŸçŸ­æœŸè®°å¿†</li>
<li>é—´éš”ç»ƒä¹ ä½¿çŸ¥è¯†å­˜å‚¨å¾—æ›´ç‰¢å›º</li>
<li>ç©¿æ’ç»ƒä¹ æœ‰åŠ©äºé•¿æœŸè®°å¿†</li>
<li>å¤šæ ·åŒ–ç»ƒä¹ ä¿ƒè¿›çŸ¥è¯†çš„æ´»å­¦æ´»ç”¨</li>
<li>å–„ç”¨ç»ƒä¹ ç»„åˆï¼Œå¸¦æ¥æˆé•¿æ€§æ€ç»´</li>
<li>çŸ¥è¯†æ˜¯å¹³é¢çš„ï¼Œå¤åˆå‹çŸ¥è¯†æ˜¯ç«‹ä½“çš„</li>
<li>å…³äºç»ƒä¹ çš„å‡ æ¡æ™®é€‚æ€§åŸåˆ™</li>
</ul>
</li>
</ul>
<p>è¯»ä¹¦ç¬”è®°ï¼šè¿™ä¸€éƒ¨åˆ†çš„å‰¯æ ‡é¢˜æ˜¯è¿è´¯æ·±å…¥çš„ã€‚</p>
<ul>
<li>4ã€çŸ¥è¯†çš„â€œæ»šé›ªçƒâ€æ•ˆåº”<ul>
<li>å­¦ä¹ çš„ä¸‰ä¸ªå…³é”®æ­¥éª¤<ul>
<li>ç¼–ç </li>
<li>å·©å›º</li>
<li>æ£€ç´¢</li>
</ul>
</li>
<li>æ¬²æ±‚æ–°çŸ¥ï¼Œå…ˆå¿˜æ—§äº‹<ul>
<li>ä½¿ç”¨Macç”µè„‘ï¼Œè¦å…ˆå¿˜è®°Windowsç”µè„‘ï¼Œå› ä¸ºWindowsçš„æ“ä½œä¹ æƒ¯ä¼šå¹²æ‰°ä½ çš„å­¦ä¹ ã€‚å¿˜æ‰çš„ä¸æ˜¯çŸ¥è¯†æœ¬èº«ï¼Œè€Œæ˜¯æ£€ç´¢çš„çº¿ç´¢ã€‚</li>
</ul>
</li>
<li>è¶Šå®¹æ˜“æƒ³èµ·ï¼Œè¶Šä¸å®¹æ˜“è®°ä½</li>
<li>å­¦ä¹ ä¸­å¿…é¡»è¦åšå“ªäº›åŠªåŠ›<ul>
<li>é‡æ–°å·©å›ºè®°å¿†</li>
<li>æ‰“é€ å¿ƒæ™ºæ¨¡å‹ï¼šå¤æ‚ç†è®ºæˆ–è¿ç»­è¿åŠ¨æŠ€èƒ½èåˆæˆæœ‰æ„ä¹‰çš„æ•´ä½“ã€‚</li>
<li>ä¸¾ä¸€åä¸‰</li>
<li>æ„å»ºæ¦‚å¿µå­¦ä¹ </li>
<li>å­¦ä¹ è¿ç§»</li>
<li>åšå¥½å­¦ä¹ çš„å¿ƒç†å‡†å¤‡</li>
</ul>
</li>
<li>è¿™äº›â€è‰¯æ€§å¹²æ‰°â€œèƒ½æå‡å­¦ä¹ æ•ˆæœ</li>
<li>åŒ–è§£å› å¤±è´¥å¸¦æ¥çš„ç„¦è™‘æ„Ÿ</li>
<li>åˆ›é€ æ€§æºäºä¸è®¾é™çš„å­¦ä¹ </li>
<li>åˆ«åœ¨æ— æ³•å…‹æœçš„å›°éš¾ä¸Šæµªè´¹æ—¶é—´</li>
</ul>
</li>
</ul>
<p>è¯»ä¹¦ç¬”è®°ï¼š</p>
<ul>
<li>5ã€æ‰“é€ é€‚åˆè‡ªå·±çš„å¿ƒæ™ºæ¨¡å‹<ul>
<li>æ²¡å¤´è„‘çš„æœºåˆ¶1å’Œçˆ±è‡ªçœçš„æœºåˆ¶2<ul>
<li>æŒ‡åå°„è„‘å’Œé€»è¾‘è„‘ï¼ˆã€Šæ€è€ƒå¿«ä¸æ…¢ã€‹ï¼‰</li>
</ul>
</li>
<li>å­¦ä¹ æ—¶é¿å…é”™è§‰å’Œè®°å¿†æ‰­æ›²</li>
<li>æ‰“é€ é€‚åˆè‡ªå·±çš„å¿ƒæ™ºæ¨¡å‹</li>
<li>ä½ æ— æ³•ä»ä¸æ“…é•¿çš„äº‹æƒ…é‡Œå­¦åˆ°çŸ¥è¯†</li>
<li>å®è·µå’Œæµ‹éªŒæ‰èƒ½æš´éœ²å­¦ä¹ æ¼æ´</li>
</ul>
</li>
</ul>
<p>è¯»ä¹¦ç¬”è®°ï¼š</p>
<ul>
<li>6ã€é€‰æ‹©é€‚åˆè‡ªå·±çš„å­¦ä¹ é£æ ¼<ul>
<li>ä¸»åŠ¨å­¦ä¹ èƒ½åˆ¶é€ æŒæ§æ„Ÿ</li>
<li>ä½ æ˜¯åˆ†æå‹ã€åˆ›æ–°å‹ã€è¿˜æ˜¯å®è·µå‹æ€ç»´<ul>
<li>ç¬¬ä¸€ç§æ™ºåŠ›åŒºåˆ†æ¨¡å‹ï¼š8ç§<ul>
<li>é€»è¾‘â€”â€”æ•°å­¦æ™ºåŠ›ï¼šæ‰¹åˆ¤æ€§æ€è€ƒï¼Œä»¥åŠä½¿ç”¨æ•°å­—å’ŒæŠ½è±¡æ¦‚å¿µçš„èƒ½ åŠ›ï¼Œè¯¸å¦‚æ­¤ç±»ã€‚</li>
<li>ç©ºé—´æ™ºåŠ›ï¼šä¸‰ç»´åˆ¤æ–­ï¼Œä»¥åŠåœ¨è„‘æµ·ä¸­å…·è±¡åŒ–çš„èƒ½åŠ›ã€‚</li>
<li>è¯­è¨€æ™ºåŠ›ï¼šä½¿ç”¨æ–‡å­—å’Œè¯­è¨€çš„èƒ½åŠ›ã€‚</li>
<li>è‚¢ä½“åŠ¨è§‰æ™ºåŠ›ï¼šè¡ŒåŠ¨æ•æ·å’Œæ§åˆ¶èº«ä½“çš„èƒ½åŠ›ã€‚</li>
<li>éŸ³ä¹æ™ºåŠ›ï¼šå¯¹å£°éŸ³ã€æ—‹å¾‹ã€éŸ³è‰²ï¼Œä»¥åŠéŸ³ä¹çš„æ•æ„Ÿæ€§ã€‚</li>
<li>äººé™…äº¤å¾€æ™ºåŠ›ï¼šâ€œè¯»æ‡‚â€ä»–äººï¼Œä»¥åŠä¸äººæœ‰æ•ˆåä½œçš„èƒ½åŠ›ã€‚</li>
<li>å†…çœæ™ºåŠ›ï¼šç†è§£è‡ªèº«ï¼Œå‡†ç¡®åˆ¤æ–­è‡ªèº«çŸ¥è¯†ã€èƒ½åŠ›ã€æ•ˆç‡çš„èƒ½åŠ›ã€‚</li>
<li>è‡ªç„¶è§‚å¯Ÿæ™ºåŠ›ï¼šåŒºåˆ†å’Œå…³è”å‘¨å›´è‡ªç„¶ç¯å¢ƒçš„èƒ½åŠ›ï¼ˆä¾‹å¦‚å›­ä¸ã€çŒäºº æˆ–å¨å¸ˆç‰¹æœ‰çš„æ™ºåŠ›ï¼‰ã€‚</li>
</ul>
</li>
<li>ç¬¬äºŒç§æ™ºåŠ›åŒºåˆ†æ¨¡å‹ï¼š3ç§<ul>
<li>åˆ†æå‹æ™ºåŠ› ï¼šåˆ†æå‹æ™ºåŠ›æ˜¯æˆ‘ä»¬è§£å†³é—®é¢˜çš„èƒ½åŠ›ï¼Œå…¸å‹çš„ä¾‹å­å°±æ˜¯è§£ç­”æµ‹éªŒä¸­çš„é—®é¢˜</li>
<li>åˆ›æ–°å‹æ™ºåŠ› ï¼šåˆ›æ–°å‹æ™ºåŠ›æ˜¯æˆ‘ä»¬ç»¼åˆå¹¶åº”ç”¨ç°æœ‰çš„çŸ¥è¯†ä¸æŠ€èƒ½ï¼Œåº”å¯¹é‚£äº›æ–°çš„ç‰¹æ®Šæƒ…å†µçš„èƒ½åŠ›ï¼›</li>
<li>å®è·µå‹æ™ºåŠ› ï¼šå®è·µå‹æ™ºåŠ›æ˜¯æˆ‘ä»¬é€‚åº”æ—¥å¸¸ç”Ÿæ´»çš„èƒ½åŠ›â€”â€”æ˜ç™½åœ¨å…·ä½“ç¯å¢ƒä¸‹éœ€è¦åšä»€ä¹ˆå¹¶è¡ŒåŠ¨ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬æ‰€è¯´çš„â€œè¡—å¤´æ™ºæ…§â€ã€‚</li>
</ul>
</li>
</ul>
</li>
<li>å­¦ä¸å¥½çš„é¢†åŸŸæš´éœ²äº†ä½ çš„èƒ½åŠ›ç»“æ„</li>
<li>ç”¨æ­ç§¯æœ¨çš„æ–¹æ³•æ„å»ºçŸ¥è¯†</li>
<li>æœ‰äººå–œæ¬¢çœ‹è¯´æ˜ä¹¦ï¼Œæœ‰äººå–œæ¬¢åŠ¨æ‰‹è¯•é”™</li>
</ul>
</li>
</ul>
<p>è¯»ä¹¦ç¬”è®°ï¼šä¸åŒçš„æ–‡åŒ–ä¸å­¦ä¹ åœºæ™¯éœ€è¦ä¸åŒçš„æ™ºåŠ›ç±»å‹ã€‚</p>
<ul>
<li>7ã€ç»ˆèº«å­¦ä¹ è€…åŸºæœ¬çš„åŸºæœ¬<ul>
<li>åŒèƒèƒçš„è®¤çŸ¥èƒ½åŠ›ä¹Ÿä¼šå¤©å·®åœ°åˆ«<br>å¤§è„‘çš„ç»“æ„ä¸æ•´ä½“æ„é€ åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šæ˜¯ç”±åŸºå› å†³å®šçš„ï¼Œä½†ç¥ç»ç½‘ç»œçš„ç²¾ç»†æ„é€ ä¼¼ä¹ä¹Ÿå¯ä»¥ç”±ç»éªŒæ¥å¡‘é€ ï¼Œè€Œä¸”å…·å¤‡å¤§å¹…ä¿®æ”¹çš„èƒ½åŠ›ã€‚</li>
<li>æ€§æ ¼ã€æ±‚çŸ¥æ¬²å’Œå®¶åº­æ¡ä»¶å¯¹å­¦ä¹ çš„å½±å“<br>æ™ºå•†æ˜¯åŸºå› ğŸ§¬ä¸ç¯å¢ƒå…±åŒä½œç”¨çš„äº§ç‰©ã€‚<br>äººç±»æ™ºå•†åœ¨æŒç»­å‡é«˜ï¼Œå› ä¸ºæ•™è‚²ã€æ–‡åŒ–ï¼ˆç”µè§†æœºå…´èµ·ï¼‰ã€è¥å…»ï¼ˆè„‚è‚ªé…¸ã€é“ã€ç»´Bï¼‰å‘ç”Ÿäº†æå¤§çš„å˜åŒ–ã€‚<br>ç¤¾ä¼šç»æµåœ°ä½ä¹Ÿä¼šå½±å“æ™ºå•†ã€‚æ—©æœŸæ•™è‚²å¯ä»¥æå‡è´«å›°å­©å­çš„æ™ºå•†ã€‚</li>
<li>è„‘åŠ›è®­ç»ƒå¯ä»¥æå‡å­¦ä¹ è‡ªä¿¡<br>æµä½“æ™ºåŠ›ï¼šæŒ‡æ¨ç†ã€å‘ç°å…³ç³»ã€æŠ½è±¡ æ€ç»´ï¼Œä»¥åŠåœ¨è§£å†³é—®é¢˜çš„åŒæ—¶å¤´è„‘ä¸­ä¿ç•™ä¿¡æ¯çš„èƒ½åŠ›ã€‚<br>æ™¶ä½“æ™ºåŠ›ï¼šæŒ‡ç§¯ç´¯çš„å…³äºä¸–ç•Œçš„çŸ¥è¯†ï¼Œä»¥åŠä»è¿‡å»çš„å­¦ä¹ ä¸ç»éªŒä¸­æç‚¼å‡ºæ¥çš„ ç¨‹åºæˆ–å¿ƒæ™ºæ¨¡å‹ã€‚</li>
<li>æƒ³è¦ç»ˆèº«æˆé•¿ï¼Œè¯·åƒä¸“å®¶ä¸€æ ·æ€è€ƒ<br>1ã€ä¿¡å¿µï¼šä½ è¦ç›¸ä¿¡æ™ºåŠ›æ°´å¹³ä¸æ˜¯å›ºå®šçš„ï¼Œè€Œæ˜¯åœ¨å¾ˆå¤§ç¨‹åº¦ä¸ŠæŒæ¡åœ¨è‡ªå·±æ‰‹ä¸­ã€‚<br>2ã€é¢å¯¹å¤±è´¥çš„æ€åº¦ï¼šé‚£äº›å°†å¤±è´¥å½’å’äºæœ¬èº«æ— èƒ½çš„äººâ€”â€”è¯´â€œæˆ‘å°±æ˜¯ä¸å¤Ÿèªæ˜â€çš„äººâ€”â€”ä¼šå˜å¾—æ— åŠ©ï¼›è€Œé‚£äº›è®¤ä¸ºå¤±è´¥æ˜¯åŠªåŠ›ä¸å¤Ÿæˆ–ç­–ç•¥ä¸å¯¹çš„äººåˆ™ä¼šæ·±å…¥å‘æ˜ï¼Œå°è¯•ä¸åŒçš„åšæ³•ã€‚<br>3ã€ç›®æ ‡ï¼šæœ‰çš„å­¦ç”Ÿä»¥æˆç»©ä¸ºç›®æ ‡ï¼Œè€Œæœ‰çš„å­¦ç”Ÿåˆ™ä»¥å­¦ä¹ ä¸ºç›®æ ‡ã€‚å¯¹äºå‰ä¸€ç§äººæ¥è¯´ï¼Œä»–ä»¬åŠªåŠ›æ˜¯ä¸ºäº†è¯æ˜è‡ªå·±çš„èƒ½åŠ›ã€‚å¯¹äºç¬¬äºŒç§äººæ¥è¯´ï¼Œä»–ä»¬åŠªåŠ›åˆ™æ˜¯ä¸ºäº†å­¦åˆ°æ–°çš„çŸ¥è¯†æˆ–æŠ€èƒ½</li>
<li>å­¦ä¹ æ‰§è¡ŒåŠ›æ¯”å­¦ä¹ æŠ€å·§æ›´é‡è¦ï¼šæˆä¸ºä¸“å®¶éœ€è¦ä¸€ä¸‡å°æ—¶åˆ»æ„ç»ƒä¹ ã€‚</li>
<li>æŒæ¡å‡ ä¸ªé€‚åˆè‡ªå·±çš„è®°å¿†æ–¹æ³•ï¼šè®°å¿†å®«æ®¿ç­‰è®°å¿†æŠ€å·§</li>
</ul>
</li>
</ul>
<p>è¯»ä¹¦ç¬”è®°ï¼šæ™ºå•† = åŸºå›  + ç¯å¢ƒå› ç´ ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡æ”¹å˜ç¯å¢ƒå› ç´ æå‡æˆ‘ä»¬çš„æ™ºå•†ã€‚</p>
<ul>
<li>8ã€å†™ç»™å¤§å®¶çš„å­¦ä¹ ç­–ç•¥<ul>
<li>ç»™å­¦ç”Ÿçš„å­¦ä¹ ç­–ç•¥<ul>
<li>ç»ƒä¹ ä»è®°å¿†ä¸­æ£€ç´¢æ–°çŸ¥è¯†</li>
<li>æœ‰é—´éš”çš„å®‰æ’æ£€ç´¢ç»ƒä¹ </li>
<li>å­¦ä¹ æ—¶ç©¿æ’å®‰æ’ä¸åŒç±»å‹é—®é¢˜</li>
</ul>
</li>
<li>ç»™èŒåœºäººå£«çš„å­¦ä¹ ç­–ç•¥</li>
<li>ç»™æ•™å¸ˆçš„å­¦ä¹ ç­–ç•¥<ul>
<li>å‘å­¦ç”Ÿè§£é‡Šå­¦ä¹ çš„è¿‡ç¨‹</li>
<li>æ•™å­¦ç”Ÿå¦‚ä½•å­¦ä¹ </li>
<li>åœ¨è¯¾å ‚ä¸Šåˆ›é€ åˆæ„å›°éš¾</li>
<li>ä¿è¯é€æ˜åº¦ï¼šè®©å­¦ç”Ÿç†è§£ç”¨æ„ã€‚</li>
</ul>
</li>
<li>ç»™åŸ¹è®­è€…çš„å­¦ä¹ ç­–ç•¥</li>
</ul>
</li>
</ul>
<h5 id="å…¨ä¹¦æ€»ç»“"><a href="#å…¨ä¹¦æ€»ç»“" class="headerlink" title="å…¨ä¹¦æ€»ç»“"></a>å…¨ä¹¦æ€»ç»“</h5><p>ä»ä½œè€…çš„èŒä¸šå¯ä»¥çœ‹å‡ºï¼Œä¸€ä¸ªå‡ºç‰ˆäººå’Œä¸¤ä¸ªæ•™æˆåˆä½œå‡ºç‰ˆçš„ä¸€æœ¬ä¹¦ã€‚å±äºè®¤çŸ¥å¿ƒç†å­¦èŒƒç•´ã€‚ä¸»è¦ä»‹ç»å­¦ä¹ ã€è®¤çŸ¥ã€å¤§è„‘ç›¸å…³å®éªŒå’Œç»“è®ºã€‚</p>
<p>1ã€è‡ªå·±ç©¶ç«Ÿæœ‰æ²¡æœ‰æŒæ¡ä¸€ä¸ªçŸ¥è¯†ç‚¹ã€‚è€ƒè¯•ï¼ˆæµ‹éªŒã€è‡ªæµ‹ï¼‰æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„æ£€éªŒæ‰‹æ®µã€‚ä¸åƒå­¦æ ¡é‡Œçš„è€ƒè¯•ï¼Œè¦ä»¥æ­£ç¡®çš„å¿ƒæ€çœ‹å¾…è€ƒè¯•ï¼Œåªæ˜¯æ£€æµ‹è‡ªå·±çŸ¥è¯†çš„æŒæ¡åº¦ï¼Œè€Œä¸æ˜¯è¦ä¸€è¾ƒé«˜ä¸‹ã€‚</p>
<p>ä¸ªäººç†è§£ï¼š<br>è·å–åˆ°æ–°çŸ¥è¯†ï¼Œåœç•™åœ¨æµ…å±‚è®°å¿†ï¼Œä¼šæœ‰è¿·æƒ‘æ€§ï¼Œä»¥ä¸ºè‡ªå·±æ‡‚äº†ã€‚å®åˆ™è¿‡æ®µæ—¶é—´å°±å¿˜è®°äº†ã€‚æˆ‘ä»¬åº”è¯¥é—´éš”æ€§çš„å›å¿†çŸ¥è¯†ï¼Œå†…åŒ–å¸æ”¶ï¼Œè¿™æ ·æ‰èƒ½å°†çŸ¥è¯†çµæ´»è¿ç”¨ã€‚</p>
]]></content>
  </entry>
  <entry>
    <title>ã€Šéº»çœç†å·¥æ·±åº¦æ€è€ƒæ³•ã€‹</title>
    <url>/%E3%80%8A%E9%BA%BB%E7%9C%81%E7%90%86%E5%B7%A5%E6%B7%B1%E5%BA%A6%E6%80%9D%E8%80%83%E6%B3%95%E3%80%8B.html</url>
    <content><![CDATA[<hr>
<h4 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h4><h6 id="ä¹¦ç±ç®€ä»‹"><a href="#ä¹¦ç±ç®€ä»‹" class="headerlink" title="ä¹¦ç±ç®€ä»‹"></a>ä¹¦ç±ç®€ä»‹</h6><table>
    <tr>
        <td><img src="../images/books/masheng-thinking.jpg" width="100"/></td>
        <td>éº»çœç†å·¥æ·±åº¦æ€è€ƒæ³• : ä»æ¨¡å‹åŠåŠ¨åŠ›æœºåˆ¶æ¥æ€è€ƒç°è±¡</td>
    </tr>
</table>

<h6 id="å…³äºä½œè€…"><a href="#å…³äºä½œè€…" class="headerlink" title="å…³äºä½œè€…"></a>å…³äºä½œè€…</h6><p>[æ—¥] å¹³äº•å­å¿—ï¼ˆTakashi Hiraiï¼‰,ç½—å…°è´æ ¼ç®¡ç†å’¨è¯¢å…¬å¸æ‰§è¡Œè‘£äº‹,ä¸œäº¬å¤§å­¦ç†å­¦ç¡•å£«ã€éº»çœç†å·¥MBAåšå£«ã€‚</p>
<p>å…¶ä»–å‡ºç‰ˆç‰©ï¼š</p>
<ul>
<li>ã€Šæœ¬è³ªæ€è€ƒ : MITèè‹±é€™æ¨£æ‰¾åˆ°å•é¡Œæ ¹æºï¼Œè§£æ±ºå›°å¢ƒã€‹ã€</li>
<li>ã€Šå›¾åƒæ€è€ƒæœ¯ : ä¸ºä»€ä¹ˆèªæ˜äººä¼šé€šè¿‡ç”»å›¾æ¥æ€è€ƒï¼Ÿå¦‚ä½•ç”¨ä¸€é¡µçº¸è§£å†³ç”Ÿæ´»å’Œå·¥ä½œé—®é¢˜ã€‹</li>
</ul>
<h4 id="ä¹¦æœ¬çš„ç»“æ„"><a href="#ä¹¦æœ¬çš„ç»“æ„" class="headerlink" title="ä¹¦æœ¬çš„ç»“æ„"></a>ä¹¦æœ¬çš„ç»“æ„</h4><ol>
<li>ä¹ä¸ªæ€ç»´å®šå¼ï¼ˆäº†è§£æ€ç»´å®šå¼æ‰èƒ½æ³¨æ„ğŸ“¢é¿å…ï¼‰</li>
<li>æ¨¡å‹å’ŒåŠ¨åŠ›æœºåˆ¶</li>
<li>ç¬¬ä¸€æ­¥ï¼šå»ºç«‹æ¨¡å‹</li>
<li>ç¬¬äºŒæ­¥ï¼šè§£è¯»åŠ¨åŠ›æœºåˆ¶</li>
<li>ç¬¬ä¸‰æ­¥ï¼šå¯»æ‰¾æ”¹å˜æ¨¡å‹çš„å¯¹ç­–</li>
<li>ç¬¬å››æ­¥ï¼šä»å®è·µè·å¾—åé¦ˆ</li>
<li>æ—¥å¸¸è®­ç»ƒæ–¹æ³•</li>
</ol>
<h5 id="ä¹ä¸ªæ€ç»´å®šå¼"><a href="#ä¹ä¸ªæ€ç»´å®šå¼" class="headerlink" title="ä¹ä¸ªæ€ç»´å®šå¼"></a>ä¹ä¸ªæ€ç»´å®šå¼</h5><ul>
<li>åˆçº§æ€ç»´å®šå¼<ul>
<li>å› æœå€’ç½®â€”â€”â€”â€”â€”â€”ï¼ˆè¡¨é¢ç°è±¡ä¸æ˜¯åŸå› ï¼Œç©¶å…¶ç°è±¡çš„æœ¬è´¨ï¼‰</li>
<li>æ»¡è¶³äºæ™®é€šè§£</li>
</ul>
</li>
<li>å¯èƒ½é™·å…¥ä¸¤éš¾çš„ä¸¥å³»å®šå¼<ul>
<li>ä¾èµ–æ¡†æ¶â€”â€”â€”â€”â€”â€”ï¼ˆæ¡†æ¶æ˜¯å·¥å…·ï¼Œä¸æ»¡è¶³äºå·¥å…·çš„ä½¿ç”¨ï¼Œè€Œæ˜¯å€ŸåŠ©æ¡†æ¶æ€è€ƒï¼‰</li>
<li>èŒƒå›´é€‚åº”â€”â€”â€”â€”â€”â€”ï¼ˆæŒ‡ç€çœ¼äºäº‹ç‰©åˆ†ç±»ä»¥å¯»æ‰¾è§£é‡Šï¼‰</li>
<li>æ€è€ƒæ­¢äºå…³é”®è¯â€”â€”â€”â€”â€”â€”ï¼ˆè¦ç†è§£å’Œæ€è€ƒä¸€äº›é«˜å¤§ä¸Šçš„å…³é”®è¯çš„å«ä¹‰ï¼Œåˆ«ä»¥ä¸ºä½ æ‡‚äº†ï¼‰</li>
<li>æ‰§ç€äºåˆæ­¥å‡è®¾</li>
</ul>
</li>
<li>ä¸èƒ½è¿ˆå…¥æ€è€ƒå¤§é—¨çš„ç—‡çŠ¶<ul>
<li>å¿˜å´æ€è€ƒçš„åˆè¡·â€”â€”â€”â€”â€”â€”ï¼ˆæ”¶é›†èµ„æ–™æ˜¯ä¸ºäº†ä½¿ç”¨èµ„æ–™ï¼Œè€Œä¸æ˜¯ç›®çš„ï¼‰</li>
<li>åé‡è¿‡ç¨‹</li>
<li>å¤±å»ç‹¬ç«‹æ€ç»´â€”â€”â€”â€”â€”â€”ï¼ˆä¾èµ–ä»–äººï¼Œä¸€å‘³åœ°â€æ˜¯å•Šâ€ï¼Œâ€å¯¹å•Šâ€ï¼Œâ€æ˜¯è¿™æ ·å—ï¼Ÿâ€ï¼‰</li>
</ul>
</li>
</ul>
<h5 id="æ¨¡å‹å’ŒåŠ¨åŠ›æœºåˆ¶"><a href="#æ¨¡å‹å’ŒåŠ¨åŠ›æœºåˆ¶" class="headerlink" title="æ¨¡å‹å’ŒåŠ¨åŠ›æœºåˆ¶"></a>æ¨¡å‹å’ŒåŠ¨åŠ›æœºåˆ¶</h5><blockquote>
<p>â€œæœ¬è´¨â€ = â€œæ¨¡å‹â€ Ã— â€œåŠ¨åŠ›æœºåˆ¶â€</p>
</blockquote>
<blockquote>
<p>â€œæ¨¡å‹æ˜¯æŒ‡äº§ç”ŸæŸç§ç°è±¡çš„ç»“æ„ï¼ŒåŒ…æ‹¬æ„æˆè¦ç´ åŠå…¶ç›¸äº’å…³ç³»ã€‚â€</p>
</blockquote>
<blockquote>
<p>â€œæ‰€è°“åŠ¨åŠ›æœºåˆ¶ï¼Œæ˜¯ä»¥é•¿è¿œç›®å…‰è§‚å¯Ÿæ¨¡å‹äº§ç”Ÿçš„ç°è±¡ï¼Œä»¥åŠä»Šåå°†ä¼šäº§ç”Ÿæ€æ ·çš„ç»“æœåŠåŠ¨å‘ï¼Œå³ä¼šå‡ºç°æ€æ ·çš„æ¨¡å¼ã€‚â€</p>
</blockquote>
<center>
    <img src="../images/books/moxing-dongli.jpg" width="400"/>
</center>


<p>æ¨¡å‹æ˜¯ä»€ä¹ˆï¼Ÿ</p>
<ul>
<li>å‰¥ç¦»ç»†ææœ«èŠ‚åçš„ç²¾ç®€æ¦‚å¿µå›¾æˆ–å› æœå¾ªç¯å›¾</li>
</ul>
<p>åŠ¨åŠ›æœºåˆ¶æ˜¯ä»€ä¹ˆï¼Ÿ</p>
<ul>
<li>æ¨¡å‹éšç€æ—¶é—´æµé€äº§ç”Ÿçš„è¿åŠ¨åŠç»“æœ</li>
</ul>
<h5 id="å»ºç«‹æ¨¡å‹"><a href="#å»ºç«‹æ¨¡å‹" class="headerlink" title="å»ºç«‹æ¨¡å‹"></a>å»ºç«‹æ¨¡å‹</h5><ul>
<li>åˆ†æé—®é¢˜çš„å› ç´ ï¼ŒåŠå…¶å› æœå…³ç³»</li>
<li>ç”¨ä¸€å¼ å›¾ç»˜åˆ¶å‡ºå› æœå¾ªç¯å›¾</li>
</ul>
<center>
    <img src="../images/books/yinguo-xunhuantu.jpg" width="400"/>
</center>

<p>å»ºæ¨¡è¦ç‚¹â‘ ï¼š5ä¸ªè¦ç´ ï¼š</p>
<ul>
<li>â€œè¾“å…¥æºæ˜¯æŒ‡æŠ•å…¥æ¨¡å‹ä¸­çš„è¦ç´ â€</li>
<li>â€œè¾“å‡ºç‚¹æ˜¯æŒ‡æ¨¡å‹äº§ç”Ÿçš„æˆæœâ€</li>
<li>â€œç«äº‰å…³ç³»æ˜¯æŒ‡åœ¨è¾“å…¥åŠè¾“å‡ºç­‰æ–¹é¢äº’ç›¸ç«äº‰çš„å¯¹è±¡â€</li>
<li>â€œåˆä½œå…³ç³»æ˜¯æŒ‡åœ¨ä¸€èµ·å¯ä»¥äº’è¡¥æˆ–åä½œçš„å¯¹è±¡â€</li>
<li>â€œå½±å“è€…æ˜¯æŒ‡é—´æ¥å¯¹æ¨¡å‹æ•´ä½“äº§ç”Ÿé‡å¤§å½±å“çš„è¦ç´ â€</li>
</ul>
<p>å»ºæ¨¡è¦ç‚¹â‘¡ï¼šå±‚æ¬¡ç»“æ„</p>
<center>
    <img src="../images/books/model-level.jpg" width="400"/>
</center>

<p>å»ºæ¨¡è¦ç‚¹â‘¢ï¼šæ³¨é‡å› æœï¼Œæ— è§†ç›¸å…³</p>
<center>
    <img src="../images/books/xiangguan-yinguo.jpg" width="400"/>
</center>

<h5 id="è§£è¯»åŠ¨åŠ›æœºåˆ¶"><a href="#è§£è¯»åŠ¨åŠ›æœºåˆ¶" class="headerlink" title="è§£è¯»åŠ¨åŠ›æœºåˆ¶"></a>è§£è¯»åŠ¨åŠ›æœºåˆ¶</h5><p>â€œåŠ¨åŠ›æœºåˆ¶çš„ 6 ç§ä»£è¡¨æ€§æ¨¡å¼â€</p>
<center>
    <img src="../images/books/donglijizhi-moshi.jpg" width="400"/>
</center>

<ul>
<li><p>åŠ¨åŠ›æœºåˆ¶æ¢ç©¶è¦ç‚¹â‘ ï¼šåˆ†å¼€ç ”ç©¶å­˜é‡å’Œæµé‡</p>
</li>
<li><p>åŠ¨åŠ›æœºåˆ¶æ¢ç©¶è¦ç‚¹â‘¡ï¼šå¯¹äº‹ç‰©è¿›è¡Œéçº¿æ€§è§£è¯»</p>
</li>
<li><p>åŠ¨åŠ›æœºåˆ¶æ¢ç©¶è¦ç‚¹â‘¢ï¼šæ¢ç©¶ä½œç”¨ä¸åä½œç”¨</p>
</li>
<li><p>åŠ¨åŠ›æœºåˆ¶æ¢ç©¶è¦ç‚¹â‘£ï¼šä»å„è¦ç´ çš„è§†è§’è¿›è¡Œæ·±å±‚æ¬¡çš„æ€è€ƒ</p>
</li>
<li><p>åŠ¨åŠ›æœºåˆ¶çš„è§£è¯»æ–¹æ³•â‘ ã€€æ¢ç©¶æ‹ç‚¹</p>
</li>
<li><p>åŠ¨åŠ›æœºåˆ¶çš„è§£è¯»æ–¹æ³•â‘¡ã€€ç ”ç©¶ç›¸å˜ï¼ˆç›¸å˜ä½¿åŠ¨åŠ›æœºåˆ¶ä¸å†è¿ç»­ï¼‰</p>
</li>
<li><p>åŠ¨åŠ›æœºåˆ¶çš„è§£è¯»æ–¹æ³•â‘¢ã€€é”å®šæœ¬æºåŠ¨åŠ›</p>
</li>
</ul>
<h5 id="å¯»æ‰¾æ”¹å˜æ¨¡å‹çš„å¯¹ç­–-å¯»æ‰¾è§£å†³é—®é¢˜çš„æ ¹æœ¬æ–¹æ³•"><a href="#å¯»æ‰¾æ”¹å˜æ¨¡å‹çš„å¯¹ç­–-å¯»æ‰¾è§£å†³é—®é¢˜çš„æ ¹æœ¬æ–¹æ³•" class="headerlink" title="å¯»æ‰¾æ”¹å˜æ¨¡å‹çš„å¯¹ç­–(å¯»æ‰¾è§£å†³é—®é¢˜çš„æ ¹æœ¬æ–¹æ³•)"></a>å¯»æ‰¾æ”¹å˜æ¨¡å‹çš„å¯¹ç­–(å¯»æ‰¾è§£å†³é—®é¢˜çš„æ ¹æœ¬æ–¹æ³•)</h5><ul>
<li>å¯»æ‰¾å¯¹ç­–çš„è¦ç‚¹â‘  æ­£ç¡®ç†è§£å‰ææ¡ä»¶</li>
<li>å¯»æ‰¾å¯¹ç­–çš„è¦ç‚¹â‘¡ åŸå› ä¸ä¸€å®šæ¥è¿‘ç»“æœ</li>
<li>å¯»æ‰¾å¯¹ç­–çš„è¦ç‚¹â‘¢ å°†æ€è€ƒèŒƒå›´æ‰©å±•åˆ°å—å½±å“çš„æ–¹æ–¹é¢é¢ï¼ˆä¸æ–­åœ°é—®è‡ªå·±æ˜¯å¦è€ƒè™‘åˆ°äº†æ‰€æœ‰å¯èƒ½æœ‰å½±å“çš„å› ç´ ï¼‰</li>
<li>å¯»æ‰¾å¯¹ç­–çš„è¦ç‚¹â‘£ æå‡è§†è§’<ul>
<li>å°è¯•å¶å°”æ”¾ä¸‹çœ¼å‰çš„é—®é¢˜ï¼ˆå¦‚æœè¢«çœ¼å‰çš„é—®é¢˜å ç”¨å¤ªå¤šæ³¨æ„åŠ›ï¼Œå°±å¾ˆéš¾æ‘¸ç´¢å‡ºé—®é¢˜çš„æ•´ä½“è„‰ç»œï¼‰</li>
</ul>
</li>
<li>å¯»æ‰¾å¯¹ç­–çš„è¦ç‚¹â‘¤ æƒ³ä¸€æƒ³â€œè¯¥å¦‚ä½•æ€è€ƒâ€<ul>
<li>â€œé¦–å…ˆæ€è€ƒçš„åº”è¯¥æ˜¯æ€è€ƒé¡ºåºå’Œåˆ¤æ–­æ ‡å‡†â€</li>
</ul>
</li>
</ul>
<h5 id="ä»å®è·µè·å¾—åé¦ˆ"><a href="#ä»å®è·µè·å¾—åé¦ˆ" class="headerlink" title="ä»å®è·µè·å¾—åé¦ˆ"></a>ä»å®è·µè·å¾—åé¦ˆ</h5><p>ä»å®è·µä¸­å¾—åˆ°çš„åé¦ˆå¯ä»¥æé«˜æ€è€ƒç²¾ç¡®åº¦ï¼Œåå¤ç»ƒä¹ å»ºç«‹æ¨¡å‹ã€è§£è¯»åŠ¨åŠ›æœºåˆ¶ã€å¯»æ‰¾æ”¹å˜æ¨¡å‹çš„å¯¹ç­–ã€‚</p>
<h5 id="æ—¥å¸¸è®­ç»ƒæ–¹æ³•"><a href="#æ—¥å¸¸è®­ç»ƒæ–¹æ³•" class="headerlink" title="æ—¥å¸¸è®­ç»ƒæ–¹æ³•"></a>æ—¥å¸¸è®­ç»ƒæ–¹æ³•</h5><p>ç•¥ã€‚</p>
<h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><ul>
<li>å…¨ä¹¦çš„æ ¸å¿ƒåœ¨ç¬¬å››ç¬¬äº”ç« ã€‚å…¶ä»–éƒ¨åˆ†å¯ä»¥å¿«é€Ÿè·³è¯»ã€‚</li>
<li>å…¨ä¹¦å›´ç»•1.å»ºç«‹æ¨¡å‹ã€2.è§£è¯»åŠ¨åŠ›æœºåˆ¶ã€3.æ”¹å˜æ¨¡å‹ï¼Œè¿™ä¸‰ä¸ªæ­¥éª¤ä»‹ç»äº†å½“æˆ‘ä»¬é‡åˆ°å„ç§é—®é¢˜æ—¶ï¼Œæˆ‘ä»¬åº”è¯¥å¦‚ä½•åˆ†æé—®é¢˜ï¼Œæ‰¾å‡ºé—®é¢˜çš„æœ¬è´¨ï¼Œç„¶åä»æœ¬è´¨è§£å†³é—®é¢˜æœ¬èº«ï¼Œè€Œä¸æ˜¯æµ®äºè¡¨é¢ã€‚åŒæ—¶ï¼Œè„‘æµ·ä¸­è¦ç‰¢è®°ä¸€äº›æ€ç»´å®šå¼ï¼Œé¿å…é™·å…¥æ€ç»´å®šå¼å½“ä¸­ã€‚</li>
</ul>
]]></content>
      <categories>
        <category>Reading</category>
      </categories>
      <tags>
        <tag>Reading</tag>
      </tags>
  </entry>
</search>
